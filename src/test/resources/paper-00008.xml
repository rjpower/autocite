<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml>
<page number="1" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="0" size="19" family="Times" color="#000000"/>
	<fontspec id="1" size="11" family="Times" color="#000000"/>
	<fontspec id="2" size="35" family="Times" color="#000000"/>
	<fontspec id="3" size="15" family="Times" color="#000000"/>
	<fontspec id="4" size="9" family="Times" color="#000000"/>
	<fontspec id="5" size="12" family="Times" color="#000000"/>
<text top="83" left="265" width="362" height="19" font="0">Journal of Object Technology</text>
<text top="103" left="178" width="538" height="17" font="1">Published by AITO ‚Äî Association Internationale pour les Technologies Objets, <a href="http://www.jot.fm/copyright.html">¬© JOT 2011</a></text>
<text top="119" left="357" width="182" height="17" font="1">Online at <a href="http://www.jot.fm">http://www.jot.fm.</a></text>
<text top="227" left="370" width="152" height="34" font="2">CSOM/PL</text>
<text top="272" left="218" width="456" height="34" font="2">A Virtual Machine Product Line</text>
<text top="329" left="231" width="114" height="16" font="3"><a href="pdfxml.html#30">Michael Haupt</a></text>
<text top="327" left="345" width="6" height="11" font="4"><a href="pdfxml.html#30">a</a></text>
<text top="329" left="389" width="93" height="16" font="3"><a href="pdfxml.html#30">Stefan Marr</a></text>
<text top="327" left="482" width="7" height="11" font="4"><a href="pdfxml.html#30">b</a></text>
<text top="329" left="526" width="136" height="16" font="3"><a href="pdfxml.html#30">Robert Hirschfeld</a></text>
<text top="327" left="662" width="6" height="11" font="4"><a href="pdfxml.html#30">c</a></text>
<text top="360" left="208" width="235" height="19" font="5">a. Oracle Labs, Potsdam, Germany</text>
<text top="383" left="230" width="180" height="12" font="5"><a href="http://labs.oracle.com/">http://labs.oracle.com/</a></text>
<text top="396" left="230" width="335" height="19" font="5">(work performed while at Hasso Plattner Institute)</text>
<text top="420" left="207" width="418" height="19" font="5">b. Software Languages Lab, Vrije Universiteit Brussel, Belgium</text>
<text top="443" left="230" width="173" height="12" font="5"><a href="http://soft.vub.ac.be/">http://soft.vub.ac.be/</a></text>
<text top="463" left="209" width="476" height="19" font="5">c. Software Architecture Group, Hasso Plattner Institute, University of</text>
<text top="481" left="230" width="126" height="19" font="5">Potsdam, Germany</text>
<text top="504" left="230" width="267" height="12" font="5"><a href="http://www.hpi.uni-potsdam.de/swa/">http://www.hpi.uni-potsdam.de/swa/</a></text>
<text top="572" left="207" width="52" height="14" font="5">Abstract</text>
<text top="569" left="275" width="413" height="19" font="5">CSOM/PL is a software product line (SPL) derived from apply-</text>
<text top="587" left="207" width="478" height="19" font="5">ing multi-dimensional separation of concerns (MDSOC) techniques to the</text>
<text top="605" left="207" width="478" height="19" font="5">domain of high-level language virtual machine (VM) implementations. For</text>
<text top="623" left="207" width="480" height="19" font="5">CSOM/PL, we modularised CSOM, a Smalltalk VM implemented in C,</text>
<text top="641" left="207" width="478" height="19" font="5">using VMADL (virtual machine architecture description language). Several</text>
<text top="659" left="207" width="478" height="19" font="5">features of the original CSOM were encapsulated in VMADL modules and</text>
<text top="676" left="207" width="478" height="19" font="5">composed in various combinations. In an evaluation of our approach, we</text>
<text top="694" left="207" width="478" height="19" font="5">show that applying MDSOC and SPL principles to a domain as complex</text>
<text top="712" left="207" width="481" height="19" font="5">as that of VMs is not only feasible but beneÔ¨Åcial, as it improves under-</text>
<text top="730" left="207" width="478" height="19" font="5">standability, maintainability, and conÔ¨Ågurability of VM implementations</text>
<text top="748" left="207" width="199" height="19" font="5">without harming performance.</text>
<text top="784" left="207" width="60" height="14" font="5">Keywords</text>
<text top="781" left="283" width="405" height="19" font="5">Virtual machines, architecture, software product lines, multi-</text>
<text top="799" left="207" width="227" height="19" font="5">dimensional separation of concerns</text>
<text top="847" left="170" width="10" height="20" font="0">1</text>
<text top="847" left="201" width="105" height="20" font="0">Introduction</text>
<text top="881" left="170" width="553" height="19" font="5">Implementors working on high-level language virtual machines (VMs) <a href="pdfxml.html#28">[SN05] </a>typically</text>
<text top="899" left="170" width="553" height="19" font="5">face the characteristic problem of intricately intertwined module dependencies. Even</text>
<text top="917" left="170" width="555" height="19" font="5">though logical modules such as memory management and emulation engine are perceiv-</text>
<text top="935" left="170" width="553" height="19" font="5">able, they can often hardly be identiÔ¨Åed as such in the code. The interdependencies</text>
<text top="953" left="170" width="553" height="19" font="5">lead to partial functionality realisations of logical modules being interwoven with</text>
<text top="971" left="170" width="553" height="19" font="5">other logical modules‚Äô code. This, in turn, is due to a lack of modular abstraction</text>
<text top="989" left="170" width="332" height="19" font="5">application in the domain of VM implementations.</text>
<text top="1007" left="192" width="530" height="19" font="5">A second diÔ¨Éculty with VM implementations is that they frequently need to be</text>
<text top="1025" left="170" width="556" height="19" font="5">tailored to speciÔ¨Åc needs. DiÔ¨Äerent dimensions of interest are relevant in this regard.</text>
<text top="1094" left="170" width="524" height="16" font="4">Michael Haupt, Stefan Marr, Robert Hirschfeld. CSOM/PL A Virtual Machine Product Line. In</text>
<text top="1108" left="170" width="541" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011, </a>pages 1‚Äì30. <a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">doi:10.5381/jot.2011.10.1.a12</a></text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="6" size="8" family="Times" color="#000000"/>
	<fontspec id="7" size="6" family="Times" color="#000000"/>
<text top="74" left="170" width="7" height="14" font="5">2</text>
<text top="74" left="190" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="170" width="556" height="19" font="5">The particular application domain might call for diÔ¨Äerently aggressive optimisation.</text>
<text top="167" left="170" width="452" height="19" font="5">For instance, Oracle‚Äôs HotSpot JVM features two diÔ¨Äerent v<a href="pdfxml.html#2">ersions</a></text>
<text top="169" left="622" width="6" height="9" font="6"><a href="pdfxml.html#2">1</a></text>
<text top="167" left="635" width="88" height="19" font="5">optimised for</text>
<text top="185" left="170" width="556" height="19" font="5">client- or server-speciÔ¨Åc applications, which use diÔ¨Äerent just-in-time (JIT) compilers.</text>
<text top="203" left="170" width="430" height="19" font="5">The conÔ¨Åguration is chosen at VM startup time. The Jikes R<a href="pdfxml.html#2">VM</a></text>
<text top="205" left="600" width="6" height="9" font="6"><a href="pdfxml.html#2">2</a></text>
<text top="203" left="611" width="37" height="19" font="5"><a href="pdfxml.html#26">[AAB</a></text>
<text top="205" left="649" width="9" height="9" font="6"><a href="pdfxml.html#26">+</a></text>
<text top="203" left="658" width="35" height="19" font="5"><a href="pdfxml.html#26">99, A</a></text>
<text top="205" left="694" width="9" height="9" font="6"><a href="pdfxml.html#26">+</a></text>
<text top="203" left="704" width="19" height="19" font="5"><a href="pdfxml.html#26">00]</a></text>
<text top="221" left="170" width="553" height="19" font="5">can employ a selection of two diÔ¨Äerent JIT compilers that can moreover be combined</text>
<text top="239" left="170" width="330" height="19" font="5">with an adaptively optimising infrastructure <a href="pdfxml.html#26">[BCF</a></text>
<text top="241" left="500" width="9" height="9" font="6"><a href="pdfxml.html#26">+</a></text>
<text top="239" left="510" width="23" height="19" font="5"><a href="pdfxml.html#26">99].</a></text>
<text top="257" left="192" width="531" height="19" font="5">Other dimensions of interest are, e. g., memory allocation behaviour, calling for</text>
<text top="275" left="170" width="555" height="19" font="5">diÔ¨Äerent choices of garbage collectors (GCs) <a href="pdfxml.html#27">[JL96, </a><a href="pdfxml.html#26">BCM04]; </a>availability of CPU cores,</text>
<text top="293" left="170" width="555" height="19" font="5">inÔ¨Çuencing the threading model (native or user-level threads, or hybrid scheduling);</text>
<text top="311" left="170" width="553" height="19" font="5">and the target platform, possibly imposing all kinds of limitations on the rest of the</text>
<text top="329" left="170" width="553" height="19" font="5">implementation (e. g., VMs for resource-constrained devices). Clearly, all of the choices</text>
<text top="347" left="170" width="553" height="19" font="5">have implications on the interactions of the diÔ¨Äerent modules, in turn leading to more</text>
<text top="365" left="170" width="183" height="19" font="5">intricate relationships <a href="pdfxml.html#27">[HAT</a></text>
<text top="366" left="353" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="365" left="363" width="23" height="19" font="5"><a href="pdfxml.html#27">09].</a></text>
<text top="383" left="192" width="139" height="19" font="5">Previous work <a href="pdfxml.html#27">[HAT</a></text>
<text top="384" left="332" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="383" left="342" width="381" height="19" font="5"><a href="pdfxml.html#27">09] </a>introduced the notion of service modules to address</text>
<text top="401" left="170" width="556" height="19" font="5">module entangling in VMs. A service module is a module with a bidirectional interface‚Äî</text>
<text top="419" left="170" width="345" height="19" font="5">in the fashion of open modules <a href="pdfxml.html#26">[Ald05] </a>or XPIs <a href="pdfxml.html#27">[GSS</a></text>
<text top="420" left="515" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="419" left="525" width="199" height="19" font="5"><a href="pdfxml.html#27">06]‚Äîthat </a>can not only be sent</text>
<text top="436" left="170" width="553" height="19" font="5">requests, but that can also exhibit internal situations of interest to the outside. An</text>
<text top="454" left="170" width="555" height="19" font="5">initial proposal of an architecture description language (VMADL) was introduced,</text>
<text top="472" left="170" width="553" height="19" font="5">along with a proof of concept implementation, supporting the concepts of service</text>
<text top="490" left="170" width="290" height="19" font="5">modules at the programming language level.</text>
<text top="508" left="192" width="530" height="19" font="5">The characteristics of the second problem suggest to regard the various VM</text>
<text top="526" left="170" width="553" height="19" font="5">subsystems and their variations as features in the sense of a software product line</text>
<text top="544" left="168" width="554" height="19" font="5">(SPL) <a href="pdfxml.html#26">[CN02]. </a>SPL development organises the diÔ¨Äerent shapes of a software system</text>
<text top="562" left="170" width="553" height="19" font="5">in a particular domain along the lines of a feature model. A feature model comprises</text>
<text top="580" left="170" width="553" height="19" font="5">the possible variations in the shapes of the software system‚Äôs features in a formalised</text>
<text top="598" left="170" width="553" height="19" font="5">way, e. g., as a feature diagram. Such a model represents all members of the resulting</text>
<text top="620" left="170" width="96" height="13" font="5">product family</text>
<text top="616" left="266" width="457" height="19" font="5">. Concrete realisations of the software system, according to choices</text>
<text top="634" left="170" width="553" height="19" font="5">made for the diÔ¨Äerent possible variations, are called products. The formalisation allows</text>
<text top="652" left="170" width="518" height="19" font="5">for validating conÔ¨Åguration choices, and for rejecting conÔ¨Çicting conÔ¨Ågurations.</text>
<text top="670" left="192" width="530" height="19" font="5">This article reports on the results achieved in combining the VMADL approach and</text>
<text top="688" left="170" width="555" height="19" font="5">SPL principles and applying them to the VM implementation domain. In particular,</text>
<text top="705" left="170" width="399" height="19" font="5">we have applied these principles and techniques to <a href="pdfxml.html#2">CSOM</a></text>
<text top="707" left="568" width="6" height="9" font="6"><a href="pdfxml.html#2">3</a></text>
<text top="705" left="582" width="37" height="19" font="5"><a href="pdfxml.html#27">[HHP</a></text>
<text top="707" left="618" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="705" left="628" width="95" height="19" font="5"><a href="pdfxml.html#27">10], </a>a VM for</text>
<text top="723" left="170" width="553" height="19" font="5">a Smalltalk <a href="pdfxml.html#27">[GR83] </a>dialect. CSOM is primarily intended for use in teaching, and</text>
<text top="741" left="170" width="555" height="19" font="5">consequently focuses on understandability and clarity. It is moderately complex,</text>
<text top="759" left="170" width="555" height="19" font="5">featuring a bytecode interpreter and a mark/sweep GC <a href="pdfxml.html#27">[JL96]. </a>Despite its simplicity,</text>
<text top="777" left="170" width="380" height="19" font="5">CSOM exhibits characteristic crosscutting concerns <a href="pdfxml.html#27">[HAT</a></text>
<text top="779" left="550" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="777" left="560" width="163" height="19" font="5"><a href="pdfxml.html#27">09]; </a>increasingly so when</text>
<text top="795" left="170" width="316" height="19" font="5">extended with additional or alternative features.</text>
<text top="813" left="192" width="531" height="19" font="5">VMADL was used to modularise several extensions to CSOM that were previously</text>
<text top="831" left="170" width="555" height="19" font="5">introduced by hand. The extensions were of diÔ¨Äerent kinds‚Äîgarbage collectors, multi-</text>
<text top="849" left="170" width="553" height="19" font="5">threading implementations, optimised representation of integral numbers, and image</text>
<text top="867" left="170" width="553" height="19" font="5">persistence‚Äîand exhibited diÔ¨Äerent crosscutting characteristics. Encapsulating these</text>
<text top="885" left="170" width="553" height="19" font="5">extensions in service modules allowed for turning CSOM into an SPL, which we call</text>
<text top="903" left="170" width="70" height="19" font="5"><a href="pdfxml.html#2">CSOM/PL</a></text>
<text top="904" left="240" width="6" height="9" font="6"><a href="pdfxml.html#2">4</a></text>
<text top="903" left="247" width="479" height="19" font="5"><a href="pdfxml.html#2">, </a>enabling diÔ¨Äerent combinations of modules to be chosen at compile-time.</text>
<text top="921" left="192" width="383" height="19" font="5">In summary, the contributions of this paper are as follows.</text>
<text top="946" left="192" width="530" height="19" font="5">‚Ä¢ We present the Ô¨Årst full version and implementation of VMADL. It diÔ¨Äers</text>
<text top="974" left="187" width="5" height="8" font="7"><a href="java.sun.com/ products/ hotspot/ whitepaper.html">1</a></text>
<text top="978" left="193" width="286" height="10" font="4"><a href="java.sun.com/ products/ hotspot/ whitepaper.html">java.sun.com/products/hotspot/whitepaper.html</a></text>
<text top="989" left="187" width="5" height="8" font="7"><a href="jikesrvm.org">2</a></text>
<text top="992" left="193" width="76" height="10" font="4"><a href="jikesrvm.org">jikesrvm.org</a></text>
<text top="1003" left="187" width="5" height="8" font="7"><a href="www.hpi.uni-potsdam.de/swa/projects/som">3</a></text>
<text top="1006" left="193" width="248" height="10" font="4"><a href="www.hpi.uni-potsdam.de/swa/projects/som">www.hpi.uni-potsdam.de/swa/projects/som</a></text>
<text top="1017" left="187" width="5" height="8" font="7">4</text>
<text top="1019" left="193" width="531" height="11" font="4">The code and live CD with CSOM/PL are available at <a href="www.hpi.uni-potsdam.de/swa/projects/som/">www.hpi.uni-potsdam.de/swa/projects/</a></text>
<text top="1034" left="170" width="485" height="10" font="4"><a href="www.hpi.uni-potsdam.de/swa/projects/som/">som/. </a>Due to license regulations, pure::variants cannot be included with the CD image.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="630" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="715" width="7" height="14" font="5">3</text>
<text top="150" left="207" width="303" height="19" font="5">signiÔ¨Åcantly from the proof of concept <a href="pdfxml.html#27">[HAT</a></text>
<text top="151" left="510" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="150" left="520" width="205" height="19" font="5"><a href="pdfxml.html#27">09] </a>in that it has explicit con-</text>
<text top="167" left="207" width="515" height="19" font="5">structs and extended support for service module combinations. Moreover, the</text>
<text top="185" left="207" width="515" height="19" font="5">proof of concept was replaced with a more stable implementation that applies</text>
<text top="203" left="207" width="79" height="19" font="5">Asp<a href="pdfxml.html#3">ectC++</a></text>
<text top="205" left="286" width="6" height="9" font="6"><a href="pdfxml.html#3">5</a></text>
<text top="203" left="297" width="352" height="19" font="5"><a href="pdfxml.html#28">[O. 02], </a>a production-quality AOP extension to C++.</text>
<text top="233" left="192" width="530" height="19" font="5">‚Ä¢ We show that an approach based on multi-dimensional separation of concerns</text>
<text top="255" left="207" width="124" height="13" font="5">at source code level</text>
<text top="251" left="338" width="385" height="19" font="5">alleviates programming in a complex domain with intricate</text>
<text top="269" left="207" width="515" height="19" font="5">crosscutting relationships. The beneÔ¨Åcial eÔ¨Äect of applying VMADL in the VM</text>
<text top="287" left="207" width="518" height="19" font="5">implementation domain consists in making architectural interdependencies ex-</text>
<text top="305" left="207" width="515" height="19" font="5">plicit not only at the source code level, but abstractly so, by means of interactions</text>
<text top="323" left="207" width="210" height="19" font="5">between bidirectional interfaces.</text>
<text top="353" left="192" width="530" height="19" font="5">‚Ä¢ We demonstrate how the approach can be used to establish an SPL in this</text>
<text top="371" left="207" width="515" height="19" font="5">domain, fostering conÔ¨Åguration and variability management as well as code</text>
<text top="389" left="207" width="515" height="19" font="5">reuse. The SPL includes combinations of features that were previously applied</text>
<text top="407" left="207" width="505" height="19" font="5">in isolation only. The CSOM product line was realised using pur<a href="pdfxml.html#3">e::variants</a></text>
<text top="408" left="714" width="6" height="9" font="6"><a href="pdfxml.html#3">6</a></text>
<text top="407" left="721" width="4" height="19" font="5"><a href="pdfxml.html#3">,</a></text>
<text top="425" left="207" width="515" height="19" font="5">a state-of-the-art tool for SPL development. By virtue of pure::variants, the</text>
<text top="442" left="207" width="515" height="19" font="5">CSOM/PL product space is consistently represented as a feature model, and</text>
<text top="460" left="207" width="515" height="19" font="5">products can be easily conÔ¨Ågured and validated. Once a product has been</text>
<text top="478" left="207" width="483" height="19" font="5">conÔ¨Ågured, corresponding build scripts can be generated by the SPL tool.</text>
<text top="508" left="192" width="530" height="19" font="5">In the remainder of this paper, we Ô¨Årst introduce the CSOM VM in the following</text>
<text top="526" left="170" width="555" height="19" font="5">section. In Sec. <a href="pdfxml.html#5">3, </a>we sketch the architectural principles at work in CSOM/PL,</text>
<text top="544" left="170" width="553" height="19" font="5">and give an introduction to the language VMADL, including a description of its</text>
<text top="562" left="170" width="553" height="19" font="5">implementation. The CSOM/PL results and how they were achieved is illustrated in</text>
<text top="580" left="170" width="553" height="19" font="5">Sec. <a href="pdfxml.html#12">4. </a>The evaluation of the obtained results is described in Sec. <a href="pdfxml.html#18">5. </a>Related work is</text>
<text top="598" left="170" width="546" height="19" font="5">discussed in Sec. <a href="pdfxml.html#23">6, </a>and Sec. <a href="pdfxml.html#25">7 </a>summarises the paper and gives future work directions.</text>
<text top="646" left="170" width="10" height="20" font="0">2</text>
<text top="646" left="201" width="242" height="20" font="0">The CSOM Virtual Machine</text>
<text top="680" left="170" width="44" height="19" font="5"><a href="pdfxml.html#3">CSOM</a></text>
<text top="682" left="214" width="6" height="9" font="6"><a href="pdfxml.html#3">7</a></text>
<text top="680" left="225" width="37" height="19" font="5"><a href="pdfxml.html#27">[HHP</a></text>
<text top="682" left="262" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="680" left="272" width="451" height="19" font="5"><a href="pdfxml.html#27">10] </a>is a VM for a Smalltalk dialect designed for teaching purposes. Its</text>
<text top="698" left="170" width="553" height="19" font="5">precursor, SOM (Simple Object Machine) was implemented in Java at the University</text>
<text top="716" left="170" width="555" height="19" font="5">of √Örhus. CSOM is a port of SOM to C done at the Hasso Plattner Institute. There,</text>
<text top="734" left="170" width="554" height="19" font="5">CSOM has been used in two graduate courses on virtual machines in 2007 and 2008.</text>
<text top="752" left="192" width="530" height="19" font="5">Unlike most Smalltalk VMs, CSOM does not support images <a href="pdfxml.html#27">[GR83], </a>but instead</text>
<text top="770" left="170" width="553" height="19" font="5">relies on text Ô¨Åles containing Smalltalk code as input. The Smalltalk application to be</text>
<text top="788" left="170" width="553" height="19" font="5">run is passed as a command line parameter when the VM is started. If no application</text>
<text top="806" left="170" width="268" height="19" font="5">is given, the VM starts a Smalltalk shell.</text>
<text top="823" left="192" width="533" height="19" font="5">The architecture of CSOM is deliberately simple to ease its employment in teaching.</text>
<text top="841" left="170" width="553" height="19" font="5">An overview about the architecture is given as block diagram in Fig. <a href="pdfxml.html#4">1. </a>The arrows</text>
<text top="859" left="170" width="553" height="19" font="5">between modules denote ‚Äúuses‚Äù relationships. The standard implementation features a</text>
<text top="877" left="170" width="553" height="19" font="5">Smalltalk parser and compiler, a corresponding object model for representing Smalltalk</text>
<text top="895" left="170" width="553" height="19" font="5">entities, a bytecode interpreter, and a mark/sweep GC. The helper library contains</text>
<text top="913" left="170" width="468" height="19" font="5">dedicated implementations of data structures used throughout the VM.</text>
<text top="931" left="192" width="530" height="19" font="5">The CSOM source code consists of 88 C Ô¨Åles (43 .c and 45 .h Ô¨Åles) accounting</text>
<text top="949" left="170" width="553" height="19" font="5">for 6,725 PSLOC <a href="pdfxml.html#28">[Par92] </a>spread over seven logical modules represented by the folder</text>
<text top="967" left="170" width="553" height="19" font="5">structure of the implementation. The C implementation is accompanied by 568 lines of</text>
<text top="997" left="187" width="5" height="8" font="7"><a href="www.aspectc.org">5</a></text>
<text top="1000" left="193" width="95" height="10" font="4"><a href="www.aspectc.org">www.aspectc.org</a></text>
<text top="1011" left="187" width="5" height="8" font="7"><a href="www.pure-systems.com/pure_variants.49.0.html">6</a></text>
<text top="1014" left="193" width="280" height="10" font="4"><a href="www.pure-systems.com/pure_variants.49.0.html">www.pure-systems.com/pure_variants.49.0.html</a></text>
<text top="1025" left="187" width="5" height="8" font="7">7</text>
<text top="1028" left="193" width="127" height="11" font="4">Pronounced ‚Äú see-som‚Äù.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="8" size="9" family="Helvetica" color="#000000"/>
	<fontspec id="9" size="6" family="Helvetica" color="#000000"/>
	<fontspec id="10" size="4" family="Helvetica" color="#000000"/>
<text top="74" left="170" width="7" height="14" font="5">4</text>
<text top="74" left="190" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="192" left="436" width="17" height="10" font="8"><b>VM</b></text>
<text top="386" left="551" width="48" height="10" font="8"><b>Compiler</b></text>
<text top="323" left="498" width="50" height="10" font="8"><b>Bytecode</b></text>
<text top="291" left="581" width="56" height="10" font="8"><b>Interpreter</b></text>
<text top="306" left="583" width="53" height="8" font="9"><b>Switch/Case</b></text>
<text top="298" left="241" width="38" height="10" font="8"><b>Helper </b></text>
<text top="311" left="239" width="38" height="10" font="8"><b>Library</b></text>
<text top="332" left="238" width="34" height="6" font="10">- LinkedList</text>
<text top="340" left="238" width="33" height="6" font="10">- Hashmap</text>
<text top="348" left="238" width="22" height="6" font="10">- String</text>
<text top="356" left="238" width="35" height="6" font="10">- StringMap</text>
<text top="248" left="404" width="56" height="10" font="8"><b>Language </b></text>
<text top="261" left="417" width="25" height="10" font="8"><b>Core</b></text>
<text top="303" left="314" width="48" height="10" font="8"><b>Garbage </b></text>
<text top="317" left="312" width="48" height="10" font="8"><b>Collector</b></text>
<text top="332" left="310" width="52" height="8" font="9"><b>Mark/Sweep</b></text>
<text top="300" left="498" width="67" height="10" font="8"><b>ObjectModel</b></text>
<text top="416" left="448" width="53" height="10" font="8"><b>Primitives</b></text>
<text top="279" left="407" width="20" height="6" font="10">- Array</text>
<text top="287" left="407" width="21" height="6" font="10">- Class</text>
<text top="295" left="407" width="27" height="6" font="10">- Method</text>
<text top="303" left="407" width="24" height="6" font="10">- Object</text>
<text top="311" left="407" width="26" height="6" font="10">- Symbol</text>
<text top="319" left="407" width="43" height="6" font="10">- SymbolTable</text>
<text top="327" left="407" width="10" height="6" font="10">- ...</text>
<text top="160" left="545" width="89" height="10" font="8"><b>Standard Library</b></text>
<text top="160" left="318" width="119" height="10" font="8"><b>Smalltalk Applications</b></text>
<text top="444" left="344" width="204" height="17" font="1">Figure 1 ‚Äì Architecture of CSOM.</text>
<text top="493" left="170" width="555" height="19" font="5">Smalltalk code in roughly two dozen Ô¨Åles constituting its standard library. Additionally,</text>
<text top="511" left="170" width="327" height="19" font="5">a test suite and a set of benchmarks are available.</text>
<text top="529" left="192" width="530" height="19" font="5">SOM, implemented in Java, exploits object-oriented programming (OOP) concepts</text>
<text top="547" left="170" width="555" height="19" font="5">to a large extent, using inheritance and interfaces. Also, the VM-level and language-</text>
<text top="564" left="170" width="553" height="19" font="5">level representations of core classes of the SOM Smalltalk standard library have parallel</text>
<text top="582" left="170" width="553" height="19" font="5">hierarchies. For instance, the Smalltalk implementation of the Object class is mirrored</text>
<text top="600" left="170" width="553" height="19" font="5">by a corresponding class on the VM side. The Smalltalk Array class inherits from</text>
<text top="623" left="170" width="47" height="12" font="5">Object</text>
<text top="618" left="217" width="506" height="19" font="5">, and so does the VM-level representation of Smalltalk arrays. This design is</text>
<text top="636" left="170" width="553" height="19" font="5">preserved in CSOM by using a macro-based emulation of OOP constructs in C. It</text>
<text top="654" left="170" width="553" height="19" font="5">supports single inheritance and a limited notion of traits <a href="pdfxml.html#27">[CUL89], </a>which is used to</text>
<text top="672" left="170" width="553" height="19" font="5">emulate Java‚Äôs interfaces. Late binding is achieved by using a SEND macro to send</text>
<text top="690" left="170" width="553" height="19" font="5">messages and parameters to objects. C was preferred over C++ because it provides</text>
<text top="708" left="170" width="553" height="19" font="5">full low-level control over object layout in memory, including virtual method table</text>
<text top="726" left="170" width="70" height="19" font="5">placement.</text>
<text top="744" left="192" width="533" height="19" font="5">As already mentioned, CSOM has been used in teaching over the past few years.</text>
<text top="762" left="170" width="556" height="19" font="5">Students have implemented extensions to CSOM to fulÔ¨Ål coursework assignments.</text>
<text top="780" left="170" width="553" height="19" font="5">Two alternative multi-threading approaches have been realised. Native threading</text>
<text top="798" left="170" width="553" height="19" font="5">uses the pthreads <a href="pdfxml.html#28">[LB96] </a>library, whereas green threading implements scheduling</text>
<text top="816" left="170" width="555" height="19" font="5">and thread management within the VM itself. For memory management, GCs ap-</text>
<text top="833" left="170" width="553" height="19" font="5">plying mark/sweep and reference counting <a href="pdfxml.html#27">[JL96] </a>have been implemented. As an</text>
<text top="855" left="170" width="198" height="13" font="5">emulation engine optimisation</text>
<text top="851" left="368" width="358" height="19" font="5">, a threaded interpreter <a href="pdfxml.html#26">[Bel73] </a>has been implemented.</text>
<text top="873" left="170" width="141" height="13" font="5">Integer representation</text>
<text top="869" left="316" width="406" height="19" font="5">was optimised using one-based tagged integers <a href="pdfxml.html#27">[GR83]. </a>Virtual</text>
<text top="891" left="170" width="44" height="13" font="5">images</text>
<text top="887" left="221" width="471" height="19" font="5"><a href="pdfxml.html#27">[GR83], </a>saving snapshots of application state, were provided for CSOM.</text>
<text top="905" left="192" width="530" height="19" font="5">Each of the above was implemented as a stand-alone extension to CSOM. The</text>
<text top="923" left="170" width="555" height="19" font="5">separate coursework groups were not concerned with clear modularisation and interop-</text>
<text top="941" left="170" width="555" height="19" font="5">erability among the extensions. The implementations are independent of each other,</text>
<text top="959" left="170" width="469" height="19" font="5">and represent custom-built products derived from a common code base.</text>
<text top="977" left="192" width="531" height="19" font="5">The diÔ¨Äerent extensions exhibit largely diÔ¨Äerent crosscutting characteristics. For</text>
<text top="995" left="170" width="553" height="19" font="5">instance, mark/sweep and reference-counting GC both require the structural extension</text>
<text top="1013" left="168" width="143" height="19" font="5">(‚Äúintroduction‚Äù <a href="pdfxml.html#27">[KHH</a></text>
<text top="1014" left="312" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="1013" left="322" width="401" height="19" font="5"><a href="pdfxml.html#27">01]) </a>of adding a mark bit or reference count to objects‚Äîan</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="630" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="715" width="7" height="14" font="5">5</text>
<text top="150" left="170" width="555" height="19" font="5">extension that is external to the actual GC logic. Behavioural crosscutting, however,</text>
<text top="167" left="170" width="553" height="19" font="5">is much diÔ¨Äerent: while reference counting requires modiÔ¨Åcations at practically all</text>
<text top="185" left="170" width="553" height="19" font="5">pointer assignments throughout the VM implementation (including implicit ones like</text>
<text top="203" left="170" width="498" height="19" font="5">parameter passing), mark/sweep GC is attached only to allocation requests.</text>
<text top="221" left="192" width="530" height="19" font="5">Another example is multi-threading. Native threading eÔ¨Äectively requires the</text>
<text top="239" left="170" width="553" height="19" font="5">interpreter implementation to be thread-safe (i. e., the interpreter‚Äôs global state must</text>
<text top="257" left="170" width="553" height="19" font="5">be turned into thread-local state). Conversely, green threading implies signiÔ¨Åcant</text>
<text top="275" left="170" width="553" height="19" font="5">changes in the interpreter logic itself, as the interpreter is responsible for passing</text>
<text top="293" left="170" width="399" height="19" font="5">control to the scheduler, e. g., every Ì†µÌ±Å bytecode instructions.</text>
<text top="311" left="192" width="530" height="19" font="5">All in all, the extensions realised so far constitute an interesting challenge with</text>
<text top="329" left="170" width="555" height="19" font="5">regard to modularisation. This holds even more when combinations of the aforemen-</text>
<text top="347" left="170" width="553" height="19" font="5">tioned extensions are taken into account, e. g., a version of CSOM that features both</text>
<text top="365" left="170" width="264" height="19" font="5">a mark/sweep GC and native threading.</text>
<text top="413" left="170" width="10" height="20" font="0">3</text>
<text top="413" left="201" width="236" height="20" font="0">Virtual Machine Modularity</text>
<text top="447" left="170" width="524" height="19" font="5">In this section, we Ô¨Årst summarise the approach to VM modularisation <a href="pdfxml.html#27">[HAT</a></text>
<text top="448" left="694" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="447" left="704" width="19" height="19" font="5"><a href="pdfxml.html#27">09]</a></text>
<text top="465" left="170" width="553" height="19" font="5">whose concepts VMADL implements. We then give an overview of the concrete</text>
<text top="483" left="170" width="555" height="19" font="5">language mechanisms necessary to realise the approach. Following some examples,</text>
<text top="501" left="170" width="554" height="19" font="5">we discuss the evolution of VMADL from the previous version, motivating its recent</text>
<text top="519" left="170" width="451" height="19" font="5">language features. Finally, we describe the VMADL implementation.</text>
<text top="562" left="170" width="22" height="17" font="3">3.1</text>
<text top="562" left="210" width="227" height="17" font="3">Disentangling VM Architecture</text>
<text top="588" left="170" width="138" height="19" font="5">Previous work <a href="pdfxml.html#27">[HAT</a></text>
<text top="590" left="308" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="588" left="318" width="408" height="19" font="5"><a href="pdfxml.html#27">09] </a>investigated the architectures of diÔ¨Äerent VM implemen-</text>
<text top="606" left="170" width="553" height="19" font="5">tations, Ô¨Ånding that they typically exhibit no clear boundaries between subsystems</text>
<text top="624" left="170" width="553" height="19" font="5">perceivable as logical modules. This insight motivated the necessity of an architectural</text>
<text top="642" left="170" width="555" height="19" font="5">approach with support for reasoning about high-level modular structures in VM im-</text>
<text top="660" left="170" width="553" height="19" font="5">plementations, and led to the proposal fo a Ô¨Årst version of VMADL, which this article</text>
<text top="678" left="170" width="54" height="19" font="5">extends.</text>
<text top="696" left="192" width="530" height="19" font="5">First, we would like to explain the notion of architecture that we adopt. There is</text>
<text top="714" left="170" width="553" height="19" font="5">no consensus on a deÔ¨Ånition for the terms ‚Äúarchitecture‚Äù and ‚Äúarchitectural description</text>
<text top="732" left="170" width="556" height="19" font="5">language‚Äù (ADL). A wide range of diÔ¨Äerent interpretations of the terms <a href="pdfxml.html#28">[MT00] </a>exists.</text>
<text top="749" left="170" width="553" height="19" font="5">On the one end of the spectrum, there are, e. g., graphical ADLs that enable an easier</text>
<text top="767" left="170" width="553" height="19" font="5">comprehension of system architectures to improve communication about systems. On</text>
<text top="785" left="170" width="553" height="19" font="5">the other, there are languages proposing formal semantics and tools for analyses, code</text>
<text top="803" left="170" width="556" height="19" font="5">synthesis, and run-time support, to allow for a formal evaluation of complex systems.</text>
<text top="821" left="192" width="532" height="19" font="5">VM architecture needs to be supported at the source code level. Consequently,</text>
<text top="839" left="170" width="553" height="19" font="5">modules and their interactions have to be described at a level that is close to the</text>
<text top="857" left="170" width="553" height="19" font="5">implementation language but still supports architectural abstraction in that it expresses</text>
<text top="875" left="170" width="553" height="19" font="5">larger-scale interdependencies. At the same time, the implementation language must</text>
<text top="893" left="170" width="418" height="19" font="5">not be constrained in its degree of control over low-level details.</text>
<text top="911" left="192" width="530" height="19" font="5">VMADL modularises VM implementations into service modules, introducing a</text>
<text top="929" left="170" width="553" height="19" font="5">logical module structure into the code. Each service module can span several Ô¨Åles</text>
<text top="947" left="170" width="553" height="19" font="5">containing source code contributing to the feature the module deÔ¨Ånes. Service modules</text>
<text top="965" left="170" width="553" height="19" font="5">have bidirectional interfaces, i. e., they can not only be sent requests, but can also signal</text>
<text top="983" left="170" width="553" height="19" font="5">internal situations of interest to the outside world. Other service modules can attach</text>
<text top="1000" left="170" width="553" height="19" font="5">to these signals and react to them. These signals are called exposed join points. They</text>
<text top="1018" left="170" width="553" height="19" font="5">are deÔ¨Åned using pointcuts, i. e., they can express complex internal situations whose</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="7" height="14" font="5">6</text>
<text top="74" left="190" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="170" width="556" height="19" font="5">occurrence can trigger reactions in client modules attaching to the exposed interface.</text>
<text top="167" left="170" width="553" height="19" font="5">This exposed interface constitutes a module-speciÔ¨Åc join point model, elements of</text>
<text top="185" left="170" width="341" height="19" font="5">which can be quantiÔ¨Åed over by means of pointcuts.</text>
<text top="203" left="192" width="530" height="19" font="5">To achieve these goals, VMADL provides a frame in which an implementation</text>
<text top="221" left="170" width="553" height="19" font="5">language and an aspect language can be combined. Consequently, VMADL is essentially</text>
<text top="239" left="170" width="553" height="19" font="5">agnostic as far as the particular implementation and aspect languages are concerned: it</text>
<text top="257" left="170" width="556" height="19" font="5">adds high-level modularity constructs that coordinate the interaction of the former two.</text>
<text top="275" left="170" width="258" height="19" font="5">The Ô¨Årst VMADL proof of concept <a href="pdfxml.html#27">[HAT</a></text>
<text top="277" left="427" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="275" left="437" width="286" height="19" font="5"><a href="pdfxml.html#27">09] </a>was applied with C as the implementation</text>
<text top="293" left="170" width="553" height="19" font="5">language, and Aspicere2 <a href="pdfxml.html#26">[AS07] </a>as the aspect language. In the present work, the</text>
<text top="311" left="170" width="542" height="19" font="5">implementation language is still C, but AspectC++ <a href="pdfxml.html#28">[O. 02] </a>is the aspect language.</text>
<text top="354" left="170" width="22" height="17" font="3">3.2</text>
<text top="354" left="210" width="209" height="17" font="3">VMADL Language Concepts</text>
<text top="380" left="169" width="554" height="19" font="5">We now give an overview of the core mechanisms VMADL provides. As already</text>
<text top="398" left="170" width="553" height="19" font="5">mentioned, the main concept in VMADL is a service module. Each service module</text>
<text top="416" left="170" width="416" height="19" font="5">deÔ¨Ånes its bidirectional interface using the following constructs:</text>
<text top="449" left="192" width="532" height="19" font="5">‚Ä¢ Type definitions: Each service module deÔ¨Ånes a set of types or data structures,</text>
<text top="467" left="207" width="460" height="19" font="5">which can be used by other service modules or in module interactions.</text>
<text top="497" left="192" width="530" height="19" font="5">‚Ä¢ Function definitions: Each service module explicitly exposes a set of functions</text>
<text top="514" left="207" width="135" height="19" font="5">constituting its API.</text>
<text top="544" left="192" width="530" height="19" font="5">‚Ä¢ Join-point definitions: Each service module deÔ¨Ånes a set of internal situations</text>
<text top="562" left="207" width="515" height="19" font="5">that are exposed as join points to other modules. These are tightly coupled to</text>
<text top="580" left="207" width="515" height="19" font="5">the implementation of a service module, but abstract away from the concrete</text>
<text top="598" left="207" width="354" height="19" font="5">implementation, so that client modules are decoupled.</text>
<text top="628" left="192" width="530" height="19" font="5">‚Ä¢ Exposed global variables: Service modules deÔ¨Åne global variables that need</text>
<text top="646" left="207" width="390" height="19" font="5">to be exposed to other modules in their interface deÔ¨Ånition.</text>
<text top="676" left="192" width="492" height="19" font="5">‚Ä¢ Module dependencies: Required service modules are stated explicitly.</text>
<text top="705" left="192" width="530" height="19" font="5">‚Ä¢ Structured interface and refinement: Service module interfaces provide</text>
<text top="723" left="207" width="518" height="19" font="5">structured named sections which allow later cross-cutting reÔ¨Ånement (cf. Sec. <a href="pdfxml.html#7">3.3).</a></text>
<text top="753" left="192" width="530" height="19" font="5">‚Ä¢ Startup and shutdown phases: In complex systems like VMs, the phases</text>
<text top="771" left="207" width="518" height="19" font="5">of initialisation and termination introduce strong coupling and ordering re-</text>
<text top="789" left="207" width="515" height="19" font="5">quirements. To facilitate expressing those, service modules can provide speciÔ¨Åc</text>
<text top="807" left="207" width="458" height="19" font="5">functions and join points that are only accessible during these phases.</text>
<text top="840" left="192" width="533" height="19" font="5">An architectural description also needs to deÔ¨Åne service module interactions.</text>
<text top="858" left="170" width="553" height="19" font="5">VMADL‚Äôs combiners provide architectural-level implementation fragments describing</text>
<text top="875" left="170" width="553" height="19" font="5">all interactions that exceed API-like usage. Service modules depending on another</text>
<text top="893" left="170" width="553" height="19" font="5">service module can use the interface of that module in their implementation. Other</text>
<text top="911" left="170" width="553" height="19" font="5">forms of interactions, like advising join points, are expressed using combiners. They</text>
<text top="929" left="170" width="213" height="19" font="5">provide the following constructs:</text>
<text top="962" left="192" width="530" height="19" font="5">‚Ä¢ Combined pairs of service modules: A combiner always describes the</text>
<text top="980" left="207" width="483" height="19" font="5">interaction between a speciÔ¨Åc pair of modules which are explicitly named.</text>
<text top="1010" left="192" width="530" height="19" font="5">‚Ä¢ Module dependencies: If combiners require other service modules to enable</text>
<text top="1028" left="207" width="464" height="19" font="5">the interaction of the given pair of modules, these are stated explicitly.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="11" size="5" family="Times" color="#000000"/>
<text top="74" left="630" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="715" width="7" height="14" font="5">7</text>
<text top="150" left="192" width="530" height="19" font="5">‚Ä¢ Advice: A combiner speciÔ¨Åes advice to join points exposed by other service</text>
<text top="167" left="207" width="58" height="19" font="5">modules.</text>
<text top="197" left="192" width="532" height="19" font="5">‚Ä¢ Startup and shutdown phases: Similar to the service modules themselves,</text>
<text top="215" left="207" width="515" height="19" font="5">interactions can be speciÔ¨Åed that are only relevant during initialisation and</text>
<text top="233" left="207" width="128" height="19" font="5">termination phases.</text>
<text top="266" left="192" width="530" height="19" font="5">Since VMADL is explicitly meant to be used on top of a set of implementation</text>
<text top="284" left="170" width="553" height="19" font="5">languages, these languages themselves need to fulÔ¨Ål some requirements to enable the</text>
<text top="302" left="170" width="434" height="19" font="5">desired degree of modularisation. The requirements are as follows:</text>
<text top="335" left="192" width="533" height="19" font="5">‚Ä¢ Data type refinement: Feature combinations in SPL development may re-</text>
<text top="353" left="207" width="515" height="19" font="5">quire the deÔ¨Ånition of feature-speciÔ¨Åc, i. e., service module-speciÔ¨Åc, changes to</text>
<text top="371" left="207" width="515" height="19" font="5">types deÔ¨Åned by particular modules. These are expressed using the underlying</text>
<text top="389" left="207" width="498" height="19" font="5">implementation language as part of the type deÔ¨Ånitions of a service module.</text>
<text top="419" left="192" width="530" height="19" font="5">‚Ä¢ Control over object layout: SpeciÔ¨Åc to VMs is the requirement to have</text>
<text top="436" left="207" width="515" height="19" font="5">precise control over the layout of data structures in memory. Mechanisms like</text>
<text top="454" left="207" width="515" height="19" font="5">GCs need to be able to make certain assumptions about this, requiring modules</text>
<text top="472" left="207" width="418" height="19" font="5">to be able to put constraints on their reÔ¨Ånements of data types.</text>
<text top="515" left="170" width="22" height="17" font="3">3.3</text>
<text top="515" left="210" width="183" height="17" font="3">VMADL: A Walkthrough</text>
<text top="542" left="170" width="556" height="19" font="5">This overview of VMADL uses abbreviated actual code from the CSOM/PL imple-</text>
<text top="560" left="170" width="553" height="19" font="5">mentation (cf. Sec. <a href="pdfxml.html#12">4) </a>to introduce the various features. A complete example of two</text>
<text top="578" left="170" width="445" height="19" font="5">service module deÔ¨Ånitions and their combination is given in App. <a href="pdfxml.html#29">A.</a></text>
<text top="596" left="192" width="530" height="19" font="5">Lst. <a href="pdfxml.html#7">1 </a>introduces service module definitions. Four such modules are deÔ¨Åned, and</text>
<text top="613" left="170" width="553" height="19" font="5">the Interpreter and VMCore module deÔ¨Ånitions demonstrate that the API is simply</text>
<text top="631" left="170" width="553" height="19" font="5">deÔ¨Åned by declaring the corresponding C function. VMObjects declares a dependency</text>
<text top="649" left="170" width="553" height="19" font="5">on ObjectModel using the require keyword. The listing also demonstrates how join</text>
<text top="671" left="170" width="102" height="13" font="5">point exposition</text>
<text top="667" left="278" width="445" height="19" font="5">is achieved by using AspectC++ deÔ¨Ånitions: the VMObjects module</text>
<text top="685" left="170" width="553" height="19" font="5">exposes the initializer pointcut, which matches whenever a C function matching</text>
<text top="703" left="170" width="553" height="19" font="5">the name _VM%_init is executed. Note that require is used to express mandatory</text>
<text top="721" left="170" width="553" height="19" font="5">relationships between modules explicitly. This ensures that the resulting conÔ¨Åguration</text>
<text top="739" left="170" width="261" height="19" font="5">includes all mandatory service modules.</text>
<text top="772" left="158" width="5" height="7" font="11">1</text>
<text top="770" left="170" width="117" height="9" font="6">service Interpreter {</text>
<text top="783" left="158" width="5" height="7" font="11">2</text>
<text top="782" left="190" width="161" height="9" font="6">void Interpreter_start(void);</text>
<text top="795" left="158" width="5" height="7" font="11">3</text>
<text top="794" left="170" width="6" height="9" font="6">}</text>
<text top="807" left="158" width="5" height="7" font="11">4</text>
<text top="806" left="170" width="89" height="9" font="6">service VMCore {</text>
<text top="819" left="158" width="5" height="7" font="11">5</text>
<text top="818" left="190" width="272" height="9" font="6">void Universe_set_global(_VMSymbol*, _VMObject*);</text>
<text top="831" left="158" width="5" height="7" font="11">6</text>
<text top="830" left="170" width="6" height="9" font="6">}</text>
<text top="843" left="158" width="5" height="7" font="11">7</text>
<text top="842" left="170" width="150" height="9" font="6">service ObjectModel { ... }</text>
<text top="855" left="158" width="5" height="7" font="11">8</text>
<text top="854" left="170" width="106" height="9" font="6">service VMObjects {</text>
<text top="867" left="158" width="5" height="7" font="11">9</text>
<text top="866" left="190" width="111" height="9" font="6">require ObjectModel;</text>
<text top="879" left="152" width="10" height="7" font="11">10</text>
<text top="878" left="190" width="44" height="9" font="6">expose {</text>
<text top="891" left="152" width="10" height="7" font="11">11</text>
<text top="890" left="210" width="261" height="9" font="6">pointcut initializer() = &#34;void _VM%_init(...)&#34;;</text>
<text top="903" left="152" width="10" height="7" font="11">12</text>
<text top="902" left="190" width="6" height="9" font="6">}</text>
<text top="915" left="152" width="10" height="7" font="11">13</text>
<text top="914" left="170" width="6" height="9" font="6">}</text>
<text top="934" left="298" width="296" height="17" font="1">Listing 1 ‚Äì Service module definition in VMADL.</text>
<text top="969" left="192" width="530" height="19" font="5">The speciÔ¨Åcation of service module interactions is illustrated in Lst. <a href="pdfxml.html#8">2. </a>A combiner</text>
<text top="987" left="170" width="553" height="19" font="5">allows implementing module interactions at the same architectural level as service</text>
<text top="1005" left="170" width="553" height="19" font="5">modules, but without requiring a direct modiÔ¨Åcation of the module deÔ¨Ånitions. This</text>
<text top="1023" left="170" width="553" height="19" font="5">separation enables developers to describe module interactions at a well-deÔ¨Åned place in</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="7" height="14" font="5">8</text>
<text top="74" left="190" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="170" width="553" height="19" font="5">the source code, which in return enables an easier recognition of module relationships</text>
<text top="167" left="170" width="553" height="19" font="5">and dependencies. Furthermore, a combiner becomes part of the system only if all</text>
<text top="185" left="170" width="378" height="19" font="5">modules it refers to are part of the product conÔ¨Åguration.</text>
<text top="218" left="158" width="5" height="7" font="11">1</text>
<text top="217" left="170" width="178" height="9" font="6">combine GCMarkSweep, VMObjects {</text>
<text top="230" left="158" width="5" height="7" font="11">2</text>
<text top="229" left="190" width="233" height="9" font="6">advice execution(VMObjects::initializer())</text>
<text top="242" left="158" width="5" height="7" font="11">3</text>
<text top="241" left="195" width="67" height="9" font="6">: around() {</text>
<text top="254" left="158" width="5" height="7" font="11">4</text>
<text top="253" left="210" width="211" height="9" font="6">gc_start_uninterruptable_allocation();</text>
<text top="266" left="158" width="5" height="7" font="11">5</text>
<text top="265" left="210" width="83" height="9" font="6">tjp-&gt;proceed();</text>
<text top="278" left="158" width="5" height="7" font="11">6</text>
<text top="276" left="210" width="200" height="9" font="6">gc_end_uninterruptable_allocation();</text>
<text top="290" left="158" width="5" height="7" font="11">7</text>
<text top="288" left="190" width="6" height="9" font="6">}</text>
<text top="302" left="158" width="5" height="7" font="11">8</text>
<text top="300" left="170" width="6" height="9" font="6">}</text>
<text top="314" left="158" width="5" height="7" font="11">9</text>
<text top="312" left="170" width="128" height="9" font="6">combine Image, VMCore {</text>
<text top="326" left="152" width="10" height="7" font="11">10</text>
<text top="324" left="190" width="389" height="9" font="6">advice execution(&#34;void Universe_set_global(...)&#34;) &amp;&amp; args(name, value)</text>
<text top="337" left="152" width="10" height="7" font="11">11</text>
<text top="336" left="195" width="250" height="9" font="6">: after (_VMSymbol* name, _VMObject* value) {</text>
<text top="349" left="152" width="10" height="7" font="11">12</text>
<text top="348" left="210" width="144" height="9" font="6">// register key for symbol</text>
<text top="361" left="152" width="10" height="7" font="11">13</text>
<text top="360" left="210" width="289" height="9" font="6">SEND(globals_dictionary_symbols, addIfAbsent, name);</text>
<text top="373" left="152" width="10" height="7" font="11">14</text>
<text top="372" left="190" width="6" height="9" font="6">}</text>
<text top="385" left="152" width="10" height="7" font="11">15</text>
<text top="384" left="170" width="6" height="9" font="6">}</text>
<text top="405" left="289" width="314" height="17" font="1">Listing 2 ‚Äì Definition of service module interactions.</text>
<text top="440" left="192" width="530" height="19" font="5">The Ô¨Årst combiner in Lst. <a href="pdfxml.html#8">2 </a>avoids GC runs during object initialisation by attaching</text>
<text top="458" left="170" width="556" height="19" font="5">an around advice to the initializer join point exposed by the VMObjects module.</text>
<text top="476" left="170" width="553" height="19" font="5">The second shows an advice using join point context information. It establishes</text>
<text top="494" left="170" width="503" height="19" font="5">management of a symbol table saved along with the Smalltalk virtual image.</text>
<text top="512" left="192" width="533" height="19" font="5">When implementation languages such as C or C++ are used, the VM implemen-</text>
<text top="529" left="170" width="555" height="19" font="5">tation most likely uses preprocessor macros. From a feature-oriented perspective,</text>
<text top="547" left="170" width="556" height="19" font="5">preprocessor macros are problematic, since they cannot be reÔ¨Åned in a composable way.</text>
<text top="565" left="170" width="555" height="19" font="5">However, their use cannot always be avoided. In the case of CSOM, whose implemen-</text>
<text top="583" left="170" width="556" height="19" font="5">tation emulates object-orientation in C, macros are used to realise message sending.</text>
<text top="601" left="170" width="553" height="19" font="5">The implementation of 1-based integer tagging (cf. Sec. <a href="pdfxml.html#16">4.2) </a>requires a redeÔ¨Ånition of</text>
<text top="619" left="170" width="106" height="19" font="5">the SEND macro.</text>
<text top="637" left="192" width="530" height="19" font="5">To enable some form of reÔ¨Ånement, we use named sections as demonstrated in</text>
<text top="655" left="170" width="555" height="19" font="5">Lst. <a href="pdfxml.html#8">3. </a>While named sections are meant to structure and document interface deÔ¨Ånitions,</text>
<text top="673" left="170" width="553" height="19" font="5">they also support reÔ¨Åning interface deÔ¨Ånitions. The listing shows how the SEND macro</text>
<text top="691" left="170" width="553" height="19" font="5">is deÔ¨Åned in the SendMacro named section in the ObjectModel service module, and</text>
<text top="709" left="170" width="373" height="19" font="5">also its redeÔ¨Ånition in the TaggedIntOne service module.</text>
<text top="742" left="158" width="5" height="7" font="11">1</text>
<text top="740" left="170" width="117" height="9" font="6">service ObjectModel {</text>
<text top="754" left="158" width="5" height="7" font="11">2</text>
<text top="752" left="190" width="61" height="9" font="6">SendMacro {</text>
<text top="766" left="158" width="5" height="7" font="11">3</text>
<text top="764" left="210" width="472" height="9" font="6">#define SEND(O,M,...) ({ typeof(O) _O = (O); (_O-&gt;_vtable-&gt;M(_O , ##__VA_ARGS__)); })</text>
<text top="778" left="158" width="5" height="7" font="11">4</text>
<text top="776" left="190" width="6" height="9" font="6">}</text>
<text top="790" left="158" width="5" height="7" font="11">5</text>
<text top="788" left="170" width="6" height="9" font="6">}</text>
<text top="801" left="158" width="5" height="7" font="11">6</text>
<text top="800" left="170" width="122" height="9" font="6">service TaggedIntOne {</text>
<text top="813" left="158" width="5" height="7" font="11">7</text>
<text top="812" left="190" width="233" height="9" font="6">#include &lt;tagged-int-one/tagged-int-one.h&gt;</text>
<text top="825" left="158" width="5" height="7" font="11">8</text>
<text top="824" left="190" width="172" height="9" font="6">replace ObjectModel.SendMacro {</text>
<text top="837" left="158" width="5" height="7" font="11">9</text>
<text top="836" left="210" width="133" height="9" font="6">#define SEND(O,M,...) ({</text>
<text top="849" left="152" width="10" height="7" font="11">10</text>
<text top="848" left="230" width="189" height="9" font="6">typeof(O) _Org = (typeof(O))(O); \</text>
<text top="861" left="152" width="10" height="7" font="11">11</text>
<text top="860" left="230" width="106" height="9" font="6">typeof(_Org) _O = \</text>
<text top="873" left="152" width="10" height="7" font="11">12</text>
<text top="872" left="250" width="389" height="9" font="6">(typeof(_Org))(INT_IS_TAGGED(_Org) ? VMInteger_Global_Box() : _Org); \</text>
<text top="885" left="152" width="10" height="7" font="11">13</text>
<text top="884" left="230" width="228" height="9" font="6">(_O-&gt;_vtable-&gt;M(_Org, ##__VA_ARGS__)); })</text>
<text top="897" left="152" width="10" height="7" font="11">14</text>
<text top="896" left="190" width="6" height="9" font="6">}</text>
<text top="909" left="152" width="10" height="7" font="11">15</text>
<text top="908" left="170" width="6" height="9" font="6">}</text>
<text top="928" left="329" width="236" height="17" font="1">Listing 3 ‚Äì Named section replacement.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="630" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="715" width="7" height="14" font="5">9</text>
<text top="151" left="170" width="22" height="17" font="3">3.4</text>
<text top="151" left="210" width="59" height="17" font="3">ClassDL</text>
<text top="177" left="170" width="553" height="19" font="5">As stated in Sec. <a href="pdfxml.html#6">3.2, </a>VMADL requires the implementation language to provide</text>
<text top="195" left="170" width="553" height="19" font="5">mechanisms for data type reÔ¨Ånement and explicit control over object layout. Since we</text>
<text top="213" left="170" width="533" height="19" font="5">used C as an implementation language, these features were not directly available.</text>
<text top="231" left="192" width="530" height="19" font="5">Thus, we introduced ClassDL as a language orthogonal to VMADL, which provides</text>
<text top="249" left="170" width="553" height="19" font="5">us with the necessary Ô¨Çexibility to describe crosscutting reÔ¨Ånements of classes in our</text>
<text top="267" left="170" width="553" height="19" font="5">OOP emulation. ClassDL is merely a simple layer on top of C that provides notation</text>
<text top="285" left="170" width="553" height="19" font="5">to deÔ¨Åne classes and traits. From ClassDL deÔ¨Ånitions, the necessary implementation</text>
<text top="303" left="170" width="553" height="19" font="5">details like structure deÔ¨Ånitions for object layout and virtual method tables, including</text>
<text top="321" left="170" width="553" height="19" font="5">code for their initialisation, are generated. The ClassDL notation used to deÔ¨Åne Ô¨Åelds</text>
<text top="339" left="170" width="553" height="19" font="5">conforms to Ô¨Åeld deÔ¨Ånitions in C structures. Respectively, method deÔ¨Ånitions conform</text>
<text top="356" left="170" width="159" height="19" font="5">to function declarations.</text>
<text top="374" left="192" width="530" height="19" font="5">To support structural changes in service module combinations, an additional</text>
<text top="392" left="170" width="553" height="19" font="5">keyword was introduced to reÔ¨Åne classes or traits from other modules. Within the</text>
<text top="410" left="170" width="553" height="19" font="5">scope of our case study, it was necessary to add methods and Ô¨Åelds to existing classes</text>
<text top="428" left="170" width="553" height="19" font="5">due to the structural crosscutting exhibited by some features (cf. Sec. <a href="pdfxml.html#3">2). </a>For method</text>
<text top="446" left="170" width="553" height="19" font="5">introductions, simple deÔ¨Ånitions are given like in a normal class deÔ¨Ånition. As object</text>
<text top="464" left="170" width="553" height="19" font="5">layout must be controllable at a Ô¨Åne level of granularity‚Äîin particular, the order of</text>
<text top="482" left="170" width="553" height="19" font="5">Ô¨Åelds in objects is important‚Äî, a Ô¨Åeld can be deÔ¨Åned with an additional predicate</text>
<text top="500" left="170" width="553" height="19" font="5">specifying the position with respect to another Ô¨Åeld. These language constructs are</text>
<text top="518" left="170" width="372" height="19" font="5">suÔ¨Écient to modularise the features under consideration.</text>
<text top="547" left="158" width="5" height="7" font="11">1</text>
<text top="546" left="170" width="106" height="9" font="6">service VMObjects {</text>
<text top="559" left="158" width="5" height="7" font="11">2</text>
<text top="558" left="190" width="89" height="9" font="6">class VMObject {</text>
<text top="571" left="158" width="5" height="7" font="11">3</text>
<text top="570" left="210" width="111" height="9" font="6">size_t num_of_fields</text>
<text top="583" left="158" width="5" height="7" font="11">4</text>
<text top="582" left="210" width="106" height="9" font="6">pVMObject fields[0]</text>
<text top="595" left="158" width="5" height="7" font="11">5</text>
<text top="594" left="190" width="6" height="9" font="6">}</text>
<text top="607" left="158" width="5" height="7" font="11">6</text>
<text top="606" left="190" width="167" height="9" font="6">trait VMInvokable : VMObject {</text>
<text top="619" left="158" width="5" height="7" font="11">7</text>
<text top="618" left="210" width="106" height="9" font="6">pVMSymbol signature</text>
<text top="631" left="158" width="5" height="7" font="11">8</text>
<text top="630" left="210" width="83" height="9" font="6">pVMClass holder</text>
<text top="643" left="158" width="5" height="7" font="11">9</text>
<text top="642" left="210" width="117" height="9" font="6">void invoke(pVMFrame)</text>
<text top="655" left="152" width="10" height="7" font="11">10</text>
<text top="654" left="190" width="6" height="9" font="6">}</text>
<text top="667" left="152" width="10" height="7" font="11">11</text>
<text top="666" left="190" width="150" height="9" font="6">class VMArray : VMObject {}</text>
<text top="679" left="152" width="10" height="7" font="11">12</text>
<text top="678" left="190" width="217" height="9" font="6">class VMMethod : VMArray, VMInvokable {</text>
<text top="691" left="152" width="10" height="7" font="11">13</text>
<text top="690" left="210" width="106" height="9" font="6">pVMSymbol signature</text>
<text top="703" left="152" width="10" height="7" font="11">14</text>
<text top="702" left="210" width="83" height="9" font="6">pVMClass holder</text>
<text top="715" left="152" width="10" height="7" font="11">15</text>
<text top="714" left="210" width="183" height="9" font="6">bytecode_t get_bytecode(intptr_t)</text>
<text top="727" left="152" width="10" height="7" font="11">16</text>
<text top="726" left="210" width="217" height="9" font="6">void set_bytecode(intptr_t, bytecode_t)</text>
<text top="739" left="152" width="10" height="7" font="11">17</text>
<text top="738" left="210" width="156" height="9" font="6">void invoke_method(pVMFrame)</text>
<text top="751" left="152" width="10" height="7" font="11">18</text>
<text top="749" left="190" width="6" height="9" font="6">}</text>
<text top="763" left="152" width="10" height="7" font="11">19</text>
<text top="761" left="170" width="6" height="9" font="6">}</text>
<text top="775" left="152" width="10" height="7" font="11">20</text>
<text top="773" left="170" width="111" height="9" font="6">service GCRefCount {</text>
<text top="787" left="152" width="10" height="7" font="11">21</text>
<text top="785" left="190" width="94" height="9" font="6">refine VMObject {</text>
<text top="799" left="152" width="10" height="7" font="11">22</text>
<text top="797" left="210" width="211" height="9" font="6">intptr_t gc_field { before fields[0] }</text>
<text top="810" left="152" width="10" height="7" font="11">23</text>
<text top="809" left="190" width="6" height="9" font="6">}</text>
<text top="822" left="152" width="10" height="7" font="11">24</text>
<text top="821" left="170" width="6" height="9" font="6">}</text>
<text top="842" left="311" width="271" height="17" font="1">Listing 4 ‚Äì ClassDL object layout definitions.</text>
<text top="880" left="192" width="530" height="19" font="5">Lst. <a href="pdfxml.html#9">4 </a>shows some ClassDL examples. It Ô¨Årst presents how object layouts and</text>
<text top="898" left="170" width="556" height="19" font="5">interfaces for classes and traits deÔ¨Åned in the VMObjects service module are speciÔ¨Åed.</text>
<text top="916" left="170" width="553" height="19" font="5">It then shows how the reference-counting GC extends object layout in a controlled way</text>
<text top="934" left="170" width="553" height="19" font="5">by inserting the reference count Ô¨Åeld before the fields array responsible for storing</text>
<text top="952" left="170" width="123" height="19" font="5">actual object slots.</text>
<text top="969" left="192" width="530" height="19" font="5">We would like to point out once more that ClassDL is entirely orthogonal to</text>
<text top="987" left="170" width="554" height="19" font="5">VMADL. Also, ClassDL is purely declarative: method implementations are not</text>
<text top="1005" left="170" width="553" height="19" font="5">given. It replaces C headers but relies on the implementation given in C source Ô¨Åles</text>
<text top="1023" left="168" width="81" height="19" font="5">(cf. Sec. <a href="pdfxml.html#11">3.6).</a></text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="10" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">10</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="192" width="531" height="19" font="5">ClassDL‚Äôs sole purpose is to add the required capabilities of data type reÔ¨Ånement</text>
<text top="167" left="170" width="553" height="19" font="5">and control over object layout to the used implementation language. Had CSOM</text>
<text top="185" left="170" width="553" height="19" font="5">been implemented in a diÔ¨Äerent language with dedicated support for object-oriented</text>
<text top="203" left="170" width="553" height="19" font="5">modularisation and heterogeneous crosscutting, ClassDL would probably not have</text>
<text top="221" left="170" width="99" height="19" font="5">been necessary.</text>
<text top="264" left="170" width="22" height="17" font="3">3.5</text>
<text top="264" left="210" width="155" height="17" font="3">Evolution of VMADL</text>
<text top="291" left="170" width="492" height="19" font="5">As already mentioned, the Ô¨Årst version of VMADL was introduced <a href="pdfxml.html#27">[HAT</a></text>
<text top="292" left="661" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="291" left="671" width="52" height="19" font="5"><a href="pdfxml.html#27">09] </a>as a</text>
<text top="309" left="170" width="553" height="19" font="5">proof of concept. The version of VMADL presented here is has evolved beyond a mere</text>
<text top="327" left="170" width="269" height="19" font="5">proof of concept into a robust tool chain.</text>
<text top="345" left="192" width="530" height="19" font="5">From a language point of view, three concepts were added. First, combiners</text>
<text top="362" left="170" width="553" height="19" font="5">were introduced to enable a clear separation between service module interfaces and</text>
<text top="380" left="170" width="553" height="19" font="5">service module interactions. This allows for a clearer modularisation and avoids</text>
<text top="398" left="170" width="553" height="19" font="5">polluting base modules with optional functionality. In the proof of concept, service</text>
<text top="416" left="170" width="553" height="19" font="5">module interactions were deÔ¨Åned in service module deÔ¨Ånitions themselves, prohibiting</text>
<text top="434" left="170" width="462" height="19" font="5">deÔ¨Ånitions of interaction facets when introducing new service modules.</text>
<text top="452" left="192" width="530" height="19" font="5">Second, VMADL as presented here introduces explicit module relationships using</text>
<text top="470" left="170" width="553" height="19" font="5">the require keyword. The reason for this is twofold. On the one hand, it documents</text>
<text top="488" left="170" width="553" height="19" font="5">relationships between service modules on an architectural level. On the other, it</text>
<text top="506" left="170" width="461" height="19" font="5">enables the tool chain to select required code fragments automatically.</text>
<text top="524" left="192" width="530" height="19" font="5">The third feature introduced in VMADL presented here is the concept of named</text>
<text top="546" left="170" width="52" height="13" font="5">sections</text>
<text top="542" left="222" width="501" height="19" font="5">. While it is useful for documentation purposes, it also enables crosscutting</text>
<text top="560" left="170" width="553" height="19" font="5">reÔ¨Ånement of service module interfaces, especially if the underlying implementation</text>
<text top="578" left="170" width="316" height="19" font="5">language lacks suÔ¨Éciently powerful mechanisms.</text>
<text top="621" left="170" width="22" height="17" font="3">3.6</text>
<text top="621" left="210" width="181" height="17" font="3">The VMADL Tool Chain</text>
<text top="647" left="170" width="553" height="19" font="5">The VMADL tool chain reuses standard tools wherever possible and introduces a</text>
<text top="665" left="170" width="553" height="19" font="5">custom compiler only to process the actual VMADL/ClassDL source code. We now</text>
<text top="683" left="170" width="553" height="19" font="5">give an overview of the work Ô¨Çow for the user, implementation details, and relevant</text>
<text top="701" left="170" width="312" height="19" font="5">limitations of the current tool chain as a whole.</text>
<text top="739" left="170" width="71" height="13" font="5">Workflow</text>
<text top="735" left="256" width="467" height="19" font="5">An overview of the interaction of the involved tools, compilers, and</text>
<text top="753" left="170" width="553" height="19" font="5">artifacts is given in Fig. <a href="pdfxml.html#11">2. </a>As discussed in Sec. <a href="pdfxml.html#12">4, </a>pure::variants is used to build the</text>
<text top="771" left="170" width="553" height="19" font="5">feature model which is represented at the source code level by the diÔ¨Äerent VMADL</text>
<text top="789" left="170" width="556" height="19" font="5">modules. Based on the feature model, the developer can select a product configuration.</text>
<text top="807" left="170" width="556" height="19" font="5">Pure::variants gives the set of selected service modules to the make-based build system.</text>
<text top="825" left="170" width="553" height="19" font="5">The build system in return invokes the diÔ¨Äerent compilation steps to process the source</text>
<text top="842" left="170" width="553" height="19" font="5">artifacts and select the required implementation fragments to generate a binary for</text>
<text top="860" left="170" width="553" height="19" font="5">the desired conÔ¨Åguration. It needs to be noted that pure::variants is optional. Users</text>
<text top="878" left="170" width="553" height="19" font="5">relying on their ability to select non-conÔ¨Çicting feature combinations can enter the</text>
<text top="901" left="170" width="31" height="12" font="5">make</text>
<text top="896" left="206" width="422" height="19" font="5">command line resulting from applying pure::variants themselves.</text>
<text top="914" left="192" width="530" height="19" font="5">To ease development with the tool chain, it adheres to the standard conventions of</text>
<text top="932" left="170" width="553" height="19" font="5">the GNU Compiler Collection in terms of interface and error reporting. Thus, the</text>
<text top="950" left="170" width="553" height="19" font="5">VMADL compiler gives feedback to the user in the normal error format known from</text>
<text top="968" left="170" width="553" height="19" font="5">GCC. This enables IDEs like Eclipse and Xcode to parse warnings and errors and</text>
<text top="986" left="170" width="513" height="19" font="5">display them in line with the code, as is done for normal GCC error messages.</text>
<text top="1004" left="192" width="531" height="19" font="5">Furthermore, debugging is facilitated by utilising the standard #line preprocessor</text>
<text top="1022" left="170" width="553" height="19" font="5">pragma, which enables compatible IDEs to debug directly on the original source Ô¨Åle</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="11" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="12" size="7" family="Helvetica" color="#000000"/>
	<fontspec id="13" size="5" family="Helvetica" color="#000000"/>
	<fontspec id="14" size="7" family="Helvetica" color="#000000"/>
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">11</text>
<text top="375" left="492" width="58" height="9" font="12">C++ Compiler</text>
<text top="311" left="483" width="76" height="9" font="12">AspectC++ (ag++)</text>
<text top="237" left="474" width="72" height="9" font="12">VMADL Compiler</text>
<text top="158" left="426" width="42" height="9" font="12">CSOM/PL</text>
<text top="180" left="507" width="35" height="9" font="12">Modules</text>
<text top="202" left="537" width="27" height="9" font="12">*.h, *.c</text>
<text top="285" left="405" width="21" height="9" font="12">GNU</text>
<text top="296" left="403" width="23" height="9" font="12">Make</text>
<text top="202" left="463" width="31" height="9" font="12">*.vmadl</text>
<text top="274" left="457" width="37" height="9" font="12">module.*</text>
<text top="274" left="531" width="27" height="9" font="12">*.h, *.c</text>
<text top="274" left="502" width="17" height="9" font="12">*.ah</text>
<text top="343" left="471" width="15" height="9" font="12">*.cc</text>
<text top="375" left="313" width="77" height="9" font="12">CSOM Executable</text>
<text top="187" left="377" width="34" height="7" font="13">CSOM/PL</text>
<text top="196" left="372" width="44" height="7" font="13">Configuration</text>
<text top="300" left="370" width="0" height="9" font="14">pure::variants</text>
<text top="405" left="328" width="238" height="17" font="1">Figure 2 ‚Äì VMADL tool chain overview</text>
<text top="454" left="170" width="553" height="19" font="5">instead of the preprocessed intermediate version produced by the VMADL compiler.</text>
<text top="492" left="170" width="119" height="13" font="5">Implementation</text>
<text top="488" left="304" width="419" height="19" font="5">The VMADL compiler is implemented in Java and uses ANTLR</text>
<text top="506" left="170" width="555" height="19" font="5">grammars to generate parsers for VMADL and ClassDL. Furthermore, it uses a sim-</text>
<text top="524" left="170" width="553" height="19" font="5">pliÔ¨Åed grammar for C to parse function deÔ¨Ånitions. The main purpose of the compiler</text>
<text top="542" left="170" width="553" height="19" font="5">is to preprocess the VMADL deÔ¨Ånitions and generate the actual implementation Ô¨Åles</text>
<text top="560" left="170" width="156" height="19" font="5">for C and Aspect C++.</text>
<text top="577" left="192" width="530" height="19" font="5">Pure::variants creates a simple build script containing a command line to invoke</text>
<text top="600" left="170" width="31" height="12" font="5">make</text>
<text top="595" left="201" width="521" height="19" font="5">. The VMADL compiler is parameterised with those. The main input for the</text>
<text top="613" left="170" width="553" height="19" font="5">compiler are thus a set of *.vmadl Ô¨Åles containing the deÔ¨Ånition of service modules</text>
<text top="631" left="170" width="553" height="19" font="5">and combiners. These Ô¨Åles are parsed and checked for consistency. Required VMADL</text>
<text top="649" left="170" width="556" height="19" font="5">modules are loaded on demand based on the initially given list of service modules.</text>
<text top="667" left="170" width="553" height="19" font="5">The simple C parser is used to parse the C implementation Ô¨Åles and verify that all</text>
<text top="685" left="170" width="479" height="19" font="5">functions are available that have been deÔ¨Åned in the ClassDL deÔ¨Ånitions.</text>
<text top="703" left="192" width="533" height="19" font="5">When the consistency check fails, the error is reported back to the user immediately.</text>
<text top="721" left="170" width="553" height="19" font="5">In case it passes, the VMADL compiler will generated AspectC++ .ah Ô¨Åles with all</text>
<text top="739" left="170" width="553" height="19" font="5">advice and pointcut deÔ¨Ånitions provided in the service modules. Furthermore, it will</text>
<text top="757" left="170" width="553" height="19" font="5">generate C header Ô¨Åles that deÔ¨Åne the functions, types, and variables exported by a</text>
<text top="775" left="170" width="553" height="19" font="5">service module. The implementation of service modules is not provided inline with</text>
<text top="793" left="170" width="312" height="19" font="5">their deÔ¨Ånition, but comes as additional C Ô¨Åles.</text>
<text top="811" left="192" width="531" height="19" font="5">In addition to these VMADL speciÔ¨Åc implementation Ô¨Åles, the ClassDL compiler</text>
<text top="829" left="168" width="555" height="19" font="5">(part of the VMADL compiler), generates a set of headers and C Ô¨Åles deÔ¨Åning the</text>
<text top="846" left="170" width="553" height="19" font="5">C representation of the deÔ¨Åned classes and traits. The header Ô¨Åles are split in two</text>
<text top="864" left="170" width="553" height="19" font="5">parts. The Ô¨Årst header for each service module contains forward declarations of</text>
<text top="882" left="170" width="553" height="19" font="5">the necessary structs, i. e., type information for the class, and the second header</text>
<text top="900" left="170" width="553" height="19" font="5">contains the deÔ¨Ånition of the actual structs representing the classes/traits and their</text>
<text top="918" left="170" width="555" height="19" font="5">virtual method tables. Furthermore, a single common implementation Ô¨Åle is generated,</text>
<text top="936" left="170" width="309" height="19" font="5">containing the virtual method table initialisers.</text>
<text top="954" left="192" width="530" height="19" font="5">The compilers do not place any restrictions on Ô¨Åle names or implementation Ô¨Åle</text>
<text top="972" left="170" width="553" height="19" font="5">arrangement for the normal C code itself. The only requirement is that the compiler</text>
<text top="990" left="170" width="556" height="19" font="5">be able to identify the VMADL deÔ¨Ånitions based on names used for service modules.</text>
<text top="1008" left="192" width="531" height="19" font="5">This gives freedom to the VM implementation about how to arrange the diÔ¨Äerent</text>
<text top="1026" left="170" width="555" height="19" font="5">artifacts, e. g., how to implement a service module with actual C code. Furthermore,</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="12" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">12</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="170" width="553" height="19" font="5">a VMADL Ô¨Åle may contain a service module deÔ¨Ånition along with combiners, or just</text>
<text top="167" left="170" width="553" height="19" font="5">one or more combiners. Hence, it is possible to specify a newly arisen combination in</text>
<text top="185" left="170" width="412" height="19" font="5">a single new Ô¨Åle without having to touch already existing ones.</text>
<text top="203" left="192" width="530" height="19" font="5">For convenience, the compiler veriÔ¨Åes that the selected source tree contains an</text>
<text top="221" left="170" width="555" height="19" font="5">implementation for every function deÔ¨Åned as a member of a class/trait. Otherwise,</text>
<text top="239" left="170" width="512" height="19" font="5">the developer would be notiÔ¨Åed about such an inconsistency only at link-time.</text>
<text top="257" left="192" width="533" height="19" font="5">In the Ô¨Ånal step, the generated Ô¨Åles are processed by the AspectC++ and C++</text>
<text top="275" left="170" width="553" height="19" font="5">compilers to create the resulting CSOM binary. This Ô¨Ånal step works on the result</text>
<text top="293" left="170" width="553" height="19" font="5">of the previous preprocessing step; thus, all transformation/adaptations deÔ¨Åned in</text>
<text top="311" left="170" width="556" height="19" font="5">VMADL‚ÄîredeÔ¨Ånition of named parts in service modules and modiÔ¨Åcations to classes‚Äî</text>
<text top="329" left="170" width="556" height="19" font="5">have already been applied at that point and are consistently visible to the compilers.</text>
<text top="367" left="170" width="160" height="13" font="5">Practical Limitations</text>
<text top="363" left="345" width="378" height="19" font="5">The main limitation of the current tool chain is that it</text>
<text top="381" left="170" width="555" height="19" font="5">does not enforce consistency of feature model and implementation artifacts. Thus,</text>
<text top="399" left="170" width="553" height="19" font="5">it is possible that implementation and model get ‚Äúout of sync‚Äù and valid or invalid</text>
<text top="417" left="170" width="555" height="19" font="5">conÔ¨Ågurations are not properly reÔ¨Çected by the model. We would like to note, though,</text>
<text top="435" left="170" width="540" height="19" font="5">that the tool chain is primarily a language processor, not a feature modelling tool.</text>
<text top="453" left="192" width="530" height="19" font="5">Other limitations stem from the fact that C and AspectC++ have been used as</text>
<text top="471" left="170" width="553" height="19" font="5">implementation languages. As mentioned before, ClassDL could be replaced with</text>
<text top="488" left="170" width="553" height="19" font="5">another language (e. g., C++) since its sole purpose is to provide a conceptual model</text>
<text top="506" left="170" width="546" height="19" font="5">of classes and traits that can be the target of reÔ¨Ånements by other service modules.</text>
<text top="524" left="192" width="533" height="19" font="5">The current status of the AspectC++ implementation raises two relevant issues.</text>
<text top="542" left="170" width="554" height="19" font="5">The Ô¨Årst is a limitation of AspectC++ regarding functions with variable argument</text>
<text top="560" left="170" width="553" height="19" font="5">lists. This is currently not fully supported by AspectC++; thus, our experiments had</text>
<text top="578" left="170" width="513" height="19" font="5">to avoid using this feature for functions that constitute interesting join-points.</text>
<text top="596" left="192" width="530" height="19" font="5">Another AspectC++ characteristic is more critical, especially with regard to the</text>
<text top="614" left="170" width="553" height="19" font="5">performance-sensitive Ô¨Åeld of VM implementations. The issue is with advice that</text>
<text top="632" left="170" width="556" height="19" font="5">access and modify return values of advised functions. Here, the current state of C++</text>
<text top="650" left="170" width="553" height="19" font="5">compiler optimisations fails to provide adequate performance for complex situations</text>
<text top="668" left="170" width="553" height="19" font="5">like interpreter loops. The workaround of replacing return values with reference</text>
<text top="686" left="170" width="553" height="19" font="5">parameters is not ideal, but allows avoiding performance impacts resulting from advice</text>
<text top="704" left="170" width="555" height="19" font="5">usage. However, this is a limitation of some of the elements of the current tool chain,</text>
<text top="722" left="170" width="287" height="19" font="5">but not of the overall approach of VMADL.</text>
<text top="770" left="170" width="10" height="20" font="0">4</text>
<text top="770" left="201" width="276" height="20" font="0">A Virtual Machine Product Line</text>
<text top="804" left="170" width="553" height="19" font="5">This section presents CSOM/PL. The Ô¨Årst part discusses the product line‚Äôs feature</text>
<text top="822" left="170" width="555" height="19" font="5">model, possible conÔ¨Ågurations, representation using pure::variants, and overall ben-</text>
<text top="840" left="170" width="553" height="19" font="5">eÔ¨Åts of our approach. Subsequently, we discuss the language-level concepts used to</text>
<text top="858" left="170" width="191" height="19" font="5">modularise CSOM‚Äôs features.</text>
<text top="900" left="170" width="22" height="17" font="3">4.1</text>
<text top="900" left="210" width="225" height="17" font="3">The CSOM/PL Feature Model</text>
<text top="927" left="169" width="401" height="19" font="5">With the proof of concept implementation of VMADL <a href="pdfxml.html#27">[HAT</a></text>
<text top="928" left="570" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="927" left="580" width="143" height="19" font="5"><a href="pdfxml.html#27">09], </a>it was possible to</text>
<text top="945" left="170" width="555" height="19" font="5">use the implementation of explicit memory management, mark/sweep and reference-</text>
<text top="963" left="170" width="553" height="19" font="5">counting GC, and green as well as native threads for a case study. Each of these</text>
<text top="981" left="170" width="553" height="19" font="5">features was implemented as a mere add-on to CSOM; no feature combinations were</text>
<text top="999" left="170" width="553" height="19" font="5">provided. Some of the CSOM versions composed using the VMADL proof of concept</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="13" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="15" size="6" family="Times" color="#000000"/>
	<fontspec id="16" size="3" family="Times" color="#000000"/>
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">13</text>
<text top="153" left="437" width="25" height="8" font="15">CSOM</text>
<text top="187" left="313" width="35" height="8" font="15">Misc Libs</text>
<text top="187" left="224" width="33" height="8" font="15">VM Core</text>
<text top="225" left="570" width="34" height="8" font="15">Compiler</text>
<text top="225" left="668" width="36" height="8" font="15">Primitives</text>
<text top="225" left="616" width="41" height="8" font="15">VMObjects</text>
<text top="187" left="618" width="37" height="8" font="15">Language</text>
<text top="187" left="406" width="87" height="8" font="15">Execution Environment</text>
<text top="225" left="390" width="23" height="8" font="15">Image</text>
<text top="278" left="381" width="20" height="5" font="16">requires</text>
<text top="225" left="511" width="44" height="8" font="15">Tagged Ints</text>
<text top="263" left="525" width="16" height="8" font="15">One</text>
<text top="225" left="221" width="39" height="8" font="15">Interpreter</text>
<text top="263" left="251" width="36" height="8" font="15">Threaded</text>
<text top="263" left="188" width="47" height="8" font="15">Switch/Case</text>
<text top="225" left="322" width="31" height="8" font="15">Threads</text>
<text top="263" left="309" width="23" height="8" font="15">Green</text>
<text top="263" left="345" width="24" height="8" font="15">Native</text>
<text top="225" left="434" width="30" height="8" font="15">Memory</text>
<text top="300" left="371" width="47" height="8" font="15">Mark/Sweep</text>
<text top="300" left="434" width="36" height="8" font="15">RefCount</text>
<text top="263" left="417" width="13" height="8" font="15">GC</text>
<text top="263" left="462" width="27" height="8" font="15">Explicit</text>
<text top="325" left="193" width="506" height="17" font="1">Figure 3 ‚Äì The CSOM/PL feature model as realised by the current implementation.</text>
<text top="374" left="170" width="553" height="19" font="5">were less robust than the CSOM extensions with the same features that were coded</text>
<text top="392" left="170" width="57" height="19" font="5">by hand.</text>
<text top="410" left="192" width="531" height="19" font="5">In contrast, the present VMADL implementation enabled us to achieve signiÔ¨Åcantly</text>
<text top="428" left="170" width="553" height="19" font="5">better results. On the one hand, we were able to use, in addition to the features</text>
<text top="446" left="170" width="555" height="19" font="5">mentioned above, implementations of Smalltalk virtual images, 1-based tagged integers,</text>
<text top="463" left="170" width="553" height="19" font="5">and threaded interpretation. On the other hand, feature combinations were achieved</text>
<text top="485" left="170" width="354" height="13" font="5">that were not even existent in hand-coded form before.</text>
<text top="995" left="446" width="269" height="17" font="1">Figure 4 ‚Äì A concrete CSOM/PL configura-</text>
<text top="1015" left="469" width="131" height="12" font="1">tion in pure::variants.</text>
<text top="499" left="192" width="235" height="19" font="5">Fig. <a href="pdfxml.html#13">3 </a>shows a feature diagram repre-</text>
<text top="517" left="170" width="258" height="19" font="5">senting the current status of CSOM/PL.</text>
<text top="535" left="170" width="256" height="19" font="5">As usual with feature diagrams, boxes</text>
<text top="553" left="170" width="255" height="19" font="5">represent particular features, with the</text>
<text top="571" left="170" width="255" height="19" font="5">root representing the product line in</text>
<text top="589" left="170" width="255" height="19" font="5">question. Inner nodes denote features</text>
<text top="607" left="170" width="257" height="19" font="5">that can be realised in diÔ¨Äerent ways;</text>
<text top="625" left="170" width="258" height="19" font="5">leaves indicate concrete shapes of cer-</text>
<text top="643" left="170" width="255" height="19" font="5">tain features. The connections between</text>
<text top="661" left="170" width="258" height="19" font="5">features in the diagram point out de-</text>
<text top="679" left="170" width="258" height="19" font="5">pendencies. Mandatory features are rep-</text>
<text top="697" left="170" width="256" height="19" font="5">resented by lines with a Ô¨Ålled circle at</text>
<text top="715" left="170" width="255" height="19" font="5">the end; lines for optional features have</text>
<text top="732" left="170" width="255" height="19" font="5">an empty circle. An arc between lines</text>
<text top="750" left="170" width="157" height="19" font="5">indicates an alternative.</text>
<text top="768" left="192" width="233" height="19" font="5">Each of the 14 concrete features in</text>
<text top="786" left="170" width="256" height="19" font="5">Fig. <a href="pdfxml.html#13">3 </a>has been realised as a VMADL</text>
<text top="804" left="170" width="255" height="19" font="5">service module, and all of the achieved</text>
<text top="822" left="170" width="258" height="19" font="5">product line instances have been re-</text>
<text top="840" left="170" width="255" height="19" font="5">alised using VMADL combiners. The</text>
<text top="858" left="170" width="258" height="19" font="5">latter not only make it possible to cre-</text>
<text top="876" left="170" width="255" height="19" font="5">ate actual CSOM/PL products, but also</text>
<text top="894" left="170" width="258" height="19" font="5">make the architectural relationships be-</text>
<text top="912" left="170" width="256" height="19" font="5">tween the features (cf. Fig. <a href="pdfxml.html#4">1) </a>explicit</text>
<text top="930" left="170" width="255" height="19" font="5">at the source code level. Based on the</text>
<text top="948" left="170" width="255" height="19" font="5">given module names (cf. Sec. <a href="pdfxml.html#10">3.6), </a>the</text>
<text top="966" left="170" width="258" height="19" font="5">VMADL compiler decides which interac-</text>
<text top="984" left="170" width="255" height="19" font="5">tions are actually required to instantiate</text>
<text top="1001" left="170" width="256" height="19" font="5">a given product, and generates code only</text>
<text top="1019" left="170" width="255" height="19" font="5">for those. More detailed descriptions of</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="14" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">14</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="170" width="345" height="19" font="5">the various feature implementations are given below.</text>
<text top="167" left="192" width="530" height="19" font="5">The feature diagram exhibits a constraint imposed on virtual images: they require</text>
<text top="185" left="170" width="553" height="19" font="5">combination with the mark/sweep GC as they are not compatible with reference</text>
<text top="203" left="170" width="553" height="19" font="5">counting. This is due to the Image feature‚Äôs relying on all objects being laid out in a</text>
<text top="221" left="170" width="553" height="19" font="5">single contiguous memory area, a property that is not guaranteed by explicit memory</text>
<text top="239" left="170" width="553" height="19" font="5">management and reference counting. The feature diagram also excludes combinations</text>
<text top="257" left="170" width="553" height="19" font="5">of virtual images with multi-threading. This is simply because the Image feature</text>
<text top="275" left="170" width="555" height="19" font="5">was not adapted for thread safety. Note that these combinations are, in principle,</text>
<text top="293" left="170" width="439" height="19" font="5">achievable but require some more implementation eÔ¨Äort (cf. Sec. <a href="pdfxml.html#25">7).</a></text>
<text top="311" left="192" width="533" height="19" font="5">The feature model has been realised in software using pure::variants, an industry-</text>
<text top="329" left="170" width="555" height="19" font="5">strength tool for variability modelling and management. It features a model editor,</text>
<text top="347" left="170" width="553" height="19" font="5">product conÔ¨Ågurator, validity checker, and a rich generator infrastructure. Fig. <a href="pdfxml.html#13">4 </a>shows</text>
<text top="365" left="170" width="553" height="19" font="5">a screenshot from the product conÔ¨Åguration view, where the entire feature model tree</text>
<text top="383" left="170" width="221" height="19" font="5">of CSOM/PL has been expanded.</text>
<text top="401" left="192" width="531" height="19" font="5">In the Ô¨Ågure, yellow circles with an ‚ÄúF‚Äù denote features. An exclamation mark</text>
<text top="419" left="170" width="555" height="19" font="5">indicates a mandatory feature; a question mark, an optional feature; a green ‚ÄúX‚Äù,</text>
<text top="436" left="170" width="553" height="19" font="5">conÔ¨Çicting features. Unboxed ticks denote automatic selection, tick boxes indicate</text>
<text top="454" left="170" width="553" height="19" font="5">possible conÔ¨Åguration choices. Double green arrows next to feature circles mean that</text>
<text top="472" left="170" width="553" height="19" font="5">these features have dependencies, and hence, consequences for the overall conÔ¨Åguration</text>
<text top="490" left="170" width="553" height="19" font="5">if selected. The various ‚ÄúDescriptor‚Äù nodes contain text fragments that are used to</text>
<text top="508" left="170" width="556" height="19" font="5">assemble the list of parameters passed to the make script generated from a conÔ¨Åguration.</text>
<text top="526" left="192" width="532" height="19" font="5">The selected conÔ¨Åguration represents a CSOM VM with a threaded interpreter,</text>
<text top="544" left="170" width="555" height="19" font="5">mark-sweep GC, one-tagged integer representation, virtual images, and no multithread-</text>
<text top="562" left="170" width="553" height="19" font="5">ing support. The mark-sweep GC has been selected automatically by pure::variants as</text>
<text top="580" left="170" width="308" height="19" font="5">the Image feature was included in the product.</text>
<text top="598" left="192" width="531" height="19" font="5">From such a product conÔ¨Åguration, the SPL tool generates a one-line build script</text>
<text top="616" left="170" width="553" height="19" font="5">that is used to drive CSOM/PL Makefile conÔ¨Åguration (cf. Sec. <a href="pdfxml.html#10">3.6). </a>For the example</text>
<text top="634" left="170" width="553" height="19" font="5">given in Fig. <a href="pdfxml.html#13">4, </a>the resulting make invocation would look like this: make threaded</text>
<text top="657" left="170" width="180" height="12" font="5">marksweep int-one image</text>
<text top="652" left="350" width="4" height="19" font="5">.</text>
<text top="695" left="170" width="22" height="17" font="3">4.2</text>
<text top="695" left="210" width="277" height="17" font="3">Feature and Product Implementations</text>
<text top="721" left="169" width="554" height="19" font="5">We will now give brief examples of how VMADL was used to implement the CSOM/PL</text>
<text top="739" left="170" width="556" height="19" font="5">features as service modules, and how those were combined to instantiate products.</text>
<text top="757" left="170" width="553" height="19" font="5">Note that the CSOM ‚Äúbase implementation‚Äù did not have to be adapted to meet the</text>
<text top="775" left="170" width="553" height="19" font="5">needs of any of the extensions that were added. All combinations could be expressed</text>
<text top="793" left="170" width="555" height="19" font="5">using the abstraction capabilities of VMADL and the embedded aspect language,</text>
<text top="811" left="170" width="553" height="19" font="5">AspectC++. Throughout this section, we only give brief examples. A more elaborate</text>
<text top="829" left="170" width="553" height="19" font="5">example is given in the appendix. It shows the deÔ¨Ånition of the native multi-threading</text>
<text top="847" left="170" width="553" height="19" font="5">service module (NativeThreads) and its combination with the Interpreter and</text>
<text top="870" left="170" width="86" height="12" font="5">GCMarkSweep</text>
<text top="865" left="261" width="462" height="19" font="5">modules. This combination was chosen because it signiÔ¨Åcantly inÔ¨Çuences</text>
<text top="882" left="170" width="191" height="19" font="5">the involved service modules.</text>
<text top="920" left="170" width="166" height="13" font="5">Memory Management</text>
<text top="917" left="351" width="372" height="19" font="5">The three diÔ¨Äerent service modules representing concrete</text>
<text top="934" left="170" width="553" height="19" font="5">memory management features each have a particular implementation of a common</text>
<text top="952" left="170" width="553" height="19" font="5">interface. The explicit memory management service module, simply falling back</text>
<text top="970" left="170" width="553" height="19" font="5">to malloc and supporting no garbage collection, does not provide any additional</text>
<text top="988" left="170" width="491" height="19" font="5">functionality but relies on the interfaces oÔ¨Äered by VMCore and VMObjects.</text>
<text top="1006" left="192" width="531" height="19" font="5">The mark/sweep GC implementation is almost transparent to the explicit memory</text>
<text top="1024" left="170" width="553" height="19" font="5">management service module which acts as an underlying base module. Only few parts</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="15" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">15</text>
<text top="150" left="170" width="553" height="19" font="5">are adapted in other service modules by reÔ¨Ånement or combiners. An example is given</text>
<text top="167" left="170" width="553" height="19" font="5">in Lst. <a href="pdfxml.html#15">5 </a>for the introduction of a mark Ô¨Åeld into the VMObject by a ClassDL refine</text>
<text top="185" left="170" width="539" height="19" font="5">statement. It inserts the mark Ô¨Åeld before the Ô¨Årst Ô¨Åeld containing a member slot.</text>
<text top="218" left="158" width="5" height="7" font="11">1</text>
<text top="217" left="170" width="117" height="9" font="6">service GCMarkSweep {</text>
<text top="230" left="158" width="5" height="7" font="11">2</text>
<text top="229" left="180" width="94" height="9" font="6">refine VMObject {</text>
<text top="242" left="158" width="5" height="7" font="11">3</text>
<text top="241" left="190" width="183" height="9" font="6">int gc_field { before fields[0] }</text>
<text top="254" left="158" width="5" height="7" font="11">4</text>
<text top="253" left="180" width="6" height="9" font="6">}</text>
<text top="266" left="158" width="5" height="7" font="11">5</text>
<text top="265" left="170" width="6" height="9" font="6">}</text>
<text top="278" left="158" width="5" height="7" font="11">6</text>
<text top="276" left="170" width="178" height="9" font="6">combine GCMarkSweep, VMObjects {</text>
<text top="290" left="158" width="5" height="7" font="11">7</text>
<text top="288" left="180" width="244" height="9" font="6">advice execution(VMObjects::initializer()) :</text>
<text top="302" left="158" width="5" height="7" font="11">8</text>
<text top="300" left="180" width="56" height="9" font="6">around() {</text>
<text top="314" left="158" width="5" height="7" font="11">9</text>
<text top="312" left="190" width="211" height="9" font="6">gc_start_uninterruptable_allocation();</text>
<text top="326" left="152" width="10" height="7" font="11">10</text>
<text top="324" left="190" width="83" height="9" font="6">tjp-&gt;proceed();</text>
<text top="337" left="152" width="10" height="7" font="11">11</text>
<text top="336" left="190" width="200" height="9" font="6">gc_end_uninterruptable_allocation();</text>
<text top="349" left="152" width="10" height="7" font="11">12</text>
<text top="348" left="180" width="6" height="9" font="6">}</text>
<text top="361" left="152" width="10" height="7" font="11">13</text>
<text top="360" left="170" width="6" height="9" font="6">}</text>
<text top="381" left="291" width="310" height="17" font="1">Listing 5 ‚Äì Combine Mark/Sweep with VMObjects.</text>
<text top="416" left="192" width="530" height="19" font="5">Furthermore, a combiner describes how the GCMarkSweep and VMObjects service</text>
<text top="434" left="170" width="553" height="19" font="5">modules interact, introducing a guard for object initialisation. This avoids dangling</text>
<text top="452" left="170" width="553" height="19" font="5">pointers resulting from partially initialised objects which could be caused by a GC</text>
<text top="470" left="170" width="548" height="19" font="5">run during object creation. The corresponding code is shown in lines 6‚Äì13 in Lst. <a href="pdfxml.html#15">5.</a></text>
<text top="488" left="192" width="530" height="19" font="5">The modularisation of the reference-counting GC (GCRefCount) is, at Ô¨Årst, quite</text>
<text top="506" left="170" width="553" height="19" font="5">similar, as the example in Lst. <a href="pdfxml.html#15">6 </a>illustrates. A refine statement introduces a Ô¨Åeld for</text>
<text top="523" left="170" width="553" height="19" font="5">the reference count in the VMObject class of the VMObjects service module. Other</text>
<text top="541" left="170" width="553" height="19" font="5">than with mark/sweep GC, the nature of reference counting demands a high number of</text>
<text top="559" left="170" width="553" height="19" font="5">interactions with other modules, since almost every assignment of an object reference</text>
<text top="577" left="170" width="553" height="19" font="5">has to be tracked. Thus, combiners have to be deÔ¨Åned for all service modules the</text>
<text top="595" left="170" width="555" height="19" font="5">reference-counting GC has to be used with. These combiners are typically straightfor-</text>
<text top="613" left="170" width="553" height="19" font="5">ward. They increase the reference count of the new object before the actual execution</text>
<text top="631" left="170" width="396" height="19" font="5">and decrease the reference count of the old value afterwards.</text>
<text top="661" left="158" width="5" height="7" font="11">1</text>
<text top="659" left="170" width="111" height="9" font="6">service GCRefCount {</text>
<text top="673" left="158" width="5" height="7" font="11">2</text>
<text top="671" left="180" width="94" height="9" font="6">refine VMObject {</text>
<text top="685" left="158" width="5" height="7" font="11">3</text>
<text top="683" left="190" width="183" height="9" font="6">int gc_field { before fields[0] }</text>
<text top="697" left="158" width="5" height="7" font="11">4</text>
<text top="695" left="180" width="6" height="9" font="6">}</text>
<text top="708" left="158" width="5" height="7" font="11">5</text>
<text top="707" left="170" width="6" height="9" font="6">}</text>
<text top="720" left="158" width="5" height="7" font="11">6</text>
<text top="719" left="170" width="172" height="9" font="6">combine GCRefCount, VMObjects {</text>
<text top="732" left="158" width="5" height="7" font="11">7</text>
<text top="731" left="180" width="444" height="9" font="6">advice execution(VMObject::set_field(self, idx, val)) : around(self, idx, val) {</text>
<text top="744" left="158" width="5" height="7" font="11">8</text>
<text top="743" left="190" width="211" height="9" font="6">pVMObject old_val = self-&gt;fields[idx];</text>
<text top="756" left="158" width="5" height="7" font="11">9</text>
<text top="755" left="190" width="161" height="9" font="6">gc_inc_reference_counter(val)</text>
<text top="768" left="152" width="10" height="7" font="11">10</text>
<text top="767" left="190" width="83" height="9" font="6">tjp-&gt;proceed();</text>
<text top="780" left="152" width="10" height="7" font="11">11</text>
<text top="779" left="190" width="189" height="9" font="6">gc_dec_reference_counter(old_val);</text>
<text top="792" left="152" width="10" height="7" font="11">12</text>
<text top="791" left="180" width="6" height="9" font="6">}</text>
<text top="804" left="152" width="10" height="7" font="11">13</text>
<text top="803" left="180" width="444" height="9" font="6">advice execution(VMObject::set_class(self, idx, val)) : around(self, idx, val) {</text>
<text top="816" left="152" width="10" height="7" font="11">14</text>
<text top="815" left="190" width="178" height="9" font="6">pVMObject old_val = self-&gt;clazz;</text>
<text top="828" left="152" width="10" height="7" font="11">15</text>
<text top="827" left="190" width="161" height="9" font="6">gc_inc_reference_counter(val)</text>
<text top="840" left="152" width="10" height="7" font="11">16</text>
<text top="839" left="190" width="83" height="9" font="6">tjp-&gt;proceed();</text>
<text top="852" left="152" width="10" height="7" font="11">17</text>
<text top="851" left="190" width="189" height="9" font="6">gc_dec_reference_counter(old_val);</text>
<text top="864" left="152" width="10" height="7" font="11">18</text>
<text top="863" left="180" width="6" height="9" font="6">}</text>
<text top="876" left="152" width="10" height="7" font="11">19</text>
<text top="875" left="180" width="17" height="9" font="6">...</text>
<text top="888" left="152" width="10" height="7" font="11">20</text>
<text top="887" left="170" width="6" height="9" font="6">}</text>
<text top="900" left="152" width="10" height="7" font="11">21</text>
<text top="899" left="170" width="183" height="9" font="6">combine GCRefCount, Interpreter {</text>
<text top="912" left="152" width="10" height="7" font="11">22</text>
<text top="910" left="180" width="261" height="9" font="6">advice Interpreter::unwind_stack() : before() {</text>
<text top="924" left="152" width="10" height="7" font="11">23</text>
<text top="922" left="190" width="228" height="9" font="6">pVMFrame frame = Interpreter_get_frame();</text>
<text top="936" left="152" width="10" height="7" font="11">24</text>
<text top="934" left="190" width="239" height="9" font="6">gc_inc_reference_counter((pVMObject)frame);</text>
<text top="948" left="152" width="10" height="7" font="11">25</text>
<text top="946" left="180" width="6" height="9" font="6">}</text>
<text top="960" left="152" width="10" height="7" font="11">26</text>
<text top="958" left="180" width="17" height="9" font="6">...</text>
<text top="972" left="152" width="10" height="7" font="11">27</text>
<text top="970" left="170" width="6" height="9" font="6">}</text>
<text top="991" left="270" width="352" height="17" font="1">Listing 6 ‚Äì Combine Reference Counting with VMObjects.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="16" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">16</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="153" left="170" width="125" height="13" font="5">Multi-Threading</text>
<text top="150" left="310" width="413" height="19" font="5">From the modularisation perspective, green threading is quite</text>
<text top="167" left="170" width="553" height="19" font="5">undemanding. The service module GreenThreads interacts with the Primitives</text>
<text top="185" left="170" width="553" height="19" font="5">service module to register primitives for the Scheduler class and with the VMCore</text>
<text top="203" left="170" width="553" height="19" font="5">service module to enable the shell to use threads as well. Another combiner is used</text>
<text top="221" left="170" width="553" height="19" font="5">to adapt the Interpreter service module to signal when it reaches a safe point in</text>
<text top="239" left="170" width="375" height="19" font="5">execution to allow thread pre-emption as shown in Lst. <a href="pdfxml.html#16">7.</a></text>
<text top="272" left="158" width="5" height="7" font="11">1</text>
<text top="270" left="170" width="117" height="9" font="6">service Interpreter {</text>
<text top="284" left="158" width="5" height="7" font="11">2</text>
<text top="282" left="180" width="44" height="9" font="6">expose {</text>
<text top="296" left="158" width="5" height="7" font="11">3</text>
<text top="294" left="190" width="294" height="9" font="6">pointcut safe_points() = execution(&#34;void send(...)&#34;);</text>
<text top="308" left="158" width="5" height="7" font="11">4</text>
<text top="306" left="180" width="6" height="9" font="6">}</text>
<text top="320" left="158" width="5" height="7" font="11">5</text>
<text top="318" left="170" width="6" height="9" font="6">}</text>
<text top="332" left="158" width="5" height="7" font="11">6</text>
<text top="330" left="170" width="194" height="9" font="6">combine GreenThreads, Interpreter {</text>
<text top="343" left="158" width="5" height="7" font="11">7</text>
<text top="342" left="180" width="256" height="9" font="6">advice Interpreter::safe_points() : before() {</text>
<text top="355" left="158" width="5" height="7" font="11">8</text>
<text top="354" left="190" width="139" height="9" font="6">++scheduler_return_count;</text>
<text top="367" left="158" width="5" height="7" font="11">9</text>
<text top="366" left="190" width="161" height="9" font="6">Scheduler_insert_scheduler();</text>
<text top="379" left="152" width="10" height="7" font="11">10</text>
<text top="378" left="180" width="6" height="9" font="6">}</text>
<text top="391" left="152" width="10" height="7" font="11">11</text>
<text top="390" left="170" width="6" height="9" font="6">}</text>
<text top="411" left="320" width="252" height="17" font="1">Listing 7 ‚Äì Pre-emption for green threads.</text>
<text top="446" left="192" width="533" height="19" font="5">Some additional combiners are necessary to support the combined usage of multi-</text>
<text top="464" left="170" width="553" height="19" font="5">threading with the diÔ¨Äerent GCs. For conÔ¨Ågurations using GCMarkSweep, the combiner</text>
<text top="482" left="170" width="553" height="19" font="5">implements an extension to the GC‚Äôs mark phase to add the Scheduler-internal list</text>
<text top="500" left="170" width="553" height="19" font="5">of available threads to the GC‚Äôs root set. Were this not done, all but the currently</text>
<text top="517" left="170" width="553" height="19" font="5">running thread would not be regarded as live objects. The case is similar for reference</text>
<text top="535" left="170" width="553" height="19" font="5">counting: assignments to Scheduler data structures have to be handled like all other</text>
<text top="553" left="170" width="401" height="19" font="5">assignments to ensure reference counts are updated correctly.</text>
<text top="571" left="192" width="530" height="19" font="5">For NativeThreads, the changes are more fundamental than for green threads</text>
<text top="589" left="168" width="555" height="19" font="5">(cf. Sec. <a href="pdfxml.html#3">2). </a>The major task is to achieve thread-local execution of interpreters by</text>
<text top="607" left="170" width="553" height="19" font="5">adapting the global frame pointer to be a thread-local one. Since most service modules</text>
<text top="625" left="170" width="467" height="19" font="5">are implemented without global state, this adaptation need is very low.</text>
<text top="643" left="192" width="530" height="19" font="5">The aforementioned assignment adjustments were done to enable the combination</text>
<text top="661" left="170" width="553" height="19" font="5">of the NativeThreads and GCRefCount service modules. With GCMarkSweep, this is</text>
<text top="679" left="170" width="553" height="19" font="5">more challenging. The scheme that was implemented in the feature combination found</text>
<text top="697" left="170" width="553" height="19" font="5">in CSOM/PL is a stop-the-world solution <a href="pdfxml.html#27">[JL96]. </a>This is implemented entirely inside</text>
<text top="715" left="170" width="553" height="19" font="5">a combiner (cf. App. <a href="pdfxml.html#29">A) </a>and will therefore become part of an instance of the CSOM</text>
<text top="733" left="170" width="553" height="19" font="5">product line only if both service modules‚Äîmark/sweep GC and native threads‚Äîare</text>
<text top="751" left="170" width="47" height="19" font="5">chosen.</text>
<text top="789" left="170" width="134" height="13" font="5">Execution Engine</text>
<text top="785" left="319" width="406" height="19" font="5">Interaction with the two possible interpreters is realised us-</text>
<text top="803" left="170" width="553" height="19" font="5">ing the common Interpreter service module interface. The threaded interpreter</text>
<text top="821" left="168" width="554" height="19" font="5">(InterpreterThreaded) requires some interaction with other service modules; e. g., a</text>
<text top="838" left="170" width="553" height="19" font="5">combination with the VMObjects service module achieves the translation of method</text>
<text top="856" left="170" width="556" height="19" font="5">bytecodes into threaded code <a href="pdfxml.html#26">[Bel73] </a>after method assembly by the Smalltalk compiler.</text>
<text top="874" left="170" width="553" height="19" font="5">Bytecode index handling is also adapted. The original design implies a local bytecode</text>
<text top="892" left="170" width="555" height="19" font="5">index in every VMFrame object. For threaded interpretation, this needs to be changed,</text>
<text top="910" left="170" width="474" height="19" font="5">since it relies on a global pointer to the bytecode handler executed next.</text>
<text top="948" left="170" width="172" height="13" font="5">Integer Representation</text>
<text top="944" left="357" width="368" height="19" font="5">When integers are implemented as ‚Äúordinary‚Äù objects, i. e.,</text>
<text top="966" left="170" width="34" height="13" font="5">boxed</text>
<text top="962" left="209" width="514" height="19" font="5">integers, there is no diÔ¨Äerence between sending a message to an Integer instance</text>
<text top="980" left="170" width="553" height="19" font="5">or to another object: the virtual method table (VMT) is accessed and the message</text>
<text top="998" left="170" width="553" height="19" font="5">implementation resolved. Conversely, tagged integers do not have a multiple-slot</text>
<text top="1016" left="170" width="553" height="19" font="5">representation in memory, and do not reference a VMT. Instead, a global ‚Äúsurrogate</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="17" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">17</text>
<text top="150" left="170" width="517" height="19" font="5">object‚Äù exists via whose VMT messages sent to tagged integers are dispatched.</text>
<text top="167" left="192" width="530" height="19" font="5">In CSOM, adopting this change is challenging because sending messages to objects</text>
<text top="185" left="170" width="553" height="19" font="5">is realised via C macros, which cannot normally be redeÔ¨Åned. However, as VMADL</text>
<text top="203" left="170" width="553" height="19" font="5">features named sections (cf. Sec. <a href="pdfxml.html#7">3.3), </a>redeÔ¨Åning the SEND macro infrastructure is done</text>
<text top="221" left="170" width="553" height="19" font="5">by providing a replacement for the corresponding named section in the ObjectModel</text>
<text top="239" left="170" width="553" height="19" font="5">service module. For this case study, we used one-based tagging as in Smalltalk-80</text>
<text top="257" left="170" width="50" height="19" font="5"><a href="pdfxml.html#27">[GR83].</a></text>
<text top="295" left="170" width="137" height="13" font="5">Image Persistence</text>
<text top="291" left="322" width="401" height="19" font="5">The Smalltalk virtual images implementation in the Image</text>
<text top="309" left="170" width="553" height="19" font="5">service module relies predominantly on the abilities of ClassDL to reÔ¨Åne classes and</text>
<text top="327" left="170" width="553" height="19" font="5">add methods. This is used to update references after loading an existing image. The</text>
<text top="345" left="170" width="553" height="19" font="5">change in the startup process of the VM to load an image instead of initialising the VM</text>
<text top="363" left="170" width="553" height="19" font="5">from source Ô¨Åles is done by simple adaptations of initialisation routines implemented</text>
<text top="381" left="170" width="232" height="19" font="5">with a service module combination.</text>
<text top="424" left="170" width="22" height="17" font="3">4.3</text>
<text top="424" left="210" width="163" height="17" font="3">Feature Generalisation</text>
<text top="450" left="170" width="556" height="19" font="5">The intertwined nature of VM implementations usually leads to ad-hoc deÔ¨Åned inter-</text>
<text top="468" left="170" width="553" height="19" font="5">faces. As can be seen from the previous section, this tendency exists also for service</text>
<text top="486" left="170" width="553" height="19" font="5">modules. However, once a number of features requires a certain set of interfaces and</text>
<text top="504" left="170" width="370" height="19" font="5">events, it becomes beneÔ¨Åcial to generalise these features.</text>
<text top="522" left="192" width="533" height="19" font="5">In VMs, a common problem is the interaction of all modules with GC logic.</text>
<text top="540" left="170" width="553" height="19" font="5">The characteristics for diÔ¨Äerent GC approaches diÔ¨Äer especially when it comes to</text>
<text top="558" left="170" width="553" height="19" font="5">performance characteristics. Thus, a VM product line should be able to provide</text>
<text top="576" left="170" width="297" height="19" font="5">diÔ¨Äerent GC algorithms for speciÔ¨Åc purposes.</text>
<text top="594" left="192" width="530" height="19" font="5">The major concern for many GC types are read and write barriers. Thus, the VM</text>
<text top="612" left="170" width="553" height="19" font="5">needs to make it explicit for the GC when values are read from the heap or stored into</text>
<text top="630" left="170" width="553" height="19" font="5">it. Also important are references stored in registers, on the stack, or in other globals</text>
<text top="648" left="170" width="287" height="19" font="5">that are not immediately known to the GC.</text>
<text top="665" left="192" width="532" height="19" font="5">What we have seen above for the reference-counting GC are typical write barriers:</text>
<text top="683" left="170" width="556" height="19" font="5">on every write, the reference count of the old and new values have to be adapted.</text>
<text top="701" left="170" width="553" height="19" font="5">Furthermore, there are a couple of write barriers for storing into temporary locations</text>
<text top="719" left="170" width="553" height="19" font="5">on the stack necessary to be able to track the correct reference counts and avoid</text>
<text top="737" left="170" width="556" height="19" font="5">premature reclamation. Read barriers are very similar, but are not discussed here.</text>
<text top="755" left="170" width="556" height="19" font="5">One example of a GC algorithm using a read barrier is the pauseless GC <a href="pdfxml.html#26">[CTW05].</a></text>
<text top="773" left="170" width="556" height="19" font="5">Here, the value of each reference that is read has to be checked and possibly updated.</text>
<text top="791" left="192" width="530" height="19" font="5">With VMADL, concepts like read/write barriers can be reiÔ¨Åed and generalised on</text>
<text top="809" left="170" width="553" height="19" font="5">the architectural level. Instead of leaving the responsibility to the reference-counting</text>
<text top="827" left="170" width="555" height="19" font="5">GC to identify the points where reads/stores constitute a relevant event for a barrier,</text>
<text top="845" left="170" width="553" height="19" font="5">the service modules themselves can make these explicit. For example, see the pointcut</text>
<text top="863" left="170" width="392" height="19" font="5">in Lst. <a href="pdfxml.html#17">8 </a>which aggregates the relevant writes of VMObjects.</text>
<text top="896" left="158" width="5" height="7" font="11">1</text>
<text top="894" left="170" width="211" height="9" font="6">pointcut Interpreter::object_store() =</text>
<text top="908" left="158" width="5" height="7" font="11">2</text>
<text top="906" left="205" width="200" height="9" font="6">execution(VMObjects::set_field(...))</text>
<text top="920" left="158" width="5" height="7" font="11">3</text>
<text top="918" left="190" width="211" height="9" font="6">|| execution(VMObject::set_class(...))</text>
<text top="931" left="158" width="5" height="7" font="11">4</text>
<text top="930" left="190" width="33" height="9" font="6">|| ...</text>
<text top="951" left="274" width="345" height="17" font="1">Listing 8 ‚Äì Generalised Write Barrier for the VMObjects.</text>
<text top="986" left="192" width="531" height="19" font="5">This leads to the desired modularisation, since now the GC modules need only</text>
<text top="1003" left="170" width="553" height="19" font="5">architectural-level information about the event, and a service module can expose this</text>
<text top="1021" left="170" width="202" height="19" font="5">through appropriate pointcuts.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="18" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">18</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="155" left="232" width="30" height="9" font="6">Name</text>
<text top="155" left="421" width="140" height="9" font="6">Selected Optional Features</text>
<text top="177" left="232" width="27" height="9" font="6">Base</text>
<text top="175" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="175" left="467" width="88" height="9" font="6">Explicit Memory</text>
<text top="189" left="232" width="57" height="9" font="6">RefCount</text>
<text top="187" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="187" left="467" width="72" height="9" font="6">RefCount GC</text>
<text top="201" left="232" width="73" height="9" font="6">Mark/Sweep</text>
<text top="199" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="199" left="467" width="87" height="9" font="6">Mark/Sweep GC</text>
<text top="213" left="232" width="35" height="9" font="6">Green</text>
<text top="211" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="211" left="467" width="78" height="9" font="6">Green Threads</text>
<text top="225" left="232" width="38" height="9" font="6">Native</text>
<text top="223" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="223" left="467" width="81" height="9" font="6">Native Threads</text>
<text top="237" left="232" width="32" height="9" font="6">Image</text>
<text top="235" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="235" left="467" width="87" height="9" font="6">Mark/Sweep GC</text>
<text top="235" left="573" width="31" height="9" font="6">Image</text>
<text top="249" left="232" width="66" height="9" font="6">Tagged Ints</text>
<text top="247" left="323" width="126" height="9" font="6">Switch/Case Interpreter</text>
<text top="247" left="467" width="87" height="9" font="6">Mark/Sweep GC</text>
<text top="247" left="573" width="86" height="9" font="6">One Tagged Ints</text>
<text top="261" left="232" width="55" height="9" font="6">Threaded</text>
<text top="259" left="323" width="110" height="9" font="6">Threaded Interpreter</text>
<text top="259" left="467" width="87" height="9" font="6">Mark/Sweep GC</text>
<text top="287" left="245" width="402" height="17" font="1">Table 1 ‚Äì CSOM/PL configurations used for evaluation (cf. Fig. <a href="pdfxml.html#13">3)</a></text>
<text top="334" left="170" width="10" height="20" font="0">5</text>
<text top="334" left="201" width="90" height="20" font="0">Evaluation</text>
<text top="368" left="170" width="553" height="19" font="5">Having turned a set of hand-crafted extensions to a base system into a set of cleanly</text>
<text top="386" left="170" width="553" height="19" font="5">encapsulated service modules forming an SPL, there are two points of view from which</text>
<text top="404" left="170" width="553" height="19" font="5">the results should be evaluated. First of all, it is important to assess the impact of</text>
<text top="422" left="170" width="553" height="19" font="5">modularisation and combination on performance. This is especially interesting in the</text>
<text top="440" left="170" width="553" height="19" font="5">domain of VM implementations, where performance is crucial. CSOM has a set of</text>
<text top="458" left="170" width="553" height="19" font="5">benchmarks (cf. Sec. <a href="pdfxml.html#3">2) </a>that can be used to evaluate the performance of hand-crafted</text>
<text top="476" left="170" width="553" height="19" font="5">extensions versus automatically combined products. The second perspective is that of</text>
<text top="494" left="170" width="555" height="19" font="5">code complexity. We have evaluated the source code by applying several metrics to it,</text>
<text top="512" left="170" width="280" height="19" font="5">also considering modularity improvements.</text>
<text top="530" left="192" width="530" height="19" font="5">The hand-crafted CSOM variants were the results of student course-work, as noted</text>
<text top="548" left="170" width="555" height="19" font="5">in Sec. <a href="pdfxml.html#3">2. </a>These variants are used as the baseline for comparison. The derived VMADL-</text>
<text top="565" left="170" width="553" height="19" font="5">based product line is kept as close to the hand-crafted versions as possible. To avoid</text>
<text top="583" left="170" width="553" height="19" font="5">invalidating the results, the code bases have been synchronised to remove diÔ¨Äerences</text>
<text top="601" left="170" width="553" height="19" font="5">in functionality and execution semantics. The diÔ¨Äerences in the source code were</text>
<text top="619" left="170" width="553" height="19" font="5">minimised. The VMADL-based implementation uses conÔ¨Ågurations corresponding to</text>
<text top="637" left="170" width="553" height="19" font="5">the hand-crafted versions. The following section uses the selected optional service</text>
<text top="655" left="170" width="553" height="19" font="5">modules to indicate the exact conÔ¨Åguration. For example, Green is the conÔ¨Åguration</text>
<text top="673" left="170" width="553" height="19" font="5">including the (mandatory) base system and the green-threads feature, while Base is</text>
<text top="691" left="170" width="553" height="19" font="5">the base system without any optional service modules, i. e., the simplest possible VM</text>
<text top="709" left="170" width="268" height="19" font="5">conÔ¨Åguration with a minimal feature set.</text>
<text top="727" left="192" width="530" height="19" font="5">Below, we elaborate on the performance and code complexity assessments, and</text>
<text top="745" left="170" width="361" height="19" font="5">conclude the section with a discussion of our approach.</text>
<text top="788" left="170" width="22" height="17" font="3">5.1</text>
<text top="788" left="210" width="214" height="17" font="3">Virtual Machine Performance</text>
<text top="814" left="170" width="553" height="19" font="5">Performance measurements were run on a 8-core workstation with two Intel Xeon E5520</text>
<text top="832" left="170" width="556" height="19" font="5">processors (2.27 GHz clock rate, 16 hyperthreads overall, 8 MB cache) and 8 GB RAM.</text>
<text top="850" left="170" width="555" height="19" font="5">The operating system was Ubuntu Linux 10.10 with a 64-bit kernel (version 2.6.38-11)</text>
<text top="868" left="170" width="553" height="19" font="5">and 32-bit user land. The used compilers were GNU C++ 4.5.1, and ac++ 1.0/ag++ 0.8</text>
<text top="886" left="170" width="553" height="19" font="5">for AspectC++. The C++ compiler Ô¨Çags used were -m32 -O3 -flto, i. e., to compile</text>
<text top="904" left="170" width="556" height="19" font="5">for 32 bit, with the highest optimisation level, and link-time optimisation turned on.</text>
<text top="922" left="170" width="554" height="19" font="5">The used benchmarks originate from the original SOM implementation and are a set</text>
<text top="940" left="170" width="548" height="19" font="5">of micro-benchmarks and kernels. They are listed with a brief description in Tab. <a href="pdfxml.html#19">2.</a></text>
<text top="958" left="192" width="533" height="19" font="5">For the performance evaluation, we followed the suggestions of Georges et al.</text>
<text top="976" left="170" width="374" height="19" font="5"><a href="pdfxml.html#27">[GBE07]. </a>The benchmarks were executed using ReBenc<a href="pdfxml.html#18">h</a></text>
<text top="977" left="544" width="6" height="9" font="6"><a href="pdfxml.html#18">8</a></text>
<text top="976" left="556" width="167" height="19" font="5">on an idle machine. Each</text>
<text top="994" left="170" width="553" height="19" font="5">benchmark was executed 100 times to ensure statistical conÔ¨Ådence in the results. Each</text>
<text top="1021" left="187" width="5" height="8" font="7"><a href="https://github.com/smarr/ReBench">8</a></text>
<text top="1024" left="193" width="203" height="10" font="4"><a href="https://github.com/smarr/ReBench">https://github.com/smarr/ReBench</a></text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="19" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">19</text>
<text top="155" left="215" width="96" height="9" font="6">Micro-benchmarks</text>
<text top="155" left="495" width="39" height="9" font="6">Kernels</text>
<text top="175" left="215" width="63" height="9" font="6">IntegerLoop</text>
<text top="175" left="329" width="119" height="9" font="6">pure loop over integers</text>
<text top="175" left="495" width="38" height="9" font="6">Bounce</text>
<text top="175" left="572" width="95" height="9" font="6">physics simulation</text>
<text top="187" left="215" width="51" height="9" font="6">Fibonacci</text>
<text top="187" left="329" width="120" height="9" font="6">standard tree-recursive</text>
<text top="187" left="495" width="38" height="9" font="6">Queens</text>
<text top="187" left="572" width="101" height="9" font="6">eight queens puzzle</text>
<text top="199" left="215" width="46" height="9" font="6">Dispatch</text>
<text top="199" left="329" width="87" height="9" font="6">method dispatch</text>
<text top="199" left="495" width="39" height="9" font="6">Storage</text>
<text top="199" left="572" width="97" height="9" font="6">n-ary tree creation</text>
<text top="211" left="215" width="26" height="9" font="6">Loop</text>
<text top="211" left="329" width="64" height="9" font="6">nested loops</text>
<text top="211" left="495" width="27" height="9" font="6">Sieve</text>
<text top="211" left="572" width="90" height="9" font="6">simple prim sieve</text>
<text top="223" left="215" width="23" height="9" font="6">Sum</text>
<text top="223" left="329" width="146" height="9" font="6">object modification in loops</text>
<text top="223" left="495" width="36" height="9" font="6">Towers</text>
<text top="223" left="572" width="85" height="9" font="6">Towers of Hanoi</text>
<text top="235" left="215" width="20" height="9" font="6">List</text>
<text top="235" left="329" width="148" height="9" font="6">linked list creation/traversal</text>
<text top="235" left="495" width="59" height="9" font="6">BubbleSort</text>
<text top="235" left="572" width="70" height="9" font="6">standard sort</text>
<text top="247" left="215" width="41" height="9" font="6">Recurse</text>
<text top="247" left="329" width="94" height="9" font="6">self-recursive calls</text>
<text top="247" left="495" width="52" height="9" font="6">QuickSort</text>
<text top="247" left="572" width="70" height="9" font="6">standard sort</text>
<text top="259" left="495" width="45" height="9" font="6">TreeSort</text>
<text top="259" left="572" width="94" height="9" font="6">binary search tree</text>
<text top="287" left="281" width="331" height="17" font="1">Table 2 ‚Äì Benchmarks used for performance evaluation</text>
<text top="335" left="170" width="553" height="19" font="5">benchmark was executed in a dedicated CSOM instance. The benchmark runtime was</text>
<text top="353" left="170" width="553" height="19" font="5">measured without VM startup time. To reduce result variation, all benchmarks were</text>
<text top="371" left="170" width="549" height="19" font="5">executed on exactly the same core, and we regard only single-threaded benchmarks.</text>
<text top="389" left="192" width="530" height="19" font="5">Measurements were run for pairs of CSOM versions with the same features. We</text>
<text top="407" left="170" width="555" height="19" font="5">compare the hand-crafted implementations with the corresponding CSOM/PL con-</text>
<text top="425" left="170" width="553" height="19" font="5">Ô¨Åguration generated from VMADL service modules. This allows us to assess the</text>
<text top="443" left="170" width="553" height="19" font="5">performance impact of using VMADL on a single CSOM/PL product. We did not</text>
<text top="461" left="170" width="553" height="19" font="5">run performance measurements for feature combinations for which no hand-crafted</text>
<text top="479" left="170" width="553" height="19" font="5">VM exists as they cannot provide any insight on overheads induced by VMADL. Each</text>
<text top="496" left="170" width="553" height="19" font="5">measurement pair for a given benchmark and feature set was used to calculate the</text>
<text top="514" left="170" width="556" height="19" font="5">performance ratio of the VMADL-based version divided by the hand-crafted version.</text>
<text top="532" left="170" width="556" height="19" font="5">Thus, the ideal result would be a factor of 1, indicating identical performance properties.</text>
<text top="550" left="170" width="520" height="19" font="5">A runtime factor higher than 1 indicates an overhead induced by our approach.</text>
<text top="568" left="192" width="530" height="19" font="5">The performance comparison results are displayed in Fig. <a href="pdfxml.html#20">5. </a>For each CSOM</text>
<text top="586" left="170" width="553" height="19" font="5">conÔ¨Åguration, the relative performance of the VMADL version to the hand-crafted build</text>
<text top="604" left="170" width="553" height="19" font="5">is shown as an accumulation over all benchmarks. The individual benchmark results</text>
<text top="622" left="170" width="553" height="19" font="5">are left out for brevity; they neither show statistically relevant outliers nor diverging</text>
<text top="640" left="170" width="553" height="19" font="5">behaviour. The used graph is a standard box plot and indicates the distribution of</text>
<text top="658" left="170" width="471" height="19" font="5">the measurements. The desired result of 1 is indicated by a dashed line.</text>
<text top="676" left="192" width="533" height="19" font="5">The Ô¨Årst box, average, represents the average performance of all particular bench-</text>
<text top="694" left="170" width="553" height="19" font="5">mark runs for all conÔ¨Ågurations. It shows that adopting VMADL does not entail a</text>
<text top="712" left="170" width="553" height="19" font="5">statistically signiÔ¨Åcant overall impact on performance. On average, the benchmarks</text>
<text top="730" left="170" width="553" height="19" font="5">take, on the VMADL versions of CSOM, only about 99.18 % of the runtime they</text>
<text top="748" left="170" width="553" height="19" font="5">take on the hand-crafted versions. However, with a standard deviation of 3.3 % the</text>
<text top="765" left="170" width="179" height="19" font="5">diÔ¨Äerence is not signiÔ¨Åcant.</text>
<text top="783" left="192" width="530" height="19" font="5">Half of the VMADL-generated products exhibit small improvements. Only the</text>
<text top="808" left="169" width="553" height="13" font="5">Tagged Ints, Native, and Threaded conÔ¨Ågurations exhibit minor performance</text>
<text top="819" left="170" width="553" height="19" font="5">degradations of less than 2 %. Since these performance changes are within the limit</text>
<text top="837" left="170" width="553" height="19" font="5">of the performance changes observed for the other experiments as well, we attribute</text>
<text top="855" left="170" width="556" height="19" font="5">them to the eÔ¨Äects of compiler heuristics. The woven code produced by AspectC++</text>
<text top="873" left="170" width="553" height="19" font="5">introduces additional complexity for optimisations; so does the code organisation, in</text>
<text top="891" left="170" width="553" height="19" font="5">terms of C implementation Ô¨Åles changed between the hand-crafted and the VMADL</text>
<text top="909" left="170" width="554" height="19" font="5">version. Thus, we assume those performance diÔ¨Äerences to be caused by diÔ¨Äerently</text>
<text top="927" left="170" width="553" height="19" font="5">applied compiler optimisations. This assumption was tested by running the benchmarks</text>
<text top="945" left="170" width="554" height="19" font="5">with other optimisation Ô¨Çags and compiler versions. The result is that the diÔ¨Äerent</text>
<text top="963" left="170" width="553" height="19" font="5">conÔ¨Ågurations have diÔ¨Äerent optimal compiler settings, Ô¨Çuctuating within the 2 %</text>
<text top="981" left="170" width="181" height="19" font="5">margin around the factor 1.</text>
<text top="999" left="192" width="531" height="19" font="5">Note that there are currently restrictions with regard to the reliability of compiler</text>
<text top="1017" left="170" width="553" height="19" font="5">optimisations and certain AspectC++ constructs. As mentioned in Sec. <a href="pdfxml.html#12">3.6, </a>the used</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="20" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="17" size="2" family="Times" color="#000000"/>
	<fontspec id="18" size="5" family="Helvetica" color="#000000"/>
<text top="74" left="170" width="15" height="14" font="5">20</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="156" left="250" width="4" height="5" font="17">q</text>
<text top="344" left="250" width="4" height="5" font="17">q</text>
<text top="344" left="250" width="4" height="5" font="17">q</text>
<text top="344" left="250" width="4" height="5" font="17">q</text>
<text top="345" left="250" width="4" height="5" font="17">q</text>
<text top="345" left="250" width="4" height="5" font="17">q</text>
<text top="346" left="250" width="4" height="5" font="17">q</text>
<text top="346" left="250" width="4" height="5" font="17">q</text>
<text top="349" left="250" width="4" height="5" font="17">q</text>
<text top="349" left="250" width="4" height="5" font="17">q</text>
<text top="352" left="250" width="4" height="5" font="17">q</text>
<text top="354" left="250" width="4" height="5" font="17">q</text>
<text top="353" left="250" width="4" height="5" font="17">q</text>
<text top="353" left="250" width="4" height="5" font="17">q</text>
<text top="353" left="250" width="4" height="5" font="17">q</text>
<text top="352" left="250" width="4" height="5" font="17">q</text>
<text top="351" left="250" width="4" height="5" font="17">q</text>
<text top="355" left="250" width="4" height="5" font="17">q</text>
<text top="355" left="250" width="4" height="5" font="17">q</text>
<text top="355" left="250" width="4" height="5" font="17">q</text>
<text top="356" left="250" width="4" height="5" font="17">q</text>
<text top="356" left="250" width="4" height="5" font="17">q</text>
<text top="355" left="250" width="4" height="5" font="17">q</text>
<text top="355" left="250" width="4" height="5" font="17">q</text>
<text top="355" left="250" width="4" height="5" font="17">q</text>
<text top="357" left="250" width="4" height="5" font="17">q</text>
<text top="357" left="250" width="4" height="5" font="17">q</text>
<text top="357" left="250" width="4" height="5" font="17">q</text>
<text top="361" left="250" width="4" height="5" font="17">q</text>
<text top="359" left="250" width="4" height="5" font="17">q</text>
<text top="358" left="250" width="4" height="5" font="17">q</text>
<text top="357" left="250" width="4" height="5" font="17">q</text>
<text top="360" left="250" width="4" height="5" font="17">q</text>
<text top="365" left="250" width="4" height="5" font="17">q</text>
<text top="364" left="250" width="4" height="5" font="17">q</text>
<text top="364" left="250" width="4" height="5" font="17">q</text>
<text top="366" left="250" width="4" height="5" font="17">q</text>
<text top="367" left="250" width="4" height="5" font="17">q</text>
<text top="369" left="250" width="4" height="5" font="17">q</text>
<text top="150" left="250" width="4" height="5" font="17">q</text>
<text top="157" left="250" width="4" height="5" font="17">q</text>
<text top="159" left="250" width="4" height="5" font="17">q</text>
<text top="165" left="250" width="4" height="5" font="17">q</text>
<text top="170" left="250" width="4" height="5" font="17">q</text>
<text top="170" left="250" width="4" height="5" font="17">q</text>
<text top="175" left="250" width="4" height="5" font="17">q</text>
<text top="174" left="250" width="4" height="5" font="17">q</text>
<text top="177" left="250" width="4" height="5" font="17">q</text>
<text top="177" left="250" width="4" height="5" font="17">q</text>
<text top="188" left="250" width="4" height="5" font="17">q</text>
<text top="187" left="250" width="4" height="5" font="17">q</text>
<text top="191" left="250" width="4" height="5" font="17">q</text>
<text top="189" left="250" width="4" height="5" font="17">q</text>
<text top="189" left="250" width="4" height="5" font="17">q</text>
<text top="354" left="250" width="4" height="5" font="17">q</text>
<text top="354" left="250" width="4" height="5" font="17">q</text>
<text top="368" left="250" width="4" height="5" font="17">q</text>
<text top="269" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="310" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="269" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="266" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="267" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="268" left="301" width="4" height="5" font="17">q</text>
<text top="269" left="301" width="4" height="5" font="17">q</text>
<text top="269" left="301" width="4" height="5" font="17">q</text>
<text top="250" left="301" width="4" height="5" font="17">q</text>
<text top="251" left="301" width="4" height="5" font="17">q</text>
<text top="252" left="301" width="4" height="5" font="17">q</text>
<text top="255" left="301" width="4" height="5" font="17">q</text>
<text top="255" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="256" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="257" left="301" width="4" height="5" font="17">q</text>
<text top="332" left="403" width="4" height="5" font="17">q</text>
<text top="338" left="403" width="4" height="5" font="17">q</text>
<text top="340" left="403" width="4" height="5" font="17">q</text>
<text top="341" left="403" width="4" height="5" font="17">q</text>
<text top="344" left="403" width="4" height="5" font="17">q</text>
<text top="344" left="403" width="4" height="5" font="17">q</text>
<text top="344" left="403" width="4" height="5" font="17">q</text>
<text top="345" left="403" width="4" height="5" font="17">q</text>
<text top="345" left="403" width="4" height="5" font="17">q</text>
<text top="346" left="403" width="4" height="5" font="17">q</text>
<text top="346" left="403" width="4" height="5" font="17">q</text>
<text top="349" left="403" width="4" height="5" font="17">q</text>
<text top="349" left="403" width="4" height="5" font="17">q</text>
<text top="352" left="403" width="4" height="5" font="17">q</text>
<text top="354" left="403" width="4" height="5" font="17">q</text>
<text top="353" left="403" width="4" height="5" font="17">q</text>
<text top="353" left="403" width="4" height="5" font="17">q</text>
<text top="353" left="403" width="4" height="5" font="17">q</text>
<text top="352" left="403" width="4" height="5" font="17">q</text>
<text top="351" left="403" width="4" height="5" font="17">q</text>
<text top="355" left="403" width="4" height="5" font="17">q</text>
<text top="355" left="403" width="4" height="5" font="17">q</text>
<text top="355" left="403" width="4" height="5" font="17">q</text>
<text top="356" left="403" width="4" height="5" font="17">q</text>
<text top="356" left="403" width="4" height="5" font="17">q</text>
<text top="355" left="403" width="4" height="5" font="17">q</text>
<text top="355" left="403" width="4" height="5" font="17">q</text>
<text top="355" left="403" width="4" height="5" font="17">q</text>
<text top="357" left="403" width="4" height="5" font="17">q</text>
<text top="357" left="403" width="4" height="5" font="17">q</text>
<text top="357" left="403" width="4" height="5" font="17">q</text>
<text top="361" left="403" width="4" height="5" font="17">q</text>
<text top="359" left="403" width="4" height="5" font="17">q</text>
<text top="358" left="403" width="4" height="5" font="17">q</text>
<text top="357" left="403" width="4" height="5" font="17">q</text>
<text top="360" left="403" width="4" height="5" font="17">q</text>
<text top="365" left="403" width="4" height="5" font="17">q</text>
<text top="364" left="403" width="4" height="5" font="17">q</text>
<text top="364" left="403" width="4" height="5" font="17">q</text>
<text top="366" left="403" width="4" height="5" font="17">q</text>
<text top="367" left="403" width="4" height="5" font="17">q</text>
<text top="369" left="403" width="4" height="5" font="17">q</text>
<text top="150" left="403" width="4" height="5" font="17">q</text>
<text top="157" left="403" width="4" height="5" font="17">q</text>
<text top="159" left="403" width="4" height="5" font="17">q</text>
<text top="165" left="403" width="4" height="5" font="17">q</text>
<text top="170" left="403" width="4" height="5" font="17">q</text>
<text top="170" left="403" width="4" height="5" font="17">q</text>
<text top="175" left="403" width="4" height="5" font="17">q</text>
<text top="174" left="403" width="4" height="5" font="17">q</text>
<text top="177" left="403" width="4" height="5" font="17">q</text>
<text top="177" left="403" width="4" height="5" font="17">q</text>
<text top="188" left="403" width="4" height="5" font="17">q</text>
<text top="187" left="403" width="4" height="5" font="17">q</text>
<text top="191" left="403" width="4" height="5" font="17">q</text>
<text top="189" left="403" width="4" height="5" font="17">q</text>
<text top="189" left="403" width="4" height="5" font="17">q</text>
<text top="193" left="403" width="4" height="5" font="17">q</text>
<text top="199" left="403" width="4" height="5" font="17">q</text>
<text top="200" left="403" width="4" height="5" font="17">q</text>
<text top="200" left="403" width="4" height="5" font="17">q</text>
<text top="202" left="403" width="4" height="5" font="17">q</text>
<text top="201" left="403" width="4" height="5" font="17">q</text>
<text top="201" left="403" width="4" height="5" font="17">q</text>
<text top="215" left="403" width="4" height="5" font="17">q</text>
<text top="227" left="403" width="4" height="5" font="17">q</text>
<text top="232" left="403" width="4" height="5" font="17">q</text>
<text top="238" left="403" width="4" height="5" font="17">q</text>
<text top="237" left="403" width="4" height="5" font="17">q</text>
<text top="253" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="316" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="318" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="317" left="454" width="4" height="5" font="17">q</text>
<text top="316" left="454" width="4" height="5" font="17">q</text>
<text top="316" left="454" width="4" height="5" font="17">q</text>
<text top="316" left="454" width="4" height="5" font="17">q</text>
<text top="316" left="454" width="4" height="5" font="17">q</text>
<text top="316" left="454" width="4" height="5" font="17">q</text>
<text top="315" left="454" width="4" height="5" font="17">q</text>
<text top="314" left="454" width="4" height="5" font="17">q</text>
<text top="313" left="454" width="4" height="5" font="17">q</text>
<text top="313" left="454" width="4" height="5" font="17">q</text>
<text top="313" left="454" width="4" height="5" font="17">q</text>
<text top="313" left="454" width="4" height="5" font="17">q</text>
<text top="314" left="454" width="4" height="5" font="17">q</text>
<text top="313" left="454" width="4" height="5" font="17">q</text>
<text top="313" left="454" width="4" height="5" font="17">q</text>
<text top="248" left="454" width="4" height="5" font="17">q</text>
<text top="251" left="454" width="4" height="5" font="17">q</text>
<text top="251" left="454" width="4" height="5" font="17">q</text>
<text top="254" left="454" width="4" height="5" font="17">q</text>
<text top="272" left="505" width="4" height="5" font="17">q</text>
<text top="272" left="505" width="4" height="5" font="17">q</text>
<text top="270" left="505" width="4" height="5" font="17">q</text>
<text top="228" left="556" width="4" height="5" font="17">q</text>
<text top="234" left="556" width="4" height="5" font="17">q</text>
<text top="233" left="556" width="4" height="5" font="17">q</text>
<text top="234" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="240" left="556" width="4" height="5" font="17">q</text>
<text top="239" left="556" width="4" height="5" font="17">q</text>
<text top="239" left="556" width="4" height="5" font="17">q</text>
<text top="240" left="556" width="4" height="5" font="17">q</text>
<text top="239" left="556" width="4" height="5" font="17">q</text>
<text top="238" left="556" width="4" height="5" font="17">q</text>
<text top="238" left="556" width="4" height="5" font="17">q</text>
<text top="238" left="556" width="4" height="5" font="17">q</text>
<text top="237" left="556" width="4" height="5" font="17">q</text>
<text top="234" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="236" left="556" width="4" height="5" font="17">q</text>
<text top="236" left="556" width="4" height="5" font="17">q</text>
<text top="235" left="556" width="4" height="5" font="17">q</text>
<text top="234" left="556" width="4" height="5" font="17">q</text>
<text top="233" left="556" width="4" height="5" font="17">q</text>
<text top="230" left="556" width="4" height="5" font="17">q</text>
<text top="231" left="556" width="4" height="5" font="17">q</text>
<text top="231" left="556" width="4" height="5" font="17">q</text>
<text top="231" left="556" width="4" height="5" font="17">q</text>
<text top="234" left="556" width="4" height="5" font="17">q</text>
<text top="231" left="556" width="4" height="5" font="17">q</text>
<text top="230" left="556" width="4" height="5" font="17">q</text>
<text top="231" left="556" width="4" height="5" font="17">q</text>
<text top="230" left="556" width="4" height="5" font="17">q</text>
<text top="226" left="556" width="4" height="5" font="17">q</text>
<text top="226" left="556" width="4" height="5" font="17">q</text>
<text top="227" left="556" width="4" height="5" font="17">q</text>
<text top="225" left="556" width="4" height="5" font="17">q</text>
<text top="225" left="556" width="4" height="5" font="17">q</text>
<text top="224" left="556" width="4" height="5" font="17">q</text>
<text top="225" left="556" width="4" height="5" font="17">q</text>
<text top="228" left="556" width="4" height="5" font="17">q</text>
<text top="227" left="556" width="4" height="5" font="17">q</text>
<text top="228" left="556" width="4" height="5" font="17">q</text>
<text top="225" left="556" width="4" height="5" font="17">q</text>
<text top="219" left="556" width="4" height="5" font="17">q</text>
<text top="219" left="556" width="4" height="5" font="17">q</text>
<text top="216" left="556" width="4" height="5" font="17">q</text>
<text top="212" left="556" width="4" height="5" font="17">q</text>
<text top="204" left="556" width="4" height="5" font="17">q</text>
<text top="202" left="556" width="4" height="5" font="17">q</text>
<text top="156" left="556" width="4" height="5" font="17">q</text>
<text top="240" left="556" width="4" height="5" font="17">q</text>
<text top="243" left="556" width="4" height="5" font="17">q</text>
<text top="281" left="607" width="4" height="5" font="17">q</text>
<text top="283" left="607" width="4" height="5" font="17">q</text>
<text top="284" left="607" width="4" height="5" font="17">q</text>
<text top="295" left="607" width="4" height="5" font="17">q</text>
<text top="222" left="607" width="4" height="5" font="17">q</text>
<text top="227" left="607" width="4" height="5" font="17">q</text>
<text top="228" left="607" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="283" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="282" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="280" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="281" left="658" width="4" height="5" font="17">q</text>
<text top="276" left="658" width="4" height="5" font="17">q</text>
<text top="192" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="194" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="193" left="658" width="4" height="5" font="17">q</text>
<text top="192" left="658" width="4" height="5" font="17">q</text>
<text top="195" left="658" width="4" height="5" font="17">q</text>
<text top="195" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="298" left="658" width="4" height="5" font="17">q</text>
<text top="295" left="658" width="4" height="5" font="17">q</text>
<text top="286" left="658" width="4" height="5" font="17">q</text>
<text top="286" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="287" left="658" width="4" height="5" font="17">q</text>
<text top="285" left="658" width="4" height="5" font="17">q</text>
<text top="286" left="658" width="4" height="5" font="17">q</text>
<text top="286" left="658" width="4" height="5" font="17">q</text>
<text top="286" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="285" left="658" width="4" height="5" font="17">q</text>
<text top="284" left="658" width="4" height="5" font="17">q</text>
<text top="284" left="658" width="4" height="5" font="17">q</text>
<text top="284" left="658" width="4" height="5" font="17">q</text>
<text top="284" left="658" width="4" height="5" font="17">q</text>
<text top="284" left="658" width="4" height="5" font="17">q</text>
<text top="285" left="658" width="4" height="5" font="17">q</text>
<text top="284" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="288" left="658" width="4" height="5" font="17">q</text>
<text top="289" left="658" width="4" height="5" font="17">q</text>
<text top="289" left="658" width="4" height="5" font="17">q</text>
<text top="289" left="658" width="4" height="5" font="17">q</text>
<text top="290" left="658" width="4" height="5" font="17">q</text>
<text top="289" left="658" width="4" height="5" font="17">q</text>
<text top="290" left="658" width="4" height="5" font="17">q</text>
<text top="290" left="658" width="4" height="5" font="17">q</text>
<text top="291" left="658" width="4" height="5" font="17">q</text>
<text top="291" left="658" width="4" height="5" font="17">q</text>
<text top="290" left="658" width="4" height="5" font="17">q</text>
<text top="290" left="658" width="4" height="5" font="17">q</text>
<text top="290" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="294" left="658" width="4" height="5" font="17">q</text>
<text top="294" left="658" width="4" height="5" font="17">q</text>
<text top="294" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="294" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="292" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="293" left="658" width="4" height="5" font="17">q</text>
<text top="296" left="658" width="4" height="5" font="17">q</text>
<text top="297" left="658" width="4" height="5" font="17">q</text>
<text top="297" left="658" width="4" height="5" font="17">q</text>
<text top="297" left="658" width="4" height="5" font="17">q</text>
<text top="300" left="658" width="4" height="5" font="17">q</text>
<text top="301" left="658" width="4" height="5" font="17">q</text>
<text top="315" left="658" width="4" height="5" font="17">q</text>
<text top="321" left="658" width="4" height="5" font="17">q</text>
<text top="326" left="658" width="4" height="5" font="17">q</text>
<text top="327" left="658" width="4" height="5" font="17">q</text>
<text top="327" left="658" width="4" height="5" font="17">q</text>
<text top="328" left="658" width="4" height="5" font="17">q</text>
<text top="332" left="658" width="4" height="5" font="17">q</text>
<text top="333" left="658" width="4" height="5" font="17">q</text>
<text top="336" left="658" width="4" height="5" font="17">q</text>
<text top="337" left="658" width="4" height="5" font="17">q</text>
<text top="354" left="658" width="4" height="5" font="17">q</text>
<text top="354" left="658" width="4" height="5" font="17">q</text>
<text top="368" left="658" width="4" height="5" font="17">q</text>
<text top="343" left="238" width="28" height="7" font="13">Average</text>
<text top="343" left="294" width="17" height="7" font="13">Base</text>
<text top="343" left="337" width="32" height="7" font="13">RefCount</text>
<text top="343" left="383" width="43" height="7" font="13">Mark/Sweep</text>
<text top="343" left="445" width="21" height="7" font="13">Green</text>
<text top="343" left="496" width="22" height="7" font="13">Native</text>
<text top="343" left="547" width="21" height="7" font="13">Image</text>
<text top="343" left="589" width="40" height="7" font="13">Tagged Ints</text>
<text top="343" left="643" width="33" height="7" font="13">Threaded</text>
<text top="315" left="197" width="0" height="7" font="18">0.96</text>
<text top="288" left="197" width="0" height="7" font="18">0.98</text>
<text top="261" left="197" width="0" height="7" font="18">1.00</text>
<text top="234" left="197" width="0" height="7" font="18">1.02</text>
<text top="207" left="197" width="0" height="7" font="18">1.04</text>
<text top="305" left="178" width="0" height="7" font="18">Runtime: VMADL/handcr</text>
<text top="220" left="178" width="0" height="7" font="18">afted</text>
<text top="393" left="170" width="548" height="17" font="1">Figure 5 ‚Äì Accumulated relative performance over all benchmarks of VMADL versions to</text>
<text top="413" left="192" width="211" height="12" font="1">hand-crafted feature combinations.</text>
<text top="458" left="170" width="553" height="19" font="5">C++ compiler does currently not reliably optimise advised code modifying return</text>
<text top="476" left="170" width="553" height="19" font="5">values. To achieve a performance neutral implementation, performance critical parts</text>
<text top="493" left="170" width="475" height="19" font="5">on the interpreter loop had to be refactored to use reference parameters.</text>
<text top="536" left="170" width="22" height="17" font="3">5.2</text>
<text top="536" left="210" width="179" height="17" font="3">Source Code Complexity</text>
<text top="563" left="170" width="553" height="19" font="5">To assess source code complexity, we applied several metrics. Notice that only the</text>
<text top="585" left="170" width="39" height="13" font="5">actual</text>
<text top="581" left="216" width="510" height="19" font="5">CSOM/PL source code was regarded. For some of the extensions, e. g., multi-</text>
<text top="599" left="170" width="553" height="19" font="5">threading, the Smalltalk libraries had to be extended as well, providing APIs for the</text>
<text top="617" left="170" width="535" height="19" font="5">new features. As those do not belong to the VM as such, they were not regarded.</text>
<text top="635" left="192" width="530" height="19" font="5">The metrics were applied to the entire corpus of CSOM source code including</text>
<text top="656" left="170" width="16" height="13" font="5">all</text>
<text top="653" left="193" width="530" height="19" font="5">extensions. Hand-crafted versions represented reference values, to which results</text>
<text top="670" left="170" width="412" height="19" font="5">obtained from service module source code were put in relation.</text>
<text top="708" left="170" width="163" height="13" font="5">Lines of Code Results</text>
<text top="704" left="348" width="375" height="19" font="5">The physical source lines of code (PSLOC) <a href="pdfxml.html#28">[Par92] </a>metrics</text>
<text top="722" left="170" width="556" height="19" font="5">counts all lines of code that are not empty and do not solely consist of comments.</text>
<text top="740" left="170" width="553" height="19" font="5">Applying VMADL resulted in a moderate increase of 2.1 % (143 lines) in PSLOC, which</text>
<text top="758" left="170" width="553" height="19" font="5">must be accounted to the use of combiners as they add a declarative yet somewhat</text>
<text top="776" left="170" width="553" height="19" font="5">more verbose syntax. It needs to be noted that this value is adjusted as it does not</text>
<text top="794" left="170" width="553" height="19" font="5">account for the eÔ¨Äect of also using ClassDL. The employment of ClassDL resulted in</text>
<text top="812" left="170" width="553" height="19" font="5">a decrease of 738 PSLOC. As we want to assess the sheer eÔ¨Äect of VMADL, we elided</text>
<text top="830" left="170" width="124" height="19" font="5">the ClassDL eÔ¨Äect.</text>
<text top="868" left="170" width="144" height="13" font="5">Modularity Results</text>
<text top="864" left="329" width="394" height="19" font="5">To determine feature locality and modularisation, we identiÔ¨Åed</text>
<text top="882" left="170" width="553" height="19" font="5">changed implementation modules as well as modiÔ¨Åed functions and structures at the</text>
<text top="900" left="170" width="555" height="19" font="5">sub-module level. CSOM‚Äôs base conÔ¨Åguration Base was compared to RefCount,</text>
<text top="924" left="170" width="553" height="13" font="5">Mark/Sweep, Green and Native. Moreover, CSOM‚Äôs Mark/Sweep conÔ¨Åguration</text>
<text top="936" left="170" width="553" height="19" font="5">was compared to Image, Tagged Ints, and Threaded. That way, it was possible</text>
<text top="954" left="170" width="553" height="19" font="5">to determine, by feature, how many lines of code were added or modiÔ¨Åed, and how</text>
<text top="972" left="170" width="553" height="19" font="5">many Ô¨Åles and function or structure deÔ¨Ånitions were aÔ¨Äected. The results allow a</text>
<text top="990" left="170" width="386" height="19" font="5">comparison of hand-crafted and VMADL implementations.</text>
<text top="1007" left="192" width="530" height="19" font="5">Results from the modularity metrics are shown in Tab. <a href="pdfxml.html#21">3. </a>The table details the</text>
<text top="1025" left="170" width="553" height="19" font="5">impact on the level of lines of code, Ô¨Åles, and language. The impact on lines of code is</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="21" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">21</text>
<text top="155" left="455" width="72" height="9" font="6">Lines of Code</text>
<text top="167" left="335" width="34" height="9" font="6">Added</text>
<text top="167" left="421" width="47" height="9" font="6">Removed</text>
<text top="167" left="497" width="79" height="9" font="6">Changed (new)</text>
<text top="167" left="594" width="75" height="9" font="6">Changed (old)</text>
<text top="181" left="322" width="14" height="7" font="11">HC</text>
<text top="181" left="354" width="37" height="7" font="11">VMADL</text>
<text top="181" left="410" width="14" height="7" font="11">HC</text>
<text top="181" left="442" width="37" height="7" font="11">VMADL</text>
<text top="181" left="501" width="14" height="7" font="11">HC</text>
<text top="181" left="539" width="37" height="7" font="11">VMADL</text>
<text top="181" left="598" width="14" height="7" font="11">HC</text>
<text top="181" left="632" width="37" height="7" font="11">VMADL</text>
<text top="201" left="222" width="57" height="9" font="6">RefCount</text>
<text top="199" left="319" width="18" height="9" font="6">455</text>
<text top="199" left="374" width="18" height="9" font="6">564</text>
<text top="199" left="418" width="6" height="9" font="6">3</text>
<text top="199" left="473" width="6" height="9" font="6">0</text>
<text top="199" left="503" width="12" height="9" font="6">31</text>
<text top="199" left="571" width="6" height="9" font="6">0</text>
<text top="199" left="600" width="12" height="9" font="6">35</text>
<text top="199" left="663" width="6" height="9" font="6">0</text>
<text top="213" left="222" width="73" height="9" font="6">Mark/Sweep</text>
<text top="211" left="319" width="18" height="9" font="6">541</text>
<text top="211" left="374" width="18" height="9" font="6">788</text>
<text top="211" left="418" width="6" height="9" font="6">4</text>
<text top="211" left="473" width="6" height="9" font="6">0</text>
<text top="211" left="503" width="12" height="9" font="6">68</text>
<text top="211" left="571" width="6" height="9" font="6">0</text>
<text top="211" left="600" width="12" height="9" font="6">32</text>
<text top="211" left="663" width="6" height="9" font="6">0</text>
<text top="225" left="222" width="35" height="9" font="6">Green</text>
<text top="223" left="319" width="18" height="9" font="6">352</text>
<text top="223" left="374" width="18" height="9" font="6">390</text>
<text top="223" left="418" width="6" height="9" font="6">0</text>
<text top="223" left="473" width="6" height="9" font="6">0</text>
<text top="223" left="503" width="12" height="9" font="6">13</text>
<text top="223" left="571" width="6" height="9" font="6">0</text>
<text top="223" left="606" width="6" height="9" font="6">5</text>
<text top="223" left="663" width="6" height="9" font="6">0</text>
<text top="237" left="222" width="38" height="9" font="6">Native</text>
<text top="235" left="313" width="24" height="9" font="6">1033</text>
<text top="235" left="374" width="18" height="9" font="6">702</text>
<text top="235" left="418" width="6" height="9" font="6">0</text>
<text top="235" left="473" width="6" height="9" font="6">0</text>
<text top="235" left="509" width="6" height="9" font="6">7</text>
<text top="235" left="571" width="6" height="9" font="6">0</text>
<text top="235" left="606" width="6" height="9" font="6">3</text>
<text top="235" left="663" width="6" height="9" font="6">0</text>
<text top="249" left="222" width="32" height="9" font="6">Image</text>
<text top="247" left="313" width="24" height="9" font="6">3375</text>
<text top="247" left="368" width="24" height="9" font="6">2429</text>
<text top="247" left="412" width="12" height="9" font="6">30</text>
<text top="247" left="473" width="6" height="9" font="6">0</text>
<text top="247" left="503" width="12" height="9" font="6">94</text>
<text top="247" left="571" width="6" height="9" font="6">0</text>
<text top="247" left="594" width="18" height="9" font="6">133</text>
<text top="247" left="663" width="6" height="9" font="6">0</text>
<text top="261" left="222" width="66" height="9" font="6">Tagged Ints</text>
<text top="259" left="319" width="18" height="9" font="6">222</text>
<text top="259" left="374" width="18" height="9" font="6">296</text>
<text top="259" left="418" width="6" height="9" font="6">0</text>
<text top="259" left="473" width="6" height="9" font="6">0</text>
<text top="259" left="503" width="12" height="9" font="6">33</text>
<text top="259" left="571" width="6" height="9" font="6">0</text>
<text top="259" left="600" width="12" height="9" font="6">23</text>
<text top="259" left="663" width="6" height="9" font="6">0</text>
<text top="273" left="222" width="55" height="9" font="6">Threaded</text>
<text top="270" left="313" width="24" height="9" font="6">1447</text>
<text top="270" left="368" width="24" height="9" font="6">1001</text>
<text top="270" left="418" width="6" height="9" font="6">6</text>
<text top="270" left="473" width="6" height="9" font="6">0</text>
<text top="270" left="503" width="12" height="9" font="6">96</text>
<text top="270" left="571" width="6" height="9" font="6">0</text>
<text top="270" left="600" width="12" height="9" font="6">71</text>
<text top="270" left="663" width="6" height="9" font="6">0</text>
<text top="290" left="222" width="53" height="9" font="6">Total sum</text>
<text top="290" left="313" width="24" height="9" font="6">7425</text>
<text top="290" left="368" width="24" height="9" font="6">6170</text>
<text top="290" left="412" width="12" height="9" font="6">43</text>
<text top="290" left="473" width="6" height="9" font="6">0</text>
<text top="290" left="497" width="18" height="9" font="6">342</text>
<text top="290" left="571" width="6" height="9" font="6">0</text>
<text top="290" left="594" width="18" height="9" font="6">302</text>
<text top="290" left="663" width="6" height="9" font="6">0</text>
<text top="325" left="417" width="25" height="9" font="6">Files</text>
<text top="325" left="528" width="105" height="9" font="6">Functions &amp; Structs</text>
<text top="337" left="367" width="34" height="9" font="6">Added</text>
<text top="337" left="450" width="46" height="9" font="6">Modified</text>
<text top="337" left="558" width="46" height="9" font="6">Modified</text>
<text top="351" left="349" width="14" height="7" font="11">HC</text>
<text top="351" left="381" width="37" height="7" font="11">VMADL</text>
<text top="351" left="440" width="14" height="7" font="11">HC</text>
<text top="351" left="472" width="37" height="7" font="11">VMADL</text>
<text top="351" left="531" width="14" height="7" font="11">HC</text>
<text top="351" left="596" width="37" height="7" font="11">VMADL</text>
<text top="371" left="258" width="57" height="9" font="6">RefCount</text>
<text top="369" left="357" width="6" height="9" font="6">2</text>
<text top="369" left="412" width="6" height="9" font="6">3</text>
<text top="369" left="442" width="12" height="9" font="6">14</text>
<text top="369" left="503" width="6" height="9" font="6">0</text>
<text top="369" left="534" width="12" height="9" font="6">37</text>
<text top="369" left="627" width="6" height="9" font="6">0</text>
<text top="383" left="258" width="73" height="9" font="6">Mark/Sweep</text>
<text top="381" left="357" width="6" height="9" font="6">0</text>
<text top="381" left="412" width="6" height="9" font="6">3</text>
<text top="381" left="442" width="12" height="9" font="6">22</text>
<text top="381" left="503" width="6" height="9" font="6">0</text>
<text top="381" left="534" width="12" height="9" font="6">35</text>
<text top="381" left="627" width="6" height="9" font="6">0</text>
<text top="395" left="258" width="35" height="9" font="6">Green</text>
<text top="393" left="357" width="6" height="9" font="6">4</text>
<text top="393" left="412" width="6" height="9" font="6">3</text>
<text top="393" left="448" width="6" height="9" font="6">6</text>
<text top="393" left="503" width="6" height="9" font="6">0</text>
<text top="393" left="540" width="6" height="9" font="6">9</text>
<text top="393" left="627" width="6" height="9" font="6">0</text>
<text top="407" left="258" width="38" height="9" font="6">Native</text>
<text top="405" left="351" width="12" height="9" font="6">14</text>
<text top="405" left="412" width="6" height="9" font="6">5</text>
<text top="405" left="442" width="12" height="9" font="6">10</text>
<text top="405" left="503" width="6" height="9" font="6">0</text>
<text top="405" left="534" width="12" height="9" font="6">20</text>
<text top="405" left="627" width="6" height="9" font="6">0</text>
<text top="419" left="258" width="32" height="9" font="6">Image</text>
<text top="416" left="357" width="6" height="9" font="6">6</text>
<text top="416" left="407" width="12" height="9" font="6">11</text>
<text top="416" left="442" width="12" height="9" font="6">38</text>
<text top="416" left="503" width="6" height="9" font="6">0</text>
<text top="416" left="534" width="12" height="9" font="6">85</text>
<text top="416" left="627" width="6" height="9" font="6">0</text>
<text top="431" left="258" width="66" height="9" font="6">Tagged Ints</text>
<text top="428" left="357" width="6" height="9" font="6">1</text>
<text top="428" left="412" width="6" height="9" font="6">3</text>
<text top="428" left="442" width="12" height="9" font="6">10</text>
<text top="428" left="503" width="6" height="9" font="6">0</text>
<text top="428" left="534" width="12" height="9" font="6">29</text>
<text top="428" left="627" width="6" height="9" font="6">0</text>
<text top="443" left="258" width="55" height="9" font="6">Threaded</text>
<text top="440" left="357" width="6" height="9" font="6">9</text>
<text top="440" left="412" width="6" height="9" font="6">7</text>
<text top="440" left="442" width="12" height="9" font="6">10</text>
<text top="440" left="503" width="6" height="9" font="6">0</text>
<text top="440" left="534" width="12" height="9" font="6">31</text>
<text top="440" left="627" width="6" height="9" font="6">0</text>
<text top="460" left="258" width="53" height="9" font="6">Total sum</text>
<text top="460" left="351" width="12" height="9" font="6">36</text>
<text top="460" left="407" width="12" height="9" font="6">35</text>
<text top="460" left="436" width="18" height="9" font="6">110</text>
<text top="460" left="503" width="6" height="9" font="6">0</text>
<text top="460" left="528" width="18" height="9" font="6">246</text>
<text top="460" left="627" width="6" height="9" font="6">0</text>
<text top="488" left="200" width="493" height="17" font="1">Table 3 ‚Äì Modularity metrics results. Comparing hand-crafted (HC) vs. VMADL</text>
<text top="536" left="170" width="553" height="19" font="5">represented as newly added lines, removed lines, and changed lines. Changed lines are</text>
<text top="554" left="170" width="553" height="19" font="5">split into new and old, representing the amount of modiÔ¨Åcation as reported by GNU</text>
<text top="577" left="170" width="31" height="12" font="5">diff</text>
<text top="572" left="201" width="521" height="19" font="5">. That is, the lines in a chunk of changes in the base version (old) compared to</text>
<text top="590" left="170" width="553" height="19" font="5">the changes in the Ô¨Ånal version (new). The numbers for changed lines do not include</text>
<text top="608" left="170" width="166" height="19" font="5">added and removed lines.</text>
<text top="626" left="192" width="530" height="19" font="5">The changes on Ô¨Åle level correspond better to modules than the Ô¨Åne-grained lines</text>
<text top="644" left="170" width="553" height="19" font="5">of code metrics and are given here with the number of new and changed Ô¨Åles. For the</text>
<text top="662" left="170" width="553" height="19" font="5">intermediate level, we report the number of changed functions or structure deÔ¨Ånitions</text>
<text top="680" left="170" width="406" height="19" font="5">to give a better indication of the number of semantic changes.</text>
<text top="698" left="192" width="530" height="19" font="5">The table clearly shows that hand-crafted implementations exhibit a larger (more</text>
<text top="716" left="170" width="555" height="19" font="5">than 1,000 lines) implementation overhead. Since we did not change the inner mod-</text>
<text top="734" left="170" width="553" height="19" font="5">ularisation of service modules, the number of added Ô¨Åles remains constant, while</text>
<text top="752" left="170" width="555" height="19" font="5">eliminating crosscutting changes and thus reducing implementation overhead. Thus,</text>
<text top="770" left="170" width="553" height="19" font="5">the VMADL approach yields excellent modularity: while hand-crafting involves a</text>
<text top="787" left="170" width="553" height="19" font="5">large number of modifications in existing code, using VMADL and service modules</text>
<text top="805" left="170" width="554" height="19" font="5">merely implies introducing new Ô¨Åles, which contain all of the newly introduced code.</text>
<text top="823" left="192" width="530" height="19" font="5">In a nutshell, this means that VMADL supports real modularity: extensions are</text>
<text top="841" left="170" width="553" height="19" font="5">not invasive in any way; they are completely encapsulated in dedicated Ô¨Åles, which in</text>
<text top="859" left="170" width="405" height="19" font="5">turn results in a uniÔ¨Åed source base for the whole CSOM/PL.</text>
<text top="902" left="170" width="22" height="17" font="3">5.3</text>
<text top="902" left="210" width="199" height="17" font="3">Discussion and Conclusions</text>
<text top="932" left="170" width="85" height="13" font="5">Modularity</text>
<text top="929" left="270" width="453" height="19" font="5">An approach can be called ‚Äúmodular‚Äù <a href="pdfxml.html#28">[Par72] </a>if ‚Äúseparate groups [can]</text>
<text top="947" left="170" width="553" height="19" font="5">work on each module with little need for communication‚Äù, ‚Äúdrastic changes [can be</text>
<text top="964" left="170" width="553" height="19" font="5">made] to one module without a need to change others‚Äù, and ‚Äúit [is] possible to study</text>
<text top="982" left="170" width="553" height="19" font="5">the system one module at a time‚Äù. More recent elaborations on modularity, such as</text>
<text top="1000" left="170" width="553" height="19" font="5">those by Meyer <a href="pdfxml.html#28">[Mey97], </a>add more detail to these criteria but basically imply the</text>
<text top="1018" left="170" width="37" height="19" font="5">same.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="22" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">22</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="192" width="531" height="19" font="5">As interfaces are at the core of the VMADL approach, the beneÔ¨Åts usually brought</text>
<text top="167" left="170" width="553" height="19" font="5">about by them are also beneÔ¨Åts of VMADL. Communication among development</text>
<text top="185" left="170" width="553" height="19" font="5">groups can take place in terms of the interfaces of service modules. As long as changes</text>
<text top="203" left="170" width="556" height="19" font="5">to modules do not aÔ¨Äect their interfaces, other modules do not have to be changed.</text>
<text top="221" left="169" width="554" height="19" font="5">When semantically meaningful sets of join points are exposed and given appropriate</text>
<text top="239" left="170" width="553" height="19" font="5">names (cf. Lst. <a href="pdfxml.html#7">1), </a>it is even possible to change their deÔ¨Ånition (i. e., pointcut) without</text>
<text top="257" left="170" width="553" height="19" font="5">having to change a client. In fact, it might even be the case that the details of a</text>
<text top="275" left="170" width="553" height="19" font="5">module interaction change, but the modules themselves do not have to be modiÔ¨Åed as</text>
<text top="293" left="170" width="331" height="19" font="5">the interaction is speciÔ¨Åed in a VMADL combiner.</text>
<text top="311" left="192" width="533" height="19" font="5">Studying a system as complex as a VM one module at a time is usually hard.</text>
<text top="329" left="170" width="553" height="19" font="5">Having a clear separation of the various services into distinct modules helps in this</text>
<text top="347" left="170" width="553" height="19" font="5">process as it clariÔ¨Åes module boundaries. In this regard, VMADL combiners, keeping</text>
<text top="365" left="170" width="555" height="19" font="5">the entire speciÔ¨Åcation of service interactions in one place and referring to interfaces,</text>
<text top="383" left="170" width="553" height="19" font="5">certainly provide stronger means than simple constructs like macros or certain design</text>
<text top="401" left="170" width="163" height="19" font="5">patterns <a href="pdfxml.html#28">[Lad10, </a>pp. <a href="pdfxml.html#22">17Ô¨Ä]</a></text>
<text top="402" left="334" width="6" height="9" font="6"><a href="pdfxml.html#22">9</a></text>
<text top="401" left="345" width="293" height="19" font="5">usually mentioned when discussing MDSOC.</text>
<text top="419" left="192" width="530" height="19" font="5">One might criticise that combiners sometimes need to reÔ¨Åne particular pieces</text>
<text top="436" left="170" width="553" height="19" font="5">of service modules to enable the interaction they specify. While this might come</text>
<text top="454" left="170" width="553" height="19" font="5">across as a violation of modularity, we would like to note that such intrusions are well</text>
<text top="472" left="170" width="553" height="19" font="5">encapsulated and strictly conÔ¨Åned to the interaction at hand. They apply only in the</text>
<text top="490" left="170" width="553" height="19" font="5">setting described by the respective combiner and have no eÔ¨Äect in other interactions</text>
<text top="508" left="170" width="319" height="19" font="5">not occurring in the same product conÔ¨Åguration.</text>
<text top="526" left="192" width="530" height="19" font="5">VMADL‚Äôs name suggests a strong tie to the VM implementation domain. In</text>
<text top="544" left="170" width="556" height="19" font="5">fact, the name stems from the primary purpose the language was developed for.</text>
<text top="562" left="170" width="553" height="19" font="5">Consequently, VMADL can, in spite of its name, be used in other implementation</text>
<text top="580" left="170" width="553" height="19" font="5">domains as well. As shown, it can prove useful in C/C++ projects that have the</text>
<text top="598" left="170" width="302" height="19" font="5">potential to grow into a software product line.</text>
<text top="636" left="170" width="192" height="13" font="5">JIT Compiler Integration</text>
<text top="632" left="377" width="346" height="19" font="5">The simplicity of CSOM, most notably the lack of a</text>
<text top="650" left="170" width="553" height="19" font="5">JIT compiler, gives rise to the question of how such a feature could be integrated using</text>
<text top="668" left="170" width="553" height="19" font="5">the VMADL mechanisms. Using VMADL constructs, it is not possible to directly</text>
<text top="686" left="170" width="556" height="19" font="5">reason about exposed and other join points in machine code generated at run-time.</text>
<text top="704" left="170" width="553" height="19" font="5">However, it is possible to use VMADL to express that JIT compiler code generating</text>
<text top="725" left="170" width="248" height="13" font="5">code corresponding to such join points</text>
<text top="722" left="424" width="189" height="19" font="5">be instrumented accordingly.</text>
<text top="739" left="192" width="530" height="19" font="5">Consider the example of combining a JIT compiler and reference-counting garbage</text>
<text top="757" left="170" width="553" height="19" font="5">collector. Provided the JIT compiler exposes internal situations such as ‚Äúgenerating</text>
<text top="775" left="170" width="553" height="19" font="5">pointer assignment‚Äù and ‚Äúgenerating code for parameter passing‚Äù, the reference counting</text>
<text top="793" left="170" width="553" height="19" font="5">GC module can interact by requesting the generation of reference counter adjustments</text>
<text top="811" left="170" width="226" height="19" font="5">along with the actual assignments.</text>
<text top="849" left="170" width="93" height="13" font="5">SPL Tooling</text>
<text top="845" left="278" width="445" height="19" font="5">Utilisation of SPL tool support in CSOM/PL is less extensive than</text>
<text top="863" left="170" width="555" height="19" font="5">it might be expected: pure::variants is only used for feature model representation,</text>
<text top="881" left="170" width="553" height="19" font="5">product conÔ¨Åguration and validation, but not for generating large amounts of source</text>
<text top="899" left="170" width="553" height="19" font="5">code required to build the product. Instead, there exist various cleanly separated</text>
<text top="917" left="170" width="556" height="19" font="5">modules with explicit bidirectional interfaces mapping directly to product line features.</text>
<text top="955" left="170" width="89" height="13" font="5">Conclusions</text>
<text top="951" left="274" width="449" height="19" font="5">From the results in the three diÔ¨Äerent areas of interest described</text>
<text top="969" left="170" width="553" height="19" font="5">above, and from the considerations on Parnas‚Äô modularity criteria, we conclude that</text>
<text top="987" left="170" width="556" height="19" font="5">using VMADL is fruitful. Its employment has no negative impact on performance.</text>
<text top="1017" left="187" width="5" height="8" font="7">9</text>
<text top="1019" left="193" width="367" height="11" font="4">Also, <a href="www.ibm.com/ developerworks/ java/ library/ j-aopwork15/">www.ibm.com/developerworks/java/library/j-aopwork15/.</a></text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="23" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">23</text>
<text top="150" left="170" width="553" height="19" font="5">It supports actual modularity. The lines of code count increases slightly, but for</text>
<text top="167" left="170" width="553" height="19" font="5">the greater good of module interdependencies‚Äô being made explicit in the code. The</text>
<text top="185" left="170" width="553" height="19" font="5">subjective impression of developers is that VMADL makes working with the CSOM</text>
<text top="203" left="170" width="199" height="19" font="5">source code more comfortable.</text>
<text top="221" left="192" width="530" height="19" font="5">Finally, the strong modular characteristics of the product family code base enabled</text>
<text top="239" left="170" width="553" height="19" font="5">by VMADL result in an excellent direct mappability of product conÔ¨Ågurations to</text>
<text top="257" left="170" width="553" height="19" font="5">source code. This, in turn, signiÔ¨Åcantly reduces the eÔ¨Äort required to establish a</text>
<text top="275" left="170" width="540" height="19" font="5">collection of code fragments as input to the complex SPL generator infrastructure.</text>
<text top="323" left="170" width="10" height="20" font="0">6</text>
<text top="323" left="201" width="116" height="20" font="0">Related Work</text>
<text top="357" left="170" width="553" height="19" font="5">In the Ô¨Åeld of VM implementations, various projects have attempted to tackle the large</text>
<text top="375" left="170" width="553" height="19" font="5">complexity that is typical of the domain. Still, the strong focus on both architecture</text>
<text top="393" left="170" width="555" height="19" font="5">and modularity that we have adopted has not been chosen by any of them. Hence,</text>
<text top="411" left="170" width="553" height="19" font="5">the results from these projects do, however signiÔ¨Åcant in their own right, not bring</text>
<text top="429" left="170" width="553" height="19" font="5">about the same improvements in terms of modularity and architecture perception at</text>
<text top="447" left="170" width="190" height="19" font="5">the source code level as ours.</text>
<text top="465" left="192" width="530" height="19" font="5">The PyPy project <a href="pdfxml.html#28">[RP06] </a>focuses on tool-chain based VM development. The core</text>
<text top="483" left="170" width="553" height="19" font="5">idea is to swap out implementation complexity to dedicated tools that are applied at</text>
<text top="501" left="170" width="553" height="19" font="5">certain times during VM code generation. The PyPy VM is implemented in Python</text>
<text top="519" left="170" width="553" height="19" font="5">at a very high level, allowing developers to use the object-oriented abstraction and</text>
<text top="537" left="170" width="553" height="19" font="5">dynamic language mechanisms that Python oÔ¨Äers. Implementation takes place without</text>
<text top="554" left="170" width="553" height="19" font="5">regarding the fact that the ultimate VM will have a GC component. The GC is added</text>
<text top="572" left="170" width="462" height="19" font="5">later automatically during code transformation steps of the tool chain.</text>
<text top="590" left="192" width="530" height="19" font="5">PyPy thus hides away the complexity of interactions between VM run-time and</text>
<text top="608" left="170" width="553" height="19" font="5">memory management, easing development signiÔ¨Åcantly. While this is appreciable, it</text>
<text top="626" left="170" width="553" height="19" font="5">comes at a certain cost. The interpreter and other parts of the VM are represented</text>
<text top="644" left="170" width="553" height="19" font="5">by code actually describing a VM implementation, whereas memory management is</text>
<text top="662" left="170" width="553" height="19" font="5">represented by code that describes VM implementation transformations. There are</text>
<text top="680" left="170" width="553" height="19" font="5">two diÔ¨Äerent kinds of abstraction at play in this setting, with memory management</text>
<text top="698" left="170" width="553" height="19" font="5">being extraneous to the actual VM. The goal we pursue with VMADL, conversely, is</text>
<text top="716" left="170" width="556" height="19" font="5">to give VM developers full control over all features at the same level of abstraction.</text>
<text top="734" left="170" width="553" height="19" font="5">VMADL supports this approach by providing bidirectional interfaces and combiners</text>
<text top="752" left="170" width="357" height="19" font="5">that allow for dealing with complex interdependencies.</text>
<text top="770" left="192" width="533" height="19" font="5">Metacircular VM implementations generally beneÔ¨Åt from the modularisation tech-</text>
<text top="788" left="170" width="479" height="19" font="5">niques oÔ¨Äered by the implemented language directly. The Jikes RVM <a href="pdfxml.html#26">[AAB</a></text>
<text top="789" left="650" width="9" height="9" font="6"><a href="pdfxml.html#26">+</a></text>
<text top="788" left="659" width="34" height="19" font="5"><a href="pdfxml.html#26">99, A</a></text>
<text top="789" left="694" width="9" height="9" font="6"><a href="pdfxml.html#26">+</a></text>
<text top="788" left="704" width="19" height="19" font="5"><a href="pdfxml.html#26">00]</a></text>
<text top="806" left="170" width="77" height="19" font="5">and <a href="pdfxml.html#23">Maxine</a></text>
<text top="807" left="247" width="12" height="9" font="6"><a href="pdfxml.html#23">10</a></text>
<text top="806" left="265" width="234" height="19" font="5">are Java VMs implemented in Java.</text>
<text top="823" left="192" width="530" height="19" font="5">Jikes is a magniÔ¨Åcent platform for VM implementation research and supports</text>
<text top="841" left="170" width="553" height="19" font="5">a wide variety of choices among, e. g., GC implementations and JIT compilers. It</text>
<text top="859" left="170" width="189" height="19" font="5">makes use of code <a href="pdfxml.html#23">generation</a></text>
<text top="861" left="359" width="12" height="9" font="6"><a href="pdfxml.html#23">11</a></text>
<text top="859" left="376" width="347" height="19" font="5">to complete Java source Ô¨Åle stubs for various features</text>
<text top="877" left="170" width="553" height="19" font="5">prior to compile-time. Memory management is performed by MMTk <a href="pdfxml.html#26">[BCM04], </a>which</text>
<text top="895" left="170" width="553" height="19" font="5">encapsulates GC complexity, but introduces hardwired interactions between GC logic</text>
<text top="913" left="170" width="553" height="19" font="5">and the VM, in either code base, leading to the kind of crosscutting concerns typical</text>
<text top="931" left="170" width="553" height="19" font="5">for the VM implementation domain. To summarise, Jikes realises variability by</text>
<text top="949" left="170" width="553" height="19" font="5">template-based code generation, as opposed to VMADL, which achieves the same</text>
<text top="967" left="170" width="553" height="19" font="5">using declarative means at the programming language level. Also, Jikes does not</text>
<text top="985" left="170" width="297" height="19" font="5">support disentangling the way VMADL does.</text>
<text top="1015" left="181" width="11" height="8" font="7"><a href="labs.oracle.com/projects/maxine">10</a></text>
<text top="1018" left="193" width="197" height="10" font="4"><a href="labs.oracle.com/projects/maxine">labs.oracle.com/projects/maxine</a></text>
<text top="1029" left="181" width="11" height="8" font="7"><a href="jikesrvm.org/Building+the+RVM">11</a></text>
<text top="1032" left="193" width="184" height="10" font="4"><a href="jikesrvm.org/Building+the+RVM">jikesrvm.org/Building+the+RVM</a></text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="24" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">24</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="192" width="403" height="19" font="5">Maxine tries to improve modularity with the language <a href="pdfxml.html#24">features</a></text>
<text top="151" left="596" width="12" height="9" font="6"><a href="pdfxml.html#24">12</a></text>
<text top="150" left="613" width="113" height="19" font="5">oÔ¨Äered by Java 5.</text>
<text top="167" left="170" width="553" height="19" font="5">Interfaces are used to encapsulate features, and a build-time conÔ¨Åguration mechanism</text>
<text top="185" left="170" width="553" height="19" font="5">decides about feature implementations. Even though all feature interactions are done</text>
<text top="203" left="170" width="553" height="19" font="5">via interfaces, dependencies between feature implementations are not as obvious as</text>
<text top="221" left="170" width="553" height="19" font="5">with VMADL, since interactions are still scattered. Furthermore, the implementation</text>
<text top="239" left="170" width="553" height="19" font="5">does not achieve modularisation at the same degree as it would be possible with</text>
<text top="257" left="170" width="133" height="19" font="5">MDSOC techniques.</text>
<text top="275" left="192" width="530" height="19" font="5">ClassDL was inspired by feature-oriented programming <a href="pdfxml.html#28">[Pre97, </a><a href="pdfxml.html#26">ALRS05]. </a>ReÔ¨Åning</text>
<text top="293" left="170" width="553" height="19" font="5">a previously deÔ¨Åned class in the context of a speciÔ¨Åc feature eÔ¨Äectively supports</text>
<text top="311" left="170" width="555" height="19" font="5">heterogeneous crosscuts. VMADL thus combines aspect- and feature-oriented ap-</text>
<text top="329" left="170" width="553" height="19" font="5">proaches <a href="pdfxml.html#26">[ALS06] </a>in a more architecture-aware manner, e. g., by making module</text>
<text top="347" left="170" width="437" height="19" font="5">relationships explicit in declarations using requirement statements.</text>
<text top="365" left="192" width="90" height="19" font="5">VMKit <a href="pdfxml.html#27">[GTL</a></text>
<text top="366" left="282" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="365" left="292" width="431" height="19" font="5"><a href="pdfxml.html#27">10] </a>is called a ‚Äúsubstrate‚Äù for implementing VMs. It provides a</text>
<text top="383" left="170" width="553" height="19" font="5">common foundation that implementations of diÔ¨Äerent instruction sets and programming</text>
<text top="401" left="170" width="553" height="19" font="5">languages can build upon. The substrate includes memory and thread managers as well</text>
<text top="419" left="170" width="553" height="19" font="5">as a JIT compiler. Implementing a VM on top of it involves providing certain callbacks</text>
<text top="436" left="170" width="553" height="19" font="5">to the substrate, and mappings from ISA or programming language constructs to the</text>
<text top="454" left="170" width="499" height="19" font="5">substrate‚Äôs abstractions. VM implementation is thus signiÔ¨Åcantly simpliÔ¨Åed.</text>
<text top="472" left="192" width="531" height="19" font="5">While VMKit supports variability to the extent that implementation of diÔ¨Äerent</text>
<text top="490" left="170" width="555" height="19" font="5">languages is simpliÔ¨Åed, it restricts choices oÔ¨Äered at the substrate level. For instance,</text>
<text top="508" left="170" width="553" height="19" font="5">LLVM <a href="pdfxml.html#28">[LA04] </a>is used as the JIT compiler infrastructure, and MMTk <a href="pdfxml.html#26">[BCM04] </a>as the</text>
<text top="526" left="170" width="553" height="19" font="5">memory manager. The latter provides particularly good variability, but the overall</text>
<text top="544" left="170" width="553" height="19" font="5">degree of control over feature variation is coarse-grained, compared to our approach.</text>
<text top="562" left="192" width="533" height="19" font="5">Compared to other ADLs, VMADL is most closely related to ArchJava <a href="pdfxml.html#26">[ACN02].</a></text>
<text top="580" left="170" width="555" height="19" font="5">Like ArchJava, VMADL makes system architecture explicit in the source code it-</text>
<text top="598" left="170" width="553" height="19" font="5">self. Other languages like WRIGHT <a href="pdfxml.html#26">[AG97] </a>or Rapide <a href="pdfxml.html#28">[LV95] </a>separate architecture</text>
<text top="616" left="170" width="553" height="19" font="5">description from actual implementation, which is problematic, since it implies the</text>
<text top="634" left="170" width="553" height="19" font="5">need to keep both synchronised. VMADL‚Äôs bidirectional interfaces are related to</text>
<text top="652" left="170" width="205" height="19" font="5">principles found in nesC <a href="pdfxml.html#27">[GLvB</a></text>
<text top="653" left="375" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="652" left="385" width="338" height="19" font="5"><a href="pdfxml.html#27">03], </a>an extension to C designed to structure systems</text>
<text top="670" left="170" width="553" height="19" font="5">into components with clear boundaries. The interfaces used in nesC declaratively</text>
<text top="688" left="170" width="391" height="19" font="5">describe component interactions using events and callbacks.</text>
<text top="705" left="192" width="530" height="19" font="5">In contrast to VMADL, ArchJava assumes a dynamic architecture and multiple</text>
<text top="723" left="170" width="553" height="19" font="5">component instances at run-time. Components provide communication ports, and</text>
<text top="741" left="170" width="555" height="19" font="5">connections are explicit. This is similar to VMADL combiners but provides lower Ô¨Çexi-</text>
<text top="759" left="170" width="553" height="19" font="5">bility, since connections need to be explicit in component implementations. VMADL‚Äôs</text>
<text top="777" left="170" width="553" height="19" font="5">combiners support module combinations at the interface level without changing their</text>
<text top="795" left="170" width="513" height="19" font="5">implementations. By using a pointcut language, our approach is more Ô¨Çexible.</text>
<text top="813" left="192" width="531" height="19" font="5">MDSOC techniques oÔ¨Äer various opportunities for building SPLs. Alves et</text>
<text top="831" left="170" width="59" height="19" font="5">al. <a href="pdfxml.html#26">[AMC</a></text>
<text top="833" left="230" width="9" height="9" font="6"><a href="pdfxml.html#26">+</a></text>
<text top="831" left="239" width="484" height="19" font="5"><a href="pdfxml.html#26">07] </a>describe a methodology which uses aspect-oriented techniques to extract</text>
<text top="849" left="170" width="553" height="19" font="5">an SPL from an existing code base. The approach is similar to what we have done to</text>
<text top="867" left="170" width="555" height="19" font="5">create CSOM/PL on the basis of the diÔ¨Äerent extensions available. Compared to it,</text>
<text top="885" left="170" width="553" height="19" font="5">we do not use additional aspects for the evolution to be able to add new products to</text>
<text top="903" left="170" width="553" height="19" font="5">the SPL, instead we chose to bring the adaption to an architectural level and describe</text>
<text top="921" left="170" width="225" height="19" font="5">it by means of module interaction.</text>
<text top="939" left="192" width="530" height="19" font="5">One of the application areas of FeatureC++ <a href="pdfxml.html#26">[ALRS05] </a>is the implementation of</text>
<text top="957" left="170" width="555" height="19" font="5">SPLs <a href="pdfxml.html#28">[RSSA08]. </a>It regards feature composition as refinement of a basis implemen-</text>
<text top="974" left="170" width="553" height="19" font="5">tation. Feature modules are represented as (aspectual) mixin layers deÔ¨Åning such</text>
<text top="992" left="170" width="553" height="19" font="5">reÔ¨Ånements. Conversely, VMADL service modules are complete implementations of</text>
<text top="1022" left="181" width="11" height="8" font="7"><a href="java.sun.com/ developer/ technicalArticles/ releases/ j2se15langfeat/">12</a></text>
<text top="1026" left="193" width="413" height="10" font="4"><a href="java.sun.com/ developer/ technicalArticles/ releases/ j2se15langfeat/">java.sun.com/developer/technicalArticles/releases/j2se15langfeat/</a></text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="25" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">25</text>
<text top="150" left="170" width="553" height="19" font="5">features composed with others by connecting interfaces. VMADL does not as much</text>
<text top="167" left="170" width="553" height="19" font="5">regard the single features as crosscutting concerns as their orchestration, which it</text>
<text top="185" left="170" width="184" height="19" font="5">makes explicit in combiners.</text>
<text top="203" left="192" width="143" height="19" font="5">Figueiredo et al. <a href="pdfxml.html#27">[FCS</a></text>
<text top="205" left="335" width="9" height="9" font="6"><a href="pdfxml.html#27">+</a></text>
<text top="203" left="345" width="378" height="19" font="5"><a href="pdfxml.html#27">08] </a>investigated the inÔ¨Çuences on stability as an important</text>
<text top="221" left="170" width="553" height="19" font="5">SPL property. Their results suggest that SPLs decomposed with AOP are more stable</text>
<text top="239" left="170" width="553" height="19" font="5">regarding adaptions in optional or alternative features. We assume similar beneÔ¨Åts for</text>
<text top="257" left="170" width="184" height="19" font="5">an SPL built with VMADL.</text>
<text top="275" left="192" width="530" height="19" font="5">VMADL currently expresses explicit interactions between service modules. Some</text>
<text top="293" left="170" width="553" height="19" font="5">languages for modelling variability at an architectural level include constructs to</text>
<text top="311" left="170" width="553" height="19" font="5">model other types of relationships as well. One example in the Ô¨Åeld of product lines</text>
<text top="329" left="170" width="553" height="19" font="5">is the Variability Modelling Language <a href="pdfxml.html#28">[LSGF08]. </a>This language is meant to be used</text>
<text top="347" left="170" width="553" height="19" font="5">on a more conceptual level and not embedded into the implementation. It aims to</text>
<text top="365" left="170" width="553" height="19" font="5">describe variability orthogonally to architectural descriptions. This approach would be</text>
<text top="383" left="170" width="553" height="19" font="5">beneÔ¨Åcial to describe, for instance, service modules as alternatives. In addition to the</text>
<text top="401" left="170" width="553" height="19" font="5">variability already described with VMADL, some of the concepts of this language could</text>
<text top="419" left="170" width="548" height="19" font="5">be used to provide advanced means for the conÔ¨Åguration of instances of CSOM/PL.</text>
<text top="467" left="170" width="10" height="20" font="0">7</text>
<text top="467" left="201" width="233" height="20" font="0">Summary and Future Work</text>
<text top="501" left="169" width="556" height="19" font="5">We have presented CSOM/PL, a virtual machine product line implemented in C,</text>
<text top="519" left="170" width="553" height="19" font="5">AspectC++, and VMADL, and optionally representing the feature model with</text>
<text top="537" left="170" width="555" height="19" font="5">pure::variants. VMADL, an implementation of which is one of this work‚Äôs contributions,</text>
<text top="554" left="170" width="553" height="19" font="5">surpasses previously achieved modularisation in the VM implementation domain. It</text>
<text top="572" left="170" width="556" height="19" font="5">supports modular abstraction by means of service modules with bidirectional interfaces.</text>
<text top="590" left="170" width="553" height="19" font="5">Using VMADL allowed us to implement several CSOM Smalltalk VM features in</text>
<text top="612" left="170" width="184" height="13" font="5">combinable isolated modules</text>
<text top="608" left="355" width="368" height="19" font="5">‚Äîfeatures that were previously realised as hand-crafted</text>
<text top="626" left="170" width="553" height="19" font="5">extensions. This also facilitated devising a product line. The evaluation shows that</text>
<text top="644" left="170" width="556" height="19" font="5">performance is not harmed, and that source code modularity is signiÔ¨Åcantly improved.</text>
<text top="662" left="192" width="530" height="19" font="5">Regarding SPL tool support, VMADL represents a valuable tool that can be used</text>
<text top="680" left="170" width="553" height="19" font="5">to introduce modular SPL development in languages lacking inherent modularity</text>
<text top="698" left="170" width="553" height="19" font="5">support. Moreover, VMADL provides direct mappings from feature models to source</text>
<text top="716" left="170" width="556" height="19" font="5">modules, reducing the complexity of code preparation for consumption by generators.</text>
<text top="734" left="192" width="530" height="19" font="5">Some perceivable feature combinations have not been realised yet (cf. Sec. <a href="pdfxml.html#12">4.1). </a>This</text>
<text top="752" left="170" width="553" height="19" font="5">is not because they are impossible to achieve; it is a matter of providing more service</text>
<text top="770" left="170" width="553" height="19" font="5">module interfaces and combinations. Our ongoing work is concerned with moving</text>
<text top="788" left="170" width="553" height="19" font="5">towards the goal of dropping all constraints shown in Fig. <a href="pdfxml.html#13">3 </a>that are not conceptually</text>
<text top="806" left="170" width="553" height="19" font="5">necessary. For instance, threading together with virtual images could be realised as</text>
<text top="823" left="170" width="536" height="19" font="5">well as virtual images independent from a particular garbage collection technique.</text>
<text top="841" left="192" width="530" height="19" font="5">Performance measurements have shown that Ô¨Åne-grained control over feature</text>
<text top="859" left="170" width="553" height="19" font="5">application order is important. We will investigate how to make such control available</text>
<text top="877" left="170" width="453" height="19" font="5">in VMADL declarations without introducing uncalled-for complexity.</text>
<text top="895" left="192" width="530" height="19" font="5">The ClassDL extension was necessary because CSOM, including its particular OOP</text>
<text top="913" left="170" width="553" height="19" font="5">emulation, is implemented in C, and because this led to a lack of declarative means for</text>
<text top="931" left="170" width="553" height="19" font="5">class (re)deÔ¨Ånitions. An implementation in C++, combined with AspectC++ and/or</text>
<text top="949" left="170" width="553" height="19" font="5">FeatureC++, would have eliminated this need. In fact, a port of CSOM to C++ has</text>
<text top="967" left="170" width="533" height="19" font="5">been done and is considered for future research in disentangling VM architecture.</text>
<text top="985" left="192" width="530" height="19" font="5">We also hope to transfer our results to other, more complex, VM implementations</text>
<text top="1003" left="170" width="553" height="19" font="5">to gain more insights into the modularisation of full-scale VM implementations. Part</text>
<text top="1021" left="170" width="515" height="19" font="5">of the ongoing work in the Maxine project at Oracle Labs is investigating this.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="26" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">26</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="149" left="170" width="91" height="20" font="0">References</text>
<text top="183" left="170" width="15" height="19" font="5">[A</text>
<text top="184" left="185" width="9" height="9" font="6">+</text>
<text top="183" left="195" width="19" height="19" font="5">00]</text>
<text top="183" left="250" width="475" height="19" font="5">B. Alpern et al. The Jalape√±o Virtual Machine. IBM Systems Journal,</text>
<text top="201" left="250" width="389" height="19" font="5">39(1):211‚Äì238, February 2000. <a href="http://dx.doi.org/10.1147/sj.391.0211">doi:10.1147/sj.391.0211.</a></text>
<text top="225" left="170" width="37" height="19" font="5">[AAB</text>
<text top="226" left="207" width="9" height="9" font="6">+</text>
<text top="225" left="217" width="464" height="19" font="5">99] B. Alpern, D. Attanasio, J. J. Barton, A. Cocchi, S. F. Hummel,</text>
<text top="242" left="250" width="472" height="19" font="5">D. Lieber, M. Mergen, T. Ngo, J. Shepherd, and S. Smith. Implementing</text>
<text top="260" left="250" width="387" height="19" font="5">Jalape√±o in Java. In Proc. OOPSLA‚Äô99. ACM Press, 1999.</text>
<text top="284" left="170" width="56" height="19" font="5">[ACN02]</text>
<text top="284" left="250" width="475" height="19" font="5">Jonathan Aldrich, Craig Chambers, and David Notkin. Archjava: Con-</text>
<text top="302" left="250" width="473" height="19" font="5">necting software architecture to implementation. In Proc. ICSE‚Äô02, pages</text>
<text top="320" left="249" width="347" height="19" font="5">187‚Äì197. ACM, 2002. <a href="http://dx.doi.org/10.1145/581339.581365">doi:10.1145/581339.581365.</a></text>
<text top="344" left="170" width="46" height="19" font="5">[AG97]</text>
<text top="344" left="250" width="475" height="19" font="5">Robert Allen and David Garlan. A formal basis for architectural connec-</text>
<text top="362" left="250" width="473" height="19" font="5">tion. ACM Trans. Softw. Eng. Methodol., 6(3):213‚Äì249, 1997. Available</text>
<text top="380" left="250" width="462" height="19" font="5">from: <a href="http://portal.acm.org/citation.cfm?doid=258077.258078">http://portal.acm.org/citation.cfm?doid=258077.258078,</a></text>
<text top="403" left="250" width="196" height="12" font="5"><a href="http://dx.doi.org/10.1145/258077.258078">doi:10.1145/258077.258078</a></text>
<text top="398" left="446" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/258077.258078">.</a></text>
<text top="422" left="170" width="47" height="19" font="5">[Ald05]</text>
<text top="422" left="250" width="466" height="19" font="5">J. Aldrich. Open modules: Modular reasoning about advice. In Proc.</text>
<text top="444" left="250" width="74" height="13" font="5">ECOOP‚Äô05</text>
<text top="440" left="324" width="403" height="19" font="5">, volume 3586 of LNCS, pages 144‚Äì168. Springer, 2005. <a href="http://dx.doi.org/10.1007/11531142_7">doi:</a></text>
<text top="463" left="250" width="141" height="12" font="5"><a href="http://dx.doi.org/10.1007/11531142_7">10.1007/11531142_7</a></text>
<text top="458" left="391" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1007/11531142_7">.</a></text>
<text top="482" left="170" width="555" height="19" font="5">[ALRS05] Sven Apel, Thomas Leich, Marko Rosenm√ºller, and Gunter Saake. Fea-</text>
<text top="500" left="250" width="450" height="19" font="5">tureC++: On the symbiosis of feature-oriented and aspect-oriented</text>
<text top="517" left="250" width="433" height="19" font="5">programming. In Proc. GPCE, 2005. <a href="http://dx.doi.org/10.1007/11561347_10">doi:10.1007/11561347_10.</a></text>
<text top="541" left="170" width="52" height="19" font="5">[ALS06]</text>
<text top="541" left="250" width="467" height="19" font="5">Sven Apel, Thomas Leich, and Gunter Saake. Aspectual mixin layers:</text>
<text top="559" left="250" width="461" height="19" font="5">Aspects and features in concert. In Proc. ICSE‚Äô06. ACM, May 2006.</text>
<text top="582" left="250" width="212" height="12" font="5"><a href="http://dx.doi.org/10.1145/1134285.1134304">doi:10.1145/1134285.1134304</a></text>
<text top="577" left="462" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1134285.1134304">.</a></text>
<text top="601" left="170" width="40" height="19" font="5">[AMC</text>
<text top="603" left="210" width="9" height="9" font="6">+</text>
<text top="601" left="220" width="483" height="19" font="5">07] Vander Alves, Pedro Matos, Leonardo Cole, Alexandre Vasconcelos,</text>
<text top="619" left="250" width="454" height="19" font="5">Paulo Borba, and Geber Ramalho. Extracting and evolving code in</text>
<text top="637" left="250" width="460" height="19" font="5">product lines with aspect-oriented programming. In Transactions on</text>
<text top="659" left="249" width="276" height="13" font="5">Aspect-Oriented Software Development IV</text>
<text top="655" left="526" width="197" height="19" font="5">, volume 4640 of LNCS, pages</text>
<text top="673" left="249" width="416" height="19" font="5">117‚Äì142. Springer, 2007. <a href="http://dx.doi.org/10.1007/978-3-540-77042-8_5">doi:10.1007/978-3-540-77042-8_5.</a></text>
<text top="697" left="170" width="43" height="19" font="5">[AS07]</text>
<text top="697" left="250" width="457" height="19" font="5">B. Adams and K. De Schutter. An aspect for idiom-based exception</text>
<text top="715" left="250" width="458" height="19" font="5">handling: (using local continuation join points, join point properties,</text>
<text top="733" left="250" width="458" height="19" font="5">annotations and type parameters). In Proc. SPLAT‚Äô07. ACM, 2007.</text>
<text top="756" left="250" width="212" height="12" font="5"><a href="http://dx.doi.org/10.1145/1233843.1233844">doi:10.1145/1233843.1233844</a></text>
<text top="751" left="462" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1233843.1233844">.</a></text>
<text top="774" left="170" width="35" height="19" font="5">[BCF</text>
<text top="776" left="205" width="9" height="9" font="6">+</text>
<text top="774" left="215" width="507" height="19" font="5">99] M. G. Burke, J.-D. Choi, S. Fink, D. Grove, M. Hind, V. Sarkar, M. J.</text>
<text top="792" left="250" width="465" height="19" font="5">Serrano, V. C. Sreedhar, H. Srinivasan, and J. Whaley. The Jalape√±o</text>
<text top="810" left="250" width="473" height="19" font="5">Dynamic Optimizing Compiler for Java. In Proc. Java Grande‚Äô99, pages</text>
<text top="828" left="249" width="386" height="19" font="5">129‚Äì141. ACM Press, 1999. <a href="http://dx.doi.org/10.1145/304065.304113">doi:10.1145/304065.304113.</a></text>
<text top="852" left="170" width="58" height="19" font="5">[BCM04]</text>
<text top="852" left="250" width="472" height="19" font="5">S. M. Blackburn, P. Cheng, and K. S. McKinley. Oil and Water? High</text>
<text top="870" left="250" width="474" height="19" font="5">Performance Garbage Collection in Java with MMTk. In Proc. ICSE‚Äô07,</text>
<text top="888" left="250" width="272" height="19" font="5">2004. <a href="http://dx.doi.org/10.1109/ICSE.2004.1317436">doi:10.1109/ICSE.2004.1317436.</a></text>
<text top="912" left="170" width="45" height="19" font="5">[Bel73]</text>
<text top="912" left="250" width="475" height="19" font="5">James R. Bell. Threaded code. Communications of the ACM, 16(6):370‚Äì</text>
<text top="930" left="250" width="272" height="19" font="5">372, 1973. <a href="http://dx.doi.org/10.1145/362248.362270">doi:10.1145/362248.362270.</a></text>
<text top="954" left="170" width="45" height="19" font="5">[CN02]</text>
<text top="954" left="250" width="463" height="19" font="5">P. Clements and L. Northrop. Software Product Lines: Practices and</text>
<text top="976" left="250" width="55" height="13" font="5">Patterns</text>
<text top="972" left="305" width="156" height="19" font="5">. Addison-Wesley, 2002.</text>
<text top="996" left="170" width="60" height="19" font="5">[CTW05]</text>
<text top="996" left="250" width="473" height="19" font="5">CliÔ¨Ä Click, Gil Tene, and Michael Wolf. The pauseless gc algorithm. In</text>
<text top="1017" left="249" width="463" height="13" font="5">VEE ‚Äô05: Proceedings of the 1st ACM/USENIX international confer-</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="27" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">27</text>
<text top="153" left="250" width="264" height="13" font="5">ence on Virtual execution environments</text>
<text top="150" left="514" width="200" height="19" font="5">, pages 46‚Äì56, New York, NY,</text>
<text top="167" left="250" width="341" height="19" font="5">USA, 2005. ACM. <a href="http://dx.doi.org/10.1145/1064979.1064988">doi:10.1145/1064979.1064988.</a></text>
<text top="191" left="170" width="55" height="19" font="5">[CUL89]</text>
<text top="191" left="250" width="427" height="19" font="5">Craig Chambers, David Ungar, and Elgin Lee. An eÔ¨Écient im-</text>
<text top="209" left="250" width="440" height="19" font="5">plementation of self a dynamically-typed object-oriented language</text>
<text top="227" left="250" width="450" height="19" font="5">based on prototypes. ACM SIGPLAN Notices, 24(10):49‚Äì70, 1989.</text>
<text top="250" left="250" width="180" height="12" font="5"><a href="http://dx.doi.org/10.1145/74878.74884">doi:10.1145/74878.74884</a></text>
<text top="245" left="431" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/74878.74884">.</a></text>
<text top="269" left="170" width="33" height="19" font="5">[FCS</text>
<text top="271" left="203" width="9" height="9" font="6">+</text>
<text top="269" left="213" width="484" height="19" font="5">08] Eduardo Figueiredo, Nelio Cacho, Claudio Sant‚ÄôAnna, Mario Mon-</text>
<text top="287" left="250" width="470" height="19" font="5">teiro, Uira Kulesza, Alessandro Garcia, Sergio Soares, Fabiano Ferrari,</text>
<text top="305" left="250" width="473" height="19" font="5">Safoora Khan, Fernando Castor Filho, and Francisco Dantas. Evolving</text>
<text top="323" left="250" width="470" height="19" font="5">software product lines with aspects: An empirical study on design sta-</text>
<text top="341" left="250" width="473" height="19" font="5">bility. In Proc. ICSE‚Äô08. ACM, 2008. Available from: <a href="http://portal.acm.org/citation.cfm?id=1368124&amp;jmp=abstract&amp;coll=&amp;dl=ACM">http://portal.</a></text>
<text top="364" left="250" width="447" height="12" font="5"><a href="http://portal.acm.org/citation.cfm?id=1368124&amp;jmp=abstract&amp;coll=&amp;dl=ACM">acm.org/citation.cfm?id=1368124&amp;jmp=abstract&amp;coll=&amp;dl=ACM</a></text>
<text top="359" left="697" width="4" height="19" font="5"><a href="http://portal.acm.org/citation.cfm?id=1368124&amp;jmp=abstract&amp;coll=&amp;dl=ACM">,</a></text>
<text top="382" left="250" width="212" height="12" font="5"><a href="http://dx.doi.org/10.1145/1368088.1368124">doi:10.1145/1368088.1368124</a></text>
<text top="377" left="462" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1368088.1368124">.</a></text>
<text top="401" left="170" width="56" height="19" font="5">[GBE07]</text>
<text top="401" left="250" width="464" height="19" font="5">A. Georges, D. Buytaert, and L. Eeckhout. Statistically rigorous java</text>
<text top="419" left="250" width="453" height="19" font="5">performance evaluation. SIGPLAN Not., 42(10):57‚Äì76, 2007. <a href="http://dx.doi.org/10.1145/1297105.1297033">doi:</a></text>
<text top="442" left="250" width="180" height="12" font="5"><a href="http://dx.doi.org/10.1145/1297105.1297033">10.1145/1297105.1297033</a></text>
<text top="436" left="430" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1297105.1297033">.</a></text>
<text top="460" left="170" width="44" height="19" font="5">[GLvB</text>
<text top="462" left="214" width="9" height="9" font="6">+</text>
<text top="460" left="224" width="494" height="19" font="5">03] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.</text>
<text top="478" left="250" width="433" height="19" font="5">The nesC language: A holistic approach to networked embedded</text>
<text top="496" left="250" width="440" height="19" font="5">systems. In Proc. PLDI‚Äô03, pages 1‚Äì11. ACM, May 2003. Avail-</text>
<text top="514" left="250" width="460" height="19" font="5">able from: <a href="http://portal.acm.org/citation.cfm?id=781133">http://portal.acm.org/citation.cfm?id=781133, </a><a href="http://dx.doi.org/10.1145/781131.781133">doi:</a></text>
<text top="537" left="250" width="165" height="12" font="5"><a href="http://dx.doi.org/10.1145/781131.781133">10.1145/781131.781133</a></text>
<text top="532" left="415" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/781131.781133">.</a></text>
<text top="556" left="170" width="46" height="19" font="5">[GR83]</text>
<text top="556" left="250" width="474" height="19" font="5">A. Goldberg and D. Robson. Smalltalk-80: The Language and its Imple-</text>
<text top="578" left="250" width="66" height="13" font="5">mentation</text>
<text top="574" left="316" width="156" height="19" font="5">. Addison-Wesley, 1983.</text>
<text top="598" left="170" width="32" height="19" font="5">[GSS</text>
<text top="599" left="203" width="9" height="9" font="6">+</text>
<text top="598" left="212" width="496" height="19" font="5">06] W. G. Griswold, K. Sullivan, Y. Song, M. Shonle, N. Tewari, Y. Cai,</text>
<text top="616" left="250" width="459" height="19" font="5">and H. Rajan. Modular software design with crosscutting interfaces.</text>
<text top="638" left="250" width="97" height="13" font="5">IEEE Software</text>
<text top="634" left="347" width="311" height="19" font="5">, 23(1):51‚Äì60, 2006. <a href="http://dx.doi.org/10.1109/MS.2006.24">doi:10.1109/MS.2006.24.</a></text>
<text top="658" left="170" width="36" height="19" font="5">[GTL</text>
<text top="659" left="206" width="9" height="9" font="6">+</text>
<text top="658" left="216" width="507" height="19" font="5">10] N. GeoÔ¨Äray, G. Thomas, J. Lawall, G. Muller, and B. Folliot. VMKit: a</text>
<text top="676" left="250" width="475" height="19" font="5">Substrate for Managed Runtime Environments. In Proceedings of VEE.</text>
<text top="694" left="250" width="340" height="19" font="5">ACM Press, 2010. <a href="http://dx.doi.org/10.1145/1837854.1736006">doi:10.1145/1837854.1736006.</a></text>
<text top="717" left="170" width="36" height="19" font="5">[HAT</text>
<text top="719" left="206" width="9" height="9" font="6">+</text>
<text top="717" left="216" width="458" height="19" font="5">09] M. Haupt, B. Adams, S. Timbermont, C. Gibbs, Y. Coady, and</text>
<text top="735" left="250" width="473" height="19" font="5">R. Hirschfeld. Disentangling Virtual Machine Architecture. IET Journal</text>
<text top="757" left="250" width="340" height="13" font="5">Special Issue on Domain-Specific Aspect Languages</text>
<text top="753" left="590" width="117" height="19" font="5">, 3(3), June 2009.</text>
<text top="776" left="250" width="228" height="12" font="5"><a href="http://dx.doi.org/10.1049/iet-sen.2007.0121">doi:10.1049/iet-sen.2007.0121</a></text>
<text top="771" left="478" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1049/iet-sen.2007.0121">.</a></text>
<text top="795" left="170" width="37" height="19" font="5">[HHP</text>
<text top="797" left="207" width="9" height="9" font="6">+</text>
<text top="795" left="217" width="421" height="19" font="5">10] M. Haupt, R. Hirschfeld, T. Pape, G. Gabrysiak, S. Marr,</text>
<text top="813" left="250" width="450" height="19" font="5">A. Bergmann, A. Heise, M. Kleine, and R. Krahn. The SOM Fam-</text>
<text top="831" left="250" width="472" height="19" font="5">ily: Virtual Machines for Teaching and Research. In Proceedings of the</text>
<text top="853" left="249" width="456" height="13" font="5">15th Annual Conference on Innovation and Technology in Computer</text>
<text top="871" left="250" width="187" height="13" font="5">Science Education (ITiCSE)</text>
<text top="867" left="437" width="291" height="19" font="5">. ACM Press, 2010. <a href="http://dx.doi.org/10.1145/1822090.1822098">doi:10.1145/1822090.</a></text>
<text top="890" left="250" width="55" height="12" font="5"><a href="http://dx.doi.org/10.1145/1822090.1822098">1822098</a></text>
<text top="885" left="305" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1822090.1822098">.</a></text>
<text top="909" left="170" width="40" height="19" font="5">[JL96]</text>
<text top="909" left="250" width="460" height="19" font="5">R. Jones and R. Lins. Garbage Collection. Algorithms for Automatic</text>
<text top="931" left="250" width="206" height="13" font="5">Dynamic Memory Management</text>
<text top="927" left="456" width="91" height="19" font="5">. Wiley, 1996.</text>
<text top="951" left="170" width="38" height="19" font="5">[KHH</text>
<text top="952" left="208" width="9" height="9" font="6">+</text>
<text top="951" left="218" width="497" height="19" font="5">01] G. Kiczales, E. Hilsdale, J. Hugunin, M. Kersten, J. Palm, and W. G.</text>
<text top="968" left="250" width="460" height="19" font="5">Griswold. An Overview of AspectJ. In J. Lindskov Knudsen, editor,</text>
<text top="990" left="250" width="113" height="13" font="5">Proc. ECOOP‚Äô01</text>
<text top="986" left="363" width="363" height="19" font="5">, volume 2072 of LNCS, pages 327‚Äì353. Springer, 2001.</text>
<text top="1009" left="250" width="222" height="12" font="5"><a href="http://dx.doi.org/10.1007/3-540-45337-7_18">doi:10.1007/3-540-45337-7_18</a></text>
<text top="1004" left="472" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1007/3-540-45337-7_18">.</a></text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="28" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">28</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="150" left="170" width="44" height="19" font="5">[LA04]</text>
<text top="150" left="250" width="473" height="19" font="5">C. Lattner and V. Adve. LLVM: A Compilation Framework for Lifelong</text>
<text top="167" left="250" width="465" height="19" font="5">Program Analysis &amp; Transformation. In CGO ‚Äô04: Proceedings of the</text>
<text top="189" left="250" width="415" height="13" font="5">international symposium on Code generation and optimization</text>
<text top="185" left="666" width="46" height="19" font="5">. IEEE</text>
<text top="203" left="250" width="390" height="19" font="5">Computer Society, 2004. <a href="http://dx.doi.org/10.1109/CGO.2004.1281665">doi:10.1109/CGO.2004.1281665.</a></text>
<text top="227" left="170" width="48" height="19" font="5">[Lad10]</text>
<text top="227" left="250" width="391" height="19" font="5">R. Laddad. AspectJ in Action. Manning, 2nd edition, 2010.</text>
<text top="251" left="170" width="43" height="19" font="5">[LB96]</text>
<text top="251" left="250" width="459" height="19" font="5">B. Lewis and D. J. Berg. Threads Primer. A Guide to Multithreaded</text>
<text top="273" left="250" width="87" height="13" font="5">Programming</text>
<text top="269" left="337" width="140" height="19" font="5">. Prentice Hall, 1996.</text>
<text top="293" left="170" width="544" height="19" font="5">[LSGF08] Neil Loughran, Pablo S√°nchez, Alessandro Garcia, and Lidia Fuentes.</text>
<text top="315" left="250" width="448" height="13" font="5">Language Support for Managing Variability in Architectural Models</text>
<text top="311" left="698" width="4" height="19" font="5">,</text>
<text top="329" left="250" width="453" height="19" font="5">volume 4954 of LNCS, pages 36‚Äì51. Springer, 2008. <a href="http://dx.doi.org/10.1007/978-3-540-78789-1_3">doi:10.1007/</a></text>
<text top="352" left="250" width="152" height="12" font="5"><a href="http://dx.doi.org/10.1007/978-3-540-78789-1_3">978-3-540-78789-1_3</a></text>
<text top="347" left="402" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1007/978-3-540-78789-1_3">.</a></text>
<text top="371" left="170" width="42" height="19" font="5">[LV95]</text>
<text top="371" left="250" width="475" height="19" font="5">David C. Luckham and James Vera. An event-based architecture deÔ¨Åni-</text>
<text top="389" left="250" width="475" height="19" font="5">tion language. IEEE Transactions on Software Engineering, 21(9):717‚Äì</text>
<text top="407" left="250" width="241" height="19" font="5">734, 1995. <a href="http://dx.doi.org/10.1109/32.464548">doi:10.1109/32.464548.</a></text>
<text top="431" left="170" width="51" height="19" font="5">[Mey97]</text>
<text top="431" left="250" width="465" height="19" font="5">B. Meyer. Object-Oriented Software Construction. Prentice Hall, 2nd</text>
<text top="448" left="250" width="88" height="19" font="5">edition, 1997.</text>
<text top="472" left="170" width="48" height="19" font="5">[MT00]</text>
<text top="472" left="250" width="475" height="19" font="5">Nenad Medvidovic and Richard N. Taylor. A classiÔ¨Åcation and compar-</text>
<text top="490" left="250" width="465" height="19" font="5">ison framework for software architecture description languages. IEEE</text>
<text top="512" left="249" width="29" height="13" font="5">TSE</text>
<text top="508" left="278" width="303" height="19" font="5">, 26(1):70‚Äì93, 2000. <a href="http://dx.doi.org/10.1109/32.825767">doi:10.1109/32.825767.</a></text>
<text top="532" left="170" width="44" height="19" font="5">[O. 02]</text>
<text top="532" left="250" width="473" height="19" font="5">O. Spinczyk and A. Gal and W. Schr√∂der-Preikschat. AspectC++: An</text>
<text top="550" left="250" width="475" height="19" font="5">Aspect-Oriented Extension to C++. In Proc. TOOLS Pacific‚Äô02. ACM,</text>
<text top="568" left="250" width="34" height="19" font="5">2002.</text>
<text top="592" left="170" width="46" height="19" font="5">[Par72]</text>
<text top="592" left="250" width="465" height="19" font="5">D. L. Parnas. On the criteria to be used in decomposing systems into</text>
<text top="610" left="250" width="449" height="19" font="5">modules. Commun. ACM, 15(12):1053‚Äì1058, 1972. <a href="http://dx.doi.org/10.1145/361598.361623">doi:10.1145/</a></text>
<text top="633" left="250" width="102" height="12" font="5"><a href="http://dx.doi.org/10.1145/361598.361623">361598.361623</a></text>
<text top="628" left="352" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/361598.361623">.</a></text>
<text top="652" left="170" width="46" height="19" font="5">[Par92]</text>
<text top="652" left="250" width="462" height="19" font="5">Robert E. Park. Software size measurement: A framework for count-</text>
<text top="670" left="250" width="461" height="19" font="5">ing source statements. Technical Report CMU/SEI-92-TR- 20, ESC-</text>
<text top="688" left="250" width="470" height="19" font="5">TR-92-20, Software Engineering Institute, Carnegie Mellon University,</text>
<text top="705" left="250" width="108" height="19" font="5">September 1992.</text>
<text top="729" left="170" width="46" height="19" font="5">[Pre97]</text>
<text top="729" left="250" width="465" height="19" font="5">Christian Prehofer. Feature-Oriented Programming: A Fresh Look at</text>
<text top="747" left="250" width="423" height="19" font="5">Objects. LNCS, 1241:419‚Äì434, 1997. <a href="http://dx.doi.org/10.1007/BFb0053389">doi:10.1007/BFb0053389.</a></text>
<text top="771" left="170" width="44" height="19" font="5">[RP06]</text>
<text top="771" left="250" width="473" height="19" font="5">Armin Rigo and Samuele Pedroni. Pypy‚Äôs approach to virtual machine</text>
<text top="789" left="250" width="469" height="19" font="5">construction. In Proc. OOPSLA‚Äô06, pages 944‚Äì953. ACM, 2006. <a href="http://dx.doi.org/10.1145/1176617.1176753">doi:</a></text>
<text top="812" left="250" width="180" height="12" font="5"><a href="http://dx.doi.org/10.1145/1176617.1176753">10.1145/1176617.1176753</a></text>
<text top="807" left="430" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1176617.1176753">.</a></text>
<text top="831" left="170" width="553" height="19" font="5">[RSSA08] M. Rosenm√ºller, N. Siegmund, G. Saake, and S. Apel. Code generation</text>
<text top="849" left="250" width="460" height="19" font="5">to support static and dynamic composition of software product lines.</text>
<text top="867" left="250" width="459" height="19" font="5">In Proc. GPCE‚Äô08, pages 3‚Äì12. ACM, 2008. <a href="http://dx.doi.org/10.1145/1449913.1449917">doi:10.1145/1449913.</a></text>
<text top="890" left="250" width="55" height="12" font="5"><a href="http://dx.doi.org/10.1145/1449913.1449917">1449917</a></text>
<text top="885" left="305" width="4" height="19" font="5"><a href="http://dx.doi.org/10.1145/1449913.1449917">.</a></text>
<text top="909" left="170" width="43" height="19" font="5">[SN05]</text>
<text top="909" left="250" width="453" height="19" font="5">J. E. Smith and R. Nair. Virtual Machines. Versatile Platforms for</text>
<text top="931" left="250" width="147" height="13" font="5">Systems and Processes</text>
<text top="927" left="397" width="178" height="19" font="5">. Morgan Kaufmann, 2005.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="29" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="19" size="7" family="Times" color="#000000"/>
	<fontspec id="20" size="8" family="Times" color="#000000"/>
	<fontspec id="21" size="8" family="Times" color="#000000"/>
<text top="74" left="622" width="73" height="16" font="4">CSOM/PL ¬∑</text>
<text top="74" left="708" width="15" height="14" font="5">29</text>
<text top="149" left="170" width="14" height="20" font="0">A</text>
<text top="149" left="204" width="150" height="20" font="0">VMADL Example</text>
<text top="193" left="171" width="129" height="11" font="19"><b>service NativeThreads {</b></text>
<text top="203" left="171" width="106" height="11" font="19"><b>    require Memory;</b></text>
<text top="213" left="171" width="84" height="11" font="19"><b>    require VM;</b></text>
<text top="224" left="171" width="123" height="11" font="19"><b>    require VMObjects;</b></text>
<text top="234" left="171" width="134" height="11" font="19"><b>    require Interpreter;</b></text>
<text top="244" left="171" width="134" height="11" font="19"><b>    #include &lt;pthread.h&gt;</b></text>
<text top="255" left="171" width="263" height="11" font="19"><b>    extern pthread_key_t tsg_frame, tsg_thread;</b></text>
<text top="265" left="171" width="179" height="11" font="19"><b>    pVMMutex  VMMutex_new(void);</b></text>
<text top="276" left="171" width="302" height="11" font="19"><b>    void*     VMThread_get_safe_global(pthread_key_t);</b></text>
<text top="286" left="171" width="342" height="11" font="19"><b>    void      VMThread_set_safe_global(pthread_key_t, void*);</b></text>
<text top="296" left="171" width="168" height="11" font="19"><b>    class VMMutex : VMObject {</b></text>
<text top="307" left="171" width="235" height="11" font="19"><b>        pthread_mutex_t  embedded_mutex_id</b></text>
<text top="317" left="171" width="269" height="11" font="19"><b>        pthread_mutex_t* get_embedded_mutex_id()</b></text>
<text top="327" left="171" width="174" height="11" font="19"><b>        void             lock()</b></text>
<text top="338" left="171" width="185" height="11" font="19"><b>        void             unlock()</b></text>
<text top="348" left="171" width="202" height="11" font="19"><b>        bool             is_locked()</b></text>
<text top="359" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="369" left="171" width="207" height="11" font="19"><b>    class VMSignal : VMObject { ... }</b></text>
<text top="379" left="171" width="207" height="11" font="19"><b>    class VMThread : VMObject { ... }</b></text>
<text top="390" left="171" width="6" height="11" font="19"><b>}</b></text>
<text top="410" left="171" width="202" height="11" font="19"><b>combine NativeThreads, Interpreter {</b></text>
<text top="421" left="171" width="549" height="11" font="19"><b>    advice execution(&#34;void Interpreter_set_frame(...)&#34;) &amp;&amp; args(value) : around(_VMFrame* value) {</b></text>
<text top="431" left="171" width="286" height="11" font="19"><b>        VMThread_set_safe_global(tsg_frame, value);</b></text>
<text top="442" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="452" left="171" width="392" height="11" font="19"><b>    advice execution(&#34;_VMFrame* Interpreter_get_frame()&#34;) : around() {</b></text>
<text top="462" left="171" width="398" height="11" font="19"><b>        pVMFrame frame = (pVMFrame)VMThread_get_safe_global(tsg_frame);</b></text>
<text top="473" left="171" width="174" height="11" font="19"><b>        *tjp-&gt;result() = frame;</b></text>
<text top="483" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="493" left="171" width="6" height="11" font="19"><b>}</b></text>
<text top="514" left="171" width="202" height="11" font="19"><b>combine NativeThreads, GCMarkSweep {</b></text>
<text top="525" left="171" width="134" height="11" font="19"><b>    require Interpreter;</b></text>
<text top="535" left="171" width="134" height="11" font="19"><b>    #include &lt;pthread.h&gt;</b></text>
<text top="545" left="171" width="50" height="11" font="19"><b>    bool </b></text>
<text top="545" left="287" width="84" height="11" font="19"><b>stop_the_world;</b></text>
<text top="556" left="171" width="196" height="11" font="19"><b>    pthread_mutex_t mtx_do_collect;</b></text>
<text top="566" left="171" width="207" height="11" font="19"><b>    pthread_mutex_t mtx_gc_structure;</b></text>
<text top="576" left="171" width="302" height="11" font="19"><b>    advice execution(&#34;void gc_collect()&#34;) : around() {</b></text>
<text top="587" left="171" width="325" height="11" font="19"><b>        if (pthread_mutex_trylock(&amp;mtx_do_collect) == 0) {</b></text>
<text top="597" left="171" width="190" height="11" font="19"><b>            stop_the_world = true;</b></text>
<text top="607" left="171" width="196" height="11" font="19"><b>            wait_for_all_threads();</b></text>
<text top="618" left="171" width="151" height="11" font="19"><b>            tjp-&gt;proceed();</b></text>
<text top="628" left="171" width="246" height="11" font="19"><b>            signal_proceed_to_all_threads();</b></text>
<text top="639" left="171" width="280" height="11" font="19"><b>            pthread_mutex_unlock(&amp;mtx_do_collect);</b></text>
<text top="649" left="171" width="50" height="11" font="19"><b>        }</b></text>
<text top="659" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="670" left="171" width="347" height="11" font="19"><b>    advice Interpreter::safe_point_in_execution() : before() {</b></text>
<text top="680" left="171" width="162" height="11" font="19"><b>        if (stop_the_world) {</b></text>
<text top="690" left="171" width="258" height="11" font="19"><b>            gc_mark_reachable_stack_objects();</b></text>
<text top="701" left="171" width="213" height="11" font="19"><b>            wait_until_gc_completed();</b></text>
<text top="711" left="171" width="50" height="11" font="19"><b>        }</b></text>
<text top="722" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="732" left="171" width="409" height="11" font="19"><b>    advice call(&#34;% pthread_exit(...)&#34;) : before() { dec_thread_count(); }</b></text>
<text top="742" left="171" width="420" height="11" font="19"><b>    advice call(&#34;% pthread_create(...)&#34;) : before() { inc_thread_count(); }</b></text>
<text top="753" left="171" width="504" height="11" font="19"><b>    advice execution(&#34;void Universe_exit(int)&#34;) : before() { signal_exit_to_gc_thread(); }</b></text>
<text top="763" left="171" width="336" height="11" font="19"><b>    advice GCMarkSweep::reserve_and_get_entry() : around() {</b></text>
<text top="773" left="171" width="258" height="11" font="19"><b>        pthread_mutex_lock(&amp;mtx_gc_structure);</b></text>
<text top="784" left="171" width="129" height="11" font="19"><b>        tjp-&gt;proceed();</b></text>
<text top="794" left="171" width="269" height="11" font="19"><b>        pthread_mutex_unlock(&amp;mtx_gc_structure);</b></text>
<text top="805" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="815" left="171" width="347" height="11" font="19"><b>    advice GCMarkSweep::split_and_reserve_entry() : around() {</b></text>
<text top="825" left="171" width="258" height="11" font="19"><b>        pthread_mutex_lock(&amp;mtx_gc_structure);</b></text>
<text top="836" left="171" width="129" height="11" font="19"><b>        tjp-&gt;proceed();</b></text>
<text top="846" left="171" width="269" height="11" font="19"><b>        pthread_mutex_unlock(&amp;mtx_gc_structure);</b></text>
<text top="856" left="171" width="28" height="11" font="19"><b>    }</b></text>
<text top="867" left="171" width="6" height="11" font="19"><b>}</b></text>
<text top="200" left="566" width="116" height="10" font="20"><b>Note:</b> the code displayed</text>
<text top="212" left="566" width="151" height="10" font="6">here was abbreviated. Irrelevant </text>
<text top="224" left="566" width="94" height="10" font="6">parts are not shown.</text>
<text top="207" left="360" width="86" height="10" font="6">required interfaces</text>
<text top="220" left="360" width="125" height="10" font="6">from other service modules</text>
<text top="271" left="526" width="111" height="10" font="6">here starts the deÔ¨Ånition</text>
<text top="284" left="526" width="135" height="10" font="6">of the <i>NativeThreads</i> service </text>
<text top="296" left="526" width="126" height="10" font="6">module interface, including </text>
<text top="309" left="526" width="88" height="10" font="6">ClassDL deÔ¨Ånitions</text>
<text top="360" left="427" width="122" height="10" font="6">the interpreter needs to be</text>
<text top="372" left="427" width="151" height="10" font="6">executed thread-locally; thus, its </text>
<text top="385" left="427" width="152" height="10" font="6">global state variables have to be </text>
<text top="397" left="427" width="81" height="10" font="6">made thread-safe</text>
<text top="481" left="392" width="141" height="10" font="6">the <i>stop-the-world</i> GC scheme</text>
<text top="494" left="392" width="175" height="10" font="6">is implemented entirely in this service </text>
<text top="506" left="392" width="93" height="10" font="6">module combination</text>
<text top="537" left="505" width="104" height="10" font="6">this advice guarantees</text>
<text top="550" left="505" width="118" height="10" font="21"><i>stop-the-world</i> semantics:</text>
<text top="562" left="505" width="198" height="10" font="6">‚Äì try to acquire a lock; if this fails, a GC run</text>
<text top="575" left="505" width="189" height="10" font="6">   has already been requested in another </text>
<text top="587" left="505" width="38" height="10" font="6">   thread</text>
<text top="599" left="505" width="185" height="10" font="6">‚Äì when the lock was acquired, signal all </text>
<text top="612" left="505" width="197" height="10" font="6">   threads and wait until they have stopped </text>
<text top="624" left="505" width="182" height="10" font="6">   at a safe point; then proceed with the </text>
<text top="637" left="505" width="52" height="10" font="6">   collection</text>
<text top="649" left="505" width="172" height="10" font="6">‚Äì Ô¨Ånally, signal all threads to continue</text>
<text top="687" left="458" width="125" height="10" font="21"><i>safe point</i>: suspend thread </text>
<text top="700" left="458" width="155" height="10" font="6">execution, mark all stack objects, </text>
<text top="712" left="458" width="157" height="10" font="6">and wait for the signal to continue </text>
<text top="808" left="557" width="105" height="10" font="6">management: counting</text>
<text top="820" left="557" width="122" height="10" font="6">threads, and ensuring GC </text>
<text top="832" left="557" width="119" height="10" font="6">structures are thread-safe</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
<page number="30" position="absolute" top="0" left="0" height="1262" width="892">
<text top="74" left="170" width="15" height="14" font="5">30</text>
<text top="74" left="198" width="125" height="16" font="4">¬∑ Michael Haupt et al.</text>
<text top="149" left="170" width="157" height="20" font="0">About the authors</text>
<text top="187" left="170" width="113" height="13" font="5">Michael Haupt</text>
<text top="183" left="289" width="434" height="19" font="5">is a Principal Member of Technical StaÔ¨Ä in the Maxine team at</text>
<text top="201" left="170" width="553" height="19" font="5">Oracle Labs. Before joining Oracle, he was a post-doctoral researcher and lecturer in</text>
<text top="219" left="170" width="556" height="19" font="5">the Software Architecture Group at the Hasso-Plattner-Institut (HPI) in Potsdam.</text>
<text top="236" left="170" width="556" height="19" font="5">Michael holds a doctoral degree from Technische Universit√§t Darmstadt, Germany.</text>
<text top="254" left="170" width="553" height="19" font="5">He can be contacted by e-mail via <a href="mailto:michael.haupt@oracle.com">michael.haupt@oracle.com, </a>his home page is at</text>
<text top="277" left="170" width="275" height="12" font="5"><a href="http://labs.oracle.com/people/haupt">http://labs.oracle.com/people/haupt</a></text>
<text top="272" left="445" width="4" height="19" font="5"><a href="http://labs.oracle.com/people/haupt">.</a></text>
<text top="312" left="170" width="91" height="13" font="5">Stefan Marr</text>
<text top="308" left="265" width="459" height="19" font="5">is a PhD student at the Software Languages Lab of the Vrije Universiteit</text>
<text top="326" left="170" width="554" height="19" font="5">Brussel. He graduated with a master degree at the Hasso-Plattner-Institut (HPI)</text>
<text top="344" left="170" width="553" height="19" font="5">before going to Brussels to work on virtual machines for the manycore era. His</text>
<text top="362" left="170" width="557" height="19" font="5">email address is <a href="mailto:stefan.marr@vub.ac.be">stefan.marr@vub.ac.be </a>and his home page can be found at <a href="http://soft.vub.ac.be/~smarr/">http:</a></text>
<text top="385" left="169" width="188" height="12" font="5"><a href="http://soft.vub.ac.be/~smarr/">//soft.vub.ac.be/~smarr/</a></text>
<text top="420" left="170" width="134" height="13" font="5">Robert Hirschfeld</text>
<text top="416" left="309" width="415" height="19" font="5">is a Professor of Computer Science at the Hasso-Plattner-Institut</text>
<text top="434" left="168" width="554" height="19" font="5">(HPI) at the University of Potsdam. He received a Ph.D. in Computer Science form</text>
<text top="452" left="170" width="553" height="19" font="5">the Technical University of Ilmenau, Germany. He can be reached at <a href="mailto:hirschfeld@hpi.uni-potsdam.de">hirschfeld@</a></text>
<text top="475" left="170" width="142" height="12" font="5"><a href="mailto:hirschfeld@hpi.uni-potsdam.de">hpi.uni-potsdam.de</a></text>
<text top="470" left="312" width="339" height="19" font="5"><a href="mailto:hirschfeld@hpi.uni-potsdam.de">. </a>See also <a href="http://www.hpi.uni-potsdam.de/swa/">http://www.hpi.uni-potsdam.de/swa/.</a></text>
<text top="525" left="170" width="134" height="13" font="5">Acknowledgments</text>
<text top="522" left="319" width="406" height="19" font="5">The authors are grateful for the contributions of Bram Adams,</text>
<text top="539" left="170" width="553" height="19" font="5">Yvonne Coady, Celina Gibbs, and Stijn Timbermont to the ideas underlying the</text>
<text top="557" left="170" width="548" height="19" font="5">presented results. Special thanks go to Tobias Pape for his contributions to CSOM.</text>
<text top="575" left="192" width="530" height="19" font="5">Stefan Marr is supported by a doctoral scholarship of the Institute for the Promotion</text>
<text top="593" left="170" width="556" height="19" font="5">of Innovation through Science and Technology in Flanders (IWT-Vlaanderen), Belgium.</text>
<text top="1094" left="310" width="274" height="16" font="4"><a href="http://dx.doi.org/10.5381/jot.2011.10.1.a12">Journal of Object Technology, vol. 10, no. 12, 2011</a></text>
</page>
</pdf2xml>
