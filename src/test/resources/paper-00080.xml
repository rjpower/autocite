<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml>
<page number="1" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="0" size="17" family="Times" color="#316190"/>
	<fontspec id="1" size="25" family="Times" color="#316190"/>
	<fontspec id="2" size="16" family="Times" color="#316190"/>
	<fontspec id="3" size="16" family="Times" color="#000000"/>
	<fontspec id="4" size="37" family="Times" color="#000000"/>
	<fontspec id="5" size="17" family="Times" color="#000000"/>
	<fontspec id="6" size="10" family="Times" color="#000000"/>
	<fontspec id="7" size="10" family="Times" color="#316190"/>
	<fontspec id="8" size="11" family="Times" color="#000000"/>
	<fontspec id="9" size="11" family="Times" color="#000000"/>
<text top="171" left="122" width="193" height="20" font="0"><b>San Jose State University</b></text>
<text top="190" left="122" width="214" height="27" font="1"><a href="http://scholarworks.sjsu.edu"><b>SJSU ScholarWorks</b></a></text>
<text top="244" left="122" width="114" height="18" font="2"><a href="http://scholarworks.sjsu.edu/etd_projects">Master's Projects</a></text>
<text top="244" left="559" width="265" height="18" font="2"><a href="http://scholarworks.sjsu.edu/etd">Master's Theses and Graduate Research</a></text>
<text top="318" left="122" width="70" height="18" font="3">10-1-2011</text>
<text top="352" left="122" width="553" height="39" font="4">Graph Technique For Metamorphic Virus</text>
<text top="388" left="122" width="133" height="39" font="4">Detection</text>
<text top="444" left="122" width="91" height="20" font="5">Neha Runwal</text>
<text top="997" left="122" width="644" height="12" font="6">This Master's Project is brought to you for free and open access by the Master's Theses and Graduate Research at SJSU ScholarWorks. It has been</text>
<text top="1013" left="122" width="601" height="12" font="6">accepted for inclusion in Master's Projects by an authorized administrator of SJSU ScholarWorks. For more information, please contact</text>
<text top="1013" left="725" width="37" height="12" font="7"><a href="mailto:Library-scholarworks-group@sjsu.edu">Library-</a></text>
<text top="1030" left="122" width="136" height="12" font="7"><a href="mailto:Library-scholarworks-group@sjsu.edu">scholarworks-group@sjsu.edu</a></text>
<text top="1030" left="257" width="2" height="12" font="6">.</text>
<text top="902" left="122" width="163" height="18" font="3">Recommended Citation</text>
<text top="926" left="122" width="531" height="14" font="8">Runwal, Neha, &#34;Graph Technique For Metamorphic Virus Detection&#34; (2011). <i>Master's Projects. </i>Paper 206.</text>
<text top="942" left="122" width="243" height="14" font="8">http://scholarworks.sjsu.edu/etd_projects/206</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="10" size="15" family="Times" color="#000000"/>
	<fontspec id="11" size="20" family="Times" color="#000000"/>
<text top="1117" left="162" width="4" height="17" font="10"> </text>
<text top="1117" left="482" width="4" height="17" font="10"> </text>
<text top="138" left="486" width="4" height="17" font="10"> </text>
<text top="159" left="486" width="4" height="17" font="10"> </text>
<text top="180" left="486" width="4" height="17" font="10"> </text>
<text top="200" left="486" width="4" height="17" font="10"> </text>
<text top="222" left="251" width="475" height="21" font="11">Graph Technique For Metamorphic Virus Detection </text>
<text top="247" left="486" width="4" height="17" font="10"> </text>
<text top="268" left="486" width="4" height="17" font="10"> </text>
<text top="288" left="486" width="4" height="17" font="10"> </text>
<text top="309" left="486" width="4" height="17" font="10"> </text>
<text top="330" left="486" width="4" height="17" font="10"> </text>
<text top="371" left="425" width="126" height="17" font="10">A Project Report </text>
<text top="413" left="442" width="93" height="17" font="10">Presented to </text>
<text top="454" left="297" width="383" height="17" font="10">The Faculty of the Department of Computer Science </text>
<text top="495" left="392" width="192" height="17" font="10"> San José State University </text>
<text top="537" left="486" width="4" height="17" font="10"> </text>
<text top="578" left="486" width="4" height="17" font="10"> </text>
<text top="620" left="486" width="4" height="17" font="10"> </text>
<text top="661" left="410" width="156" height="17" font="10">In Partial Fulfillment </text>
<text top="702" left="359" width="259" height="17" font="10">of the Requirements for the Degree </text>
<text top="744" left="383" width="211" height="17" font="10">Master of Computer Science </text>
<text top="785" left="486" width="4" height="17" font="10"> </text>
<text top="826" left="486" width="4" height="17" font="10"> </text>
<text top="868" left="477" width="22" height="17" font="10">by </text>
<text top="909" left="437" width="103" height="17" font="10">Neha Runwal </text>
<text top="951" left="429" width="119" height="17" font="10">December 2011 </text>
<text top="992" left="162" width="4" height="17" font="10"> </text>
<text top="1013" left="162" width="4" height="17" font="10"> </text>
<text top="1033" left="162" width="4" height="17" font="10"> </text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="481" width="15" height="17" font="10">ii </text>
<text top="138" left="486" width="4" height="17" font="10"> </text>
<text top="159" left="162" width="4" height="17" font="10"> </text>
<text top="180" left="162" width="4" height="17" font="10"> </text>
<text top="200" left="162" width="4" height="17" font="10"> </text>
<text top="221" left="162" width="4" height="17" font="10"> </text>
<text top="242" left="162" width="4" height="17" font="10"> </text>
<text top="262" left="162" width="4" height="17" font="10"> </text>
<text top="283" left="162" width="4" height="17" font="10"> </text>
<text top="304" left="162" width="4" height="17" font="10"> </text>
<text top="325" left="162" width="4" height="17" font="10"> </text>
<text top="345" left="162" width="4" height="17" font="10"> </text>
<text top="366" left="162" width="4" height="17" font="10"> </text>
<text top="387" left="162" width="4" height="17" font="10"> </text>
<text top="407" left="162" width="4" height="17" font="10"> </text>
<text top="428" left="162" width="4" height="17" font="10"> </text>
<text top="449" left="486" width="4" height="17" font="10"> </text>
<text top="469" left="486" width="4" height="17" font="10"> </text>
<text top="490" left="486" width="4" height="17" font="10"> </text>
<text top="511" left="486" width="4" height="17" font="10"> </text>
<text top="532" left="486" width="4" height="17" font="10"> </text>
<text top="552" left="486" width="4" height="17" font="10"> </text>
<text top="573" left="486" width="4" height="17" font="10"> </text>
<text top="594" left="486" width="4" height="17" font="10"> </text>
<text top="614" left="486" width="4" height="17" font="10"> </text>
<text top="635" left="486" width="4" height="17" font="10"> </text>
<text top="656" left="486" width="4" height="17" font="10"> </text>
<text top="676" left="486" width="4" height="17" font="10"> </text>
<text top="697" left="486" width="4" height="17" font="10"> </text>
<text top="718" left="486" width="4" height="17" font="10"> </text>
<text top="739" left="486" width="4" height="17" font="10"> </text>
<text top="759" left="486" width="4" height="17" font="10"> </text>
<text top="780" left="486" width="4" height="17" font="10"> </text>
<text top="801" left="486" width="4" height="17" font="10"> </text>
<text top="821" left="486" width="4" height="17" font="10"> </text>
<text top="842" left="486" width="4" height="17" font="10"> </text>
<text top="863" left="486" width="4" height="17" font="10"> </text>
<text top="883" left="486" width="4" height="17" font="10"> </text>
<text top="904" left="486" width="4" height="17" font="10"> </text>
<text top="925" left="486" width="4" height="17" font="10"> </text>
<text top="946" left="459" width="59" height="17" font="10">© 2011 </text>
<text top="987" left="437" width="103" height="17" font="10">Neha Runwal </text>
<text top="1028" left="385" width="206" height="17" font="10">ALL RIGHTS RESERVED </text>
<text top="1116" left="483" width="4" height="17" font="10"> </text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="12" size="1" family="Times" color="#000000"/>
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="478" width="20" height="17" font="10">iii </text>
<text top="138" left="486" width="4" height="17" font="10"> </text>
<text top="159" left="486" width="4" height="17" font="10"> </text>
<text top="180" left="486" width="4" height="17" font="10"> </text>
<text top="200" left="257" width="462" height="17" font="10">The Designated Project Committee Approves the Project Titled </text>
<text top="221" left="486" width="4" height="17" font="10"> </text>
<text top="242" left="231" width="514" height="17" font="10">GRAPH TECHNIQUE FOR METAMORPHIC VIRUS DETECTION </text>
<text top="262" left="486" width="4" height="17" font="10"> </text>
<text top="283" left="477" width="22" height="17" font="10">by </text>
<text top="304" left="486" width="4" height="17" font="10"> </text>
<text top="325" left="437" width="103" height="17" font="10">Neha Runwal </text>
<text top="345" left="486" width="4" height="17" font="10"> </text>
<text top="366" left="486" width="4" height="17" font="10"> </text>
<text top="387" left="231" width="513" height="17" font="10">APPROVED FOR THE DEPARTMENT OF COMPUTER SCIENCE </text>
<text top="407" left="486" width="4" height="17" font="10"> </text>
<text top="428" left="486" width="4" height="17" font="10"> </text>
<text top="449" left="359" width="259" height="17" font="10">SAN JOSÉ STATE UNIVERSITY </text>
<text top="469" left="486" width="4" height="17" font="10"> </text>
<text top="490" left="429" width="119" height="17" font="10">December 2011 </text>
<text top="511" left="486" width="4" height="17" font="10"> </text>
<text top="532" left="486" width="4" height="17" font="10"> </text>
<text top="552" left="162" width="653" height="17" font="10">________________________________________________________________________ </text>
<text top="573" left="199" width="131" height="17" font="10">Dr. Mark Stamp,  </text>
<text top="573" left="361" width="4" height="17" font="10"> </text>
<text top="573" left="415" width="250" height="17" font="10">Department of Computer Science  </text>
<text top="573" left="685" width="4" height="17" font="10"> </text>
<text top="573" left="739" width="38" height="17" font="10">Date </text>
<text top="594" left="486" width="4" height="17" font="10"> </text>
<text top="614" left="486" width="4" height="17" font="10"> </text>
<text top="635" left="486" width="4" height="17" font="10"> </text>
<text top="656" left="162" width="653" height="17" font="10">________________________________________________________________________ </text>
<text top="676" left="199" width="125" height="17" font="10">Dr. Sami Khuri,  </text>
<text top="676" left="361" width="4" height="17" font="10"> </text>
<text top="676" left="415" width="250" height="17" font="10">Department of Computer Science  </text>
<text top="676" left="685" width="4" height="17" font="10"> </text>
<text top="676" left="739" width="38" height="17" font="10">Date </text>
<text top="697" left="486" width="4" height="17" font="10"> </text>
<text top="718" left="486" width="4" height="17" font="10"> </text>
<text top="739" left="486" width="4" height="17" font="10"> </text>
<text top="759" left="162" width="653" height="17" font="10">________________________________________________________________________ </text>
<text top="780" left="162" width="172" height="17" font="10">        Dr. Richard Low,  </text>
<text top="780" left="378" width="251" height="17" font="10">         Department of Mathematics  </text>
<text top="780" left="648" width="4" height="17" font="10"> </text>
<text top="780" left="702" width="74" height="17" font="10">        Date </text>
<text top="801" left="486" width="4" height="17" font="10"> </text>
<text top="821" left="486" width="4" height="17" font="10"> </text>
<text top="842" left="486" width="4" height="17" font="10"> </text>
<text top="863" left="486" width="4" height="17" font="10"> </text>
<text top="883" left="343" width="291" height="17" font="10">APPROVED FOR THE UNIVERSITY </text>
<text top="904" left="486" width="4" height="17" font="10"> </text>
<text top="925" left="486" width="4" height="17" font="10"> </text>
<text top="946" left="486" width="4" height="17" font="10"> </text>
<text top="966" left="162" width="653" height="17" font="10">________________________________________________________________________ </text>
<text top="987" left="199" width="121" height="17" font="10">Associate Dean  </text>
<text top="987" left="361" width="4" height="17" font="10"> </text>
<text top="987" left="415" width="303" height="17" font="10">Office of Graduate Studies and Research  </text>
<text top="987" left="739" width="38" height="17" font="10">Date </text>
<text top="1008" left="486" width="4" height="17" font="10"> </text>
<text top="1028" left="486" width="4" height="17" font="10"> </text>
<text top="1128" left="483" width="1" height="3" font="12"> </text>
<text top="1120" left="489" width="4" height="17" font="10"> </text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="479" width="19" height="17" font="10">iv </text>
<text top="138" left="439" width="98" height="17" font="10">ABSTRACT </text>
<text top="159" left="486" width="4" height="17" font="10"> </text>
<text top="180" left="231" width="514" height="17" font="10">GRAPH TECHNIQUE FOR METAMORPHIC VIRUS DETECTION </text>
<text top="200" left="486" width="4" height="17" font="10"> </text>
<text top="221" left="426" width="125" height="17" font="10">by Neha Runwal </text>
<text top="242" left="162" width="4" height="17" font="10"> </text>
<text top="262" left="162" width="650" height="17" font="10">Current anti-virus techniques include signature based detection, anomaly based detection, </text>
<text top="304" left="162" width="638" height="17" font="10">and machine learning based virus detection. Signature detection is the most widely used </text>
<text top="345" left="162" width="605" height="17" font="10">approach.  Metamorphic malware changes its internal structure with each infection. </text>
<text top="387" left="162" width="579" height="17" font="10">Metamorphism provides one of the strong known methods for evading malware </text>
<text top="428" left="162" width="75" height="17" font="10">detection. </text>
<text top="469" left="162" width="4" height="17" font="10"> </text>
<text top="511" left="162" width="599" height="17" font="10">In this project, we consider metamorphic virus detection based on a directed graph </text>
<text top="552" left="162" width="603" height="17" font="10">obtained from executable files. We compare our detection results with a previously </text>
<text top="594" left="162" width="556" height="17" font="10">developed and highly successful technique based on hidden Markov models. </text>
<text top="635" left="162" width="4" height="17" font="10"> </text>
<text top="676" left="162" width="4" height="17" font="10"> </text>
<text top="718" left="162" width="4" height="17" font="10"> </text>
<text top="759" left="162" width="4" height="17" font="10"> </text>
<text top="801" left="162" width="4" height="17" font="10"> </text>
<text top="842" left="162" width="4" height="17" font="10"> </text>
<text top="883" left="162" width="4" height="17" font="10"> </text>
<text top="925" left="162" width="4" height="17" font="10"> </text>
<text top="966" left="162" width="4" height="17" font="10"> </text>
<text top="1008" left="594" width="4" height="17" font="10"> </text>
<text top="1028" left="594" width="4" height="17" font="10"> </text>
<text top="1116" left="483" width="4" height="17" font="10"> </text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="13" size="15" family="Times" color="#000000"/>
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="481" width="13" height="17" font="10">v </text>
<text top="138" left="385" width="206" height="17" font="10">ACKNOWLEDGEMENTS </text>
<text top="159" left="486" width="4" height="17" font="10"> </text>
<text top="180" left="486" width="4" height="17" font="10"> </text>
<text top="200" left="162" width="638" height="17" font="10">I would like to thank Dr. Mark Stamp for his wonderful support through out the project. </text>
<text top="242" left="162" width="640" height="17" font="10">His idea and guidance were the keys to the success of this project. A very special thanks </text>
<text top="283" left="162" width="628" height="17" font="10">to Dr. Richard Low for suggesting a comparison formula for the graph based detection </text>
<text top="325" left="162" width="79" height="17" font="10">technique. </text>
<text top="366" left="162" width="4" height="17" font="10"> </text>
<text top="407" left="162" width="621" height="17" font="10">I also want to thank Mr. Sushant Priyadarshi for providing all related information and </text>
<text top="449" left="162" width="627" height="17" font="10">data for this project. Finally I want to thank my family and especially my husband Mr. </text>
<text top="490" left="162" width="575" height="17" font="10">Mayur Runwal for his patience and emotional support through out my Masters. </text>
<text top="532" left="162" width="4" height="17" font="10"> </text>
<text top="573" left="162" width="4" height="17" font="10"> </text>
<text top="614" left="162" width="4" height="17" font="10"> </text>
<text top="656" left="162" width="4" height="17" font="10"> </text>
<text top="697" left="162" width="4" height="17" font="10"> </text>
<text top="739" left="162" width="4" height="17" font="10"> </text>
<text top="780" left="162" width="4" height="17" font="10"> </text>
<text top="821" left="162" width="4" height="17" font="10"> </text>
<text top="863" left="162" width="4" height="17" font="10"> </text>
<text top="904" left="162" width="4" height="17" font="10"> </text>
<text top="946" left="162" width="4" height="17" font="10"> </text>
<text top="1006" left="162" width="4" height="16" font="13"><b> </b></text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="14" size="19" family="Times" color="#000000"/>
	<fontspec id="15" size="15" family="Times" color="#000000"/>
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="479" width="19" height="17" font="10">vi </text>
<text top="139" left="411" width="156" height="20" font="14">Table of Contents </text>
<text top="181" left="162" width="652" height="16" font="13"><b>1.</b> <b>Introduction................................................................................................................... 1</b> </text>
<text top="220" left="162" width="652" height="16" font="13"><b>2. Malware and detection techniques .............................................................................. 2</b> </text>
<text top="249" left="180" width="634" height="16" font="15"><i>2.1 Types of malware ...................................................................................................... 3</i> </text>
<text top="270" left="198" width="616" height="17" font="10">2.1.1 Viruses ............................................................................................................... 3 </text>
<text top="290" left="216" width="598" height="17" font="10">2.1.1.1 Polymorphic viruses.................................................................................... 3 </text>
<text top="311" left="216" width="598" height="17" font="10">2.1.1.2 Metamorphic viruses................................................................................... 4 </text>
<text top="332" left="198" width="616" height="17" font="10">2.1.2 Trojans ............................................................................................................... 6 </text>
<text top="352" left="198" width="616" height="17" font="10">2.1.3 Worms................................................................................................................ 6 </text>
<text top="382" left="180" width="634" height="16" font="15"><i>2.2 Detection techniques ................................................................................................. 6</i> </text>
<text top="403" left="198" width="616" height="17" font="10">2.2.1 Signature based detection .................................................................................. 7 </text>
<text top="423" left="198" width="616" height="17" font="10">2.2.2 Anomaly based detection................................................................................... 7 </text>
<text top="444" left="198" width="616" height="17" font="10">2.2.3 HMM based detection........................................................................................ 7 </text>
<text top="484" left="162" width="652" height="16" font="13"><b>3. Hidden Markov Models................................................................................................ 8</b> </text>
<text top="513" left="180" width="634" height="16" font="15"><i>3.1 Introduction to HMM................................................................................................ 8</i> </text>
<text top="543" left="180" width="634" height="16" font="15"><i>3.2 Main features of HMM.............................................................................................. 9</i> </text>
<text top="563" left="198" width="616" height="17" font="10">3.2.1 HMM observations .......................................................................................... 14 </text>
<text top="584" left="198" width="616" height="17" font="10">3.2.2 Limitations of HMM........................................................................................ 15 </text>
<text top="614" left="180" width="634" height="16" font="15"><i>3.3 HMM based virus detection .................................................................................... 16</i> </text>
<text top="653" left="162" width="652" height="16" font="13"><b>4. Graph technique for metamorphic virus detection ................................................. 18</b> </text>
<text top="682" left="180" width="634" height="16" font="15"><i>4.1 Related work ........................................................................................................... 18</i> </text>
<text top="712" left="180" width="634" height="16" font="15"><i>4.2 Proposed solution ................................................................................................... 19</i> </text>
<text top="742" left="180" width="634" height="16" font="15"><i>4.3 Implementation details............................................................................................ 21</i> </text>
<text top="771" left="180" width="634" height="16" font="15"><i>4.4 Graph technique algorithm..................................................................................... 26</i> </text>
<text top="801" left="180" width="634" height="16" font="15"><i>4.5 Flow of the graph technique ................................................................................... 26</i> </text>
<text top="840" left="162" width="652" height="16" font="13"><b>5. Similarity score calculation and analysis.................................................................. 27</b> </text>
<text top="869" left="180" width="634" height="16" font="15"><i>5.1 Data collection........................................................................................................ 27</i> </text>
<text top="899" left="180" width="634" height="16" font="15"><i>5.2 Test cases ................................................................................................................ 28</i> </text>
<text top="919" left="198" width="616" height="17" font="10">5.2.1 Metamorphic virus versus metamorphic virus................................................. 29 </text>
<text top="940" left="198" width="616" height="17" font="10">5.2.2 Normal file versus normal file (benign files)................................................... 29 </text>
<text top="961" left="198" width="616" height="17" font="10">5.2.3 Benign file versus metamorphic virus ............................................................. 30 </text>
<text top="981" left="198" width="616" height="17" font="10">5.2.4 Benign file versus other virus .......................................................................... 32 </text>
<text top="1002" left="198" width="616" height="17" font="10">5.2.5 Combined graph............................................................................................... 33 </text>
<text top="1032" left="180" width="634" height="16" font="15"><i>5.3 Comparing 10 benign files with 10 metamorphic files ........................................... 34</i> </text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="476" width="24" height="17" font="10">vii </text>
<text top="138" left="198" width="616" height="17" font="10">5.3.1 Average score calculation ................................................................................ 35 </text>
<text top="168" left="180" width="634" height="16" font="15"><i>5.4 Comparing 10 metamorphic virus files................................................................... 36</i> </text>
<text top="198" left="180" width="634" height="16" font="15"><i>5.5 Parameter variations in the formula....................................................................... 37</i> </text>
<text top="218" left="198" width="616" height="17" font="10">5.5.1 First variation ................................................................................................... 37 </text>
<text top="239" left="198" width="616" height="17" font="10">5.5.2 Second variation............................................................................................... 40 </text>
<text top="260" left="198" width="616" height="17" font="10">5.5.3 Third variation ................................................................................................. 42 </text>
<text top="280" left="198" width="616" height="17" font="10">5.5.4 Fourth variation................................................................................................ 43 </text>
<text top="301" left="198" width="616" height="17" font="10">5.5.5 Fifth variation................................................................................................... 44 </text>
<text top="341" left="162" width="652" height="16" font="13"><b>6. Observations................................................................................................................ 45</b> </text>
<text top="380" left="162" width="652" height="16" font="13"><b>7. Analysis of graph technique....................................................................................... 47</b> </text>
<text top="418" left="162" width="652" height="16" font="13"><b>8. Attacks on the graph technique ................................................................................. 48</b> </text>
<text top="447" left="180" width="634" height="16" font="15"><i>8.1 Removing distinct instructions................................................................................ 48</i> </text>
<text top="477" left="180" width="634" height="16" font="15"><i>8.2 Using a morphing engine........................................................................................ 50</i> </text>
<text top="497" left="198" width="536" height="17" font="10">8.2.1 Morphing engine based on subroutine code insertion and instruction </text>
<text top="518" left="198" width="616" height="17" font="10">substitution................................................................................................................ 50 </text>
<text top="539" left="216" width="598" height="17" font="10">8.2.1.1 Comparing HMM and graph based detection........................................... 52 </text>
<text top="559" left="198" width="616" height="17" font="10">8.2.2 Morphing engine based on block dead code insertion..................................... 53 </text>
<text top="580" left="216" width="598" height="17" font="10">8.2.2.1 Comparing HMM and graph based detection for block morphing........... 56 </text>
<text top="601" left="198" width="616" height="17" font="10">8.2.3 Morphing engine based on random dead code insertion ................................. 58 </text>
<text top="622" left="216" width="598" height="17" font="10">8.2.3.1 Comparing HMM and graph based detection for random morphing ....... 59 </text>
<text top="652" left="180" width="634" height="16" font="15"><i>8.3 Reason behind all morphing results for graph based detection ............................. 61</i> </text>
<text top="691" left="162" width="652" height="16" font="13"><b>9. Conclusion ................................................................................................................... 64</b> </text>
<text top="730" left="162" width="652" height="16" font="13"><b>10. Future work ............................................................................................................... 67</b> </text>
<text top="768" left="162" width="652" height="16" font="13"><b>References ........................................................................................................................ 68</b> </text>
<text top="807" left="162" width="652" height="16" font="13"><b>Appendix A: More frequent assembly instructions [21] ............................................. 73</b> </text>
<text top="846" left="162" width="652" height="16" font="13"><b>Appendix B: Additional scores and graphs .................................................................. 74</b> </text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="474" width="29" height="17" font="10">viii </text>
<text top="139" left="430" width="116" height="16" font="13"><b>List of Figures </b></text>
<text top="160" left="486" width="4" height="16" font="13"><b> </b></text>
<text top="180" left="162" width="652" height="17" font="10">Figure 1: Metamorphic virus generations [32] ................................................................... 4 </text>
<text top="221" left="162" width="652" height="17" font="10">Figure 2: Anatomy of a metamorphic engine [33].............................................................. 5 </text>
<text top="262" left="162" width="652" height="17" font="10">Figure 3: Generic Hidden Markov Model [17]................................................................... 9 </text>
<text top="304" left="162" width="652" height="17" font="10">Figure 4: Similarity graphs of the NGVCK pair............................................................... 16 </text>
<text top="345" left="162" width="652" height="17" font="10">Figure 5: Bi-directed graph created using the matrix in Table 6 ...................................... 25 </text>
<text top="387" left="162" width="652" height="17" font="10">Figure 6: Flow of the graph technique.............................................................................. 27 </text>
<text top="428" left="162" width="652" height="17" font="10">Figure 7: Similarity scores of metamorphic virus files..................................................... 29 </text>
<text top="469" left="162" width="652" height="17" font="10">Figure 8: Similarity scores for normal files ...................................................................... 30 </text>
<text top="511" left="162" width="652" height="17" font="10">Figure 9: Similarity score for normal versus metamorphic virus file............................... 31 </text>
<text top="552" left="162" width="652" height="17" font="10">Figure 10: Graph for normal file versus other viruses...................................................... 32 </text>
<text top="594" left="162" width="652" height="17" font="10">Figure 11: Graph for all types combined .......................................................................... 33 </text>
<text top="635" left="162" width="652" height="17" font="10">Figure 12: Showing graph for normal file versus metamorphic virus file........................ 34 </text>
<text top="676" left="162" width="652" height="17" font="10">Figure 13: Graph plotted after average score calculations................................................ 35 </text>
<text top="718" left="162" width="652" height="17" font="10">Figure 14: Metamorphic virus versus metamorphic virus ................................................ 36 </text>
<text top="759" left="162" width="652" height="17" font="10">Figure 15: Graph showing match and non-match case together....................................... 37 </text>
<text top="801" left="162" width="652" height="17" font="10">Figure 16: Result of first variation for match case ........................................................... 38 </text>
<text top="842" left="162" width="652" height="17" font="10">Figure 17: Result of first variation for non-match case .................................................... 39 </text>
<text top="883" left="162" width="652" height="17" font="10">Figure 18: Result of first variation.................................................................................... 40 </text>
<text top="925" left="162" width="652" height="17" font="10">Figure 19: Result of second variation ............................................................................... 41 </text>
<text top="966" left="162" width="652" height="17" font="10">Figure 20: Result of third variation................................................................................... 42 </text>
<text top="1008" left="162" width="652" height="17" font="10">Figure 21: Result of fourth variation ................................................................................ 43 </text>
</page>
<page number="10" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="479" width="19" height="17" font="10">ix </text>
<text top="138" left="162" width="652" height="17" font="10">Figure 22: Result of fifth variation ................................................................................... 44 </text>
<text top="180" left="162" width="652" height="17" font="10">Figure 23: Equation 1 results for both the cases ............................................................... 46 </text>
<text top="221" left="162" width="652" height="17" font="10">Figure 24: Graph for different files after instruction removal attack................................ 48 </text>
<text top="262" left="162" width="652" height="17" font="10">Figure 25: Graph to compare similar and different files after attack................................ 49 </text>
<text top="304" left="162" width="652" height="17" font="10">Figure 26: 30% subroutine code inserted in metamorphic virus files .............................. 51 </text>
<text top="345" left="162" width="652" height="17" font="10">Figure 27: 40% subroutine code inserted in metamorphic virus files .............................. 51 </text>
<text top="387" left="162" width="652" height="17" font="10">Figure 28: HMM based detection results with 30% subroutines copied [7]..................... 53 </text>
<text top="428" left="162" width="652" height="17" font="10">Figure 29: Scores for block morphed metamorphic viruses ............................................. 54 </text>
<text top="469" left="162" width="652" height="17" font="10">Figure 30: Metamorphic and benign versus morphed metamorphic virus ....................... 55 </text>
<text top="511" left="162" width="652" height="17" font="10">Figure 31: Metamorphic versus other benign ................................................................... 55 </text>
<text top="552" left="162" width="652" height="17" font="10">Figure 32: HMM - 30% block morphed scores ................................................................ 56 </text>
<text top="594" left="162" width="652" height="17" font="10">Figure 33: HMM - 100% block morphed results.............................................................. 57 </text>
<text top="635" left="162" width="652" height="17" font="10">Figure 34: Randomly morphed metamorphic viruses versus benign files........................ 59 </text>
<text top="676" left="162" width="652" height="17" font="10">Figure 35: HMM - 30% random morphed results ............................................................ 60 </text>
<text top="718" left="162" width="652" height="17" font="10">Figure 36: HMM - 100% random morphed results .......................................................... 61 </text>
<text top="759" left="162" width="652" height="17" font="10">Figure 37: Block morph example ..................................................................................... 62 </text>
<text top="801" left="162" width="652" height="17" font="10">Figure 38: Random morph example ................................................................................. 63 </text>
<text top="842" left="162" width="652" height="17" font="10">Figure 39: Graph with all comparisons............................................................................. 74 </text>
<text top="883" left="162" width="652" height="17" font="10">Figure 40: 30% junk code inserted ................................................................................... 77 </text>
<text top="925" left="162" width="652" height="17" font="10">Figure 41: 30% dead code inserted ................................................................................... 77 </text>
<text top="966" left="162" width="652" height="17" font="10">Figure 42: 40% dead code inserted ................................................................................... 78 </text>
<text top="1008" left="162" width="652" height="17" font="10">Figure 43: 40% junk code inserted ................................................................................... 78 </text>
</page>
<page number="11" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="481" width="14" height="17" font="10">x </text>
<text top="138" left="162" width="652" height="17" font="10">Figure 44: Consolidated block morph HMM results for metamorphic viruses ................ 79 </text>
<text top="180" left="162" width="652" height="17" font="10">Figure 45: Consolidated block morph HMM results for benign files............................... 79 </text>
<text top="221" left="162" width="652" height="17" font="10">Figure 46: Consolidated random morph HMM results for metamorphic viruses............. 80 </text>
<text top="262" left="162" width="652" height="17" font="10">Figure 47: Consolidated random morph HMM results for benign files ........................... 80 </text>
</page>
<page number="12" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="479" width="19" height="17" font="10">xi </text>
<text top="139" left="433" width="110" height="16" font="13"><b>List of Tables </b></text>
<text top="181" left="486" width="4" height="16" font="13"><b> </b></text>
<text top="200" left="162" width="652" height="17" font="10">Table 1: Final trained HMM for English Text.................................................................. 11 </text>
<text top="242" left="162" width="652" height="17" font="10">Table 2: Final trained HMM for other texts...................................................................... 13 </text>
<text top="283" left="162" width="652" height="17" font="10">Table 3: Comparison of logarithmic probabilities ............................................................ 14 </text>
<text top="325" left="162" width="652" height="17" font="10">Table 4: Assembly language instruction traces for graph creation................................... 22 </text>
<text top="366" left="162" width="652" height="17" font="10">Table 5: Matrix created using assembly language instruction counts .............................. 23 </text>
<text top="407" left="162" width="652" height="17" font="10">Table 6: Normalized sparse matrix to make it row stochastic .......................................... 24 </text>
<text top="449" left="162" width="652" height="17" font="10">Table 7: Maximum and minimum scores ......................................................................... 33 </text>
<text top="490" left="162" width="652" height="17" font="10">Table 8: First variation scores........................................................................................... 39 </text>
<text top="532" left="162" width="652" height="17" font="10">Table 9: First variation - false positives and negatives..................................................... 39 </text>
<text top="573" left="162" width="652" height="17" font="10">Table 10: Second variation scores .................................................................................... 41 </text>
<text top="614" left="162" width="652" height="17" font="10">Table 11: Second variation - false positives and negatives .............................................. 41 </text>
<text top="656" left="162" width="652" height="17" font="10">Table 12: Third variation score......................................................................................... 42 </text>
<text top="697" left="162" width="652" height="17" font="10">Table 13: Fourth variation score ....................................................................................... 43 </text>
<text top="739" left="162" width="652" height="17" font="10">Table 14: Fifth variation score .......................................................................................... 44 </text>
<text top="780" left="162" width="652" height="17" font="10">Table 15: Comparison between parameter variations....................................................... 46 </text>
<text top="821" left="162" width="652" height="17" font="10">Table 16:  Comparison between normalized parameter variations................................... 46 </text>
<text top="863" left="162" width="652" height="17" font="10">Table 17: Different file scores .......................................................................................... 49 </text>
<text top="904" left="162" width="652" height="17" font="10">Table 18: Number of false positives / negatives after the attack ...................................... 49 </text>
<text top="946" left="162" width="652" height="17" font="10">Table 19: Scores for graph based technique ..................................................................... 52 </text>
<text top="987" left="162" width="652" height="17" font="10">Table 20: False positives / negatives in graph based technique........................................ 52 </text>
<text top="1028" left="162" width="652" height="17" font="10">Table 21: HMM based detection results with 30% subroutine insertion.......................... 52 </text>
</page>
<page number="13" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="476" width="24" height="17" font="10">xii </text>
<text top="138" left="162" width="652" height="17" font="10">Table 22: HMM - Minimum and maximum scores .......................................................... 56 </text>
<text top="180" left="162" width="652" height="17" font="10">Table 23: HMM - 30% false scores .................................................................................. 57 </text>
<text top="221" left="162" width="652" height="17" font="10">Table 24: HMM - 100% false scores ................................................................................ 58 </text>
<text top="262" left="162" width="652" height="17" font="10">Table 25: HMM - 30% false scores .................................................................................. 60 </text>
<text top="304" left="162" width="652" height="17" font="10">Table 26: HMM - 30% false scores .................................................................................. 61 </text>
<text top="345" left="162" width="4" height="17" font="10"> </text>
</page>
<page number="14" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="486" width="4" height="17" font="10"> </text>
<text top="1117" left="474" width="29" height="17" font="10">xiii </text>
<text top="139" left="420" width="137" height="16" font="13"><b>List of Equations </b></text>
<text top="181" left="486" width="4" height="16" font="13"><b> </b></text>
<text top="221" left="162" width="652" height="17" font="10">Equation 1: Formula for calculating similarity score [11]................................................ 25 </text>
<text top="262" left="162" width="652" height="17" font="10">Equation 2: Squaring the difference and take the summation .......................................... 38 </text>
<text top="304" left="162" width="170" height="17" font="10">Equation 3: Removed n</text>
<text top="300" left="332" width="6" height="11" font="6">2</text>
<text top="304" left="339" width="475" height="17" font="10"> from Equation 2 ........................................................................ 40 </text>
<text top="345" left="162" width="176" height="17" font="10">Equation 4: Removing n</text>
<text top="341" left="338" width="6" height="11" font="6">2</text>
<text top="345" left="345" width="469" height="17" font="10"> from Equation 1....................................................................... 42 </text>
<text top="387" left="162" width="652" height="17" font="10">Equation 5: Keeping only n in Equation 1........................................................................ 43 </text>
<text top="428" left="162" width="172" height="17" font="10">Equation 6: Replaced N</text>
<text top="424" left="334" width="6" height="11" font="6">2</text>
<text top="428" left="340" width="80" height="17" font="10"> with (110)</text>
<text top="424" left="420" width="6" height="11" font="6">2</text>
<text top="428" left="426" width="387" height="17" font="10"> in Equation 1 ......................................................... 44 </text>
</page>
<page number="15" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="16" size="21" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">1 </text>
<text top="131" left="135" width="174" height="22" font="16"><b>1. Introduction </b></text>
<text top="161" left="135" width="4" height="17" font="10"> </text>
<text top="182" left="135" width="611" height="17" font="10">Malicious softwares are concerns for many organizations [25]. Various reports were </text>
<text top="223" left="135" width="644" height="17" font="10">created and analyzed to find total loss occurred due to malicious softwares. According to </text>
<text top="265" left="135" width="643" height="17" font="10">[24] [25], overall effect of damages ranges from US$ 13.2 billion to US$ 67.2 billion for </text>
<text top="306" left="135" width="642" height="17" font="10">US business alone. A report [26] has a list of top ten malicious software profiles of 2006 </text>
<text top="348" left="135" width="644" height="17" font="10">where Mytob, Sdbot, and Netsky were ranked in first three. There are various techniques </text>
<text top="389" left="135" width="604" height="17" font="10">available for virus detection. But with each improvement in detection, virus writers </text>
<text top="430" left="135" width="554" height="17" font="10">attempt to improve their virus implementations so as to evade detection [1].  </text>
<text top="472" left="135" width="4" height="17" font="10"> </text>
<text top="513" left="135" width="645" height="17" font="10">According to an analysis discussed in [25], it is revealed that on average, only 48.16% of </text>
<text top="555" left="135" width="640" height="17" font="10">malware was detected by popular antivirus programs. Recent common types of malware </text>
<text top="596" left="135" width="591" height="17" font="10">include Trojans, worms, and polymorphic viruses [2]. Although not yet common, </text>
<text top="637" left="135" width="605" height="17" font="10">metamorphic viruses could present the most difficult detection challenge to date. In </text>
<text top="679" left="135" width="637" height="17" font="10">metamorphic viruses, virus writers do not have to explicitly write different undetectable </text>
<text top="720" left="135" width="635" height="17" font="10">viruses. They just have to create one virus and then use morph engines [12] to create its </text>
<text top="762" left="135" width="560" height="17" font="10">copies which will have similar functionality but different body structures [3]. </text>
<text top="803" left="135" width="4" height="17" font="10"> </text>
<text top="844" left="135" width="603" height="17" font="10">We have analyzed a graph based malware detection technique proposed in [4]. Our </text>
<text top="886" left="135" width="606" height="17" font="10">technique is inspired by the approach followed in [4]. As in [4], we create weighted </text>
<text top="927" left="135" width="601" height="17" font="10">directed graphs based on instruction counts and then directly compare the resultant </text>
<text top="969" left="135" width="627" height="17" font="10">graphs to compare the similarity of executable files. Our approach differs significantly </text>
<text top="1010" left="135" width="580" height="17" font="10">from [4] in a way that we use a much simpler method for comparing the graphs. </text>
<text top="1051" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="16" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">2 </text>
<text top="111" left="135" width="643" height="17" font="10">Following sections provide detailed information about the proposed graph technique and </text>
<text top="153" left="135" width="120" height="17" font="10">related analysis. </text>
<text top="192" left="162" width="549" height="21" font="10">•  Section 2 introduces different types of malicious software and detection </text>
<text top="237" left="189" width="86" height="17" font="10">techniques. </text>
<text top="276" left="162" width="612" height="21" font="10">•  Section 3 discusses Hidden Markov Model (HMM) and virus detection based on </text>
<text top="321" left="189" width="54" height="17" font="10">HMM. </text>
<text top="360" left="162" width="609" height="21" font="10">•  Section 4 explains the implementation details of graph based metamorphic virus </text>
<text top="405" left="189" width="75" height="17" font="10">detection. </text>
<text top="444" left="162" width="413" height="21" font="10">•  Section 5 shows various test cases and their analysis. </text>
<text top="487" left="162" width="613" height="21" font="10">•  Section 6 deals with detailed observations of all test cases discussed in section 5. </text>
<text top="529" left="162" width="402" height="21" font="10">•  Section 7 analyses graph technique and its features. </text>
<text top="572" left="162" width="607" height="21" font="10">•  Section 8 contains information about attacks carried out on the graph technique. </text>
<text top="615" left="162" width="441" height="21" font="10">•  Section 9 concludes about the proposed graph technique. </text>
<text top="657" left="162" width="491" height="21" font="10">•  Section 10 discusses future work related to the graph technique. </text>
<text top="722" left="135" width="424" height="22" font="16"><b>2. Malware and detection techniques </b></text>
<text top="753" left="135" width="4" height="17" font="10"> </text>
<text top="773" left="135" width="588" height="17" font="10">Malware is nothing but a program developed to perform malicious activities on a </text>
<text top="815" left="135" width="651" height="17" font="10">computer. These activities could harm the computer data or could simply be intended as a </text>
<text top="856" left="135" width="588" height="17" font="10">prank. Malware can be a source of revenue for a malware writer. Hence there are </text>
<text top="898" left="135" width="642" height="17" font="10">different intentions behind different types of malware. If a computer is infected with any </text>
<text top="939" left="135" width="621" height="17" font="10">type of malware, then the malware needs to be caught and removed to avoid any loss. </text>
<text top="980" left="135" width="322" height="17" font="10">This can be done using anti-virus softwares. </text>
<text top="1022" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="17" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="17" size="19" family="Times" color="#000000"/>
	<fontspec id="18" size="17" family="Times" color="#000000"/>
	<fontspec id="19" size="19" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">3 </text>
<text top="112" left="135" width="217" height="20" font="17"><i><b>2.1 Types of malware </b></i></text>
<text top="140" left="135" width="4" height="17" font="10"> </text>
<text top="161" left="135" width="587" height="17" font="10">Malicious software, commonly known as malware, tends to affect more than one </text>
<text top="202" left="135" width="609" height="17" font="10">computer at an instance. Some malware are downloaded unknowingly and executed </text>
<text top="243" left="135" width="523" height="17" font="10">without appropriate permissions. Following are a few types of malware. </text>
<text top="285" left="135" width="125" height="18" font="18"><b>2.1.1 Viruses </b></text>
<text top="330" left="135" width="644" height="17" font="10">Initially, viruses were created to stay in the boot sectors of floppy disks so that whenever </text>
<text top="371" left="135" width="625" height="17" font="10">an infected system is booted, that virus will also get executed [28]. The executables of </text>
<text top="412" left="135" width="642" height="17" font="10">viruses need human interaction to get spread onto other computers [25]. If a user uses an </text>
<text top="454" left="135" width="645" height="17" font="10">external drive to copy some data which is already infected by such viruses, then that host </text>
<text top="495" left="135" width="618" height="17" font="10">system will also get infected. “Viruses have ability to reproduce themselves infecting </text>
<text top="537" left="135" width="227" height="17" font="10">other files and programs” [27]. </text>
<text top="580" left="135" width="252" height="19" font="19"><b>2.1.1.1 Polymorphic viruses </b></text>
<text top="626" left="135" width="633" height="17" font="10">These types of viruses are encrypted and spread along with their decryptor body and an </text>
<text top="668" left="135" width="638" height="17" font="10">encrypted mutation engine [29]. The base virus remains as it is, only the decryptor body </text>
<text top="709" left="135" width="634" height="17" font="10">changes. Once these viruses are copied or downloaded, the decryptor body decrypts the </text>
<text top="750" left="135" width="626" height="17" font="10">virus and the mutation engine, to infect the host machine. The mutation engine creates </text>
<text top="792" left="135" width="624" height="17" font="10">randomized decryptor body and attaches it to the newly encrypted virus body with the </text>
<text top="833" left="135" width="622" height="17" font="10">new key on each infection [29]. So on every new infection, a new decryptor and virus </text>
<text top="875" left="135" width="628" height="17" font="10">body is generated. Heuristic analysis using sandbox can be used to detect polymorphic </text>
<text top="916" left="135" width="95" height="17" font="10">viruses [30]. </text>
<text top="957" left="135" width="4" height="17" font="10"> </text>
<text top="999" left="135" width="4" height="17" font="10"> </text>
<text top="1040" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="18" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">4 </text>
<text top="113" left="135" width="259" height="19" font="19"><b>2.1.1.2 Metamorphic viruses </b></text>
<text top="164" left="135" width="649" height="17" font="10">Metamorphic viruses are different than polymorphic viruses. Metamorphic virus does not </text>
<text top="205" left="135" width="651" height="17" font="10">carry a decryptor or encrypted virus body [31]. “Main goal of metamorphism is to change </text>
<text top="247" left="135" width="641" height="17" font="10">the appearance of the virus while keeping its functionality” [3]. Figure 1 shows different </text>
<text top="288" left="135" width="593" height="17" font="10">generations of a metamorphic virus where the shape changes but the functionality </text>
<text top="330" left="135" width="138" height="17" font="10">remains the same.  </text>
<text top="841" left="685" width="4" height="17" font="10"> </text>
<text top="879" left="283" width="356" height="16" font="13"><b>Figure 1: Metamorphic virus generations [32] </b></text>
<text top="898" left="135" width="4" height="17" font="10"> </text>
<text top="940" left="135" width="636" height="17" font="10">Body structure of a metamorphic virus changes its shape from generation to generation. </text>
<text top="981" left="135" width="651" height="17" font="10">This is done using metamorphic engine. The anatomy of a metamorphic engine is showed </text>
</page>
<page number="19" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">5 </text>
<text top="111" left="135" width="574" height="17" font="10">in Figure 2. There are different modules like locate own code, decode, analyze, </text>
<text top="153" left="135" width="166" height="17" font="10">transform, and attach.  </text>
<text top="457" left="590" width="4" height="17" font="10"> </text>
<text top="495" left="271" width="380" height="16" font="13"><b>Figure 2: Anatomy of a metamorphic engine [33] </b></text>
<text top="514" left="135" width="4" height="17" font="10"> </text>
<text top="556" left="135" width="642" height="17" font="10">As stated in [33] [3], Locate own code module is used to find own code. Decode module </text>
<text top="597" left="135" width="591" height="17" font="10">provides the virus decode information which is needed in transformation process. </text>
<text top="639" left="135" width="648" height="17" font="10">Analyze module is used to construct register liveliness. Transform module transforms the </text>
<text top="680" left="135" width="627" height="17" font="10">code into some other equivalent code. Finally, attach module is used to bind the newly </text>
<text top="721" left="135" width="387" height="17" font="10">created virus file with a new host program or file [3]. </text>
<text top="763" left="135" width="4" height="17" font="10"> </text>
<text top="804" left="135" width="581" height="17" font="10">In transform module, virus copies are transformed using techniques like register </text>
<text top="846" left="135" width="639" height="17" font="10">swapping, code obfuscation, transposition, and subroutine permutation [3]. Examples of </text>
<text top="887" left="135" width="564" height="17" font="10">metamorphic engines are Next Generation Virus Construction Kit (NGVCK), </text>
<text top="928" left="135" width="611" height="17" font="10">Phalcon/Skism Mass-Produced Code generator (PS-MPC), Second Generation virus </text>
<text top="970" left="135" width="621" height="17" font="10">generator (G2), Mass Code Generator (MPCGEN) [34]. According to [6], NGVCK is </text>
<text top="1011" left="135" width="651" height="17" font="10">more effective in creating metamorphic viruses with different generations but keeping the </text>
<text top="1053" left="135" width="324" height="17" font="10">exact functionality similar to the base virus.  </text>
</page>
<page number="20" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">6 </text>
<text top="112" left="135" width="124" height="18" font="18"><b>2.1.2 Trojans </b></text>
<text top="161" left="135" width="641" height="17" font="10">Trojan horse is a malicious program which gets stored on the host machine by luring the </text>
<text top="202" left="135" width="577" height="17" font="10">user as it is a benign software or a file [14]. When user clicks on a link or email </text>
<text top="243" left="135" width="622" height="17" font="10">attachments or downloads a file which looks familiar to user, Trojan horse gets stored </text>
<text top="285" left="135" width="504" height="17" font="10">and executed without the knowledge of the user or the administrator.  </text>
<text top="326" left="135" width="608" height="17" font="10">The purpose of a Trojan horse could be to get remote access, download and execute </text>
<text top="368" left="135" width="639" height="17" font="10">malware or to steal information from the infected system [14]. Trojans do not reproduce </text>
<text top="409" left="135" width="321" height="17" font="10">or self-replicate like viruses or worms [27].  </text>
<text top="469" left="135" width="120" height="18" font="18"><b>2.1.3 Worms </b></text>
<text top="518" left="135" width="637" height="17" font="10">Worm is a program that replicates itself over the internet or computer networks and it is </text>
<text top="559" left="135" width="636" height="17" font="10">done without any human intervention [15] [27].  Worm is a macro residing in a word or </text>
<text top="601" left="135" width="627" height="17" font="10">excel document that spreads itself across the network. This document travels from one </text>
<text top="642" left="135" width="436" height="17" font="10">computer to another infecting all intermediate systems [15]. </text>
<text top="683" left="135" width="634" height="17" font="10">Worms saturate the network and collapse it by reproducing itself. Some worms sent via </text>
<text top="725" left="135" width="409" height="17" font="10">emails include: Navidad, Pretty Park, Happy99 etc [27]. </text>
<text top="785" left="135" width="253" height="20" font="17"><i><b>2.2 Detection techniques </b></i></text>
<text top="837" left="135" width="616" height="17" font="10">As there are different types of malware, there are many types of detection techniques </text>
<text top="878" left="135" width="583" height="17" font="10">available. Most common and fast technique is signature based detection. Second </text>
<text top="920" left="135" width="645" height="17" font="10">technique is anomaly based detection which is good in detecting new malware. But these </text>
<text top="961" left="135" width="628" height="17" font="10">techniques have inadequacies to detect each and every malware [16]. Next subsections </text>
<text top="1002" left="135" width="317" height="17" font="10">discuss these detection techniques in detail. </text>
</page>
<page number="21" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">7 </text>
<text top="112" left="135" width="298" height="18" font="18"><b>2.2.1 Signature based detection </b></text>
<text top="161" left="135" width="637" height="17" font="10">Signature based detection is popular due to its simplicity, faster detection, and less false </text>
<text top="202" left="135" width="649" height="17" font="10">positives [35]. This technique looks for specific signature, a sequence of specific opcodes </text>
<text top="243" left="135" width="627" height="17" font="10">in a file to detect and classify it as a benign or virus file. It uses signature dictionary or </text>
<text top="285" left="135" width="651" height="17" font="10">database to compare with existing virus signatures [36]. Although it seems much easier to </text>
<text top="326" left="135" width="592" height="17" font="10">implement, it is not effective in case of new malware since the signatures for new </text>
<text top="368" left="135" width="637" height="17" font="10">malware will not be present in the database. Hence, this technique keeps on updating its </text>
<text top="409" left="135" width="609" height="17" font="10">database for up-to-date virus detections. Also, this detection technique can easily be </text>
<text top="450" left="135" width="603" height="17" font="10">defeated by simple code obfuscation techniques used to change the signature of the </text>
<text top="492" left="135" width="105" height="17" font="10">malware [35]. </text>
<text top="552" left="135" width="290" height="18" font="18"><b>2.2.2 Anomaly based detection </b></text>
<text top="601" left="135" width="633" height="17" font="10">This technique is efficient in detecting zero-day malware [16] as compared to signature </text>
<text top="642" left="135" width="648" height="17" font="10">based detection technique. There are two phases in anomaly based detection, training and </text>
<text top="683" left="135" width="579" height="17" font="10">detection [16]. During training phase the scanner learns about normal as well as </text>
<text top="725" left="135" width="643" height="17" font="10">malicious behavior. Malicious behavior means a behavior which changes or accesses the </text>
<text top="766" left="135" width="638" height="17" font="10">system data without the authoritative permissions. Once the scanner is trained, it is used </text>
<text top="808" left="135" width="651" height="17" font="10">to detect such malicious activities and take the appropriate actions [16]. But it has its own </text>
<text top="849" left="135" width="644" height="17" font="10">disadvantages. This technique has more false positives or negatives as compared to other </text>
<text top="890" left="135" width="522" height="17" font="10">detection techniques and secondly it is more complex and costlier [16].  </text>
<text top="950" left="135" width="254" height="18" font="18"><b>2.2.3 HMM based detection </b></text>
<text top="999" left="135" width="640" height="17" font="10">Hidden Markov Model (HMM) based virus detection is a new technique as compared to </text>
<text top="1040" left="135" width="644" height="17" font="10">above two techniques. HMM works as a state machine [6]. It helps in finding probability </text>
</page>
<page number="22" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">8 </text>
<text top="111" left="135" width="644" height="17" font="10">of transition from one state to another. Once the HMM is trained, it can be used to detect </text>
<text top="153" left="135" width="626" height="17" font="10">or differentiate between malware and benign software. It is discussed in more detail in </text>
<text top="194" left="135" width="103" height="17" font="10">later sections. </text>
<text top="255" left="135" width="294" height="22" font="16"><b>3. Hidden Markov Models </b></text>
<text top="313" left="135" width="641" height="17" font="10">There has been a lot of work done on Hidden Markov Model (HMM) for virus detection </text>
<text top="355" left="135" width="627" height="17" font="10">[17][6]. A threshold represents a value or a range where scores of benign software and </text>
<text top="396" left="135" width="587" height="17" font="10">malware do not overlap. Using such threshold, benign files and virus files can be </text>
<text top="437" left="135" width="572" height="17" font="10">distinguished. Technique in [6] was quite successful in finding the threshold to </text>
<text top="479" left="135" width="632" height="17" font="10">distinguish between malware and benign software. This section concentrates on HMM, </text>
<text top="520" left="135" width="460" height="17" font="10">its features, HMM for plain text, and HMM for virus detection. </text>
<text top="580" left="135" width="245" height="20" font="17"><i><b>3.1 Introduction to HMM </b></i></text>
<text top="632" left="135" width="606" height="17" font="10">“Hidden Markov Model is based on pattern analysis” [35] and used to find the state </text>
<text top="674" left="135" width="649" height="17" font="10">transition probabilities. It is mainly used in language recognition [17], speech recognition </text>
<text top="715" left="135" width="586" height="17" font="10">[18], and now in virus detection [6]. Here HMM is thoroughly experimented and </text>
<text top="757" left="135" width="651" height="17" font="10">analyzed for plain English text pattern to understand its working. A pattern or structure of </text>
<text top="798" left="135" width="648" height="17" font="10">the software is a sequence in which instructions are written and a way the program flows. </text>
<text top="839" left="135" width="634" height="17" font="10">Malware also has different structures as compared to benign software structures. In this </text>
<text top="881" left="135" width="614" height="17" font="10">paper, we will also compare HMM based virus detection with newly proposed graph </text>
<text top="922" left="135" width="79" height="17" font="10">technique. </text>
<text top="982" left="135" width="6" height="20" font="17"><i><b> </b></i></text>
<text top="1049" left="135" width="6" height="20" font="17"><i><b> </b></i></text>
</page>
<page number="23" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="454" width="13" height="17" font="10">9 </text>
<text top="112" left="135" width="258" height="20" font="17"><i><b>3.2 Main features of HMM </b></i></text>
<text top="164" left="135" width="639" height="17" font="10">HMM for plain English text [17] is so effective that after executing it for an observation </text>
<text top="205" left="135" width="583" height="17" font="10">string of 50000 characters, it distinguishes vowels and consonants in two states.  </text>
<text top="247" left="135" width="490" height="17" font="10">Before analyzing HMM, following are the notations used in HMM. </text>
<text top="288" left="189" width="319" height="17" font="10">“T = the length of the observation sequence </text>
<text top="330" left="189" width="277" height="17" font="10">N = the number of states in the model </text>
<text top="371" left="189" width="294" height="17" font="10">M = the number of observation symbols </text>
<text top="412" left="189" width="50" height="17" font="10">Q = {q</text>
<text top="419" left="239" width="6" height="11" font="6">0</text>
<text top="412" left="245" width="18" height="17" font="10">, q</text>
<text top="419" left="263" width="6" height="11" font="6">1</text>
<text top="412" left="269" width="54" height="17" font="10">, . . . , q</text>
<text top="419" left="323" width="21" height="11" font="6">N−1</text>
<text top="412" left="344" width="264" height="17" font="10">} = the states of the Markov process </text>
<text top="454" left="189" width="383" height="17" font="10">V = {0, 1, . . . ,M − 1} = set of possible observations </text>
<text top="495" left="189" width="263" height="17" font="10">A = the state transition probabilities </text>
<text top="537" left="189" width="281" height="17" font="10">B = the observation probability matrix </text>
<text top="574" left="191" width="10" height="22" font="5">π</text>
<text top="579" left="206" width="217" height="17" font="10"> = the initial state distribution </text>
<text top="620" left="189" width="51" height="17" font="10">O = (O</text>
<text top="627" left="240" width="6" height="11" font="6">0</text>
<text top="620" left="246" width="17" height="17" font="10">,O</text>
<text top="627" left="264" width="6" height="11" font="6">1</text>
<text top="620" left="270" width="53" height="17" font="10">, . . . ,O</text>
<text top="627" left="323" width="20" height="11" font="6">T−1</text>
<text top="620" left="343" width="231" height="17" font="10">) = observation sequence.” [17] </text>
<text top="662" left="135" width="108" height="17" font="10">Here A, B and </text>
<text top="657" left="245" width="10" height="22" font="5">π</text>
<text top="662" left="260" width="485" height="17" font="10"> are row stochastic which means every element in a row sums to 1. </text>
<text top="703" left="135" width="295" height="17" font="10">Figure 3 shows a generic HMM where O</text>
<text top="710" left="430" width="6" height="11" font="6">i </text>
<text top="703" left="437" width="139" height="17" font="10">are observations, X</text>
<text top="710" left="576" width="3" height="11" font="6">i</text>
<text top="703" left="580" width="200" height="17" font="10"> are hidden states, A shows </text>
<text top="745" left="135" width="522" height="17" font="10">state transition probabilities, and B is an observation probability matrix. </text>
<text top="966" left="783" width="4" height="17" font="10"> </text>
<text top="1004" left="283" width="356" height="16" font="13"><b>Figure 3: Generic Hidden Markov Model [17] </b></text>
<text top="1024" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="24" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">10 </text>
<text top="111" left="135" width="632" height="17" font="10">The English plain text is taken from “Brown Corpus” [37] which has around 1,000,000 </text>
<text top="153" left="135" width="634" height="17" font="10">words. In this experiment, we have removed all special symbols and considered in total </text>
<text top="194" left="135" width="638" height="17" font="10">27 symbols containing all 26 alphabets and space. For English plain text, we considered </text>
<text top="235" left="135" width="644" height="17" font="10">value of N as 2 and M as 27 (26 alphabets + space). Consider T= 50000 observations. At </text>
<text top="277" left="135" width="153" height="17" font="10">start, each element in</text>
<text top="273" left="290" width="10" height="22" font="5">π</text>
<text top="277" left="305" width="421" height="17" font="10">and A are initialized to approximately 1/2 and B matrix is </text>
<text top="319" left="135" width="175" height="17" font="10">initialized to 1/27 [17].  </text>
<text top="356" left="374" width="10" height="22" font="5">π</text>
<text top="361" left="389" width="161" height="17" font="10"> = [0.51316  0.48684] </text>
<text top="417" left="366" width="32" height="17" font="10">A = </text>
<text top="419" left="542" width="7" height="21" font="10"></text>
<text top="432" left="542" width="7" height="21" font="10"></text>
<text top="402" left="542" width="7" height="21" font="10"></text>
<text top="419" left="401" width="7" height="21" font="10"></text>
<text top="432" left="401" width="7" height="21" font="10"></text>
<text top="402" left="401" width="7" height="21" font="10"></text>
<text top="431" left="496" width="45" height="17" font="10">48344</text>
<text top="431" left="492" width="4" height="17" font="10">.</text>
<text top="431" left="483" width="9" height="17" font="10">0</text>
<text top="431" left="421" width="45" height="17" font="10">51656</text>
<text top="431" left="417" width="4" height="17" font="10">.</text>
<text top="431" left="408" width="9" height="17" font="10">0</text>
<text top="404" left="496" width="45" height="17" font="10">52532</text>
<text top="404" left="492" width="4" height="17" font="10">.</text>
<text top="404" left="483" width="9" height="17" font="10">0</text>
<text top="404" left="421" width="45" height="17" font="10">47468</text>
<text top="404" left="417" width="4" height="17" font="10">.</text>
<text top="404" left="408" width="9" height="17" font="10">0</text>
<text top="417" left="552" width="4" height="17" font="10"> </text>
<text top="477" left="135" width="649" height="17" font="10">Once the initialization is done, next step is to train the model. After 500 iterations, we get </text>
<text top="519" left="135" width="50" height="17" font="10">trained</text>
<text top="514" left="187" width="10" height="22" font="5">π</text>
<text top="519" left="202" width="504" height="17" font="10">, A, and B matrices and logarithmic probability. Depending upon this </text>
<text top="560" left="135" width="648" height="17" font="10">logarithmic probability, threshold is decided. Here the probability threshold is noted after </text>
<text top="602" left="135" width="605" height="17" font="10">the model is trained for Brown Corpus plain text. Following is a brief algorithm for </text>
<text top="643" left="135" width="54" height="17" font="10">HMM. </text>
<text top="685" left="162" width="201" height="17" font="10">a.  Every matrix (A, B, and</text>
<text top="680" left="364" width="10" height="22" font="5">π</text>
<text top="685" left="379" width="135" height="17" font="10">) is row stochastic </text>
<text top="727" left="162" width="545" height="17" font="10">b.  Iteration contains forward and backward passes to train the model [17]. </text>
<text top="768" left="162" width="538" height="17" font="10">c.  It can be run for any number of iterations (no space complexity issue). </text>
<text top="809" left="162" width="544" height="17" font="10">d.  Using final values of all matrices, logarithmic probability is calculated. </text>
<text top="851" left="162" width="595" height="17" font="10">e.  Similarity between two texts is calculated by comparing their probabilities got </text>
<text top="892" left="189" width="181" height="17" font="10">from the trained models. </text>
<text top="934" left="135" width="645" height="17" font="10">It is observed that, bigger the observation string, stronger is the trained model. In table 1, </text>
<text top="975" left="135" width="370" height="17" font="10">all matrices and final probability value are shown.  </text>
<text top="1016" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="25" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">11 </text>
<text top="112" left="261" width="216" height="17" font="10">Observations for English text </text>
<text top="153" left="261" width="73" height="17" font="10">Matrix Pi </text>
<text top="196" left="270" width="152" height="17" font="10">0.00000   1.00000 </text>
<text top="217" left="261" width="4" height="17" font="10"> </text>
<text top="238" left="261" width="113" height="17" font="10">Final Matrix A </text>
<text top="259" left="270" width="152" height="17" font="10">0.25633   0.74367 </text>
<text top="281" left="270" width="152" height="17" font="10">0.71195   0.28805 </text>
<text top="302" left="261" width="4" height="17" font="10"> </text>
<text top="323" left="261" width="4" height="17" font="10"> </text>
<text top="343" left="261" width="111" height="17" font="10">Final Matrix B </text>
<text top="364" left="261" width="4" height="17" font="10"> </text>
<text top="386" left="315" width="15" height="17" font="10">a </text>
<text top="386" left="399" width="70" height="17" font="10">0.13956 </text>
<text top="386" left="548" width="70" height="17" font="10">0.00000 </text>
<text top="407" left="315" width="15" height="17" font="10">b </text>
<text top="407" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="407" left="548" width="70" height="17" font="10">0.02306 </text>
<text top="429" left="316" width="14" height="17" font="10">c </text>
<text top="429" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="429" left="548" width="70" height="17" font="10">0.05661 </text>
<text top="450" left="315" width="15" height="17" font="10">d </text>
<text top="450" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="450" left="548" width="70" height="17" font="10">0.06925 </text>
<text top="471" left="315" width="15" height="17" font="10">e </text>
<text top="471" left="399" width="70" height="17" font="10">0.21460 </text>
<text top="471" left="548" width="70" height="17" font="10">0.00000 </text>
<text top="493" left="320" width="10" height="17" font="10">f </text>
<text top="493" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="493" left="548" width="70" height="17" font="10">0.03547 </text>
<text top="514" left="316" width="15" height="17" font="10">g </text>
<text top="514" left="399" width="70" height="17" font="10">0.00016 </text>
<text top="514" left="548" width="70" height="17" font="10">0.02780 </text>
<text top="536" left="315" width="15" height="17" font="10">h </text>
<text top="536" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="536" left="548" width="70" height="17" font="10">0.07321 </text>
<text top="557" left="321" width="9" height="17" font="10">i </text>
<text top="557" left="399" width="70" height="17" font="10">0.12308 </text>
<text top="557" left="548" width="70" height="17" font="10">0.00000 </text>
<text top="579" left="321" width="9" height="17" font="10">j </text>
<text top="579" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="579" left="548" width="70" height="17" font="10">0.00364 </text>
<text top="600" left="316" width="14" height="17" font="10">k </text>
<text top="600" left="399" width="70" height="17" font="10">0.00177 </text>
<text top="600" left="548" width="70" height="17" font="10">0.00708 </text>
<text top="622" left="321" width="9" height="17" font="10">l </text>
<text top="622" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="622" left="548" width="70" height="17" font="10">0.07258 </text>
<text top="643" left="310" width="20" height="17" font="10">m </text>
<text top="643" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="643" left="548" width="70" height="17" font="10">0.03880 </text>
<text top="665" left="315" width="15" height="17" font="10">n </text>
<text top="665" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="665" left="548" width="70" height="17" font="10">0.11439 </text>
<text top="686" left="315" width="15" height="17" font="10">o </text>
<text top="686" left="399" width="70" height="17" font="10">0.13184 </text>
<text top="686" left="548" width="70" height="17" font="10">0.00000 </text>
<text top="707" left="315" width="15" height="17" font="10">p </text>
<text top="707" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="707" left="548" width="70" height="17" font="10">0.03703 </text>
<text top="729" left="316" width="15" height="17" font="10">q </text>
<text top="729" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="729" left="548" width="70" height="17" font="10">0.00153 </text>
<text top="750" left="319" width="11" height="17" font="10">r </text>
<text top="750" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="750" left="548" width="70" height="17" font="10">0.10202 </text>
<text top="772" left="316" width="14" height="17" font="10">s </text>
<text top="772" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="772" left="548" width="70" height="17" font="10">0.11024 </text>
<text top="793" left="320" width="10" height="17" font="10">t </text>
<text top="793" left="399" width="70" height="17" font="10">0.00971 </text>
<text top="793" left="548" width="70" height="17" font="10">0.14483 </text>
<text top="815" left="315" width="15" height="17" font="10">u </text>
<text top="815" left="399" width="70" height="17" font="10">0.04514 </text>
<text top="815" left="548" width="70" height="17" font="10">0.00000 </text>
<text top="836" left="317" width="14" height="17" font="10">v </text>
<text top="836" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="836" left="548" width="70" height="17" font="10">0.01617 </text>
<text top="858" left="313" width="18" height="17" font="10">w </text>
<text top="858" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="858" left="548" width="70" height="17" font="10">0.02298 </text>
<text top="879" left="317" width="14" height="17" font="10">x </text>
<text top="879" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="879" left="548" width="70" height="17" font="10">0.00446 </text>
<text top="900" left="317" width="14" height="17" font="10">y </text>
<text top="900" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="900" left="548" width="70" height="17" font="10">0.02599 </text>
<text top="922" left="317" width="14" height="17" font="10">z </text>
<text top="922" left="399" width="70" height="17" font="10">0.00000 </text>
<text top="922" left="548" width="70" height="17" font="10">0.00110 </text>
<text top="943" left="277" width="53" height="17" font="10">space </text>
<text top="943" left="399" width="70" height="17" font="10">0.33413 </text>
<text top="943" left="548" width="70" height="17" font="10">0.01178 </text>
<text top="966" left="261" width="239" height="16" font="13"><b>log [P(observations | lambda)]  </b></text>
<text top="986" left="261" width="4" height="16" font="13"><b> </b></text>
<text top="1007" left="261" width="138" height="16" font="13"><b>= -137300.054917 </b></text>
<text top="1029" left="135" width="4" height="16" font="13"><b> </b></text>
<text top="1049" left="284" width="355" height="16" font="13"><b>Table 1: Final trained HMM for English Text </b></text>
</page>
<page number="26" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">12 </text>
<text top="111" left="135" width="4" height="17" font="10"> </text>
<text top="153" left="135" width="605" height="17" font="10">Matrix B is N x M i.e. it has 2 rows and 27 columns. Matrix B is shown vertical for </text>
<text top="194" left="135" width="630" height="17" font="10">simplicity. Two rows in matrix B represent two states. Here first row has higher values </text>
<text top="235" left="135" width="643" height="17" font="10">for all vowels and zero or smaller values for consonants. In the second row, vowels have </text>
<text top="277" left="135" width="637" height="17" font="10">zero values and consonants have larger values. Matrix B in table 1 shows the separation </text>
<text top="318" left="135" width="626" height="17" font="10">of consonants and vowels in two hidden states. This shows that HMM is able to detect </text>
<text top="360" left="135" width="219" height="17" font="10">the English language pattern.  </text>
<text top="401" left="135" width="4" height="17" font="10"> </text>
<text top="442" left="135" width="613" height="17" font="10">Next step is to check whether HMM is able to distinguish between English texts and </text>
<text top="484" left="135" width="632" height="17" font="10">other texts. For this check, HMM was tested against some other language text. Text for </text>
<text top="525" left="135" width="627" height="17" font="10">this experiment is collected from Hindi language. Table 2 shows values of all matrices </text>
<text top="567" left="135" width="228" height="17" font="10">for non-English language text.  </text>
</page>
<page number="27" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">13 </text>
<text top="111" left="135" width="4" height="17" font="10"> </text>
<text top="133" left="271" width="221" height="17" font="10">Observations from other texts  </text>
<text top="174" left="271" width="73" height="17" font="10">Matrix Pi </text>
<text top="174" left="379" width="4" height="17" font="10"> </text>
<text top="174" left="433" width="4" height="17" font="10"> </text>
<text top="174" left="487" width="4" height="17" font="10"> </text>
<text top="216" left="287" width="152" height="17" font="10">0.91991  0.08009 </text>
<text top="238" left="271" width="4" height="17" font="10"> </text>
<text top="279" left="271" width="113" height="17" font="10">Final Matrix A </text>
<text top="321" left="287" width="152" height="17" font="10">0.48633  0.51367 </text>
<text top="343" left="297" width="60" height="17" font="10">0.4912 </text>
<text top="343" left="378" width="60" height="17" font="10">0.5088 </text>
<text top="364" left="271" width="111" height="17" font="10">Final Matrix B </text>
<text top="406" left="287" width="17" height="17" font="10">A </text>
<text top="406" left="400" width="70" height="17" font="10">0.04451 </text>
<text top="406" left="535" width="70" height="17" font="10">0.04297 </text>
<text top="428" left="287" width="17" height="17" font="10">B </text>
<text top="428" left="400" width="70" height="17" font="10">0.08326 </text>
<text top="428" left="535" width="70" height="17" font="10">0.08377 </text>
<text top="449" left="287" width="18" height="17" font="10">C </text>
<text top="449" left="400" width="70" height="17" font="10">0.04328 </text>
<text top="449" left="535" width="70" height="17" font="10">0.04313 </text>
<text top="471" left="287" width="18" height="17" font="10">D </text>
<text top="471" left="400" width="70" height="17" font="10">0.04029 </text>
<text top="471" left="535" width="70" height="17" font="10">0.04035 </text>
<text top="492" left="287" width="17" height="17" font="10">E </text>
<text top="492" left="400" width="70" height="17" font="10">0.04614 </text>
<text top="492" left="535" width="70" height="17" font="10">0.04603 </text>
<text top="514" left="287" width="16" height="17" font="10">F </text>
<text top="514" left="410" width="60" height="17" font="10">0.0459 </text>
<text top="514" left="535" width="70" height="17" font="10">0.04626 </text>
<text top="535" left="287" width="19" height="17" font="10">G </text>
<text top="535" left="400" width="70" height="17" font="10">0.04887 </text>
<text top="535" left="535" width="70" height="17" font="10">0.04904 </text>
<text top="557" left="287" width="18" height="17" font="10">H </text>
<text top="557" left="400" width="70" height="17" font="10">0.05464 </text>
<text top="557" left="545" width="60" height="17" font="10">0.0548 </text>
<text top="578" left="287" width="10" height="17" font="10">I </text>
<text top="578" left="400" width="70" height="17" font="10">0.06322 </text>
<text top="578" left="545" width="60" height="17" font="10">0.0635 </text>
<text top="599" left="287" width="14" height="17" font="10">J </text>
<text top="599" left="400" width="70" height="17" font="10">0.03252 </text>
<text top="599" left="535" width="70" height="17" font="10">0.03244 </text>
<text top="621" left="287" width="17" height="17" font="10">K </text>
<text top="621" left="400" width="70" height="17" font="10">0.02737 </text>
<text top="621" left="535" width="70" height="17" font="10">0.02735 </text>
<text top="642" left="287" width="15" height="17" font="10">L </text>
<text top="642" left="400" width="70" height="17" font="10">0.00000 </text>
<text top="642" left="535" width="70" height="17" font="10">0.00000 </text>
<text top="664" left="287" width="20" height="17" font="10">M </text>
<text top="664" left="400" width="70" height="17" font="10">0.03028 </text>
<text top="664" left="535" width="70" height="17" font="10">0.03021 </text>
<text top="685" left="287" width="18" height="17" font="10">N </text>
<text top="685" left="400" width="70" height="17" font="10">0.02731 </text>
<text top="685" left="535" width="70" height="17" font="10">0.02741 </text>
<text top="707" left="287" width="19" height="17" font="10">O </text>
<text top="707" left="400" width="70" height="17" font="10">0.02733 </text>
<text top="707" left="535" width="70" height="17" font="10">0.02739 </text>
<text top="728" left="287" width="17" height="17" font="10">P </text>
<text top="728" left="400" width="70" height="17" font="10">0.02587 </text>
<text top="728" left="535" width="70" height="17" font="10">0.02597 </text>
<text top="750" left="287" width="19" height="17" font="10">Q </text>
<text top="750" left="400" width="70" height="17" font="10">0.03171 </text>
<text top="750" left="535" width="70" height="17" font="10">0.03165 </text>
<text top="771" left="287" width="18" height="17" font="10">R </text>
<text top="771" left="400" width="70" height="17" font="10">0.03166 </text>
<text top="771" left="545" width="60" height="17" font="10">0.0317 </text>
<text top="793" left="287" width="17" height="17" font="10">S </text>
<text top="793" left="400" width="70" height="17" font="10">0.03166 </text>
<text top="793" left="545" width="60" height="17" font="10">0.0317 </text>
<text top="814" left="287" width="16" height="17" font="10">T </text>
<text top="814" left="400" width="70" height="17" font="10">0.03456 </text>
<text top="814" left="535" width="70" height="17" font="10">0.03456 </text>
<text top="835" left="287" width="18" height="17" font="10">U </text>
<text top="835" left="400" width="70" height="17" font="10">0.03161 </text>
<text top="835" left="535" width="70" height="17" font="10">0.03175 </text>
<text top="857" left="287" width="17" height="17" font="10">V </text>
<text top="857" left="400" width="70" height="17" font="10">0.03315 </text>
<text top="857" left="535" width="70" height="17" font="10">0.03309 </text>
<text top="878" left="287" width="22" height="17" font="10">W </text>
<text top="878" left="400" width="70" height="17" font="10">0.03023 </text>
<text top="878" left="535" width="70" height="17" font="10">0.03025 </text>
<text top="900" left="287" width="17" height="17" font="10">X </text>
<text top="900" left="400" width="70" height="17" font="10">0.03448 </text>
<text top="900" left="535" width="70" height="17" font="10">0.03464 </text>
<text top="921" left="287" width="17" height="17" font="10">Y </text>
<text top="921" left="400" width="70" height="17" font="10">0.04027 </text>
<text top="921" left="535" width="70" height="17" font="10">0.04037 </text>
<text top="943" left="287" width="16" height="17" font="10">Z </text>
<text top="943" left="400" width="70" height="17" font="10">0.04615 </text>
<text top="943" left="535" width="70" height="17" font="10">0.04602 </text>
<text top="964" left="287" width="53" height="17" font="10">space </text>
<text top="964" left="400" width="70" height="17" font="10">0.01373 </text>
<text top="964" left="535" width="70" height="17" font="10">0.01367 </text>
<text top="986" left="271" width="373" height="16" font="13"><b>log [P(observations | lambda)] = -160022.815487 </b></text>
<text top="1029" left="292" width="339" height="16" font="13"><b>Table 2: Final trained HMM for other texts </b></text>
<text top="1048" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="28" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">14 </text>
<text top="111" left="135" width="617" height="17" font="10">In table 2, matrix B does not distinguish between vowels or consonants as it is not an </text>
<text top="153" left="135" width="603" height="17" font="10">English text. Also table 3 shows that there are different logarithmic probabilities of </text>
<text top="194" left="135" width="199" height="17" font="10">English text and other text. </text>
<text top="237" left="137" width="321" height="16" font="13"><b>Logarithmic probability for English Text </b></text>
<text top="237" left="479" width="297" height="16" font="13"><b>Logarithmic probability for other text </b></text>
<text top="259" left="137" width="123" height="16" font="13"><b>-137300.054917 </b></text>
<text top="259" left="479" width="123" height="16" font="13"><b>-160022.815487 </b></text>
<text top="280" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="301" left="270" width="382" height="16" font="13"><b>Table 3: Comparison of logarithmic probabilities </b></text>
<text top="320" left="135" width="4" height="17" font="10"> </text>
<text top="341" left="135" width="636" height="17" font="10">HMM easily distinguishes between English and other texts. All related observations are </text>
<text top="383" left="135" width="319" height="17" font="10">discussed in more detail in the next section. </text>
<text top="443" left="135" width="228" height="18" font="18"><b>3.2.1 HMM observations </b></text>
<text top="491" left="135" width="647" height="17" font="10">Hidden Markov Model testing is carried out for 200 to 500 iterations for English text and </text>
<text top="533" left="135" width="502" height="17" font="10">other text. This section summarizes the changes in matrices A, B, and</text>
<text top="528" left="638" width="10" height="22" font="5">π</text>
<text top="533" left="653" width="93" height="17" font="10">. At the end, </text>
<text top="575" left="135" width="622" height="17" font="10">matrix A had similar distribution of numbers in both the states for plain English texts. </text>
<text top="616" left="135" width="636" height="17" font="10">Matrix A had row values ranging from 0.19 to 0.808 and 0.69 to 0.302. Matrix A and B </text>
<text top="658" left="135" width="617" height="17" font="10">varied with plain English texts observation sequences and with number of iterations.  </text>
<text top="699" left="135" width="4" height="17" font="10"> </text>
<text top="740" left="135" width="634" height="17" font="10">1. At the end of all the iterations, all vowels {A,E,I,O,U} had higher values in state one </text>
<text top="782" left="149" width="613" height="17" font="10">along with very small values for C,G,K,L,P,T and Y in state one. But in state two all </text>
<text top="823" left="149" width="617" height="17" font="10">these vowels had zeros (0) and other characters had bigger values which had zeros or </text>
<text top="865" left="149" width="636" height="17" font="10">very small values in state one. After increasing the number of iterations to 500 and later </text>
<text top="906" left="149" width="625" height="17" font="10">to 1000, small values were changed to zero. Hence training a model may require more </text>
<text top="947" left="148" width="155" height="17" font="10">number of iterations. </text>
</page>
<page number="29" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">15 </text>
<text top="111" left="135" width="640" height="17" font="10">2. The final logarithmic probability was similar in case of plain English text. Parameters </text>
<text top="153" left="148" width="568" height="17" font="10">such as number of iterations or seed value were affecting the final value of the </text>
<text top="194" left="148" width="473" height="17" font="10">probability though not making significant difference to B matrix. </text>
<text top="235" left="135" width="543" height="17" font="10">3. &#34;Space&#34; had similar distribution in both the states throughout the HMM. </text>
<text top="277" left="149" width="4" height="17" font="10"> </text>
<text top="337" left="135" width="234" height="18" font="18"><b>3.2.2 Limitations of HMM </b></text>
<text top="386" left="135" width="625" height="17" font="10">Though HMM is able to detect English text pattern, there are still few limitations over </text>
<text top="427" left="135" width="599" height="17" font="10">HMM which could affect its efficiency. Few factors like observations, observation </text>
<text top="468" left="135" width="618" height="17" font="10">length, and number of iterations do affect the trained matrices values and logarithmic </text>
<text top="510" left="135" width="540" height="17" font="10">probability. Following are some HMM limitations based on above factors. </text>
<text top="551" left="162" width="578" height="17" font="10">1.  If the observation sequence is small then the final probability value changes </text>
<text top="593" left="189" width="599" height="17" font="10">drastically as compared to the probability of the observation sequence with 50,000 </text>
<text top="634" left="189" width="381" height="17" font="10">characters even though both are plain English texts.  </text>
<text top="675" left="162" width="571" height="17" font="10">2.  When the seed value was changed, the probability value was also changed. </text>
<text top="717" left="162" width="541" height="17" font="10">3.  HMM mainly depends upon the total count of characters present in the </text>
<text top="758" left="189" width="574" height="17" font="10">observation sequence. So if all the characters are evenly distributed then HMM </text>
<text top="800" left="189" width="323" height="17" font="10">does not give appropriate probability value.  </text>
<text top="841" left="162" width="602" height="17" font="10">4.  HMM shows different values for the final trained model and probability for the </text>
<text top="882" left="189" width="564" height="17" font="10">same observation string due to variations in input values of observation string </text>
<text top="924" left="189" width="261" height="17" font="10">length, seed number, and iterations. </text>
<text top="965" left="135" width="617" height="17" font="10">From above limitations, it seems that observation sequence, its length, iterations, and </text>
<text top="1007" left="135" width="644" height="17" font="10">seed value affect HMM results and logarithmic probability. To avoid these problems, we </text>
<text top="1048" left="135" width="624" height="17" font="10">can consider constant values for few factors like iterations and seed value. And before </text>
</page>
<page number="30" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">16 </text>
<text top="111" left="135" width="619" height="17" font="10">comparing HMM results of two texts, observation sequence length should be same to </text>
<text top="153" left="135" width="334" height="17" font="10">compare results and probabilities adequately.  </text>
<text top="213" left="135" width="313" height="20" font="17"><i><b>3.3 HMM based virus detection </b></i></text>
<text top="265" left="135" width="631" height="17" font="10">In [6], an effective virus detection scheme based on HMMs is developed and analyzed. </text>
<text top="306" left="135" width="650" height="17" font="10">There were many test cases executed to check the effectiveness of HMM based detection. </text>
<text top="348" left="135" width="641" height="17" font="10">Datasets consisted different virus files, CYGWIN files, and NGVCK metamorphic virus </text>
<text top="389" left="135" width="635" height="17" font="10">files belonging to IDAN virus family. It is proven that NGVCK creates varied morphed </text>
<text top="430" left="135" width="619" height="17" font="10">copies maintaining the existing functionality of the base virus [6]. Figure 4 shows the </text>
<text top="472" left="135" width="508" height="17" font="10">graph of the NGVCK virus pair with highest similarity score of 21%.  </text>
<text top="513" left="135" width="4" height="17" font="10"> </text>
<text top="870" left="783" width="4" height="17" font="10"> </text>
<text top="909" left="276" width="370" height="16" font="13"><b>Figure 4: Similarity graphs of the NGVCK pair </b></text>
<text top="928" left="135" width="4" height="17" font="10"> </text>
<text top="970" left="135" width="646" height="17" font="10">After creating the variants using NGVCK, the HMM was trained. In [6], a five fold cross </text>
<text top="1011" left="135" width="647" height="17" font="10">validation technique is used to train the HMM. In this, the whole dataset is divided into 5 </text>
<text top="1052" left="135" width="626" height="17" font="10">subsets. For training purpose, 4 datasets are used and the fifth subset is used to test the </text>
</page>
<page number="31" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">17 </text>
<text top="111" left="135" width="652" height="17" font="10">trained HMM model. This process is repeated for 5 times. At the end of the experiment, it </text>
<text top="153" left="135" width="577" height="17" font="10">was observed that HMM had higher probabilities for similar virus files and low </text>
<text top="194" left="135" width="627" height="17" font="10">probabilities for benign and metamorphic virus files. For 200 metamorphic viruses, 25 </text>
<text top="235" left="135" width="615" height="17" font="10">models were trained to classify viruses and normal files. HMM was able to detect 23 </text>
<text top="277" left="135" width="628" height="17" font="10">models out of 25 models and was able to distinguish between viruses and normal files. </text>
<text top="318" left="135" width="4" height="17" font="10"> </text>
<text top="360" left="135" width="626" height="17" font="10">HMM based detection was tested against a morphing engine in [7]. For 5% subroutine </text>
<text top="401" left="135" width="596" height="17" font="10">code insertion in the metamorphic virus files, scores calculated using HMM based </text>
<text top="442" left="135" width="623" height="17" font="10">detection technique showed 3 false positives and 6 false negatives amongst 40 normal </text>
<text top="484" left="135" width="604" height="17" font="10">files and 40 metamorphic virus files. When 15% of the subroutine was copied from </text>
<text top="525" left="135" width="651" height="17" font="10">normal file to metamorphic virus file and scores were calculated using HMM. There were </text>
<text top="567" left="135" width="623" height="17" font="10">26 false negatives and 33 false positives in 40 normal and 40 metamorphic virus files. </text>
<text top="608" left="135" width="640" height="17" font="10">And for 30% of the subroutine code insertion, there were 36 false negatives and 35 false </text>
<text top="649" left="135" width="624" height="17" font="10">positives which shows that HMM based detection was not able to distinguish between </text>
<text top="691" left="135" width="581" height="17" font="10">normal files and metamorphic virus files with 30% of subroutine code insertion. </text>
<text top="732" left="135" width="4" height="17" font="10"> </text>
<text top="774" left="135" width="569" height="17" font="10">Above scores show that the morphing engine is very effective in morphing the </text>
<text top="815" left="135" width="589" height="17" font="10">metamorphic virus files and is able to defeat the HMM based detection. It is very </text>
<text top="856" left="135" width="560" height="17" font="10">important to check our graph technique against this morphing engine as well. </text>
</page>
<page number="32" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="20" size="8" family="Times" color="#000000"/>
	<fontspec id="21" size="16" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">18 </text>
<text top="131" left="135" width="597" height="22" font="16"><b>4. Graph technique for metamorphic virus detection </b></text>
<text top="189" left="135" width="630" height="17" font="10">Next subsection discusses the graph based malware detection technique from [4] along </text>
<text top="230" left="135" width="626" height="17" font="10">with our proposed graph technique. Rest subsections will focus on the implementation </text>
<text top="272" left="135" width="416" height="17" font="10">details, flow chart, and algorithm of our graph technique. </text>
<text top="313" left="135" width="4" height="17" font="10"> </text>
<text top="353" left="135" width="172" height="20" font="17"><i><b>4.1 Related work </b></i></text>
<text top="405" left="135" width="598" height="17" font="10">As discussed in paper [6], HMM based virus detection was effective in classifying </text>
<text top="446" left="135" width="613" height="17" font="10">metamorphic viruses and benign files. HMM is able to detect NGVCK metamorphic </text>
<text top="487" left="135" width="558" height="17" font="10">virus copies with less false positives and negatives. In paper [7], an engine is </text>
<text top="529" left="135" width="640" height="17" font="10">implemented to morph copies of metamorphic viruses to make them undetectable by the </text>
<text top="570" left="135" width="637" height="17" font="10">HMM. This engine was tested against HMM based detection technique, and engine was </text>
<text top="612" left="135" width="596" height="17" font="10">able to defeat the HMM based virus detection. In the HMM based detection, these </text>
<text top="653" left="135" width="624" height="17" font="10">morphed metamorphic virus copies were able to evade the detection and increased the </text>
<text top="694" left="135" width="239" height="17" font="10">false positive and negative rates. </text>
<text top="736" left="135" width="4" height="17" font="10"> </text>
<text top="777" left="135" width="645" height="17" font="10">As proposed in [4], virus detection can be carried out by creating graphs according to the </text>
<text top="819" left="135" width="616" height="17" font="10">assembly instructions present in files and comparing those graphs using graph kernel </text>
<text top="860" left="135" width="636" height="17" font="10">technique. Graph kernel is used to find the similarity between two graphs. Graph kernel </text>
<text top="903" left="135" width="95" height="17" font="10">has a feature </text>
<text top="913" left="242" width="8" height="10" font="20"><i>H</i></text>
<text top="898" left="232" width="9" height="22" font="5">φ</text>
<text top="903" left="254" width="242" height="17" font="10"> for each possible graph H where </text>
<text top="903" left="540" width="6" height="17" font="3">)</text>
<text top="903" left="520" width="19" height="17" font="3">(<i>G</i></text>
<text top="913" left="508" width="8" height="10" font="20"><i>H</i></text>
<text top="898" left="498" width="9" height="22" font="5">φ</text>
<text top="903" left="549" width="208" height="17" font="10"> measures how many graphs </text>
<text top="948" left="135" width="648" height="17" font="10">have the same structure as graph H [38]. In [4], Spectral kernel and Gaussian kernel were </text>
<text top="989" left="135" width="617" height="17" font="10">used. Spectral kernel is using graph’s global structure like smoothness, diameter, and </text>
<text top="1030" left="135" width="620" height="17" font="10">number of components to find the similarity matrix. Gaussian kernel considered local </text>
</page>
<page number="33" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">19 </text>
<text top="111" left="135" width="645" height="17" font="10">structure of the graph where it takes the squared difference between corresponding edges </text>
<text top="153" left="135" width="622" height="17" font="10">in weighted adjacency matrices. Once the similarity matrix is constructed using graph </text>
<text top="194" left="135" width="645" height="17" font="10">kernels and their combination, Support Vector Machine (SVM) is used for classification. </text>
<text top="235" left="135" width="640" height="17" font="10">SVM maximizes the margin where hyperplane can be separated [39]. Critical element is </text>
<text top="277" left="135" width="637" height="17" font="10">support vector and for such inputs it identifies in which of the two classes it belongs to.  </text>
<text top="318" left="135" width="4" height="17" font="10"> </text>
<text top="360" left="135" width="650" height="17" font="10">In paper [4], the test data sets contain different types of viruses. It used 1,615 instances of </text>
<text top="401" left="135" width="593" height="17" font="10">malware and 615 instances of benign software. Tests were carried out against this </text>
<text top="442" left="135" width="624" height="17" font="10">technique and top five antivirus softwares and results were compared. Results showed </text>
<text top="484" left="135" width="622" height="17" font="10">that the combined graph kernels were 96.41% accurate in classifying normal files and </text>
<text top="525" left="135" width="473" height="17" font="10">viruses.  But there were 47 false positives and 33 false negatives. </text>
<text top="567" left="135" width="4" height="17" font="10"> </text>
<text top="608" left="135" width="645" height="17" font="10">Compared to the above technique, our proposed technique differs significantly in finding </text>
<text top="649" left="135" width="644" height="17" font="10">the similarity check and in the classification techniques used. In our method, comparison </text>
<text top="691" left="135" width="635" height="17" font="10">between the two graphs or matrices is much simpler than the technique proposed in [4]. </text>
<text top="732" left="135" width="465" height="17" font="10">We will discuss our technique in more detail in further sections. </text>
<text top="793" left="135" width="225" height="20" font="17"><i><b>4.2 Proposed solution </b></i></text>
<text top="844" left="135" width="608" height="17" font="10">The proposed graph technique includes graph creations based on traces of assembly </text>
<text top="886" left="135" width="650" height="17" font="10">language instructions. Mostly viruses are in the form of executable files. We have a set of </text>
<text top="927" left="135" width="652" height="17" font="10">disassembled virus and benign files. In this graph technique we are creating an instruction </text>
<text top="969" left="135" width="626" height="17" font="10">array to keep track of all instructions present in a file. This array is initialized using an </text>
<text top="1010" left="135" width="597" height="17" font="10">existing instruction set file. As tracing progresses, this array is appended with new </text>
<text top="1051" left="135" width="628" height="17" font="10">assembly instructions found in the file. A successive instruction set represents any two </text>
</page>
<page number="34" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">20 </text>
<text top="111" left="135" width="625" height="17" font="10">same or different instructions coming after each other (subsection 4.3 discusses this in </text>
<text top="153" left="135" width="619" height="17" font="10">more detail). There is another matrix which is used to store counts of such successive </text>
<text top="194" left="135" width="608" height="17" font="10">instruction sets. In this matrix, rows and columns will represent instructions. Before </text>
<text top="235" left="135" width="626" height="17" font="10">tracing starts, this whole matrix is initialized to zero. Both the array and the matrix are </text>
<text top="277" left="135" width="603" height="17" font="10">updated for each instruction. Assembly file contains a sequence of combinations of </text>
<text top="318" left="135" width="585" height="17" font="10">instructions and related operands. Instruction performs defined operations on the </text>
<text top="360" left="135" width="597" height="17" font="10">operands or using the operands. Following is an example of an assembly language </text>
<text top="401" left="135" width="197" height="17" font="10">instruction with operands.  </text>
<text top="442" left="397" width="128" height="17" font="10">MOV EAX, 20H </text>
<text top="484" left="135" width="620" height="17" font="10">Here “MOV” is an instruction and “EAX” and “20H” are operands. MOV instruction </text>
<text top="525" left="135" width="623" height="17" font="10">copies 20H into EAX which is a register. There are more than 130 assembly language </text>
<text top="567" left="135" width="651" height="17" font="10">instructions for a particular processor [40]. Operands can be different forms like registers, </text>
<text top="608" left="135" width="637" height="17" font="10">memory operands, flags etc. There could be 3000 different combinations of instructions </text>
<text top="649" left="135" width="588" height="17" font="10">and different operands [4]. If we create a graph based upon such combinations of </text>
<text top="691" left="135" width="650" height="17" font="10">vertices, graph will become too large to compare. Instead we considered only instructions </text>
<text top="732" left="135" width="587" height="17" font="10">to represent vertices in the graph. The program ignores comments, variables, and </text>
<text top="774" left="135" width="639" height="17" font="10">instruction operands. Once the complete file is traced and matrix is updated, next step is </text>
<text top="815" left="135" width="615" height="17" font="10">to repeat this process for another file. For second file, another matrix will be created. </text>
<text top="856" left="135" width="641" height="17" font="10">Both the matrices will have same number of rows and columns as both matrices will use </text>
<text top="898" left="135" width="615" height="17" font="10">the same array which has list of all distinct instructions present in both the files. This </text>
<text top="939" left="135" width="615" height="17" font="10">matrix can be represented as a bi-directed graph. Subsection 4.3 discusses the matrix </text>
<text top="981" left="135" width="636" height="17" font="10">operations in more detail. Once both the matrices are ready with respective counts, next </text>
<text top="1022" left="135" width="628" height="17" font="10">step is to calculate the similarity score between these matrices. This score is calculated </text>
</page>
<page number="35" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">21 </text>
<text top="111" left="135" width="601" height="17" font="10">using a formula shown in equation 1. Last step is to classify whether these files are </text>
<text top="153" left="135" width="149" height="17" font="10">similar or different.  </text>
<text top="213" left="135" width="269" height="20" font="17"><i><b>4.3 Implementation details </b></i></text>
<text top="265" left="135" width="624" height="17" font="10">This subsection gives detailed information about the implementation of the technique. </text>
<text top="306" left="135" width="650" height="17" font="10">Our technique is based upon assembly language instructions. Every processor has its own </text>
<text top="348" left="135" width="652" height="17" font="10">assembly language instruction sets [8]. So if we use specific/fixed set of instructions, then </text>
<text top="389" left="135" width="583" height="17" font="10">it might not be possible to compare or differentiate any other assembly language </text>
<text top="430" left="135" width="651" height="17" font="10">instruction set. Hence we considered to collect all new instructions while tracing the files. </text>
<text top="472" left="135" width="637" height="17" font="10">When any instruction which is not present in the matrix is found, it will get appended at </text>
<text top="513" left="135" width="638" height="17" font="10">the end of the matrix and this will increase the length of the matrix and the array. Hence </text>
<text top="555" left="135" width="630" height="17" font="10">the length of the matrix is nothing but the total number of distinct instructions found in </text>
<text top="596" left="135" width="581" height="17" font="10">the software / malware. As mentioned, this matrix contains counts of successive </text>
<text top="637" left="135" width="649" height="17" font="10">instructions. For successive instructions example, consider there is an instruction ADD in </text>
<text top="679" left="135" width="596" height="17" font="10">the code segment of the file. If that instructions is present in the matrix, and if it is </text>
<text top="720" left="135" width="639" height="17" font="10">preceded by another instruction MOV, then its count in the matrix with the combination </text>
<text top="762" left="135" width="599" height="17" font="10">of previous instruction (MOV row) and current instruction (ADD column), will be </text>
<text top="803" left="135" width="644" height="17" font="10">increased. For example, Table 4 shows a code segment, based on which, a matrix will be </text>
<text top="844" left="135" width="617" height="17" font="10">created. The total number of distinct instructions is 17 and those are listed below. All </text>
<text top="886" left="135" width="640" height="17" font="10">distinct instructions will represent an individual node in the graph. All these instructions </text>
<text top="927" left="135" width="623" height="17" font="10">push, mov, sub, and, test, jz, int, fnstcw, movzx, or, fldcw, call, leave, retn, align, xor, </text>
<text top="969" left="135" width="621" height="17" font="10">and lea will have outgoing and incoming edges representing some numbers which are </text>
<text top="1010" left="135" width="381" height="17" font="10">counts of those instructions coming after each other. </text>
<text top="1051" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="36" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="22" size="12" family="Times" color="#000000"/>
	<fontspec id="23" size="12" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">22 </text>
<text top="114" left="142" width="159" height="14" font="22"><b>Instruction (Operator) </b></text>
<text top="114" left="332" width="66" height="14" font="22"><b>Operand </b></text>
<text top="134" left="142" width="38" height="14" font="23">Push </text>
<text top="134" left="332" width="31" height="14" font="23">Ebp </text>
<text top="155" left="142" width="32" height="14" font="23">Mov </text>
<text top="155" left="332" width="62" height="14" font="23">ebp, esp </text>
<text top="175" left="142" width="31" height="14" font="23">Sub </text>
<text top="175" left="332" width="45" height="14" font="23">esp, 8 </text>
<text top="195" left="142" width="31" height="14" font="23">And </text>
<text top="195" left="332" width="126" height="14" font="23">esp, 0FFFFFFF0h </text>
<text top="215" left="142" width="32" height="14" font="23">Mov </text>
<text top="215" left="332" width="156" height="14" font="23">eax, ds:dword_404000 </text>
<text top="236" left="142" width="33" height="14" font="23">Test </text>
<text top="236" left="332" width="61" height="14" font="23">eax, eax </text>
<text top="256" left="142" width="19" height="14" font="23">Jz </text>
<text top="256" left="332" width="121" height="14" font="23">Short loc_401013 </text>
<text top="276" left="142" width="21" height="14" font="23">Int </text>
<text top="276" left="659" width="12" height="14" font="23">3 </text>
<text top="296" left="142" width="51" height="14" font="23">Fnstcw </text>
<text top="296" left="332" width="84" height="14" font="23">[ebp+var_2] </text>
<text top="317" left="142" width="47" height="14" font="23">Movzx </text>
<text top="317" left="332" width="116" height="14" font="23">eax, [ebp+var_2] </text>
<text top="337" left="142" width="31" height="14" font="23">And </text>
<text top="337" left="332" width="127" height="14" font="23">eax, 0FFFFF0C0h </text>
<text top="357" left="142" width="32" height="14" font="23">Mov </text>
<text top="357" left="332" width="108" height="14" font="23">[ebp+var_2], ax </text>
<text top="377" left="142" width="47" height="14" font="23">Movzx </text>
<text top="377" left="332" width="116" height="14" font="23">eax, [ebp+var_2] </text>
<text top="398" left="142" width="21" height="14" font="23">Or </text>
<text top="398" left="332" width="71" height="14" font="23">eax, 33Fh </text>
<text top="418" left="142" width="32" height="14" font="23">Mov </text>
<text top="418" left="332" width="108" height="14" font="23">[ebp+var_2], ax </text>
<text top="438" left="142" width="43" height="14" font="23">Fldcw </text>
<text top="438" left="332" width="84" height="14" font="23">[ebp+var_2] </text>
<text top="458" left="142" width="32" height="14" font="23">Mov </text>
<text top="458" left="332" width="232" height="14" font="23">[esp+8+var_8], offset sub_401050 </text>
<text top="479" left="142" width="30" height="14" font="23">Call </text>
<text top="479" left="332" width="87" height="14" font="23">sub_401960 </text>
<text top="499" left="142" width="127" height="14" font="23">Leave, Retn, Align </text>
<text top="499" left="332" width="29" height="14" font="23">10h </text>
<text top="519" left="142" width="38" height="14" font="23">Push </text>
<text top="519" left="332" width="31" height="14" font="23">Ebp </text>
<text top="539" left="142" width="32" height="14" font="23">Mov </text>
<text top="539" left="332" width="62" height="14" font="23">eax, 10h </text>
<text top="560" left="142" width="32" height="14" font="23">Mov </text>
<text top="560" left="332" width="62" height="14" font="23">ebp, esp </text>
<text top="580" left="142" width="38" height="14" font="23">Push </text>
<text top="580" left="332" width="26" height="14" font="23">Edi </text>
<text top="600" left="142" width="38" height="14" font="23">Push </text>
<text top="600" left="332" width="25" height="14" font="23">Esi </text>
<text top="620" left="142" width="38" height="14" font="23">Push </text>
<text top="620" left="332" width="30" height="14" font="23">Ebx </text>
<text top="641" left="142" width="31" height="14" font="23">Sub </text>
<text top="641" left="332" width="64" height="14" font="23">esp, 7Ch </text>
<text top="661" left="142" width="32" height="14" font="23">Mov </text>
<text top="661" left="332" width="113" height="14" font="23">edi, [ebp+arg_0] </text>
<text top="681" left="142" width="32" height="14" font="23">Mov </text>
<text top="681" left="332" width="112" height="14" font="23">esi, [ebp+arg_4] </text>
<text top="701" left="142" width="31" height="14" font="23">And </text>
<text top="701" left="332" width="126" height="14" font="23">esp, 0FFFFFFF0h </text>
<text top="722" left="142" width="30" height="14" font="23">Call </text>
<text top="722" left="332" width="87" height="14" font="23">sub_401930 </text>
<text top="742" left="142" width="30" height="14" font="23">Call </text>
<text top="742" left="332" width="65" height="14" font="23">j___main </text>
<text top="762" left="142" width="32" height="14" font="23">Mov </text>
<text top="762" left="332" width="111" height="14" font="23">[ebp+var_4C], 0 </text>
<text top="782" left="142" width="32" height="14" font="23">Mov </text>
<text top="782" left="332" width="257" height="14" font="23">[esp+88h+var_88], offset unk_404090 </text>
<text top="803" left="142" width="30" height="14" font="23">Call </text>
<text top="803" left="332" width="169" height="14" font="23">j_CORBA_exception_init </text>
<text top="823" left="142" width="32" height="14" font="23">Mov </text>
<text top="823" left="332" width="236" height="14" font="23">dword ptr [esp+88h+var_84+4], esi </text>
<text top="843" left="142" width="28" height="14" font="23">Xor </text>
<text top="843" left="332" width="61" height="14" font="23">edx, edx </text>
<text top="863" left="142" width="32" height="14" font="23">Mov </text>
<text top="863" left="332" width="152" height="14" font="23">eax, offset off_402000 </text>
<text top="884" left="142" width="32" height="14" font="23">Mov </text>
<text top="884" left="332" width="157" height="14" font="23">[esp+88h+var_78], edx </text>
<text top="904" left="142" width="32" height="14" font="23">Mov </text>
<text top="904" left="332" width="160" height="14" font="23">[esp+88h+var_7C], eax </text>
<text top="924" left="142" width="32" height="14" font="23">Mov </text>
<text top="924" left="332" width="220" height="14" font="23">dword ptr [esp+88h+var_84], edi </text>
<text top="944" left="142" width="32" height="14" font="23">Mov </text>
<text top="944" left="332" width="329" height="14" font="23">[esp+88h+var_88], offset aOafClient ; &#34;oaf-client&#34; </text>
<text top="965" left="142" width="30" height="14" font="23">Call </text>
<text top="965" left="332" width="121" height="14" font="23">j_poptGetContext </text>
<text top="985" left="142" width="32" height="14" font="23">Mov </text>
<text top="985" left="332" width="61" height="14" font="23">ebx, eax </text>
<text top="1005" left="142" width="29" height="14" font="23">Lea </text>
<text top="1005" left="332" width="76" height="14" font="23">esi, [esi+0] </text>
<text top="1025" left="135" width="504" height="16" font="13"><b>Table 4: Assembly language instruction traces for graph creation </b></text>
<text top="1044" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="37" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">23 </text>
<text top="111" left="135" width="641" height="17" font="10">After tracing above instructions and finding all the counts, matrix looks like as shown in </text>
<text top="132" left="135" width="63" height="17" font="10">Table 5. </text>
<text top="153" left="135" width="4" height="17" font="10"> </text>
<text top="496" left="782" width="4" height="14" font="23"> </text>
<text top="510" left="135" width="4" height="17" font="10"> </text>
<text top="532" left="199" width="525" height="16" font="13"><b>Table 5: Matrix created using assembly language instruction counts </b></text>
<text top="552" left="135" width="4" height="17" font="10"> </text>
<text top="593" left="135" width="627" height="17" font="10">In table 5, blank cells represent zeros. Sparse matrix contains more zeros and very less </text>
<text top="635" left="135" width="619" height="17" font="10">non-zero values. Thus this matrix becomes a sparse matrix due to less number of non-</text>
<text top="676" left="135" width="576" height="17" font="10">zero values. Rows in this matrix will represent the nodes and values in that row </text>
<text top="717" left="135" width="620" height="17" font="10">correspond to values of the edges going out from that node to other nodes. Now if we </text>
<text top="759" left="135" width="649" height="17" font="10">keep all these counts as it is and calculate the difference, then this technique can easily be </text>
<text top="800" left="135" width="646" height="17" font="10">defeated. It is because, if we add more and more dead code to the .asm file, it will simply </text>
<text top="842" left="135" width="366" height="17" font="10">increase the count and will lead to incorrect score. </text>
<text top="883" left="135" width="4" height="17" font="10"> </text>
<text top="924" left="135" width="610" height="17" font="10">In a matrix if each row sums to one, then this matrix is called row stochastic matrix. </text>
<text top="966" left="135" width="629" height="17" font="10">To avoid this problem and to find the probability, we decided to make that matrix, row </text>
<text top="1007" left="135" width="625" height="17" font="10">stochastic. Stochastic matrix is used for non-deterministic or probabilistic calculations </text>
</page>
<page number="38" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">24 </text>
<text top="111" left="135" width="648" height="17" font="10">[9]. By taking sum of a row and dividing each value in that row by that sum makes it row </text>
<text top="153" left="135" width="543" height="17" font="10">stochastic. The sparse row stochastic matrix looks like as shown in table 6. </text>
<text top="194" left="135" width="4" height="17" font="10"> </text>
<text top="215" left="135" width="4" height="17" font="10"> </text>
<text top="614" left="783" width="4" height="16" font="13"><b> </b></text>
<text top="630" left="227" width="468" height="16" font="13"><b>Table 6: Normalized sparse matrix to make it row stochastic </b></text>
<text top="650" left="135" width="4" height="17" font="10"> </text>
<text top="671" left="135" width="4" height="17" font="10"> </text>
<text top="691" left="135" width="625" height="17" font="10">Table 6 shows the probability of transition from one instruction to another instruction. </text>
<text top="733" left="135" width="643" height="17" font="10">This way whole successive instruction count is stored in the matrix. Now this matrix can </text>
<text top="774" left="135" width="393" height="17" font="10">be represented in a graph format as shown in figure 5. </text>
</page>
<page number="39" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="24" size="39" family="Times" color="#000000"/>
	<fontspec id="25" size="13" family="Times" color="#000000"/>
	<fontspec id="26" size="25" family="Times" color="#000000"/>
	<fontspec id="27" size="13" family="Times" color="#000000"/>
	<fontspec id="28" size="25" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">25 </text>
<text top="111" left="135" width="4" height="17" font="10"> </text>
<text top="153" left="135" width="4" height="17" font="10"> </text>
<text top="194" left="135" width="4" height="17" font="10"> </text>
<text top="235" left="135" width="4" height="17" font="10"> </text>
<text top="277" left="135" width="4" height="17" font="10"> </text>
<text top="318" left="135" width="4" height="17" font="10"> </text>
<text top="360" left="135" width="4" height="17" font="10"> </text>
<text top="401" left="135" width="4" height="17" font="10"> </text>
<text top="442" left="135" width="4" height="17" font="10"> </text>
<text top="484" left="135" width="4" height="17" font="10"> </text>
<text top="526" left="216" width="490" height="16" font="13"><b>Figure 5: Bi-directed graph created using the matrix in Table 6 </b></text>
<text top="546" left="135" width="4" height="17" font="10"> </text>
<text top="567" left="135" width="4" height="17" font="10"> </text>
<text top="587" left="135" width="606" height="17" font="10">Reason behind creating a graph is we want to find the probability of one instruction </text>
<text top="629" left="135" width="644" height="17" font="10">coming after another or same instruction. After constructing the matrix (graph) for a file, </text>
<text top="670" left="135" width="639" height="17" font="10">next step is to create another matrix with the counts of successive instructions present in </text>
<text top="712" left="135" width="561" height="17" font="10">other file. We use the Equation 1 to measure the similarity between two files. </text>
<text top="766" left="478" width="92" height="47" font="24">∑ ∑</text>
<text top="755" left="501" width="9" height="18" font="25">−</text>
<text top="755" left="476" width="9" height="18" font="25">=</text>
<text top="809" left="487" width="9" height="18" font="25">=</text>
<text top="753" left="567" width="9" height="18" font="25">−</text>
<text top="753" left="541" width="9" height="18" font="25">=</text>
<text top="809" left="552" width="9" height="18" font="25">=</text>
<text top="772" left="622" width="15" height="31" font="26">−</text>
<text top="772" left="375" width="15" height="31" font="26">=</text>
<text top="758" left="510" width="8" height="15" font="25">1</text>
<text top="812" left="498" width="8" height="15" font="25">0</text>
<text top="774" left="703" width="8" height="15" font="25">2</text>
<text top="756" left="575" width="8" height="15" font="25">1</text>
<text top="812" left="563" width="8" height="15" font="25">0</text>
<text top="795" left="424" width="8" height="15" font="25">2</text>
<text top="778" left="692" width="9" height="26" font="26">)</text>
<text top="778" left="671" width="9" height="26" font="26">)</text>
<text top="778" left="520" width="9" height="26" font="26">(</text>
<text top="778" left="459" width="9" height="26" font="26">(</text>
<text top="778" left="442" width="14" height="26" font="26">*</text>
<text top="761" left="410" width="14" height="26" font="26">1</text>
<text top="759" left="487" width="11" height="15" font="27"><i>N</i></text>
<text top="759" left="469" width="4" height="15" font="27"><i>i</i></text>
<text top="813" left="481" width="4" height="15" font="27"><i>i</i></text>
<text top="757" left="552" width="11" height="15" font="27"><i>N</i></text>
<text top="757" left="534" width="4" height="15" font="27"><i>j</i></text>
<text top="813" left="546" width="4" height="15" font="27"><i>j</i></text>
<text top="793" left="654" width="9" height="15" font="27"><i>ij</i></text>
<text top="793" left="603" width="9" height="15" font="27"><i>ij</i></text>
<text top="779" left="642" width="14" height="25" font="28"><i>b</i></text>
<text top="779" left="589" width="14" height="25" font="28"><i>a</i></text>
<text top="800" left="401" width="18" height="25" font="28"><i>N</i></text>
<text top="779" left="248" width="116" height="25" font="28"><i>Difference</i></text>
<text top="796" left="719" width="13" height="17" font="10">   </text>
<text top="857" left="241" width="440" height="16" font="13"><b>Equation 1: Formula for calculating similarity score [11] </b></text>
<text top="876" left="135" width="4" height="17" font="10"> </text>
<text top="897" left="135" width="4" height="17" font="10"> </text>
<text top="918" left="135" width="628" height="17" font="10">Threshold will be a range or a value which will be useful in classifying benign file and </text>
<text top="959" left="135" width="628" height="17" font="10">virus file. If the score calculated by this formula is lower than the threshold that means </text>
<text top="1001" left="135" width="645" height="17" font="10">compared files have similar structures in nature. Else if score is higher than the threshold </text>
<text top="155" left="265" width="40" height="17" font="10">Push </text>
<text top="355" left="481" width="23" height="17" font="10">Or </text>
<text top="288" left="644" width="56" height="17" font="10">Fnstcw </text>
<text top="288" left="516" width="56" height="17" font="10">Movzx </text>
<text top="222" left="332" width="35" height="17" font="10">And </text>
<text top="166" left="577" width="20" height="17" font="10">Jz </text>
<text top="298" left="437" width="35" height="17" font="10">Test </text>
<text top="222" left="197" width="45" height="17" font="10">Align </text>
<text top="317" left="251" width="49" height="17" font="10">Fldcw </text>
<text top="423" left="374" width="48" height="17" font="10">Leave </text>
<text top="207" left="698" width="24" height="17" font="10">Int </text>
<text top="220" left="563" width="31" height="17" font="10">Lea </text>
<text top="263" left="265" width="39" height="17" font="10">Retn </text>
<text top="330" left="346" width="32" height="17" font="10">Xor </text>
<text top="398" left="629" width="35" height="17" font="10">Call </text>
<text top="207" left="454" width="39" height="17" font="10">Mov </text>
<text top="137" left="389" width="33" height="17" font="10">Sub </text>
<text top="124" left="290" width="18" height="11" font="6">0.4 </text>
<text top="185" left="307" width="18" height="11" font="6">0.4 </text>
<text top="141" left="321" width="18" height="11" font="6">0.2 </text>
<text top="166" left="347" width="24" height="11" font="6">0.05 </text>
<text top="177" left="453" width="30" height="11" font="6">0.389 </text>
<text top="142" left="455" width="24" height="11" font="6">0.05 </text>
<text top="233" left="386" width="24" height="11" font="6">0.05 </text>
<text top="244" left="452" width="24" height="11" font="6">0.05 </text>
<text top="269" left="514" width="24" height="11" font="6">0.05 </text>
<text top="367" left="597" width="30" height="11" font="6">0.167 </text>
<text top="300" left="374" width="24" height="11" font="6">0.05 </text>
<text top="206" left="536" width="24" height="11" font="6">0.05 </text>
<text top="151" left="494" width="18" height="11" font="6">0.5 </text>
<text top="172" left="404" width="18" height="11" font="6">0.5 </text>
<text top="217" left="383" width="24" height="11" font="6">0.66 </text>
<text top="462" left="536" width="24" height="11" font="6">0.33 </text>
<text top="179" left="532" width="9" height="11" font="6">1 </text>
<text top="170" left="644" width="9" height="11" font="6">1 </text>
<text top="246" left="695" width="9" height="11" font="6">1 </text>
<text top="287" left="624" width="9" height="11" font="6">1 </text>
<text top="327" left="523" width="18" height="11" font="6">0.5 </text>
<text top="335" left="490" width="9" height="11" font="6">1 </text>
<text top="266" left="347" width="9" height="11" font="6">1 </text>
<text top="340" left="647" width="18" height="11" font="6">0.6 </text>
<text top="408" left="708" width="18" height="11" font="6">0.2 </text>
<text top="406" left="536" width="18" height="11" font="6">0.2 </text>
<text top="373" left="307" width="9" height="11" font="6">1 </text>
<text top="228" left="246" width="9" height="11" font="6">1 </text>
<text top="178" left="212" width="9" height="11" font="6">1 </text>
<text top="260" left="418" width="9" height="11" font="6">1 </text>
</page>
<page number="40" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">26 </text>
<text top="111" left="135" width="633" height="17" font="10">that means files are different from each other. In this way technique will find whether a </text>
<text top="153" left="135" width="312" height="17" font="10">given file is a malware or benign software. </text>
<text top="195" left="135" width="4" height="16" font="13"><b> </b></text>
<text top="234" left="135" width="309" height="20" font="17"><i><b>4.4 Graph technique algorithm </b></i></text>
<text top="286" left="135" width="519" height="17" font="10">Below is the algorithm to briefly explain the proposed graph technique. </text>
<text top="306" left="135" width="4" height="17" font="10"> </text>
<text top="327" left="135" width="407" height="17" font="10">1.<b> </b>Trace assembly language instructions for the first file </text>
<text top="368" left="135" width="616" height="17" font="10">2. Initialize an array with most frequent assembly language instructions present in an </text>
<text top="410" left="148" width="127" height="17" font="10">“InstSet.txt” file. </text>
<text top="451" left="135" width="605" height="17" font="10">2. Create a matrix with memory allocated for all instructions in the above array and </text>
<text top="493" left="148" width="204" height="17" font="10">initialize all cells with zero. </text>
<text top="534" left="135" width="589" height="17" font="10">3. The matrix will be appended dynamically whenever a new instruction is found </text>
<text top="575" left="135" width="646" height="17" font="10">4. While tracing the program, keep counting the number of successive instructions which </text>
<text top="617" left="162" width="424" height="17" font="10">are coming after each other. Store this count in the matrix. </text>
<text top="658" left="135" width="390" height="17" font="10">5. Repeat steps 3 and 4 until it reaches end of the file. </text>
<text top="700" left="135" width="357" height="17" font="10">6. Repeat steps from 1 through 5 for another file. </text>
<text top="741" left="135" width="643" height="17" font="10">7. To calculate the similarity score between these two files (matrices), use the formula in </text>
<text top="782" left="148" width="87" height="17" font="10">Equation 1. </text>
<text top="824" left="135" width="595" height="17" font="10">8. This similarity score will decide whether the given files are similar or different. </text>
<text top="884" left="135" width="321" height="20" font="17"><i><b>4.5 Flow of the graph technique </b></i></text>
<text top="936" left="135" width="622" height="17" font="10">Figure 6 shows the flow of the graph technique implementation. Combinations of any </text>
<text top="977" left="135" width="626" height="17" font="10">two files from the following sets will become inputs to the program. A simple text file </text>
<text top="1019" left="135" width="603" height="17" font="10">containing more frequent instructions will be used to initialize the matrix. Then the </text>
<text top="1060" left="135" width="647" height="17" font="10">program creates matrices for both the files. Those matrices are sent as an input to another </text>
</page>
<page number="41" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">27 </text>
<text top="111" left="135" width="638" height="17" font="10">module which calculates the similarity score. This score is then used to classify whether </text>
<text top="153" left="135" width="233" height="17" font="10">the files are similar or different. </text>
<text top="194" left="135" width="4" height="17" font="10"> </text>
<text top="215" left="135" width="4" height="17" font="10"> </text>
<text top="255" left="135" width="7" height="22" font="16"><b> </b></text>
<text top="286" left="135" width="4" height="17" font="10"> </text>
<text top="306" left="135" width="4" height="17" font="10"> </text>
<text top="327" left="135" width="4" height="17" font="10"> </text>
<text top="348" left="135" width="4" height="17" font="10"> </text>
<text top="368" left="135" width="4" height="17" font="10"> </text>
<text top="389" left="135" width="4" height="17" font="10"> </text>
<text top="410" left="135" width="4" height="17" font="10"> </text>
<text top="430" left="135" width="4" height="17" font="10"> </text>
<text top="451" left="135" width="4" height="17" font="10"> </text>
<text top="472" left="135" width="4" height="17" font="10"> </text>
<text top="493" left="135" width="4" height="17" font="10"> </text>
<text top="513" left="135" width="4" height="17" font="10"> </text>
<text top="534" left="135" width="4" height="17" font="10"> </text>
<text top="555" left="135" width="4" height="17" font="10"> </text>
<text top="576" left="313" width="296" height="16" font="13"><b>Figure 6: Flow of the graph technique </b></text>
<text top="615" left="135" width="7" height="22" font="16"><b> </b></text>
<text top="646" left="135" width="4" height="17" font="10"> </text>
<text top="667" left="135" width="4" height="17" font="10"> </text>
<text top="707" left="135" width="495" height="22" font="16"><b>5. Similarity score calculation and analysis </b></text>
<text top="752" left="135" width="190" height="20" font="17"><i><b>5.1 Data collection </b></i></text>
<text top="804" left="135" width="621" height="17" font="10">Three different sets are used to test our graph technique. First set has 200 IDAN virus </text>
<text top="845" left="135" width="621" height="17" font="10">files which belong to one metamorphic virus family. Second set consists of 41 benign </text>
<text top="887" left="135" width="613" height="17" font="10">files which are nothing but CYGWIN files [13]. Third set contains 25 different virus </text>
<text top="928" left="135" width="650" height="17" font="10">files. These files do not belong to any family. All these sets were created in [6] to analyze </text>
<text top="970" left="135" width="249" height="17" font="10">HMM based detection technique.  </text>
<text top="1011" left="135" width="4" height="17" font="10"> </text>
<text top="246" left="173" width="78" height="17" font="10">CYGWIN </text>
<text top="268" left="173" width="35" height="17" font="10">files </text>
<text top="354" left="159" width="49" height="17" font="10">IDAN </text>
<text top="375" left="159" width="99" height="17" font="10">metamorphic </text>
<text top="396" left="159" width="76" height="17" font="10">virus files </text>
<text top="480" left="167" width="91" height="17" font="10">IDAV other </text>
<text top="502" left="167" width="76" height="17" font="10">virus files </text>
<text top="505" left="368" width="135" height="16" font="13"><b>Graph technique </b></text>
<text top="237" left="389" width="103" height="17" font="10">Create matrix </text>
<text top="258" left="389" width="43" height="17" font="10">using </text>
<text top="279" left="389" width="82" height="17" font="10">instruction </text>
<text top="300" left="389" width="46" height="17" font="10">traces </text>
<text top="368" left="389" width="102" height="17" font="10">Provide basic </text>
<text top="389" left="389" width="106" height="17" font="10">instruction set </text>
<text top="279" left="589" width="72" height="17" font="10">Calculate </text>
<text top="300" left="589" width="116" height="17" font="10">similarity score </text>
<text top="422" left="578" width="104" height="17" font="10">Classification </text>
<text top="443" left="578" width="33" height="17" font="10">unit </text>
<text top="542" left="588" width="133" height="17" font="10">Similar / different </text>
</page>
<page number="42" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">28 </text>
<text top="111" left="135" width="631" height="17" font="10">As per results in [6], metamorphic viruses can be detected using HMM based detection </text>
<text top="153" left="135" width="583" height="17" font="10">technique. But according to [7], this technique can be defeated by few morphing </text>
<text top="194" left="135" width="610" height="17" font="10">techniques like dead code insertion, junk code insertion, and instruction substitution </text>
<text top="235" left="135" width="640" height="17" font="10">methods. According to [7], 30% subroutine code insertion similar to dead code insertion </text>
<text top="277" left="135" width="595" height="17" font="10">evades metamorphic virus detection. Percentage of the subroutine code inserted is </text>
<text top="318" left="135" width="587" height="17" font="10">calculated as per the total number of instructions present in subroutines of a file.  </text>
<text top="360" left="135" width="4" height="17" font="10"> </text>
<text top="401" left="135" width="629" height="17" font="10">There are two considerations in choosing this dataset. First consideration is we want to </text>
<text top="442" left="135" width="634" height="17" font="10">compare this technique with HMM based detection technique [6]. For this we will have </text>
<text top="484" left="135" width="558" height="17" font="10">to use the same dataset, to adequately compare these two techniques. Second </text>
<text top="525" left="135" width="608" height="17" font="10">consideration, as discussed in subsection 3.3, is NGVCK metamorphic viruses have </text>
<text top="567" left="135" width="527" height="17" font="10">already been tested for variation in their structures of all generations [6]. </text>
<text top="608" left="135" width="651" height="17" font="10">Our aim is to check if our graph technique works for simple metamorphic virus detection, </text>
<text top="649" left="135" width="647" height="17" font="10">then next step would be to check if it can be defeated by a morphing engine implemented </text>
<text top="691" left="135" width="49" height="17" font="10">in [7]. </text>
<text top="751" left="135" width="148" height="20" font="17"><i><b>5.2 Test cases </b></i></text>
<text top="803" left="135" width="621" height="17" font="10">Our program compares two files to find their similarity score. This graph technique is </text>
<text top="844" left="135" width="646" height="17" font="10">implemented to detect metamorphic viruses. Hence there are four important comparisons </text>
<text top="886" left="135" width="130" height="17" font="10">of different files.  </text>
<text top="927" left="216" width="359" height="17" font="10">a.  Metamorphic virus versus metamorphic virus </text>
<text top="969" left="216" width="249" height="17" font="10">b.  Normal file versus normal file </text>
<text top="1010" left="216" width="331" height="17" font="10">c.  Benign file versus metamorphic virus file </text>
<text top="1051" left="216" width="259" height="17" font="10">d.  Benign file versus other viruses </text>
</page>
<page number="43" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">29 </text>
<text top="112" left="135" width="476" height="18" font="18"><b>5.2.1 Metamorphic virus versus metamorphic virus </b></text>
<text top="161" left="135" width="648" height="17" font="10">In this combination, we are comparing two metamorphic virus files from the same family </text>
<text top="202" left="135" width="606" height="17" font="10">(IDAN). We have 200 IDAN metamorphic virus files created using NGVCK. After </text>
<text top="243" left="135" width="601" height="17" font="10">comparing one metamorphic virus file with another metamorphic virus file, we got </text>
<text top="285" left="135" width="140" height="17" font="10">around 100 scores. </text>
<text top="326" left="135" width="4" height="17" font="10"> </text>
<text top="546" left="782" width="4" height="17" font="10"> </text>
<text top="563" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="584" left="254" width="414" height="16" font="13"><b>Figure 7: Similarity scores of metamorphic virus files </b></text>
<text top="603" left="41" width="4" height="17" font="10"> </text>
<text top="624" left="135" width="634" height="17" font="10">Figure 7 shows 100 similarity scores between 200 metamorphic viruses. It shows 0.173 </text>
<text top="665" left="135" width="621" height="17" font="10">as minimum and 0.525 as maximum score for metamorphic virus files (similar files).  </text>
<text top="707" left="135" width="429" height="17" font="10">In this case, similar file score range is from 0.173 to 0.525. </text>
<text top="727" left="135" width="4" height="17" font="10"> </text>
<text top="767" left="135" width="454" height="18" font="18"><b>5.2.2 Normal file versus normal file (benign files) </b></text>
<text top="815" left="135" width="620" height="17" font="10">In this combination, we are comparing two benign (normal) files. We have around 41 </text>
<text top="857" left="135" width="635" height="17" font="10">benign files representing CYGWIN files. After comparing one CYGWIN file with only </text>
<text top="898" left="135" width="325" height="17" font="10">one CYGWIN file, we get around 20 scores. </text>
</page>
<page number="44" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">30 </text>
<text top="414" left="770" width="4" height="17" font="10"> </text>
<text top="453" left="295" width="332" height="16" font="13"><b>Figure 8: Similarity scores for normal files </b></text>
<text top="472" left="135" width="4" height="17" font="10"> </text>
<text top="514" left="135" width="648" height="17" font="10">Maximum similarity score between benign files is 0.468 and minimum similarity score is </text>
<text top="555" left="135" width="614" height="17" font="10">0.023. In both the combinations from 5.2.1 and 5.2.2, scores approximately lie in the </text>
<text top="596" left="135" width="197" height="17" font="10">range from 0.023 to 0.525. </text>
<text top="638" left="135" width="4" height="17" font="10"> </text>
<text top="658" left="135" width="4" height="17" font="10"> </text>
<text top="698" left="135" width="402" height="18" font="18"><b>5.2.3 Benign file versus metamorphic virus </b></text>
<text top="747" left="135" width="621" height="17" font="10">This combination is the most important combination. If our graph technique is able to </text>
<text top="788" left="135" width="593" height="17" font="10">find a similarity score outside the above range, then we will be able to distinguish </text>
<text top="829" left="135" width="430" height="17" font="10">between metamorphic virus files and benign software files. </text>
<text top="871" left="135" width="4" height="17" font="10"> </text>
<text top="912" left="135" width="572" height="17" font="10">For this combination we have 41 instances of benign files and 200 instances of </text>
<text top="954" left="135" width="644" height="17" font="10">metamorphic virus files. As this is a one to one comparison, we are using 41 instances of </text>
<text top="995" left="135" width="647" height="17" font="10">both the files. Figure 9 shows the graph for 41 metamorphic virus files compared with 41 </text>
<text top="1036" left="135" width="93" height="17" font="10">benign files. </text>
</page>
<page number="45" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">31 </text>
<text top="388" left="784" width="4" height="17" font="10"> </text>
<text top="406" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="426" left="200" width="522" height="16" font="13"><b>Figure 9: Similarity score for normal versus metamorphic virus file </b></text>
<text top="446" left="135" width="4" height="17" font="10"> </text>
<text top="487" left="135" width="611" height="17" font="10">Figure 10 shows the similarity score between metamorphic virus file and benign file </text>
<text top="529" left="135" width="635" height="17" font="10">ranges from 0.588 to 0.966. Clearly from above three combinations, metamorphic virus </text>
<text top="570" left="135" width="627" height="17" font="10">files and benign files are less similar as their scores have higher values as compared to </text>
<text top="612" left="135" width="413" height="17" font="10">that of two benign files and two metamorphic virus files. </text>
<text top="653" left="135" width="4" height="17" font="10"> </text>
<text top="694" left="135" width="652" height="17" font="10">Maximum score range for similar files (two benign files and two metamorphic virus files) </text>
<text top="736" left="135" width="651" height="17" font="10">is 0.525 and minimum score range for different files (one benign versus one metamorphic </text>
<text top="777" left="135" width="649" height="17" font="10">virus file) is 0.588. This shows that there is a threshold of 0.063 between similar files and </text>
<text top="819" left="135" width="616" height="17" font="10">different files. There are one more combinations which are not very important in this </text>
<text top="860" left="135" width="380" height="17" font="10">scenario, but can be useful in further improvements. </text>
<text top="901" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="46" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">32 </text>
<text top="130" left="135" width="328" height="18" font="18"><b>5.2.4 Benign file versus other virus </b></text>
<text top="179" left="135" width="643" height="17" font="10">This combination is also important as the virus we are comparing does not belong to any </text>
<text top="220" left="135" width="639" height="17" font="10">family. To see if this graph technique is able to detect that this virus and benign files are </text>
<text top="261" left="135" width="368" height="17" font="10">different, we compared virus file with benign file.  </text>
<text top="303" left="135" width="4" height="17" font="10"> </text>
<text top="344" left="135" width="630" height="17" font="10">We have 41 benign files and 26 virus files which do not belong to any virus family. To </text>
<text top="386" left="135" width="638" height="17" font="10">have one to one comparison, we considered 26 virus files and 26 benign files. Figure 10 </text>
<text top="427" left="135" width="548" height="17" font="10">is the graph created after calculating the scores of 26 virus and benign files. </text>
<text top="790" left="784" width="4" height="17" font="10"> </text>
<text top="807" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="828" left="255" width="413" height="16" font="13"><b>Figure 10: Graph for normal file versus other viruses </b></text>
<text top="847" left="135" width="4" height="17" font="10"> </text>
<text top="889" left="135" width="616" height="17" font="10">This graph technique also differentiates between normal viruses and normal (benign) </text>
<text top="930" left="135" width="627" height="17" font="10">softwares. The range of the similarity score is 0.563 to 0.86. This range is closer to the </text>
<text top="971" left="135" width="631" height="17" font="10">third combination (metamorphic virus Vs benign file) range 0.588 to 0.966. This graph </text>
<text top="1013" left="135" width="620" height="17" font="10">technique distinguishes between a benign file and any malware present in the dataset. </text>
</page>
<page number="47" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">33 </text>
<text top="112" left="135" width="209" height="18" font="18"><b>5.2.5 Combined graph </b></text>
<text top="161" left="135" width="317" height="17" font="10">Figure 11 shows combination of all graphs. </text>
<text top="534" left="783" width="4" height="17" font="10"> </text>
<text top="551" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="572" left="304" width="314" height="16" font="13"><b>Figure 11: Graph for all types combined </b></text>
<text top="591" left="135" width="4" height="17" font="10"> </text>
<text top="633" left="135" width="632" height="17" font="10">There is a threshold between similar file scores and different file scores. Table 7 shows </text>
<text top="674" left="135" width="511" height="17" font="10">minimum scores and maximum scores for all cases explained till now. </text>
<text top="717" left="135" width="341" height="16" font="13"><b>Metamorphic files versus metamorphic files </b></text>
<text top="738" left="135" width="4" height="17" font="10"> </text>
<text top="738" left="356" width="122" height="17" font="10">Minimum Score </text>
<text top="738" left="578" width="125" height="17" font="10">Maximum Score </text>
<text top="759" left="135" width="97" height="17" font="10">Similar Files </text>
<text top="759" left="356" width="45" height="17" font="10">0.173 </text>
<text top="759" left="578" width="45" height="17" font="10">0.525 </text>
<text top="780" left="135" width="4" height="17" font="10"> </text>
<text top="803" left="135" width="240" height="16" font="13"><b>Benign files versus benign files </b></text>
<text top="823" left="135" width="4" height="17" font="10"> </text>
<text top="823" left="356" width="122" height="17" font="10">Minimum Score </text>
<text top="823" left="578" width="125" height="17" font="10">Maximum Score </text>
<text top="845" left="135" width="97" height="17" font="10">Similar Files </text>
<text top="845" left="356" width="45" height="17" font="10">0.023 </text>
<text top="845" left="578" width="45" height="17" font="10">0.468 </text>
<text top="866" left="135" width="4" height="17" font="10"> </text>
<text top="889" left="135" width="291" height="16" font="13"><b>Benign files versus metamorphic files </b></text>
<text top="909" left="135" width="4" height="17" font="10"> </text>
<text top="909" left="356" width="122" height="17" font="10">Minimum Score </text>
<text top="909" left="578" width="125" height="17" font="10">Maximum Score </text>
<text top="931" left="135" width="110" height="17" font="10">Different Files </text>
<text top="931" left="356" width="45" height="17" font="10">0.588 </text>
<text top="931" left="578" width="45" height="17" font="10">0.966 </text>
<text top="952" left="135" width="4" height="17" font="10"> </text>
<text top="975" left="135" width="251" height="16" font="13"><b>Benign files versus other viruses </b></text>
<text top="995" left="135" width="4" height="17" font="10"> </text>
<text top="995" left="356" width="122" height="17" font="10">Minimum Score </text>
<text top="995" left="578" width="125" height="17" font="10">Maximum Score </text>
<text top="1016" left="135" width="110" height="17" font="10">Different Files </text>
<text top="1016" left="356" width="45" height="17" font="10">0.563 </text>
<text top="1016" left="578" width="45" height="17" font="10">0.860 </text>
<text top="1039" left="303" width="317" height="16" font="13"><b>Table 7: Maximum and minimum scores </b></text>
<text top="1059" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="48" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">34 </text>
<text top="111" left="135" width="616" height="17" font="10">We have compared files with one to one mapping. But now we will compare one file </text>
<text top="153" left="135" width="359" height="17" font="10">with all other files using many to many mapping. </text>
<text top="194" left="135" width="4" height="17" font="10"> </text>
<text top="254" left="135" width="566" height="20" font="17"><i><b>5.3 Comparing 10 benign files with 10 metamorphic files </b></i></text>
<text top="306" left="135" width="635" height="17" font="10">For this combination, we are taking 10 benign files and 10 metamorphic virus files. We </text>
<text top="348" left="135" width="623" height="17" font="10">will get 100 different observations from many to many comparisons. Figure 12 shows </text>
<text top="389" left="135" width="643" height="17" font="10">graph of 100 scores for 20 different file combinations. In figure 12, match case is grayed </text>
<text top="430" left="135" width="619" height="17" font="10">out as those records are temporarily disabled to show only non-match case. Figure 15 </text>
<text top="472" left="135" width="196" height="17" font="10">shows the complete graph. </text>
<text top="513" left="135" width="4" height="17" font="10"> </text>
<text top="849" left="773" width="4" height="17" font="10"> </text>
<text top="866" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="887" left="184" width="555" height="16" font="13"><b>Figure 12: Showing graph for normal file versus metamorphic virus file </b></text>
<text top="907" left="135" width="4" height="17" font="10"> </text>
<text top="948" left="135" width="629" height="17" font="10">Minimum score here is 0.555 and maximum score is 0.933. Score 0.555 is greater than </text>
<text top="990" left="135" width="618" height="17" font="10">0.525 which is the maximum score for similar files. Graph technique easily identifies </text>
<text top="1031" left="135" width="202" height="17" font="10">different file or similar file. </text>
</page>
<page number="49" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">35 </text>
<text top="111" left="135" width="4" height="17" font="10"> </text>
<text top="132" left="135" width="4" height="17" font="10"> </text>
<text top="171" left="135" width="296" height="18" font="18"><b>5.3.1 Average score calculation </b></text>
<text top="220" left="135" width="628" height="17" font="10">If we take the average of 10 scores for a particular file compared with different type of </text>
<text top="261" left="135" width="639" height="17" font="10">files, we can surely differentiate between metamorphic virus files and benign files using </text>
<text top="303" left="135" width="625" height="17" font="10">this graph technique. We took average of each benign file by adding all ten scores and </text>
<text top="344" left="135" width="324" height="17" font="10">dividing it by 10. It can be seen in figure 13. </text>
<text top="386" left="135" width="4" height="17" font="10"> </text>
<text top="752" left="783" width="4" height="17" font="10"> </text>
<text top="769" left="239" width="444" height="16" font="13"><b>Figure 13: Graph plotted after average score calculations </b></text>
<text top="789" left="135" width="4" height="17" font="10"> </text>
<text top="830" left="135" width="614" height="17" font="10">In figure 13 minimum average score is 0.6464 and maximum average score is 0.844. </text>
<text top="872" left="135" width="641" height="17" font="10">Minimum average score is larger than threshold 0.525. Before taking average, minimum </text>
<text top="913" left="135" width="598" height="17" font="10">score was 0.555 which was closer to threshold 0.525 as compared to the minimum </text>
<text top="955" left="135" width="593" height="17" font="10">average score of 0.6464. It gives confirmed results of similarity or differentiation. </text>
<text top="1015" left="135" width="6" height="20" font="17"><i><b> </b></i></text>
</page>
<page number="50" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">36 </text>
<text top="112" left="135" width="423" height="20" font="17"><i><b>5.4 Comparing 10 metamorphic virus files </b></i></text>
<text top="164" left="135" width="622" height="17" font="10">Mapping for this comparison will be many to many. Any two metamorphic virus files </text>
<text top="205" left="135" width="617" height="17" font="10">compared with each other using this graph technique will give the same score even if </text>
<text top="247" left="135" width="629" height="17" font="10">order of the files is changed. So here we will get 45 distinct scores from many to many </text>
<text top="288" left="135" width="603" height="17" font="10">mapping of 10 virus files. Figure 14 shows the graph with non-match case disabled </text>
<text top="330" left="135" width="368" height="17" font="10">(grayed out). Figure 15 shows the complete graph. </text>
<text top="680" left="783" width="4" height="17" font="10"> </text>
<text top="718" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="738" left="240" width="437" height="16" font="13"><b>Figure 14: Metamorphic virus versus metamorphic virus</b></text>
<text top="740" left="678" width="4" height="13" font="22"><b> </b></text>
<text top="758" left="459" width="4" height="13" font="22"><b> </b></text>
<text top="776" left="459" width="4" height="13" font="22"><b> </b></text>
</page>
<page number="51" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">37 </text>
<text top="413" left="783" width="4" height="17" font="10"> </text>
<text top="430" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="451" left="219" width="485" height="16" font="13"><b>Figure 15: Graph showing match and non-match case together</b> </text>
<text top="471" left="135" width="4" height="17" font="10"> </text>
<text top="512" left="135" width="618" height="17" font="10">Figure 15 shows both match case versus non-match case. There is a threshold of 0.06 </text>
<text top="553" left="135" width="604" height="17" font="10">between match case and non-match case. No false positives or false negatives were </text>
<text top="595" left="135" width="51" height="17" font="10">found. </text>
<text top="636" left="135" width="4" height="17" font="10"> </text>
<text top="677" left="135" width="592" height="17" font="10">But now there is a need to check if the formula is effective for metamorphic virus </text>
<text top="719" left="135" width="631" height="17" font="10">detection. To test its strength, we made some changes in parameters of the formula and </text>
<text top="760" left="135" width="600" height="17" font="10">calculated the scores with one to one mapping between a set of 41 benign files and </text>
<text top="802" left="135" width="520" height="17" font="10">metamorphic virus files and another set of 100 metamorphic virus files. </text>
<text top="843" left="135" width="4" height="17" font="10"> </text>
<text top="883" left="135" width="393" height="20" font="17"><i><b>5.5 Parameter variations in the formula </b></i></text>
<text top="925" left="135" width="183" height="18" font="18"><b>5.5.1 First variation </b></text>
<text top="973" left="135" width="639" height="17" font="10">Now we need to test formula for its strength. In the first variation, we took the square of </text>
<text top="1015" left="135" width="473" height="17" font="10">the difference and then went on adding it to the cumulative sum.  </text>
</page>
<page number="52" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">38 </text>
<text top="129" left="479" width="92" height="47" font="24">∑ ∑</text>
<text top="118" left="502" width="9" height="18" font="25">−</text>
<text top="118" left="476" width="9" height="18" font="25">=</text>
<text top="172" left="488" width="9" height="18" font="25">=</text>
<text top="116" left="567" width="9" height="18" font="25">−</text>
<text top="116" left="541" width="9" height="18" font="25">=</text>
<text top="172" left="553" width="9" height="18" font="25">=</text>
<text top="135" left="622" width="15" height="31" font="26">−</text>
<text top="135" left="375" width="15" height="31" font="26">=</text>
<text top="121" left="511" width="8" height="15" font="25">1</text>
<text top="175" left="498" width="8" height="15" font="25">0</text>
<text top="114" left="672" width="8" height="15" font="25">2</text>
<text top="119" left="576" width="8" height="15" font="25">1</text>
<text top="175" left="563" width="8" height="15" font="25">0</text>
<text top="158" left="425" width="8" height="15" font="25">2</text>
<text top="141" left="683" width="18" height="26" font="26">))</text>
<text top="141" left="521" width="9" height="26" font="26">(</text>
<text top="141" left="460" width="9" height="26" font="26">(</text>
<text top="141" left="442" width="14" height="26" font="26">*</text>
<text top="124" left="410" width="14" height="26" font="26">1</text>
<text top="121" left="487" width="11" height="15" font="27"><i>N</i></text>
<text top="121" left="469" width="4" height="15" font="27"><i>i</i></text>
<text top="175" left="481" width="4" height="15" font="27"><i>i</i></text>
<text top="120" left="553" width="11" height="15" font="27"><i>N</i></text>
<text top="120" left="534" width="4" height="15" font="27"><i>j</i></text>
<text top="175" left="546" width="4" height="15" font="27"><i>j</i></text>
<text top="156" left="655" width="9" height="15" font="27"><i>ij</i></text>
<text top="156" left="604" width="9" height="15" font="27"><i>ij</i></text>
<text top="141" left="642" width="14" height="25" font="28"><i>b</i></text>
<text top="141" left="590" width="14" height="25" font="28"><i>a</i></text>
<text top="162" left="401" width="18" height="25" font="28"><i>N</i></text>
<text top="141" left="248" width="115" height="25" font="28"><i>Difference</i></text>
<text top="159" left="707" width="4" height="17" font="10"> </text>
<text top="220" left="218" width="487" height="16" font="13"><b>Equation 2: Squaring the difference and taking the summation </b></text>
<text top="239" left="135" width="4" height="17" font="10"> </text>
<text top="281" left="135" width="612" height="17" font="10">This change in the formula is tested against the same dataset. After calculating score </text>
<text top="322" left="135" width="649" height="17" font="10">using this changed formula, graph in figure 16 was plotted. Normal file option is disabled </text>
<text top="364" left="135" width="111" height="17" font="10">for time being. </text>
<text top="405" left="135" width="4" height="17" font="10"> </text>
<text top="739" left="783" width="4" height="17" font="10"> </text>
<text top="777" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="798" left="269" width="384" height="16" font="13"><b>Figure 16: Result of first variation for match case </b></text>
<text top="818" left="135" width="4" height="17" font="10"> </text>
<text top="859" left="135" width="642" height="17" font="10">The scores for similar files are ranging from 0.003 to 0.007. Scores for different files are </text>
<text top="901" left="135" width="144" height="17" font="10">shown in figure 17. </text>
<text top="942" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="53" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">39 </text>
<text top="412" left="782" width="4" height="17" font="10"> </text>
<text top="451" left="251" width="419" height="16" font="13"><b>Figure 17: Result of first variation for non-match case </b></text>
<text top="470" left="135" width="4" height="17" font="10"> </text>
<text top="512" left="135" width="314" height="17" font="10">Scores are ranging from 0.0054 to 0.0085.  </text>
<text top="554" left="251" width="4" height="17" font="10"> </text>
<text top="554" left="382" width="122" height="17" font="10">Minimum Score </text>
<text top="554" left="525" width="125" height="17" font="10">Maximum Score </text>
<text top="575" left="251" width="97" height="17" font="10">Similar Files </text>
<text top="575" left="382" width="45" height="17" font="10">0.003 </text>
<text top="575" left="525" width="45" height="17" font="10">0.007 </text>
<text top="597" left="251" width="110" height="17" font="10">Different Files </text>
<text top="597" left="382" width="54" height="17" font="10">0.0054 </text>
<text top="597" left="525" width="54" height="17" font="10">0.0085 </text>
<text top="619" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="640" left="344" width="235" height="16" font="13"><b>Table 8: First variation scores </b></text>
<text top="660" left="135" width="4" height="17" font="10"> </text>
<text top="680" left="135" width="4" height="17" font="10"> </text>
<text top="702" left="246" width="4" height="17" font="10"> </text>
<text top="702" left="467" width="137" height="17" font="10">Threshold = 0.006 </text>
<text top="723" left="246" width="112" height="17" font="10">False Positives </text>
<text top="723" left="467" width="13" height="17" font="10">2 </text>
<text top="745" left="246" width="119" height="17" font="10">False Negatives </text>
<text top="745" left="467" width="22" height="17" font="10">17 </text>
<text top="767" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="788" left="255" width="413" height="16" font="13"><b>Table 9: First variation - false positives and negatives </b></text>
</page>
<page number="54" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="29" size="10" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">40 </text>
<text top="403" left="782" width="4" height="17" font="10"> </text>
<text top="441" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="462" left="327" width="268" height="16" font="13"><b>Figure 18: Result of first variation </b></text>
<text top="481" left="135" width="4" height="17" font="10"> </text>
<text top="523" left="135" width="647" height="17" font="10">In figure 18, scores are overlapping for different and similar files. This formula change is </text>
<text top="564" left="135" width="583" height="17" font="10">not much effective, as there are many false negatives though less false positives. </text>
<text top="624" left="135" width="211" height="18" font="18"><b>5.5.2 Second variation </b></text>
<text top="673" left="135" width="526" height="17" font="10">In this variation, we are keeping the above change as it is but removing n</text>
<text top="669" left="661" width="6" height="11" font="6">2</text>
<text top="673" left="667" width="118" height="17" font="10"> from it. As n is </text>
<text top="714" left="135" width="644" height="17" font="10">the total number of distinct instructions present in both the files, it might not affect much </text>
<text top="756" left="135" width="143" height="17" font="10">in similarity score.  </text>
<text top="814" left="431" width="92" height="47" font="24">∑ ∑</text>
<text top="803" left="455" width="9" height="18" font="25">−</text>
<text top="803" left="429" width="9" height="18" font="25">=</text>
<text top="857" left="440" width="9" height="18" font="25">=</text>
<text top="802" left="520" width="9" height="18" font="25">−</text>
<text top="802" left="494" width="9" height="18" font="25">=</text>
<text top="857" left="505" width="9" height="18" font="25">=</text>
<text top="821" left="575" width="15" height="31" font="26">−</text>
<text top="821" left="390" width="15" height="31" font="26">=</text>
<text top="807" left="463" width="8" height="15" font="25">1</text>
<text top="861" left="451" width="8" height="15" font="25">0</text>
<text top="800" left="625" width="8" height="15" font="25">2</text>
<text top="805" left="528" width="8" height="15" font="25">1</text>
<text top="861" left="516" width="8" height="15" font="25">0</text>
<text top="827" left="636" width="18" height="26" font="26">))</text>
<text top="827" left="474" width="9" height="26" font="26">(</text>
<text top="827" left="412" width="9" height="26" font="26">(</text>
<text top="807" left="440" width="11" height="15" font="27"><i>N</i></text>
<text top="807" left="422" width="4" height="15" font="27"><i>i</i></text>
<text top="861" left="434" width="4" height="15" font="27"><i>i</i></text>
<text top="805" left="505" width="11" height="15" font="27"><i>N</i></text>
<text top="805" left="487" width="4" height="15" font="27"><i>j</i></text>
<text top="861" left="499" width="4" height="15" font="27"><i>j</i></text>
<text top="842" left="608" width="9" height="15" font="27"><i>ij</i></text>
<text top="842" left="556" width="9" height="15" font="27"><i>ij</i></text>
<text top="827" left="595" width="14" height="25" font="28"><i>b</i></text>
<text top="827" left="543" width="14" height="25" font="28"><i>a</i></text>
<text top="827" left="263" width="115" height="25" font="28"><i>Difference</i></text>
<text top="845" left="660" width="4" height="17" font="10"> </text>
<text top="906" left="299" width="181" height="16" font="13"><b>Equation 3: Removed n</b></text>
<text top="901" left="481" width="6" height="11" font="29"><b>2</b></text>
<text top="906" left="487" width="136" height="16" font="13"><b> from Equation 2 </b></text>
<text top="925" left="135" width="4" height="17" font="10"> </text>
<text top="967" left="135" width="125" height="17" font="10">After removing n</text>
<text top="963" left="260" width="6" height="11" font="6">2</text>
<text top="967" left="266" width="476" height="17" font="10"> from the formula, we got figure 21 for similar and different files. </text>
</page>
<page number="55" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">41 </text>
<text top="411" left="783" width="4" height="17" font="10"> </text>
<text top="449" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="470" left="317" width="288" height="16" font="13"><b>Figure 19: Result of second variation </b></text>
<text top="489" left="135" width="4" height="17" font="10"> </text>
<text top="510" left="135" width="4" height="17" font="10"> </text>
<text top="531" left="251" width="4" height="17" font="10"> </text>
<text top="531" left="382" width="122" height="17" font="10">Minimum Score </text>
<text top="531" left="525" width="125" height="17" font="10">Maximum Score </text>
<text top="553" left="251" width="97" height="17" font="10">Similar Files </text>
<text top="553" left="382" width="54" height="17" font="10">10.241 </text>
<text top="553" left="525" width="54" height="17" font="10">26.072 </text>
<text top="574" left="251" width="110" height="17" font="10">Different Files </text>
<text top="574" left="382" width="54" height="17" font="10">25.159 </text>
<text top="574" left="525" width="54" height="17" font="10">48.695 </text>
<text top="597" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="618" left="330" width="262" height="16" font="13"><b>Table 10: Second variation scores </b></text>
<text top="637" left="135" width="4" height="17" font="10"> </text>
<text top="658" left="135" width="4" height="17" font="10"> </text>
<text top="679" left="246" width="4" height="17" font="10"> </text>
<text top="679" left="467" width="114" height="17" font="10">Threshold = 25 </text>
<text top="701" left="246" width="112" height="17" font="10">False Positives </text>
<text top="701" left="467" width="13" height="17" font="10">0 </text>
<text top="722" left="246" width="119" height="17" font="10">False Negatives </text>
<text top="722" left="467" width="13" height="17" font="10">2 </text>
<text top="745" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="765" left="241" width="440" height="16" font="13"><b>Table 11: Second variation - false positives and negatives </b></text>
<text top="785" left="135" width="4" height="17" font="10"> </text>
<text top="826" left="135" width="607" height="17" font="10">Figure 18 and figure 19 show that this formula also works but not as accurate as the </text>
<text top="868" left="135" width="627" height="17" font="10">formula in equation 1, that is, no threshold to differentiate between similar or different </text>
<text top="909" left="135" width="350" height="17" font="10">files but very less false positives and negatives.  </text>
<text top="951" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="56" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">42 </text>
<text top="130" left="135" width="190" height="18" font="18"><b>5.5.3 Third variation </b></text>
<text top="179" left="135" width="244" height="17" font="10">In this change, we are removing n</text>
<text top="175" left="379" width="6" height="11" font="6">2</text>
<text top="179" left="385" width="388" height="17" font="10"> from Equation 1. For every score calculation, we are </text>
<text top="220" left="135" width="650" height="17" font="10">dividing by the square of the total number of distinct instructions present in both the files. </text>
<text top="261" left="135" width="641" height="17" font="10">The value of n is approximately similar in all the cases. The score might not get affected </text>
<text top="303" left="135" width="167" height="17" font="10">due to removal of the n</text>
<text top="299" left="302" width="6" height="11" font="6">2</text>
<text top="303" left="308" width="51" height="17" font="10"> term.  </text>
<text top="357" left="425" width="92" height="47" font="24">∑ ∑</text>
<text top="346" left="449" width="9" height="18" font="25">−</text>
<text top="346" left="423" width="9" height="18" font="25">=</text>
<text top="400" left="434" width="9" height="18" font="25">=</text>
<text top="344" left="514" width="9" height="18" font="25">−</text>
<text top="344" left="488" width="9" height="18" font="25">=</text>
<text top="400" left="499" width="9" height="18" font="25">=</text>
<text top="363" left="569" width="15" height="31" font="26">−</text>
<text top="363" left="384" width="15" height="31" font="26">=</text>
<text top="349" left="458" width="8" height="15" font="25">1</text>
<text top="403" left="445" width="8" height="15" font="25">0</text>
<text top="365" left="650" width="8" height="15" font="25">2</text>
<text top="348" left="523" width="8" height="15" font="25">1</text>
<text top="403" left="510" width="8" height="15" font="25">0</text>
<text top="369" left="639" width="9" height="26" font="26">)</text>
<text top="369" left="618" width="9" height="26" font="26">)</text>
<text top="369" left="467" width="9" height="26" font="26">(</text>
<text top="369" left="406" width="9" height="26" font="26">(</text>
<text top="350" left="434" width="11" height="15" font="27"><i>N</i></text>
<text top="350" left="416" width="4" height="15" font="27"><i>i</i></text>
<text top="404" left="428" width="4" height="15" font="27"><i>i</i></text>
<text top="348" left="499" width="11" height="15" font="27"><i>N</i></text>
<text top="348" left="481" width="4" height="15" font="27"><i>j</i></text>
<text top="404" left="492" width="4" height="15" font="27"><i>j</i></text>
<text top="385" left="602" width="9" height="15" font="27"><i>ij</i></text>
<text top="385" left="550" width="9" height="15" font="27"><i>ij</i></text>
<text top="370" left="589" width="14" height="25" font="28"><i>b</i></text>
<text top="370" left="536" width="14" height="25" font="28"><i>a</i></text>
<text top="370" left="257" width="116" height="25" font="28"><i>Difference</i></text>
<text top="388" left="666" width="4" height="17" font="10"> </text>
<text top="448" left="296" width="187" height="16" font="13"><b>Equation 4: Removing n</b></text>
<text top="444" left="484" width="6" height="11" font="29"><b>2</b></text>
<text top="448" left="490" width="136" height="16" font="13"><b> from Equation 1 </b></text>
<text top="468" left="135" width="4" height="17" font="10"> </text>
<text top="800" left="782" width="4" height="17" font="10"> </text>
<text top="838" left="324" width="275" height="16" font="13"><b>Figure 20: Result of third variation </b></text>
<text top="857" left="135" width="4" height="17" font="10"> </text>
<text top="899" left="135" width="642" height="17" font="10">The only difference is that values are in thousands range with a separation of 146 and no </text>
<text top="940" left="135" width="246" height="17" font="10">false positives or false negatives.  </text>
<text top="982" left="278" width="4" height="17" font="10"> </text>
<text top="982" left="409" width="122" height="17" font="10">Minimum Score </text>
<text top="982" left="552" width="125" height="17" font="10">Maximum Score </text>
<text top="1004" left="278" width="97" height="17" font="10">Similar Files </text>
<text top="1004" left="409" width="63" height="17" font="10">585.056 </text>
<text top="1004" left="552" width="72" height="17" font="10">2084.291 </text>
<text top="1025" left="278" width="110" height="17" font="10">Different Files </text>
<text top="1025" left="409" width="72" height="17" font="10">2230.528 </text>
<text top="1025" left="552" width="72" height="17" font="10">6783.549 </text>
<text top="1047" left="339" width="245" height="16" font="13"><b>Table 12: Third variation score </b></text>
</page>
<page number="57" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">43 </text>
<text top="112" left="135" width="203" height="18" font="18"><b>5.5.4 Fourth variation </b></text>
<text top="161" left="135" width="270" height="17" font="10">Till now we have seen that value of n</text>
<text top="157" left="405" width="6" height="11" font="6">2</text>
<text top="161" left="411" width="371" height="17" font="10"> does not affect much. Another small change could </text>
<text top="202" left="135" width="104" height="17" font="10">be removing n</text>
<text top="198" left="239" width="6" height="11" font="6">2</text>
<text top="202" left="245" width="471" height="17" font="10"> and only keeping n which is nothing but total number of distinct </text>
<text top="243" left="135" width="266" height="17" font="10">instructions present in both the files. </text>
<text top="298" left="451" width="92" height="47" font="24">∑ ∑</text>
<text top="287" left="474" width="9" height="18" font="25">−</text>
<text top="287" left="448" width="9" height="18" font="25">=</text>
<text top="341" left="460" width="9" height="18" font="25">=</text>
<text top="285" left="539" width="9" height="18" font="25">−</text>
<text top="285" left="513" width="9" height="18" font="25">=</text>
<text top="341" left="525" width="9" height="18" font="25">=</text>
<text top="304" left="594" width="15" height="31" font="26">−</text>
<text top="304" left="359" width="15" height="31" font="26">=</text>
<text top="290" left="483" width="8" height="15" font="25">1</text>
<text top="344" left="470" width="8" height="15" font="25">0</text>
<text top="306" left="675" width="8" height="15" font="25">2</text>
<text top="288" left="548" width="8" height="15" font="25">1</text>
<text top="344" left="535" width="8" height="15" font="25">0</text>
<text top="310" left="664" width="9" height="26" font="26">)</text>
<text top="310" left="643" width="9" height="26" font="26">)</text>
<text top="310" left="493" width="9" height="26" font="26">(</text>
<text top="310" left="432" width="9" height="26" font="26">(</text>
<text top="310" left="414" width="14" height="26" font="26">*</text>
<text top="293" left="388" width="14" height="26" font="26">1</text>
<text top="290" left="460" width="11" height="15" font="27"><i>N</i></text>
<text top="290" left="442" width="4" height="15" font="27"><i>i</i></text>
<text top="344" left="453" width="4" height="15" font="27"><i>i</i></text>
<text top="289" left="525" width="11" height="15" font="27"><i>N</i></text>
<text top="289" left="506" width="4" height="15" font="27"><i>j</i></text>
<text top="344" left="518" width="4" height="15" font="27"><i>j</i></text>
<text top="325" left="627" width="9" height="15" font="27"><i>ij</i></text>
<text top="325" left="576" width="9" height="15" font="27"><i>ij</i></text>
<text top="310" left="615" width="14" height="25" font="28"><i>b</i></text>
<text top="310" left="562" width="14" height="25" font="28"><i>a</i></text>
<text top="331" left="386" width="18" height="25" font="28"><i>N</i></text>
<text top="310" left="232" width="116" height="25" font="28"><i>Difference</i></text>
<text top="328" left="691" width="4" height="17" font="10"> </text>
<text top="389" left="299" width="324" height="16" font="13"><b>Equation 5: Keeping only n in Equation 1 </b></text>
<text top="408" left="135" width="4" height="17" font="10"> </text>
<text top="752" left="782" width="4" height="17" font="10"> </text>
<text top="790" left="319" width="285" height="16" font="13"><b>Figure 21: Result of fourth variation </b></text>
<text top="809" left="135" width="4" height="17" font="10"> </text>
<text top="830" left="135" width="4" height="17" font="10"> </text>
<text top="851" left="266" width="4" height="17" font="10"> </text>
<text top="851" left="397" width="122" height="17" font="10">Minimum Score </text>
<text top="851" left="539" width="125" height="17" font="10">Maximum Score </text>
<text top="873" left="266" width="97" height="17" font="10">Similar Files </text>
<text top="873" left="397" width="54" height="17" font="10">10.087 </text>
<text top="873" left="539" width="54" height="17" font="10">33.083 </text>
<text top="894" left="266" width="110" height="17" font="10">Different Files </text>
<text top="894" left="397" width="54" height="17" font="10">37.659 </text>
<text top="894" left="539" width="54" height="17" font="10">77.971 </text>
<text top="917" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="937" left="334" width="254" height="16" font="13"><b>Table 13: Fourth variation score </b></text>
<text top="957" left="135" width="4" height="17" font="10"> </text>
<text top="999" left="135" width="599" height="17" font="10">No false positives or false negatives appeared in figure 21 with threshold of 4.576. </text>
</page>
<page number="58" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">44 </text>
<text top="130" left="135" width="183" height="18" font="18"><b>5.5.5 Fifth variation </b></text>
<text top="179" left="135" width="196" height="17" font="10">In this variation, the term n</text>
<text top="175" left="331" width="6" height="11" font="6">2</text>
<text top="179" left="337" width="179" height="17" font="10"> is kept constant as (110)</text>
<text top="175" left="516" width="6" height="11" font="6">2</text>
<text top="179" left="523" width="244" height="17" font="10"> and graph is plotted in figure 22. </text>
<text top="233" left="475" width="92" height="47" font="24">∑ ∑</text>
<text top="222" left="498" width="9" height="18" font="25">−</text>
<text top="222" left="472" width="9" height="18" font="25">=</text>
<text top="276" left="484" width="9" height="18" font="25">=</text>
<text top="220" left="563" width="9" height="18" font="25">−</text>
<text top="220" left="537" width="9" height="18" font="25">=</text>
<text top="276" left="549" width="9" height="18" font="25">=</text>
<text top="239" left="618" width="15" height="31" font="26">−</text>
<text top="239" left="336" width="15" height="31" font="26">=</text>
<text top="225" left="507" width="8" height="15" font="25">1</text>
<text top="279" left="494" width="8" height="15" font="25">0</text>
<text top="241" left="699" width="8" height="15" font="25">2</text>
<text top="223" left="572" width="8" height="15" font="25">1</text>
<text top="279" left="559" width="8" height="15" font="25">0</text>
<text top="262" left="421" width="8" height="15" font="25">2</text>
<text top="245" left="688" width="9" height="26" font="26">)</text>
<text top="245" left="667" width="9" height="26" font="26">)</text>
<text top="245" left="517" width="9" height="26" font="26">(</text>
<text top="245" left="456" width="9" height="26" font="26">(</text>
<text top="245" left="438" width="14" height="26" font="26">*</text>
<text top="266" left="410" width="9" height="26" font="26">)</text>
<text top="266" left="367" width="41" height="26" font="26">110</text>
<text top="266" left="360" width="9" height="26" font="26">(</text>
<text top="228" left="389" width="14" height="26" font="26">1</text>
<text top="226" left="483" width="11" height="15" font="27"><i>N</i></text>
<text top="226" left="465" width="4" height="15" font="27"><i>i</i></text>
<text top="280" left="477" width="4" height="15" font="27"><i>i</i></text>
<text top="224" left="549" width="11" height="15" font="27"><i>N</i></text>
<text top="224" left="530" width="4" height="15" font="27"><i>j</i></text>
<text top="280" left="542" width="4" height="15" font="27"><i>j</i></text>
<text top="260" left="651" width="9" height="15" font="27"><i>ij</i></text>
<text top="260" left="600" width="9" height="15" font="27"><i>ij</i></text>
<text top="246" left="638" width="14" height="25" font="28"><i>b</i></text>
<text top="246" left="586" width="14" height="25" font="28"><i>a</i></text>
<text top="246" left="209" width="116" height="25" font="28"><i>Difference</i></text>
<text top="263" left="715" width="4" height="17" font="10"> </text>
<text top="324" left="266" width="184" height="16" font="13"><b>Equation 6: Replaced N</b></text>
<text top="320" left="449" width="6" height="11" font="29"><b>2</b></text>
<text top="324" left="456" width="82" height="16" font="13"><b> with (110)</b></text>
<text top="320" left="537" width="6" height="11" font="29"><b>2</b></text>
<text top="324" left="544" width="113" height="16" font="13"><b> in Equation 1 </b></text>
<text top="344" left="135" width="4" height="17" font="10"> </text>
<text top="680" left="783" width="4" height="17" font="10"> </text>
<text top="718" left="327" width="269" height="16" font="13"><b>Figure 22: Result of fifth variation </b></text>
<text top="738" left="135" width="4" height="17" font="10"> </text>
<text top="779" left="135" width="617" height="17" font="10">Though there are no false positives or negatives present, threshold 0.012 is not larger </text>
<text top="821" left="135" width="404" height="17" font="10">enough. This proves that Equation 1 is more effective.   </text>
<text top="863" left="238" width="4" height="17" font="10"> </text>
<text top="863" left="368" width="122" height="17" font="10">Minimum Score </text>
<text top="863" left="511" width="125" height="17" font="10">Maximum Score </text>
<text top="884" left="238" width="97" height="17" font="10">Similar Files </text>
<text top="884" left="368" width="45" height="17" font="10">0.048 </text>
<text top="884" left="511" width="45" height="17" font="10">0.172 </text>
<text top="906" left="238" width="110" height="17" font="10">Different Files </text>
<text top="906" left="368" width="45" height="17" font="10">0.184 </text>
<text top="906" left="511" width="36" height="17" font="10">0.56 </text>
<text top="928" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="949" left="342" width="238" height="16" font="13"><b>Table 14: Fifth variation score </b></text>
<text top="988" left="135" width="7" height="22" font="16"><b> </b></text>
</page>
<page number="59" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">45 </text>
<text top="113" left="135" width="187" height="22" font="16"><b>6. Observations </b></text>
<text top="171" left="135" width="627" height="17" font="10">From all above test cases, we observed that the graph technique differentiates between </text>
<text top="212" left="135" width="304" height="17" font="10">metamorphic virus files and benign files.  </text>
<text top="254" left="135" width="4" height="17" font="10"> </text>
<text top="295" left="135" width="652" height="17" font="10">Graph technique was tested against many types of files. The similarity score distinguishes </text>
<text top="337" left="135" width="626" height="17" font="10">between similar and non-similar files. When two virus files not belonging to any virus </text>
<text top="378" left="135" width="612" height="17" font="10">family are compared, results show that their score fall in similarity range. When two </text>
<text top="419" left="135" width="634" height="17" font="10">metamorphic virus files from the same family are compared, again the score falls in the </text>
<text top="461" left="135" width="644" height="17" font="10">similarity range. When two benign files are compared against each other, score classifies </text>
<text top="502" left="135" width="154" height="17" font="10">them as similar files. </text>
<text top="543" left="135" width="4" height="17" font="10"> </text>
<text top="585" left="135" width="637" height="17" font="10">But when a benign file is compared against a simple virus or metamorphic virus, results </text>
<text top="626" left="135" width="640" height="17" font="10">immediately show that it belongs to different score range. When this score calculation is </text>
<text top="668" left="135" width="640" height="17" font="10">computed using variations in the formula, all figures from section 5.5 show that formula </text>
<text top="709" left="135" width="421" height="17" font="10">in equation 1 fits the best as compared to other variations. </text>
<text top="751" left="135" width="9" height="15" font="23"> </text>
</page>
<page number="60" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">46 </text>
<text top="446" left="837" width="4" height="17" font="10"> </text>
<text top="484" left="277" width="368" height="16" font="13"><b>Figure 23: Equation 1 results for both the cases </b></text>
<text top="504" left="135" width="4" height="17" font="10"> </text>
<text top="546" left="143" width="143" height="13" font="22"><b>Parameter Variations </b></text>
<text top="546" left="306" width="69" height="13" font="22"><b>Threshold </b></text>
<text top="546" left="396" width="97" height="13" font="22"><b>False Positives </b></text>
<text top="546" left="513" width="103" height="13" font="22"><b>False Negatives </b></text>
<text top="546" left="635" width="80" height="13" font="22"><b>Score range </b></text>
<text top="563" left="143" width="110" height="14" font="23">Without variation </text>
<text top="563" left="306" width="38" height="14" font="23">0.063 </text>
<text top="563" left="396" width="11" height="14" font="23">0 </text>
<text top="563" left="513" width="11" height="14" font="23">0 </text>
<text top="563" left="635" width="86" height="14" font="23">0.173 – 0.966 </text>
<text top="581" left="143" width="88" height="14" font="23">First variation </text>
<text top="581" left="306" width="25" height="14" font="23">NA </text>
<text top="581" left="396" width="11" height="14" font="23">2 </text>
<text top="581" left="513" width="19" height="14" font="23">17 </text>
<text top="581" left="635" width="94" height="14" font="23">0.003 – 0.0085 </text>
<text top="599" left="143" width="105" height="14" font="23">Second variation </text>
<text top="599" left="306" width="25" height="14" font="23">NA </text>
<text top="599" left="396" width="11" height="14" font="23">0 </text>
<text top="599" left="513" width="11" height="14" font="23">2 </text>
<text top="599" left="635" width="101" height="14" font="23">10.241 – 48.695 </text>
<text top="617" left="143" width="94" height="14" font="23">Third variation </text>
<text top="617" left="306" width="26" height="14" font="23">146 </text>
<text top="617" left="396" width="11" height="14" font="23">0 </text>
<text top="617" left="513" width="11" height="14" font="23">0 </text>
<text top="617" left="635" width="124" height="14" font="23">585.056 – 6783.549 </text>
<text top="635" left="143" width="101" height="14" font="23">Fourth variation </text>
<text top="635" left="306" width="38" height="14" font="23">4.576 </text>
<text top="635" left="396" width="11" height="14" font="23">0 </text>
<text top="635" left="513" width="11" height="14" font="23">0 </text>
<text top="635" left="635" width="101" height="14" font="23">10.087 – 77.971 </text>
<text top="653" left="143" width="90" height="14" font="23">Fifth variation </text>
<text top="653" left="306" width="38" height="14" font="23">0.012 </text>
<text top="653" left="396" width="11" height="14" font="23">0 </text>
<text top="653" left="513" width="11" height="14" font="23">0 </text>
<text top="653" left="635" width="79" height="14" font="23">0.048 – 0.56 </text>
<text top="673" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="694" left="256" width="411" height="16" font="13"><b>Table 15: Comparison between parameter variations </b></text>
<text top="713" left="135" width="4" height="17" font="10"> </text>
<text top="734" left="135" width="591" height="17" font="10">To check which variation was the most effective, all score ranges are normalized. </text>
<text top="775" left="135" width="590" height="17" font="10">Parameter variation 1 and 2 are removed from the comparison as there is no clear </text>
<text top="817" left="135" width="594" height="17" font="10">threshold between similar and different files. Table 16 shows all threshold values. </text>
<text top="859" left="135" width="134" height="13" font="22"><b>Parameter variation </b></text>
<text top="859" left="298" width="69" height="13" font="22"><b>Threshold </b></text>
<text top="859" left="388" width="97" height="13" font="22"><b>False Positives </b></text>
<text top="859" left="505" width="103" height="13" font="22"><b>False Negatives </b></text>
<text top="859" left="627" width="80" height="13" font="22"><b>Score range </b></text>
<text top="876" left="135" width="110" height="14" font="23">Without variation </text>
<text top="876" left="298" width="45" height="14" font="23">0.0630 </text>
<text top="876" left="388" width="11" height="14" font="23">0 </text>
<text top="876" left="505" width="11" height="14" font="23">0 </text>
<text top="876" left="627" width="86" height="14" font="23">0.173 – 0.966 </text>
<text top="894" left="135" width="143" height="14" font="23">Third variation / 10000 </text>
<text top="894" left="298" width="45" height="14" font="23">0.0146 </text>
<text top="894" left="388" width="11" height="14" font="23">0 </text>
<text top="894" left="505" width="11" height="14" font="23">0 </text>
<text top="894" left="627" width="101" height="14" font="23">0.0585 – 0.6783 </text>
<text top="912" left="135" width="135" height="14" font="23">Fourth variation / 100 </text>
<text top="912" left="298" width="45" height="14" font="23">0.0457 </text>
<text top="912" left="388" width="11" height="14" font="23">0 </text>
<text top="912" left="505" width="11" height="14" font="23">0 </text>
<text top="912" left="627" width="101" height="14" font="23">0.1008 – 0.7797 </text>
<text top="930" left="135" width="90" height="14" font="23">Fifth variation </text>
<text top="930" left="298" width="45" height="14" font="23">0.0120 </text>
<text top="930" left="388" width="11" height="14" font="23">0 </text>
<text top="930" left="505" width="11" height="14" font="23">0 </text>
<text top="930" left="627" width="79" height="14" font="23">0.048 – 0.56 </text>
<text top="950" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="971" left="208" width="507" height="16" font="13"><b>Table 16:  Comparison between normalized parameter variations </b></text>
<text top="1011" left="135" width="477" height="17" font="10">In equation 1, threshold is higher as compared to other variations. </text>
</page>
<page number="61" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">47 </text>
<text top="113" left="135" width="354" height="22" font="16"><b>7. Analysis of graph technique </b></text>
<text top="171" left="135" width="352" height="17" font="10">Following are the key features of this technique. </text>
<text top="210" left="135" width="596" height="21" font="10">•  Common instruction is present in both the files. Range of total difference for a </text>
<text top="255" left="162" width="260" height="17" font="10">common instruction (row) is 0 to 2. </text>
<text top="294" left="135" width="552" height="21" font="10">•  The sparse matrix is normalized to make it a row stochastic matrix. This </text>
<text top="339" left="162" width="595" height="17" font="10">normalization helps in calculating the probability of similarity. If the matrix is not </text>
<text top="381" left="162" width="552" height="17" font="10">normalized, then this technique can be attacked by increasing the number of </text>
<text top="422" left="162" width="344" height="17" font="10">instructions using dead or junk code insertions. </text>
<text top="461" left="135" width="608" height="21" font="10">•  If an instruction is present in one file but not in the other file, then it is a distinct </text>
<text top="506" left="162" width="550" height="17" font="10">instruction. The difference of rows representing distinct instructions is one.  </text>
<text top="547" left="135" width="4" height="17" font="10"> </text>
<text top="589" left="135" width="615" height="17" font="10">Due to all the above features, detection rate of the graph technique is close to 100%.  </text>
<text top="630" left="135" width="562" height="17" font="10">HMM virus detection technique [6] was also successful in detecting NGVCK </text>
<text top="672" left="135" width="621" height="17" font="10">metamorphic virus files. But HMM detection technique failed when morphing engine </text>
<text top="713" left="135" width="620" height="17" font="10">implemented in [7] was used to morph metamorphic virus copies by inserting 30% of </text>
<text top="754" left="135" width="148" height="17" font="10">dead and junk code. </text>
<text top="796" left="135" width="4" height="17" font="10"> </text>
<text top="837" left="135" width="632" height="17" font="10">Next step in this project is to create an attack on this graph technique by compromising </text>
<text top="879" left="135" width="621" height="17" font="10">its features and by using morphing engine from [7] to morph metamorphic virus files. </text>
<text top="939" left="135" width="7" height="22" font="16"><b> </b></text>
<text top="1013" left="135" width="7" height="22" font="16"><b> </b></text>
</page>
<page number="62" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">48 </text>
<text top="113" left="135" width="7" height="22" font="16"><b> </b></text>
<text top="186" left="135" width="390" height="22" font="16"><b>8. Attacks on the graph technique </b></text>
<text top="244" left="135" width="604" height="17" font="10">A metamorphic virus file may contain some instructions which are uncommon (not </text>
<text top="286" left="135" width="587" height="17" font="10">present) in benign files. If we try to replace or remove those instructions to make </text>
<text top="327" left="135" width="622" height="17" font="10">metamorphic virus file look like a benign file, then test that virus file against a benign </text>
<text top="368" left="135" width="606" height="17" font="10">file. This might give us score which falls in the similar score range. Removing such </text>
<text top="410" left="135" width="278" height="17" font="10">instructions will also lower the score.  </text>
<text top="470" left="135" width="349" height="20" font="17"><i><b>8.1 Removing distinct instructions </b></i></text>
<text top="522" left="135" width="607" height="17" font="10">Distinct instructions which are not present in benign file but present in virus file are </text>
<text top="563" left="135" width="620" height="17" font="10">removed from the virus file to make it look like a normal file. Almost 80% of distinct </text>
<text top="605" left="135" width="646" height="17" font="10">instructions are removed from a virus file, and scores are calculated. Figure 24 shows the </text>
<text top="646" left="135" width="341" height="17" font="10">different file scores before and after the attack. </text>
<text top="931" left="769" width="4" height="17" font="10"> </text>
<text top="969" left="199" width="524" height="16" font="13"><b>Figure 24: Graph for different files after instruction removal attack </b></text>
</page>
<page number="63" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">49 </text>
<text top="111" left="81" width="4" height="17" font="10"> </text>
<text top="153" left="241" width="4" height="17" font="10"> </text>
<text top="153" left="423" width="259" height="17" font="10">Minimum Score  Maximum Score </text>
<text top="175" left="241" width="227" height="17" font="10">Score before the attack  0.588 </text>
<text top="175" left="556" width="45" height="17" font="10">0.966 </text>
<text top="196" left="241" width="157" height="17" font="10">Score after the attack </text>
<text top="196" left="423" width="45" height="17" font="10">0.511 </text>
<text top="196" left="556" width="36" height="17" font="10">0.94 </text>
<text top="219" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="240" left="346" width="231" height="16" font="13"><b>Table 17: Different file scores </b></text>
<text top="259" left="135" width="4" height="17" font="10"> </text>
<text top="301" left="135" width="628" height="17" font="10">Minimum score fell below the threshold for different files. There is one false negative. </text>
<text top="343" left="246" width="4" height="17" font="10"> </text>
<text top="343" left="467" width="119" height="17" font="10">Threshold = 0.5 </text>
<text top="364" left="246" width="112" height="17" font="10">False Positives </text>
<text top="364" left="467" width="13" height="17" font="10">0 </text>
<text top="386" left="246" width="119" height="17" font="10">False Negatives </text>
<text top="386" left="467" width="13" height="17" font="10">1 </text>
<text top="408" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="429" left="220" width="482" height="16" font="13"><b>Table 18: Number of false positives / negatives after the attack </b></text>
<text top="448" left="135" width="4" height="17" font="10"> </text>
<text top="469" left="135" width="4" height="17" font="10"> </text>
<text top="511" left="135" width="602" height="17" font="10">From table 18 it is clear that, this attack is able to remove the threshold but it is not </text>
<text top="552" left="135" width="310" height="17" font="10">successful in defeating the virus detection. </text>
<text top="593" left="135" width="4" height="17" font="10"> </text>
<text top="850" left="782" width="4" height="17" font="10"> </text>
<text top="888" left="200" width="523" height="16" font="13"><b>Figure 25: Graph to compare similar and different files after attack </b></text>
</page>
<page number="64" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">50 </text>
<text top="130" left="135" width="293" height="20" font="17"><i><b>8.2 Using a morphing engine </b></i></text>
<text top="196" left="135" width="587" height="18" font="18"><b>8.2.1 Morphing engine based on subroutine code insertion and </b></text>
<text top="241" left="135" width="223" height="18" font="18"><b>instruction substitution </b></text>
<text top="290" left="135" width="586" height="17" font="10">In [7], morph engine results are really good in terms of junk and subroutine code </text>
<text top="331" left="135" width="617" height="17" font="10">insertions. Dead instructions are a set of instructions which are intentionally kept at a </text>
<text top="373" left="135" width="636" height="17" font="10">place where control never comes and those instructions will not be executed. False loop </text>
<text top="414" left="135" width="632" height="17" font="10">condition is never true and control does not enter in the loop through out the execution. </text>
<text top="455" left="135" width="648" height="17" font="10">When dead instructions are placed into the code segment, they do not get executed due to </text>
<text top="497" left="135" width="651" height="17" font="10">a new jump or a false loop condition. In [7], junk code insertion denotes dead instructions </text>
<text top="538" left="135" width="648" height="17" font="10">added in between a code segment. Before the dead instructions, a new jump instruction is </text>
<text top="579" left="135" width="620" height="17" font="10">added which points to the original code and avoids dead code execution. There is one </text>
<text top="621" left="135" width="624" height="17" font="10">more type of dead code insertion which is subroutine code insertion. A function in the </text>
<text top="662" left="135" width="639" height="17" font="10">morphing engine copies subroutines from normal file and pastes it into the virus copy to </text>
<text top="704" left="135" width="629" height="17" font="10">make it look similar to the normal file. As this subroutine is not called anywhere in the </text>
<text top="745" left="135" width="619" height="17" font="10">virus file, it becomes a dead code. Instruction substitution though not carried out on a </text>
<text top="786" left="135" width="586" height="17" font="10">higher percentage, morphs the virus copy. Instruction substitution is not of much </text>
<text top="828" left="135" width="462" height="17" font="10">importance here as it constitutes to 2-3% of the complete code.  </text>
<text top="869" left="135" width="4" height="17" font="10"> </text>
<text top="911" left="135" width="596" height="17" font="10">Here we have two major cases, junk code insertion and subroutine insertion. After </text>
<text top="952" left="135" width="648" height="17" font="10">modifying the morphing engine in [7] to satisfy current requirements, scores for 30% and </text>
<text top="993" left="135" width="506" height="17" font="10">40% morphing are calculated and following is a 30% morphed graph. </text>
<text top="1035" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="65" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">51 </text>
<text top="429" left="823" width="4" height="17" font="10"> </text>
<text top="467" left="199" width="524" height="16" font="13"><b>Figure 26: 30% subroutine code inserted in metamorphic virus files </b></text>
<text top="486" left="135" width="4" height="17" font="10"> </text>
<text top="528" left="135" width="607" height="17" font="10">In figure 26, similar file scores are getting merged with different file scores at some </text>
<text top="569" left="135" width="648" height="17" font="10">extent. Almost 4 files fall into false positive range. Similarly figure 27 is a graph for 40% </text>
<text top="611" left="135" width="639" height="17" font="10">subroutine code insertion case. It seems that this attack performs better than instructions </text>
<text top="652" left="135" width="120" height="17" font="10">removal attack.  </text>
<text top="985" left="782" width="4" height="17" font="10"> </text>
<text top="1024" left="199" width="524" height="16" font="13"><b>Figure 27: 40% subroutine code inserted in metamorphic virus files </b></text>
<text top="1043" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="66" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">52 </text>
<text top="111" left="135" width="442" height="17" font="13"><b>8.2.1.1 Comparing HMM and graph based detection </b></text>
<text top="157" left="135" width="651" height="17" font="10">We will compare these results with the results stated in [7]. Figure 28 shows the result for </text>
<text top="199" left="135" width="570" height="17" font="10">30% subroutine code insertion tested against HMM based detection technique. </text>
<text top="242" left="279" width="9" height="17" font="10">  </text>
<text top="242" left="392" width="246" height="17" font="10">Minimum score  Maximum score </text>
<text top="265" left="279" width="97" height="17" font="10">Similar Files </text>
<text top="265" left="433" width="45" height="17" font="10">0.173 </text>
<text top="265" left="557" width="45" height="17" font="10">0.525 </text>
<text top="288" left="279" width="110" height="17" font="10">Different Files </text>
<text top="288" left="433" width="45" height="17" font="10">0.428 </text>
<text top="288" left="557" width="45" height="17" font="10">0.926 </text>
<text top="312" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="333" left="292" width="338" height="16" font="13"><b>Table 19: Scores for graph based technique </b></text>
<text top="352" left="189" width="4" height="17" font="10"> </text>
<text top="376" left="348" width="220" height="17" font="10">False Positive  False Negative </text>
<text top="406" left="397" width="13" height="17" font="10">4 </text>
<text top="406" left="509" width="13" height="17" font="10">0 </text>
<text top="437" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="458" left="224" width="475" height="16" font="13"><b>Table 20: False positives / negatives in graph based technique </b></text>
<text top="478" left="135" width="4" height="17" font="10"> </text>
<text top="498" left="135" width="643" height="17" font="10">Table 19 and 20 shows results of our graph technique for morphed metamorphic viruses. </text>
<text top="519" left="135" width="4" height="17" font="10"> </text>
<text top="540" left="189" width="4" height="17" font="10"> </text>
<text top="563" left="310" width="112" height="17" font="10">False Positives </text>
<text top="563" left="458" width="119" height="17" font="10">False Negatives </text>
<text top="593" left="364" width="22" height="17" font="10">35 </text>
<text top="593" left="512" width="22" height="17" font="10">36 </text>
<text top="623" left="189" width="4" height="17" font="10"> </text>
<text top="645" left="188" width="547" height="16" font="13"><b>Table 21: HMM based detection results with 30% subroutine insertion </b></text>
<text top="665" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="67" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">53 </text>
<text top="515" left="783" width="4" height="17" font="10"> </text>
<text top="532" left="177" width="568" height="16" font="13"><b>Figure 28: HMM based detection results with 30% subroutines copied [7] </b></text>
<text top="552" left="135" width="4" height="17" font="10"> </text>
<text top="593" left="135" width="628" height="17" font="10">Table 21 and Figure 28 show that HMM virus detection technique was failing for 30% </text>
<text top="635" left="135" width="608" height="17" font="10">subroutine copying from normal file. But our graph technique works much better as </text>
<text top="676" left="135" width="620" height="17" font="10">compared to HMM based detection technique. Graph based detection technique has 4 </text>
<text top="718" left="135" width="651" height="17" font="10">false positives. In [7], HMM based detection failed for 30% subroutine code with 36 false </text>
<text top="759" left="135" width="607" height="17" font="10">negatives and 35 false positives. This way, second attack is also failing to break our </text>
<text top="800" left="135" width="335" height="17" font="10">graph technique and to evade virus detection.  </text>
<text top="860" left="135" width="548" height="18" font="18"><b>8.2.2 Morphing engine based on block dead code insertion </b></text>
<text top="909" left="135" width="642" height="17" font="10">In the block morphing, we are capturing a random block from benign file and appending </text>
<text top="950" left="135" width="638" height="17" font="10">that code into metamorphic virus. The size of the block depends upon the inputs such as </text>
<text top="992" left="135" width="639" height="17" font="10">percentage of morphing, virus and benign files, and the file sizes. First we need to count </text>
<text top="1033" left="135" width="641" height="17" font="10">the total number of lines present in the virus file. To count the number of lines, we parse </text>
</page>
<page number="68" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">54 </text>
<text top="111" left="135" width="610" height="17" font="10">the whole virus file ignoring comments, variable declarations, and blank lines. Then </text>
<text top="153" left="135" width="603" height="17" font="10">according to the given percentage input we calculate the total number of lines to be </text>
<text top="194" left="135" width="650" height="17" font="10">copied. Percentage value ranges from 0 to 1. For example, if the percentage value entered </text>
<text top="235" left="135" width="607" height="17" font="10">is x and total number of actual instruction lines is n, then total number of lines to be </text>
<text top="277" left="135" width="643" height="17" font="10">copied from benign file is n * x. If n is 700 and x is 0.2 then total number of lines copied </text>
<text top="318" left="135" width="626" height="17" font="10">from a benign file is 140. After appending the chunk of code in the metamorphic virus </text>
<text top="360" left="135" width="644" height="17" font="10">file, we calculate the similarity score for the metamorphic virus file as well as the benign </text>
<text top="401" left="135" width="635" height="17" font="10">file from which the chunk of code is copied. Figure 29 shows scores for all 40 morphed </text>
<text top="442" left="135" width="651" height="17" font="10">metamorphic viruses scored against 40 benign files for percentages ranging from 0.1 to 1. </text>
<text top="796" left="782" width="4" height="17" font="10"> </text>
<text top="813" left="235" width="453" height="16" font="13"><b>Figure 29: Scores for block morphed metamorphic viruses </b></text>
<text top="833" left="135" width="4" height="17" font="10"> </text>
<text top="854" left="135" width="639" height="17" font="10">There is huge drop in scores for different kind of files. For 100% of morphing, the score </text>
<text top="895" left="135" width="642" height="17" font="10">is below the threshold of 0.525. Till 30%, scores are not affected much. There are only 4 </text>
<text top="936" left="135" width="430" height="17" font="10">false positives and 6 false negatives as shown in figure 30.  </text>
</page>
<page number="69" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">55 </text>
<text top="419" left="782" width="4" height="17" font="10"> </text>
<text top="436" left="180" width="558" height="16" font="13"><b>Figure 30: Metamorphic and benign versus morphed metamorphic virus</b></text>
<text top="438" left="738" width="4" height="13" font="22"><b> </b></text>
<text top="456" left="459" width="4" height="13" font="22"><b> </b></text>
<text top="473" left="135" width="620" height="17" font="10">These scores are calculated when a morphed metamorphic virus is compared with the </text>
<text top="514" left="135" width="646" height="17" font="10">benign file from which the chunk of code is copied. Hence these two files look similar as </text>
<text top="556" left="135" width="617" height="17" font="10">we increase the percentage. Figure 31 shows a graph where metamorphic virus file is </text>
<text top="597" left="135" width="479" height="17" font="10">compared with the benign file from which the code is not copied.  </text>
<text top="885" left="782" width="4" height="17" font="10"> </text>
<text top="923" left="287" width="344" height="16" font="13"><b>Figure 31: Metamorphic versus other benign</b></text>
<text top="925" left="631" width="4" height="13" font="22"><b> </b></text>
<text top="964" left="459" width="4" height="13" font="22"><b> </b></text>
</page>
<page number="70" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">56 </text>
<text top="111" left="135" width="629" height="17" font="10">In figure 31, most of the scores are above the threshold of 0.5. It shows that even if the </text>
<text top="153" left="135" width="629" height="17" font="10">metamorphic virus file is morphed using benign code, it still can be detected using this </text>
<text top="194" left="135" width="124" height="17" font="10">graph technique. </text>
<text top="254" left="135" width="611" height="17" font="13"><b>8.2.2.1 Comparing HMM and graph based detection for block morphing </b></text>
<text top="299" left="135" width="647" height="17" font="10">For this comparison, we have calculated scores individually for all block morphed copies </text>
<text top="341" left="135" width="650" height="17" font="10">of metamorphic virus files and benign files. To calculate HMM scores we used the HMM </text>
<text top="382" left="135" width="634" height="17" font="10">detector from [6]. Around 800 scores were calculated for benign files and metamorphic </text>
<text top="424" left="135" width="602" height="17" font="10">virus files for all percentage cases. Figure 32 shows 30% block morphed scores for </text>
<text top="465" left="135" width="299" height="17" font="10">metamorphic virus files and benign files. </text>
<text top="506" left="135" width="4" height="17" font="10"> </text>
<text top="829" left="782" width="4" height="17" font="10"> </text>
<text top="846" left="281" width="360" height="16" font="13"><b>Figure 32: HMM - 30% block morphed scores </b></text>
<text top="866" left="135" width="4" height="17" font="10"> </text>
<text top="887" left="135" width="463" height="17" font="10">In figure 32, there are many false positives and false negatives.  </text>
<text top="907" left="135" width="4" height="17" font="10"> </text>
<text top="930" left="230" width="9" height="17" font="10">  </text>
<text top="930" left="441" width="246" height="17" font="10">Minimum score  Maximum score </text>
<text top="953" left="230" width="207" height="17" font="10">Morphed Metamorphic files </text>
<text top="953" left="478" width="51" height="17" font="10">-2.620 </text>
<text top="953" left="598" width="60" height="17" font="10">-43.488 </text>
<text top="976" left="230" width="92" height="17" font="10">Benign files </text>
<text top="976" left="478" width="51" height="17" font="10">-3.437 </text>
<text top="976" left="599" width="60" height="17" font="10">-31.602 </text>
<text top="1000" left="267" width="389" height="16" font="13"><b>Table 22: HMM - Minimum and maximum scores </b></text>
<text top="1020" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="71" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">57 </text>
<text top="111" left="135" width="595" height="17" font="10">From table 22, it is clear that all benign file scores lie inside the range of morphed </text>
<text top="153" left="135" width="641" height="17" font="10">metamorphic virus file scores. HMM is not able to distinguish between virus and benign </text>
<text top="194" left="135" width="636" height="17" font="10">files as there is no clear threshold to distinguish. If we consider a particular threshold of </text>
<text top="235" left="135" width="647" height="17" font="10">say -3.800 where &gt; -3.800 are metamorphic virus files and &lt; -3.800 are benign files, then </text>
<text top="277" left="135" width="578" height="17" font="10">values of false positives and false negatives are calculated as shown in table 23. </text>
<text top="321" left="348" width="220" height="17" font="10">False Positive  False Negative </text>
<text top="351" left="397" width="13" height="17" font="10">1 </text>
<text top="351" left="509" width="13" height="17" font="10">9 </text>
<text top="382" left="325" width="271" height="16" font="13"><b>Table 23: HMM - 30% false scores </b></text>
<text top="402" left="135" width="4" height="17" font="10"> </text>
<text top="443" left="135" width="647" height="17" font="10">Values of false positives and false negatives depend upon the threshold. If we increase or </text>
<text top="485" left="135" width="637" height="17" font="10">decrease the particular threshold then false scores are affected. Table 24 shows the false </text>
<text top="526" left="135" width="245" height="17" font="10">scores for 100% block morphing. </text>
<text top="865" left="782" width="4" height="17" font="10"> </text>
<text top="903" left="275" width="373" height="16" font="13"><b>Figure 33: HMM - 100% block morphed results </b></text>
<text top="943" left="135" width="639" height="17" font="10">Here if we consider threshold of -5.000 then table 24 shows the counts of false positives </text>
<text top="985" left="135" width="146" height="17" font="10">and false negatives. </text>
<text top="1026" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="72" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">58 </text>
<text top="114" left="348" width="220" height="17" font="10">False Positive  False Negative </text>
<text top="144" left="393" width="22" height="17" font="10">11 </text>
<text top="144" left="509" width="13" height="17" font="10">3 </text>
<text top="175" left="321" width="280" height="16" font="13"><b>Table 24: HMM - 100% false scores </b></text>
<text top="195" left="135" width="4" height="17" font="10"> </text>
<text top="236" left="135" width="629" height="17" font="10">From above figures and tables, it is clear that block morphing is not able to completely </text>
<text top="278" left="135" width="591" height="17" font="10">evade HMM based metamorphic virus detection. When we compare HMM based </text>
<text top="319" left="135" width="591" height="17" font="10">detection with graph based detection against block morphing engine, graph based </text>
<text top="361" left="135" width="621" height="17" font="10">detection is definitely more accurate than HMM as the numbers of false positives and </text>
<text top="402" left="135" width="445" height="17" font="10">false negatives are very less in case of graph based detection. </text>
<text top="462" left="135" width="569" height="18" font="18"><b>8.2.3 Morphing engine based on random dead code insertion </b></text>
<text top="511" left="135" width="630" height="17" font="10">In the random morphing, we are capturing a random block from benign file and evenly </text>
<text top="552" left="135" width="607" height="17" font="10">distributing the whole chunk of instructions into metamorphic virus. The size of the </text>
<text top="594" left="135" width="630" height="17" font="10">chunk depends upon the inputs such as percentage of morphing, virus and benign files, </text>
<text top="635" left="135" width="636" height="17" font="10">and the file sizes. It is similar to block morphing in calculating the total number of lines </text>
<text top="676" left="135" width="626" height="17" font="10">present in the virus file. Then according to the given percentage input we calculate the </text>
<text top="718" left="135" width="585" height="17" font="10">total number of lines to be copied. Percentage calculation is also similar to block </text>
<text top="759" left="135" width="648" height="17" font="10">morphing. Main difference between these two morphing engines is how the metamorphic </text>
<text top="801" left="135" width="609" height="17" font="10">virus file morphed using the code copied from benign file. In random morphing, the </text>
<text top="842" left="135" width="644" height="17" font="10">copied code is evenly distributed through out the metamorphic virus file depending upon </text>
<text top="883" left="135" width="640" height="17" font="10">a factor “after_lines”. Value of “after_lines” is calculated by dividing length of the virus </text>
<text top="925" left="135" width="626" height="17" font="10">file with total number of lines to be copied. For example if the morphing percentage is </text>
<text top="966" left="135" width="645" height="17" font="10">100% then each statement from the chunk of code is inserted after each instruction in the </text>
<text top="1008" left="135" width="589" height="17" font="10">virus file. Hence total number of lines in both the morphing engines will be same </text>
</page>
<page number="73" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">59 </text>
<text top="111" left="135" width="636" height="17" font="10">according to the percentage value. Figure 34 shows scores for all 40 randomly morphed </text>
<text top="153" left="135" width="651" height="17" font="10">metamorphic viruses scored against 40 benign files for percentages ranging from 0.1 to 1. </text>
<text top="475" left="783" width="4" height="17" font="10"> </text>
<text top="513" left="184" width="555" height="16" font="13"><b>Figure 34: Randomly morphed metamorphic viruses versus benign files </b></text>
<text top="534" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="553" left="135" width="638" height="17" font="10">Random morphing did not remove the threshold between similar and different files, and </text>
<text top="595" left="135" width="638" height="17" font="10">instead improved the similarity score between different types of files. Here the score for </text>
<text top="636" left="135" width="619" height="17" font="10">all percentages is higher than 0.5. Hence this technique is able to distinguish between </text>
<text top="677" left="135" width="368" height="17" font="10">morphed metamorphic virus files and benign files. </text>
<text top="719" left="135" width="4" height="17" font="10"> </text>
<text top="778" left="135" width="630" height="17" font="13"><b>8.2.3.1 Comparing HMM and graph based detection for random morphing </b></text>
<text top="824" left="135" width="611" height="17" font="10">For this comparison, we have calculated scores individually for all random morphed </text>
<text top="865" left="135" width="652" height="17" font="10">copies of metamorphic virus files and benign files. Around 800 scores were calculated for </text>
<text top="907" left="135" width="633" height="17" font="10">benign files and metamorphic virus files for all percentage cases. Figure 35 shows 30% </text>
<text top="948" left="135" width="502" height="17" font="10">random morphed scores for metamorphic virus files and benign files. </text>
</page>
<page number="74" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">60 </text>
<text top="410" left="783" width="4" height="17" font="10"> </text>
<text top="448" left="270" width="383" height="16" font="13"><b>Figure 35: HMM - 30% random morphed results </b></text>
<text top="468" left="135" width="4" height="17" font="10"> </text>
<text top="509" left="135" width="608" height="17" font="10">If we consider a threshold of -5.0 and &gt; -5.0 are metamorphic viruses and &lt; -5.0 are </text>
<text top="551" left="135" width="392" height="17" font="10">benign files, then table 25 shows false score statistics. </text>
<text top="595" left="348" width="220" height="17" font="10">False Positive  False Negative </text>
<text top="625" left="393" width="22" height="17" font="10">11 </text>
<text top="625" left="509" width="13" height="17" font="10">5 </text>
<text top="656" left="325" width="271" height="16" font="13"><b>Table 25: HMM - 30% false scores </b></text>
<text top="676" left="135" width="4" height="17" font="10"> </text>
<text top="717" left="135" width="652" height="17" font="10">Figure 36 shows score ranges for 100% randomly morphed metamorphic virus copies and </text>
<text top="759" left="135" width="93" height="17" font="10">benign files. </text>
</page>
<page number="75" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">61 </text>
<text top="404" left="782" width="4" height="17" font="10"> </text>
<text top="442" left="265" width="392" height="16" font="13"><b>Figure 36: HMM - 100% random morphed results </b></text>
<text top="461" left="135" width="4" height="17" font="10"> </text>
<text top="482" left="135" width="501" height="17" font="10">If we consider a threshold of -5.000 then table 26 shows false scores. </text>
<text top="523" left="135" width="4" height="17" font="10"> </text>
<text top="547" left="348" width="220" height="17" font="10">False Positive  False Negative </text>
<text top="577" left="393" width="22" height="17" font="10">11 </text>
<text top="577" left="509" width="13" height="17" font="10">5 </text>
<text top="608" left="325" width="271" height="16" font="13"><b>Table 26: HMM - 30% false scores </b></text>
<text top="628" left="135" width="4" height="17" font="10"> </text>
<text top="649" left="135" width="632" height="17" font="10">In random morphing, the total count of false positives and false negatives is larger than </text>
<text top="690" left="135" width="613" height="17" font="10">that of block morphing. Random morphing is more effective than block morphing in </text>
<text top="731" left="135" width="402" height="17" font="10">evading the HMM based metamorphic virus detection.  </text>
<text top="773" left="135" width="4" height="17" font="10"> </text>
<text top="815" left="135" width="562" height="20" font="17"><i><b>8.3 Reason behind all morphing results for graph based </b></i></text>
<text top="863" left="135" width="99" height="20" font="17"><i><b>detection </b></i></text>
<text top="911" left="135" width="599" height="17" font="10">In block morphing, the whole chunk is copied. That means the count of successive </text>
<text top="952" left="135" width="634" height="17" font="10">instructions is moving towards equality. It results in morphed metamorphic virus file to </text>
<text top="993" left="135" width="635" height="17" font="10">look like benign file from which the code is copied. But score between two similar files </text>
<text top="1035" left="135" width="624" height="17" font="10">also has some non-zero value. So if another benign file is compared with the morphed </text>
</page>
<page number="76" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">62 </text>
<text top="111" left="135" width="585" height="17" font="10">metamorphic virus file, then the score is still high which shows both the files are </text>
<text top="153" left="135" width="343" height="17" font="10">different. Figure 37 gives detailed information. </text>
<text top="621" left="783" width="4" height="17" font="10"> </text>
<text top="659" left="333" width="257" height="16" font="13"><b>Figure 37: Block morph example </b></text>
<text top="679" left="135" width="6" height="20" font="17"><i><b> </b></i></text>
<text top="703" left="135" width="639" height="17" font="10">In random morphing, the overall chunk is scattered in the whole metamorphic virus file. </text>
<text top="744" left="135" width="627" height="17" font="10">This distribution is even and statements are inserted after particular number of lines. If </text>
<text top="785" left="135" width="641" height="17" font="10">there is increase in the count of successive instructions, then the score will also increase. </text>
<text top="827" left="135" width="634" height="17" font="10">And due to new insertions of statements the count for those successive instructions will </text>
<text top="868" left="135" width="347" height="17" font="10">increase. Figure 38 shows detailed information. </text>
<text top="910" left="135" width="4" height="17" font="10"> </text>
<text top="200" left="181" width="124" height="22" font="11">Normal1.txt </text>
<text top="227" left="181" width="54" height="22" font="11">MOV </text>
<text top="255" left="181" width="51" height="22" font="11">ADD </text>
<text top="282" left="181" width="48" height="22" font="11">SUB </text>
<text top="200" left="431" width="102" height="22" font="11">Virus1.txt </text>
<text top="227" left="431" width="62" height="22" font="11">PUSH </text>
<text top="255" left="431" width="29" height="22" font="11">JZ </text>
<text top="282" left="431" width="44" height="22" font="11">INT </text>
<text top="413" left="276" width="157" height="18" font="3">Bmorph_virus1.txt </text>
<text top="435" left="276" width="51" height="18" font="3">PUSH </text>
<text top="458" left="276" width="24" height="18" font="3">JZ </text>
<text top="481" left="276" width="36" height="18" font="3">INT </text>
<text top="503" left="276" width="45" height="18" font="3">MOV </text>
<text top="526" left="276" width="43" height="18" font="3">ADD </text>
<text top="548" left="276" width="40" height="18" font="3">SUB </text>
<text top="200" left="622" width="124" height="22" font="11">Normal2.txt </text>
<text top="227" left="622" width="54" height="22" font="11">MOV </text>
<text top="255" left="622" width="51" height="22" font="11">ADD </text>
<text top="282" left="622" width="44" height="22" font="11">JNZ </text>
<text top="309" left="622" width="48" height="22" font="11">SUB </text>
<text top="521" left="144" width="50" height="22" font="11">Less </text>
<text top="548" left="144" width="91" height="22" font="11">different </text>
<text top="532" left="600" width="148" height="22" font="11">More different </text>
<text top="230" left="335" width="94" height="22" font="11">Different </text>
</page>
<page number="77" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">63 </text>
<text top="507" left="783" width="6" height="20" font="17"><i><b> </b></i></text>
<text top="527" left="321" width="275" height="16" font="13"><b>Figure 38: Random morph example</b></text>
<text top="524" left="596" width="6" height="20" font="17"><i><b> </b></i></text>
<text top="548" left="459" width="6" height="20" font="17"><i><b> </b></i></text>
<text top="571" left="135" width="637" height="17" font="10">Whenever there is increment in the count of successive instructions, score will increase. </text>
<text top="612" left="135" width="638" height="17" font="10">If the score is high, that means both the files are much different in appearance or nature. </text>
<text top="117" left="219" width="115" height="20" font="14">Normal1.txt </text>
<text top="142" left="219" width="50" height="20" font="14">MOV </text>
<text top="168" left="219" width="48" height="20" font="14">ADD </text>
<text top="193" left="219" width="45" height="20" font="14">SUB </text>
<text top="117" left="454" width="95" height="20" font="14">Virus1.txt </text>
<text top="142" left="454" width="58" height="20" font="14">PUSH </text>
<text top="168" left="454" width="27" height="20" font="14">JZ </text>
<text top="193" left="454" width="41" height="20" font="14">INT </text>
<text top="315" left="309" width="145" height="17" font="10">Bmorph_virus1.txt </text>
<text top="336" left="309" width="48" height="17" font="10">PUSH </text>
<text top="357" left="309" width="41" height="17" font="10">MOV </text>
<text top="378" left="309" width="22" height="17" font="10">JZ </text>
<text top="399" left="309" width="39" height="17" font="10">ADD </text>
<text top="420" left="309" width="33" height="17" font="10">INT </text>
<text top="440" left="309" width="37" height="17" font="10">SUB </text>
<text top="117" left="633" width="115" height="20" font="14">Normal2.txt </text>
<text top="142" left="633" width="50" height="20" font="14">MOV </text>
<text top="168" left="633" width="48" height="20" font="14">ADD </text>
<text top="193" left="633" width="41" height="20" font="14">JNZ </text>
<text top="218" left="633" width="45" height="20" font="14">SUB </text>
<text top="428" left="143" width="138" height="20" font="14">More different </text>
<text top="427" left="612" width="138" height="20" font="14">More different </text>
<text top="144" left="364" width="88" height="20" font="14">Different </text>
<text top="258" left="350" width="88" height="20" font="14">Morphed </text>
</page>
<page number="78" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="30" size="19" family="Times" color="#000000"/>
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">64 </text>
<text top="113" left="135" width="157" height="22" font="16"><b>9. Conclusion</b></text>
<text top="117" left="292" width="6" height="21" font="30"><i> </i></text>
<text top="167" left="135" width="556" height="17" font="10">Graph based detection technique distinguishes between viruses, benign files, </text>
<text top="208" left="135" width="638" height="17" font="10">metamorphic viruses, and randomly morphed metamorphic viruses. There is a threshold </text>
<text top="249" left="135" width="581" height="17" font="10">to distinguish between similar and different files with no false negatives or false </text>
<text top="291" left="135" width="635" height="17" font="10">positives. Graph based detection technique results show 100% detection with zero error </text>
<text top="332" left="135" width="43" height="17" font="10">rates. </text>
<text top="374" left="135" width="4" height="17" font="10"> </text>
<text top="415" left="135" width="594" height="17" font="10">Similar and different file scores are affected due to variations in the formula. First </text>
<text top="456" left="135" width="599" height="17" font="10">variation lowered the accuracy of the technique with 17 false negatives and 2 false </text>
<text top="498" left="135" width="619" height="17" font="10">positives. Second variation showed better results as compared to first variation. It has </text>
<text top="539" left="135" width="635" height="17" font="10">only two false negatives. Third and fourth variations show a separation between similar </text>
<text top="580" left="135" width="627" height="17" font="10">and different types of files but the threshold value is small. Third and fourth variations </text>
<text top="622" left="135" width="580" height="17" font="10">have less impact on the results of the graph based detection technique. From the </text>
<text top="663" left="135" width="618" height="17" font="10">normalized score, equation 1 is the most effective formula with maximum threshold.  </text>
<text top="705" left="135" width="4" height="17" font="10"> </text>
<text top="746" left="135" width="622" height="17" font="10">In total, four attacks are carried out on graph based detection technique. First attack is </text>
<text top="787" left="135" width="644" height="17" font="10">instruction removal attack. This attack is not much effective in defeating the graph based </text>
<text top="829" left="135" width="650" height="17" font="10">virus detection as there is only one false positive. Second attack is to morph metamorphic </text>
<text top="870" left="135" width="566" height="17" font="10">viruses using a morphing engine based on subroutine insertion and instruction </text>
<text top="912" left="135" width="639" height="17" font="10">substitution to evade virus detection by graph based detection technique. This attack not </text>
<text top="953" left="135" width="643" height="17" font="10">only removed the threshold, but also created false alarms. There are 4 false positives due </text>
<text top="994" left="135" width="646" height="17" font="10">to the second attack. Second attack shows good results as compared to first attack. Graph </text>
</page>
<page number="79" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">65 </text>
<text top="111" left="135" width="632" height="17" font="10">based detection results in second attack are compared with HMM based virus detection </text>
<text top="153" left="135" width="307" height="17" font="10">scores for morphed metamorphic viruses.  </text>
<text top="194" left="135" width="4" height="17" font="10"> </text>
<text top="235" left="135" width="628" height="17" font="10">For 30% of the subroutine code insertion, HMM based detection was showing 36 false </text>
<text top="277" left="135" width="647" height="17" font="10">negatives and 35 false positives for 40 benign files and 40 metamorphic viruses. In graph </text>
<text top="318" left="135" width="633" height="17" font="10">based detection technique only 4 false positives and no false negatives are observed for </text>
<text top="360" left="135" width="618" height="17" font="10">40 benign files and 40 metamorphic virus files. Though 4 benign files are caught as a </text>
<text top="401" left="135" width="323" height="17" font="10">virus, metamorphic virus detection is 100%. </text>
<text top="442" left="135" width="4" height="17" font="10"> </text>
<text top="484" left="135" width="618" height="17" font="10">For third and fourth attack, we created our own morphing engines to test graph based </text>
<text top="525" left="135" width="651" height="17" font="10">detection and HMM based detection. In the third attack, the morphing engine appends the </text>
<text top="567" left="135" width="618" height="17" font="10">virus file with a chunk of code copied from benign file. In block morphing, the graph </text>
<text top="608" left="135" width="618" height="17" font="10">based technique failed to detect all virus and benign files after 70% of morphing. But </text>
<text top="649" left="135" width="643" height="17" font="10">when the morphed copies were compared against other benign files from where the code </text>
<text top="691" left="135" width="599" height="17" font="10">is not copied, then the graph based technique was much effective in differentiating </text>
<text top="732" left="135" width="624" height="17" font="10">between morphed metamorphic virus files and benign files till 100% morphing. There </text>
<text top="774" left="135" width="623" height="17" font="10">were 3 false positives in 100% block morphing when compared with other benign file </text>
<text top="815" left="135" width="523" height="17" font="10">from which the code is not copied to morph the metamorphic virus file.  </text>
<text top="856" left="135" width="4" height="17" font="10"> </text>
<text top="898" left="135" width="614" height="17" font="10">In fourth attack, morphing engine is inserting each statement from the chunk of code </text>
<text top="939" left="135" width="645" height="17" font="10">copied from benign file, into virus file at a particular interval. This in effect increases the </text>
<text top="981" left="135" width="610" height="17" font="10">count of successive instructions. So the similarity score between randomly morphed </text>
</page>
<page number="80" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">66 </text>
<text top="111" left="135" width="629" height="17" font="10">metamorphic virus and benign virus file is increased, which shows that both these files </text>
<text top="153" left="135" width="142" height="17" font="10">are much different. </text>
<text top="194" left="135" width="4" height="17" font="10"> </text>
<text top="235" left="135" width="643" height="17" font="10">Graph based detection technique proved to be better in detecting metamorphic viruses as </text>
<text top="277" left="135" width="649" height="17" font="10">compared to HMM based virus detection technique. For graph based detection technique, </text>
<text top="318" left="135" width="618" height="17" font="10">the numbers of false positives and false negatives are very less as compared to HMM </text>
<text top="360" left="135" width="240" height="17" font="10">based virus detection technique.  </text>
</page>
<page number="81" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">67 </text>
<text top="131" left="135" width="184" height="22" font="16"><b>10. Future work </b></text>
<text top="189" left="135" width="620" height="17" font="10">Currently graph based detection technique is detecting NGVCK metamorphic viruses </text>
<text top="230" left="135" width="638" height="17" font="10">from IDAN family. We used an existing set of benign files, metamorphic virus files and </text>
<text top="272" left="135" width="582" height="17" font="10">other virus files. This set is limited in terms of file counts for viruses and benign </text>
<text top="313" left="135" width="646" height="17" font="10">software. Going forward, it would be useful if larger number of files is tested against this </text>
<text top="355" left="135" width="629" height="17" font="10">graph based detection technique. Every year millions of new malware are created [41]. </text>
<text top="396" left="135" width="633" height="17" font="10">So with larger data sets, it would be beneficial to consider more recent list of malware.  </text>
<text top="437" left="135" width="4" height="17" font="10"> </text>
<text top="479" left="135" width="608" height="17" font="10">In this paper, we concentrated on metamorphic viruses as they are the most difficult </text>
<text top="520" left="135" width="638" height="17" font="10">viruses to detect. This view can be broadened to other types of viruses like polymorphic </text>
<text top="561" left="135" width="276" height="17" font="10">virus, macro virus, resident virus etc.  </text>
<text top="603" left="135" width="4" height="17" font="10"> </text>
<text top="644" left="135" width="612" height="17" font="10">Any detection technique does not detect all types of malware. Another improvement </text>
<text top="686" left="135" width="588" height="17" font="10">would be to incorporate this graph based detection technique with other effective </text>
<text top="727" left="135" width="622" height="17" font="10">malware detection techniques to detect malware. This might prove to be effective and </text>
<text top="768" left="135" width="69" height="17" font="10">accurate. </text>
</page>
<page number="82" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">68 </text>
<text top="131" left="135" width="136" height="22" font="16"><b>References </b></text>
<text top="189" left="135" width="645" height="17" font="10">1. Nachenberg, C. (Jan, 1997), <i>Computer Virus Coevolution, </i>Retrieved on July 14, 2011, </text>
<text top="230" left="148" width="617" height="17" font="10">from website:<i> </i>http://www.csun.edu/~deb53351/Papers/Nachenberg_Computer_virus-</text>
<text top="272" left="148" width="190" height="17" font="10">antivirus_coevolution.pdf </text>
<text top="313" left="135" width="614" height="17" font="10">2. Top Choice Reviews (n.d.), <i>Types of Viruses, </i>Retrieved on August 21, 2011, from </text>
<text top="355" left="148" width="567" height="17" font="10">website: http://antivirus-software.topchoicereviews.com/types-of-viruses.html </text>
<text top="396" left="135" width="625" height="17" font="10">3. Konstantinou, E. (2008), <i>Metamorphic Virus: Analysis and Detection</i>, Retrieved on </text>
<text top="437" left="148" width="632" height="17" font="10">February 22, 2011, from website: http://www.ma.rhul.ac.uk/static/techrep/2008/RHUL-</text>
<text top="479" left="148" width="128" height="17" font="10">MA-2008-02.pdf </text>
<text top="520" left="135" width="607" height="17" font="10">4. Anderson, B. Quist, D. Neil, J. Storlie, C. Lane, T. (8 June, 2011), “<i>Graph-based </i></text>
<text top="562" left="148" width="600" height="16" font="15"><i>malware detection using dynamic analysis”</i>, Journal of Computer Virology, (June, </text>
<text top="603" left="148" width="294" height="17" font="10">2011), doi: 10.1007/s11416-011-0152-x </text>
<text top="644" left="135" width="549" height="17" font="10">5. M. Stamp, “Information Security: Principles and Practice,” August 2005. </text>
<text top="686" left="135" width="627" height="17" font="10">6. Wong, W. (May, 2006), <i>Analysis and Detection of Metamorphic Computer Viruses,</i> </text>
<text top="727" left="149" width="588" height="17" font="10">Master’s thesis, San Jose State University, Retrieved on February 01, 2011, from </text>
<text top="768" left="149" width="483" height="17" font="10">website: http://www.cs.sjsu.edu/faculty/stamp/students/Report.pdf </text>
<text top="810" left="135" width="640" height="17" font="10">7. Lin, D. (Dec, 2009), <i>Hunting for Undetectable Metamorphic Viruses</i>, Master’s thesis, </text>
<text top="851" left="149" width="521" height="17" font="10">San Jose State University, Retrieved on January 25, 2011 from website: </text>
<text top="893" left="149" width="414" height="17" font="10">http://www.cs.sjsu.edu/faculty/stamp/students/lin_da.pdf </text>
<text top="934" left="135" width="606" height="17" font="10">8. OSdata (2004), <i>Assembly Language</i>, Retrieved on March 10, 2011 from website: </text>
<text top="975" left="149" width="418" height="17" font="10">http://www.osdata.com/topic/language/asm/asmintro.htm </text>
</page>
<page number="83" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">69 </text>
<text top="111" left="135" width="601" height="17" font="10">9. Radev, D. (March 06, 2008), <i>Lecture 13 - Eigenvectors, Eigenvalues, Stochastic </i></text>
<text top="153" left="148" width="404" height="16" font="15"><i>Matrices,</i> Retrieved on October 11, 2011 from website: </text>
<text top="194" left="148" width="453" height="17" font="10">http://www1.cs.columbia.edu/~coms6998/Notes/lecture13.pdf </text>
<text top="235" left="135" width="647" height="17" font="10">10. AXIS ETRAX (May 19, 2005), <i>100LX Programmer’s Manual</i>, Retrieved on October </text>
<text top="277" left="148" width="171" height="17" font="10">28, 2011 from website: </text>
<text top="318" left="148" width="631" height="17" font="10">http://developer.axis.com/old/documentation/hw/etrax100lx/prog_man/5_assembly_lan</text>
<text top="360" left="148" width="98" height="17" font="10">g_syntax.pdf </text>
<text top="401" left="135" width="651" height="17" font="10">11. Low, R. (April 27, 2011). Discussion on Graph comparison formula, at San Jose State </text>
<text top="442" left="149" width="80" height="17" font="10">University </text>
<text top="484" left="135" width="639" height="17" font="10">12. SnakeByte (2002), <i>Next Generation Virus Construction Kit</i>, Retrieved on March 26, </text>
<text top="525" left="149" width="407" height="17" font="10">2011 from website: http://vx.netlux.org/vx.php?id=tn02 </text>
<text top="567" left="135" width="611" height="17" font="10">13. Cygwin (2011), <i>Cygwin Utility Files</i>, Retrieved on April 12, 2011 from website: </text>
<text top="608" left="149" width="185" height="17" font="10">http://www.cygwin.com/ </text>
<text top="649" left="135" width="642" height="17" font="10">14. Symantec (April 10, 2010), <i>Trojan Horse Risk Level 1: Very Low</i>, Retrieved on May </text>
<text top="691" left="149" width="162" height="17" font="10">9, 2011 from website: </text>
<text top="732" left="149" width="634" height="17" font="10">http://www.symantec.com/security_response/writeup.jsp?docid=2004-021914-2822-99 </text>
<text top="774" left="135" width="623" height="17" font="10">15. Symantec (October 04, 2006), <i>What is the difference between viruses, worms, and </i></text>
<text top="816" left="149" width="424" height="16" font="15"><i>Trojans?</i>, Retrieved on September 10, 2011 from website: </text>
<text top="856" left="149" width="526" height="17" font="10">http://service1.symantec.com/support/nav.nsf/docid/1999041209131106 </text>
<text top="898" left="135" width="650" height="17" font="10">16. Idika, N and Mathur, A, <i>A Survey of Malware Detection Techniques,</i>Technical report, </text>
<text top="939" left="149" width="616" height="17" font="10">Software Engineering Research Center, 2007. Retrieved Aug 19, 2011 from website: </text>
<text top="981" left="149" width="378" height="17" font="10">http://www.serc.net/system/files/SERC-TR-286.pdf </text>
</page>
<page number="84" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">70 </text>
<text top="111" left="135" width="582" height="17" font="10">17. Stamp, M.<i> </i>(Jan, 2004),<i> A Revealing Introduction to Hidden Markov Models</i>, </text>
<text top="153" left="148" width="627" height="17" font="10">Retrieved Jan 20, 2011, from website: http://www.cs.sjsu.edu/~stamp/RUA/HMM.pdf<i> </i></text>
<text top="194" left="135" width="568" height="17" font="10">18. Juang, B and Rabiner, L., <i>Hidden Markov Models for Speech Recognition</i>, </text>
<text top="235" left="148" width="425" height="17" font="10">Technometrics, Vol. 33, No. 3. (Aug., 1991), pp. 251-272. </text>
<text top="277" left="135" width="630" height="17" font="10">19. Stamp, M. (Jan, 2004), HMM Source Code, Retrieved Feb 20, 2011, from website: </text>
<text top="318" left="148" width="388" height="17" font="10">http://www.cs.sjsu.edu/~stamp/RUA/hmmSource.zip </text>
<text top="360" left="135" width="652" height="17" font="10">20. Desai, P. (2008), <i>Towards an Undetectable Computer Virus</i>, Master’s thesis, San Jose </text>
<text top="401" left="148" width="591" height="17" font="10">State University, Int. J. Multimedia Intelligence and Security, Vol. 1, No. 4, 2010<b> </b></text>
<text top="442" left="135" width="613" height="17" font="10">21. Programming Ground Up (n.d.), Programming from the ground up, Retrieved on </text>
<text top="484" left="148" width="252" height="17" font="10">November 05, 2011 from website: </text>
<text top="525" left="148" width="570" height="17" font="10">http://programminggroundup.blogspot.com/2007/01/appendix-b-common-x86-</text>
<text top="567" left="148" width="126" height="17" font="10">instructions.html </text>
<text top="608" left="135" width="586" height="17" font="10">22. Ogata, H. et.al. (Aug, 2000), <i>A heuristic graph comparison algorithm and its </i></text>
<text top="650" left="148" width="638" height="16" font="15"><i>application to detect functionally related enzyme clusters</i>, Retrieved Feb 25, 2011, from </text>
<text top="691" left="148" width="473" height="17" font="10">website: http://www.ncbi.nlm.nih.gov/pmc/articles/PMC110779  </text>
<text top="732" left="135" width="599" height="17" font="10">23. Hlaoui, A. and Wang, S. (n.d.), <i>A New Algorithm for Inexact Graph Matching,</i> </text>
<text top="774" left="148" width="625" height="17" font="10">Retrieved Feb 26, 2011, from website: http://citeseerx.ist.psu.edu/viewdoc/download? </text>
<text top="815" left="148" width="308" height="17" font="10">doi=10.1.1.90.6797&amp;rep=rep1&amp;type=pdf  </text>
<text top="856" left="135" width="643" height="17" font="10">24. ITU, (July 2008), “<i>Network security: Malware and Spam</i>”, Retrieved on October 29, </text>
<text top="898" left="148" width="573" height="17" font="10">2011 from website: http://www.itu.int/ITU-D/cyb/cybersecurity/docs/itu-study-</text>
<text top="939" left="148" width="319" height="17" font="10">financial-aspects-of-malware-and-spam.pdf </text>
</page>
<page number="85" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">71 </text>
<text top="111" left="135" width="595" height="17" font="10">25. Organization for economic co-operation and development, (2007), “<i>Malicious </i></text>
<text top="153" left="148" width="602" height="16" font="15"><i>software: A security threat to the internet economy</i>”, Retrieved on October 2, 2011 </text>
<text top="194" left="148" width="478" height="17" font="10">from website: http://www.oecd.org/dataoecd/53/34/40724457.pdf </text>
<text top="235" left="135" width="652" height="17" font="10">26. Computer economic, (n.d.), “<i>2007 Malware Report: The Economic Impact of Viruses, </i></text>
<text top="277" left="148" width="604" height="16" font="15"><i>Spyware, Adware, Botnets, and Other Malicious Code</i>”, Retrieved on November 2, </text>
<text top="318" left="148" width="144" height="17" font="10">2011 from website: </text>
<text top="360" left="148" width="546" height="17" font="10">http://www.computereconomics.com/page.cfm?name=Malware%20Report </text>
<text top="419" left="135" width="643" height="17" font="10">27. Panda Security (n.d.), “Virus, worms, trojans and backdoors: Other harmful relatives </text>
<text top="460" left="148" width="419" height="17" font="10">of viruses”, Retrieved on October 17, 2011 from website: </text>
<text top="502" left="148" width="622" height="17" font="10">http://www.pandasecurity.com/homeusers-cms3/security-info/about-malware/general-</text>
<text top="543" left="148" width="176" height="17" font="10">concepts/concept-2.htm </text>
<text top="589" left="135" width="631" height="17" font="10">28. Antivirus.about.com (n.d.), &#34;Boot sector virus repair&#34;, Retrieved Jan 27, 2011 from </text>
<text top="631" left="148" width="527" height="17" font="10">website: http://antivirus.about.com/od/securitytips/a/bootsectorvirus.htm </text>
<text top="672" left="135" width="618" height="17" font="10">29. Nachenberg, C. (n.d.), “<i>Understanding and managing Polymorphic viruses</i>”, The </text>
<text top="713" left="148" width="576" height="17" font="10">Symantec Enterprise Papers, vol. XXX, Retrieved on September 11, 2011 from </text>
<text top="755" left="148" width="476" height="17" font="10">website: http://www.symantec.com/avcenter/reference/striker.pdf </text>
<text top="796" left="135" width="638" height="17" font="10">30. Halfpap, B. (30 Mar, 2010), “<i>Artificial immune system virus detector</i>”, Retrieved on </text>
<text top="838" left="148" width="557" height="17" font="10">Aug 9, 2011 from website: http://resheth.wordpress.com/tag/virus-detection/ </text>
<text top="879" left="135" width="638" height="17" font="10">31. Peter Szor and Peter Ferrie, “<i>Hunting for metamorphic</i>”, Virus Bulletin Conference, </text>
<text top="920" left="148" width="122" height="17" font="10">September 2001 </text>
<text top="962" left="135" width="602" height="17" font="10">32. Mohamed R. Chouchane and Arun Lakhotia, “<i>Using engine signature to detect </i></text>
<text top="1004" left="148" width="439" height="16" font="15"><i>metamorphic malware</i>”. In WORM '06: Proceedings of the 4</text>
<text top="999" left="588" width="9" height="11" font="6">th</text>
<text top="1003" left="597" width="148" height="17" font="10"> ACM workshop on </text>
<text top="1045" left="148" width="543" height="17" font="10">Recurring malcode, pages 73{78, New York, NY, USA, 2006. ACM Press </text>
</page>
<page number="86" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">72 </text>
<text top="111" left="135" width="618" height="17" font="10">33. Andrew Walenstein, Rachit Mathur, Mohamed R. Chouchane R. Chouchane, and </text>
<text top="153" left="148" width="638" height="17" font="10">Arun Lakhotia, “<i>The design space of metamorphic malware</i>”. In Proceedings of the 2nd </text>
<text top="194" left="148" width="457" height="17" font="10">International Conference on Information Warfare, March 2007 </text>
<text top="235" left="135" width="277" height="17" font="10">34. VX Heavens. http://vx.netlux.org/ </text>
<text top="277" left="135" width="622" height="17" font="10">35. Priyadarshi, S. &#34;Metamorphic Detection via Emulation&#34; (2011), Master's Projects. </text>
<text top="318" left="148" width="357" height="17" font="10">Paper 177, Retrieved Jun 12, 2011 from website: </text>
<text top="360" left="148" width="331" height="17" font="10">http://scholarworks.sjsu.edu/etd_projects/177 </text>
<text top="401" left="135" width="639" height="17" font="10">36. Easy Net Live (n.d.), “<i>Signature based detection</i>”, Retrieved on November 19, 2011 </text>
<text top="442" left="149" width="465" height="17" font="10">from website: http://www.easynetlive.info/based-detection.html </text>
<text top="484" left="135" width="585" height="17" font="10">37. The Brown Corpus of Standard American English, available for download at </text>
<text top="525" left="149" width="424" height="17" font="10">http://www.cs.toronto.edu/~gpenn/csc401/a1res.html\verb </text>
<text top="567" left="135" width="587" height="17" font="10">38. Gartner, T. et al. (2003), “<i>On Graph Kernels: Hardness Results and Efficient </i></text>
<text top="609" left="148" width="314" height="16" font="15"><i>Alternatives</i>”, Springer, pp. 129–143, 2003<i> </i></text>
<text top="649" left="135" width="599" height="17" font="10">39. Berwick, R. and Idiot, V. (2003), “<i>An Idiot’s guide to Support Vector Machine </i></text>
<text top="691" left="149" width="402" height="16" font="15"><i>(SVMs)</i>”, Retrieved on October 21, 2011 from website: </text>
<text top="732" left="149" width="536" height="17" font="10">http://www.cs.ucf.edu/courses/cap6412/fall2009/papers/Berwick2003.pdf </text>
<text top="774" left="135" width="638" height="17" font="10">40. MikroElektronika (n.d.), “<i>Chapter 4: Assembly Language</i>”, Retrieved on November </text>
<text top="815" left="149" width="509" height="17" font="10">10, 2011 from website: http://www.easypsoc.com/book/chapter4.html </text>
<text top="874" left="135" width="629" height="17" font="10">41. G Data Software (9 Sep, 2010), “Number of new computer viruses at record high”, </text>
<text top="916" left="149" width="631" height="17" font="10">Retrieved on November 12, 2011 from website: http://www.gdatasoftware.co.uk/about-</text>
<text top="957" left="149" width="563" height="17" font="10">g-data/press-centre/news/news-details/article/1760-number-of-new-computer-</text>
<text top="999" left="149" width="93" height="17" font="10">viruses.html </text>
</page>
<page number="87" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">73 </text>
<text top="126" left="135" width="623" height="22" font="16"><b>Appendix A: More frequent assembly instructions [21] </b></text>
<text top="157" left="135" width="4" height="17" font="10"> </text>
<text top="180" left="142" width="134" height="14" font="22"><b>Instructions  Use </b></text>
<text top="200" left="142" width="37" height="14" font="23">push </text>
<text top="200" left="244" width="144" height="14" font="23">Push data onto stack </text>
<text top="220" left="142" width="33" height="14" font="23">mov </text>
<text top="220" left="244" width="249" height="14" font="23">Move data from one place to another </text>
<text top="240" left="142" width="33" height="14" font="23">cmp </text>
<text top="240" left="244" width="132" height="14" font="23">Compare operands </text>
<text top="259" left="142" width="24" height="14" font="23">jne </text>
<text top="259" left="244" width="126" height="14" font="23">Jump if not equals </text>
<text top="279" left="142" width="23" height="14" font="23">clc </text>
<text top="279" left="244" width="131" height="14" font="23">Clear the carry flag </text>
<text top="299" left="142" width="25" height="14" font="23">xor </text>
<text top="299" left="244" width="94" height="14" font="23">Exclusive OR </text>
<text top="319" left="142" width="28" height="14" font="23">adc </text>
<text top="319" left="244" width="102" height="14" font="23">Add with Carry </text>
<text top="339" left="142" width="23" height="14" font="23">inc </text>
<text top="339" left="244" width="103" height="14" font="23">Increment by 1 </text>
<text top="359" left="142" width="32" height="14" font="23">loop </text>
<text top="359" left="244" width="87" height="14" font="23">Loop control </text>
<text top="379" left="142" width="19" height="14" font="23">Jc </text>
<text top="379" left="244" width="99" height="14" font="23">Jump on carry </text>
<text top="399" left="142" width="28" height="14" font="23">jmp </text>
<text top="399" left="244" width="183" height="14" font="23">Simply jump to the location </text>
<text top="418" left="142" width="29" height="14" font="23">pop </text>
<text top="418" left="244" width="138" height="14" font="23">Pop data from stack </text>
<text top="438" left="142" width="40" height="14" font="23">leave </text>
<text top="438" left="244" width="127" height="14" font="23">Leave stack frame </text>
<text top="458" left="142" width="22" height="14" font="23">ret </text>
<text top="458" left="244" width="155" height="14" font="23">Return from procedure </text>
<text top="478" left="142" width="28" height="14" font="23">sbb </text>
<text top="478" left="244" width="162" height="14" font="23">Subtraction with Borrow </text>
<text top="498" left="142" width="23" height="14" font="23">jnc </text>
<text top="498" left="244" width="111" height="14" font="23">Jump if no carry </text>
<text top="518" left="142" width="38" height="14" font="23">enter </text>
<text top="518" left="244" width="122" height="14" font="23">Enter stack frame </text>
<text top="538" left="142" width="20" height="14" font="23">fld </text>
<text top="538" left="244" width="127" height="14" font="23">Floating point load </text>
<text top="558" left="142" width="48" height="14" font="23">fcomip </text>
<text top="558" left="244" width="66" height="14" font="23">Compare </text>
<text top="578" left="142" width="24" height="14" font="23">jna </text>
<text top="578" left="244" width="116" height="14" font="23">Jump if condition </text>
<text top="597" left="142" width="45" height="14" font="23">fcomp </text>
<text top="597" left="244" width="124" height="14" font="23">Compare and pop </text>
<text top="632" left="142" width="45" height="14" font="23">pusha </text>
<text top="615" left="244" width="265" height="14" font="23">Push all general purpose registers onto </text>
<text top="632" left="244" width="39" height="14" font="23">stack </text>
<text top="652" left="142" width="26" height="14" font="23">call </text>
<text top="652" left="244" width="102" height="14" font="23">Call procedure </text>
<text top="672" left="142" width="29" height="14" font="23">add </text>
<text top="672" left="244" width="58" height="14" font="23">Addition </text>
<text top="692" left="142" width="37" height="14" font="23">popa </text>
<text top="692" left="244" width="298" height="14" font="23">Pop all general purpose registers from stack </text>
<text top="712" left="142" width="20" height="14" font="23">Je </text>
<text top="712" left="244" width="101" height="14" font="23">Jump if equals </text>
<text top="730" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="88" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">74 </text>
<text top="131" left="135" width="491" height="22" font="16"><b>Appendix B: Additional scores and graphs </b></text>
<text top="487" left="770" width="4" height="17" font="10"> </text>
<text top="504" left="459" width="4" height="16" font="13"><b> </b></text>
<text top="525" left="310" width="303" height="16" font="13"><b>Figure 39: Graph with all comparisons </b></text>
<text top="544" left="135" width="4" height="17" font="10"> </text>
<text top="566" left="135" width="240" height="16" font="13"><b>Benign files versus benign files </b></text>
<text top="587" left="135" width="4" height="16" font="13"><b> </b></text>
<text top="608" left="142" width="47" height="16" font="13"><b>File 1 </b></text>
<text top="608" left="254" width="47" height="16" font="13"><b>File 2 </b></text>
<text top="608" left="365" width="47" height="16" font="13"><b>Score </b></text>
<text top="629" left="142" width="207" height="17" font="10">IDAR0.asm   IDAR1.asm  </text>
<text top="629" left="381" width="45" height="17" font="10">0.227 </text>
<text top="651" left="142" width="207" height="17" font="10">IDAR2.asm   IDAR3.asm  </text>
<text top="651" left="381" width="45" height="17" font="10">0.337 </text>
<text top="673" left="142" width="207" height="17" font="10">IDAR4.asm   IDAR5.asm  </text>
<text top="673" left="381" width="45" height="17" font="10">0.344 </text>
<text top="694" left="142" width="207" height="17" font="10">IDAR6.asm   IDAR7.asm  </text>
<text top="694" left="381" width="45" height="17" font="10">0.023 </text>
<text top="716" left="142" width="207" height="17" font="10">IDAR8.asm   IDAR9.asm  </text>
<text top="716" left="381" width="45" height="17" font="10">0.357 </text>
<text top="738" left="142" width="212" height="17" font="10">IDAR10.asm   IDAR11.asm </text>
<text top="738" left="381" width="45" height="17" font="10">0.255 </text>
<text top="760" left="142" width="212" height="17" font="10">IDAR12.asm   IDAR13.asm </text>
<text top="760" left="381" width="45" height="17" font="10">0.246 </text>
<text top="782" left="142" width="212" height="17" font="10">IDAR14.asm   IDAR15.asm </text>
<text top="782" left="381" width="45" height="17" font="10">0.468 </text>
<text top="804" left="142" width="212" height="17" font="10">IDAR16.asm   IDAR17.asm </text>
<text top="804" left="390" width="36" height="17" font="10">0.14 </text>
<text top="825" left="142" width="212" height="17" font="10">IDAR18.asm   IDAR19.asm </text>
<text top="825" left="381" width="45" height="17" font="10">0.138 </text>
<text top="847" left="142" width="212" height="17" font="10">IDAR20.asm   IDAR21.asm </text>
<text top="847" left="381" width="45" height="17" font="10">0.326 </text>
<text top="869" left="142" width="212" height="17" font="10">IDAR22.asm   IDAR23.asm </text>
<text top="869" left="381" width="45" height="17" font="10">0.431 </text>
<text top="891" left="142" width="212" height="17" font="10">IDAR24.asm   IDAR25.asm </text>
<text top="891" left="381" width="45" height="17" font="10">0.316 </text>
<text top="913" left="142" width="212" height="17" font="10">IDAR26.asm   IDAR27.asm </text>
<text top="913" left="381" width="45" height="17" font="10">0.289 </text>
<text top="934" left="142" width="212" height="17" font="10">IDAR28.asm   IDAR29.asm </text>
<text top="934" left="381" width="45" height="17" font="10">0.112 </text>
<text top="956" left="142" width="212" height="17" font="10">IDAR30.asm   IDAR31.asm </text>
<text top="956" left="381" width="45" height="17" font="10">0.231 </text>
<text top="978" left="142" width="212" height="17" font="10">IDAR32.asm   IDAR33.asm </text>
<text top="978" left="381" width="45" height="17" font="10">0.454 </text>
<text top="1000" left="142" width="212" height="17" font="10">IDAR34.asm   IDAR35.asm </text>
<text top="1000" left="381" width="45" height="17" font="10">0.431 </text>
<text top="1022" left="142" width="212" height="17" font="10">IDAR36.asm   IDAR37.asm </text>
<text top="1022" left="381" width="45" height="17" font="10">0.191 </text>
<text top="1044" left="142" width="212" height="17" font="10">IDAR38.asm   IDAR39.asm </text>
<text top="1044" left="381" width="45" height="17" font="10">0.424 </text>
</page>
<page number="89" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">75 </text>
<text top="112" left="135" width="250" height="16" font="13"><b>Family of Metamorphic Viruses </b></text>
<text top="132" left="445" width="4" height="17" font="10"> </text>
<text top="153" left="445" width="4" height="17" font="10"> </text>
<text top="173" left="445" width="4" height="17" font="10"> </text>
<text top="194" left="445" width="4" height="17" font="10"> </text>
<text top="215" left="445" width="4" height="17" font="10"> </text>
<text top="235" left="445" width="4" height="17" font="10"> </text>
<text top="256" left="445" width="4" height="17" font="10"> </text>
<text top="277" left="445" width="4" height="17" font="10"> </text>
<text top="298" left="445" width="4" height="17" font="10"> </text>
<text top="318" left="445" width="4" height="17" font="10"> </text>
<text top="339" left="445" width="4" height="17" font="10"> </text>
<text top="360" left="445" width="4" height="17" font="10"> </text>
<text top="380" left="445" width="4" height="17" font="10"> </text>
<text top="401" left="445" width="4" height="17" font="10"> </text>
<text top="422" left="445" width="4" height="17" font="10"> </text>
<text top="442" left="445" width="4" height="17" font="10"> </text>
<text top="463" left="445" width="4" height="17" font="10"> </text>
<text top="484" left="445" width="4" height="17" font="10"> </text>
<text top="505" left="445" width="4" height="17" font="10"> </text>
<text top="525" left="445" width="4" height="17" font="10"> </text>
<text top="546" left="445" width="4" height="17" font="10"> </text>
<text top="567" left="445" width="4" height="17" font="10"> </text>
<text top="587" left="445" width="4" height="17" font="10"> </text>
<text top="608" left="445" width="4" height="17" font="10"> </text>
<text top="629" left="445" width="4" height="17" font="10"> </text>
<text top="649" left="445" width="4" height="17" font="10"> </text>
<text top="670" left="445" width="4" height="17" font="10"> </text>
<text top="691" left="445" width="4" height="17" font="10"> </text>
<text top="712" left="445" width="4" height="17" font="10"> </text>
<text top="732" left="445" width="4" height="17" font="10"> </text>
<text top="753" left="445" width="4" height="17" font="10"> </text>
<text top="774" left="445" width="4" height="17" font="10"> </text>
<text top="794" left="445" width="4" height="17" font="10"> </text>
<text top="816" left="135" width="109" height="16" font="13"><b>Other viruses </b></text>
<text top="838" left="142" width="47" height="16" font="13"><b>File 1 </b></text>
<text top="838" left="242" width="47" height="16" font="13"><b>File 2 </b></text>
<text top="838" left="343" width="47" height="16" font="13"><b>Score </b></text>
<text top="860" left="142" width="84" height="14" font="23">IDAV0.asm  </text>
<text top="860" left="242" width="84" height="14" font="23">IDAV1.asm  </text>
<text top="860" left="361" width="42" height="14" font="23">0.007 </text>
<text top="880" left="142" width="84" height="14" font="23">IDAV2.asm  </text>
<text top="880" left="242" width="84" height="14" font="23">IDAV3.asm  </text>
<text top="880" left="361" width="42" height="14" font="23">0.016 </text>
<text top="900" left="142" width="84" height="14" font="23">IDAV4.asm  </text>
<text top="900" left="242" width="84" height="14" font="23">IDAV5.asm  </text>
<text top="900" left="361" width="42" height="14" font="23">0.012 </text>
<text top="921" left="142" width="84" height="14" font="23">IDAV6.asm  </text>
<text top="921" left="242" width="84" height="14" font="23">IDAV7.asm  </text>
<text top="921" left="361" width="42" height="14" font="23">0.003 </text>
<text top="941" left="142" width="84" height="14" font="23">IDAV8.asm  </text>
<text top="941" left="242" width="84" height="14" font="23">IDAV9.asm  </text>
<text top="941" left="361" width="42" height="14" font="23">0.023 </text>
<text top="961" left="142" width="189" height="14" font="23">IDAV10.asm   IDAV11.asm </text>
<text top="961" left="361" width="42" height="14" font="23">0.245 </text>
<text top="981" left="142" width="189" height="14" font="23">IDAV12.asm   IDAV13.asm </text>
<text top="981" left="361" width="42" height="14" font="23">0.236 </text>
<text top="1002" left="142" width="189" height="14" font="23">IDAV14.asm   IDAV15.asm </text>
<text top="1002" left="361" width="42" height="14" font="23">0.264 </text>
<text top="1022" left="142" width="189" height="14" font="23">IDAV16.asm   IDAV17.asm </text>
<text top="1022" left="361" width="42" height="14" font="23">0.333 </text>
<text top="1042" left="142" width="189" height="14" font="23">IDAV18.asm   IDAV19.asm </text>
<text top="1042" left="361" width="42" height="14" font="23">0.211 </text>
<text top="1062" left="142" width="189" height="14" font="23">IDAV20.asm   IDAV21.asm </text>
<text top="1062" left="361" width="42" height="14" font="23">0.174 </text>
<text top="134" left="142" width="47" height="16" font="13"><b>File 1 </b></text>
<text top="134" left="255" width="47" height="16" font="13"><b>File 2 </b></text>
<text top="134" left="367" width="47" height="16" font="13"><b>Score </b></text>
<text top="154" left="142" width="271" height="17" font="10">IDAN0.asm   IDAN1.asm   0.395 </text>
<text top="176" left="142" width="271" height="17" font="10">IDAN2.asm   IDAN3.asm   0.354 </text>
<text top="197" left="142" width="271" height="17" font="10">IDAN4.asm   IDAN5.asm   0.437 </text>
<text top="219" left="142" width="271" height="17" font="10">IDAN6.asm   IDAN7.asm   0.384 </text>
<text top="240" left="142" width="271" height="17" font="10">IDAN8.asm   IDAN9.asm   0.327 </text>
<text top="261" left="142" width="262" height="17" font="10">IDAN10.asm   IDAN11.asm  0.29 </text>
<text top="283" left="142" width="271" height="17" font="10">IDAN12.asm   IDAN13.asm  0.293 </text>
<text top="304" left="142" width="271" height="17" font="10">IDAN14.asm   IDAN15.asm  0.173 </text>
<text top="326" left="142" width="271" height="17" font="10">IDAN16.asm   IDAN17.asm  0.214 </text>
<text top="347" left="142" width="271" height="17" font="10">IDAN18.asm   IDAN19.asm  0.419 </text>
<text top="369" left="142" width="271" height="17" font="10">IDAN20.asm   IDAN21.asm  0.283 </text>
<text top="390" left="142" width="271" height="17" font="10">IDAN22.asm   IDAN23.asm  0.335 </text>
<text top="412" left="142" width="271" height="17" font="10">IDAN24.asm   IDAN25.asm  0.339 </text>
<text top="433" left="142" width="271" height="17" font="10">IDAN26.asm   IDAN27.asm  0.331 </text>
<text top="455" left="142" width="271" height="17" font="10">IDAN28.asm   IDAN29.asm  0.406 </text>
<text top="476" left="142" width="271" height="17" font="10">IDAN30.asm   IDAN31.asm  0.525 </text>
<text top="497" left="142" width="271" height="17" font="10">IDAN32.asm   IDAN33.asm  0.235 </text>
<text top="519" left="142" width="271" height="17" font="10">IDAN34.asm   IDAN35.asm  0.409 </text>
<text top="540" left="142" width="271" height="17" font="10">IDAN36.asm   IDAN37.asm  0.298 </text>
<text top="562" left="142" width="271" height="17" font="10">IDAN38.asm   IDAN39.asm  0.272 </text>
<text top="583" left="142" width="271" height="17" font="10">IDAN40.asm   IDAN41.asm  0.414 </text>
<text top="605" left="142" width="271" height="17" font="10">IDAN42.asm   IDAN43.asm  0.247 </text>
<text top="626" left="142" width="271" height="17" font="10">IDAN44.asm   IDAN45.asm  0.287 </text>
<text top="648" left="142" width="271" height="17" font="10">IDAN46.asm   IDAN47.asm  0.332 </text>
<text top="669" left="142" width="271" height="17" font="10">IDAN48.asm   IDAN49.asm  0.286 </text>
<text top="690" left="142" width="271" height="17" font="10">IDAN50.asm   IDAN51.asm  0.333 </text>
<text top="712" left="142" width="271" height="17" font="10">IDAN52.asm   IDAN53.asm  0.298 </text>
<text top="733" left="142" width="271" height="17" font="10">IDAN54.asm   IDAN55.asm  0.218 </text>
<text top="755" left="142" width="271" height="17" font="10">IDAN56.asm   IDAN57.asm  0.291 </text>
<text top="776" left="142" width="271" height="17" font="10">IDAN58.asm   IDAN59.asm  0.357 </text>
</page>
<page number="90" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">76 </text>
<text top="112" left="135" width="334" height="16" font="13"><b>Benign files versus metamorphic virus files </b></text>
<text top="133" left="135" width="4" height="16" font="13"><b> </b></text>
<text top="155" left="142" width="42" height="14" font="22"><b>File 1 </b></text>
<text top="155" left="243" width="42" height="14" font="22"><b>File 2 </b></text>
<text top="155" left="345" width="46" height="14" font="22"><b>Score </b></text>
<text top="175" left="142" width="85" height="14" font="23">IDAR0.asm  </text>
<text top="175" left="243" width="85" height="14" font="23">IDAN0.asm  </text>
<text top="175" left="363" width="42" height="14" font="23">0.702 </text>
<text top="195" left="142" width="85" height="14" font="23">IDAR1.asm  </text>
<text top="195" left="243" width="85" height="14" font="23">IDAN1.asm  </text>
<text top="195" left="363" width="42" height="14" font="23">0.738 </text>
<text top="215" left="142" width="85" height="14" font="23">IDAR2.asm  </text>
<text top="215" left="243" width="85" height="14" font="23">IDAN2.asm  </text>
<text top="215" left="363" width="42" height="14" font="23">0.933 </text>
<text top="235" left="142" width="85" height="14" font="23">IDAR3.asm  </text>
<text top="235" left="243" width="85" height="14" font="23">IDAN3.asm  </text>
<text top="235" left="363" width="42" height="14" font="23">0.706 </text>
<text top="254" left="142" width="85" height="14" font="23">IDAR4.asm  </text>
<text top="254" left="243" width="85" height="14" font="23">IDAN4.asm  </text>
<text top="254" left="371" width="33" height="14" font="23">0.82 </text>
<text top="274" left="142" width="85" height="14" font="23">IDAR5.asm  </text>
<text top="274" left="243" width="85" height="14" font="23">IDAN5.asm  </text>
<text top="274" left="363" width="42" height="14" font="23">0.675 </text>
<text top="294" left="142" width="85" height="14" font="23">IDAR6.asm  </text>
<text top="294" left="243" width="85" height="14" font="23">IDAN6.asm  </text>
<text top="294" left="363" width="42" height="14" font="23">0.782 </text>
<text top="314" left="142" width="85" height="14" font="23">IDAR7.asm  </text>
<text top="314" left="243" width="85" height="14" font="23">IDAN7.asm  </text>
<text top="314" left="363" width="42" height="14" font="23">0.588 </text>
<text top="334" left="142" width="85" height="14" font="23">IDAR8.asm  </text>
<text top="334" left="243" width="85" height="14" font="23">IDAN8.asm  </text>
<text top="334" left="363" width="42" height="14" font="23">0.635 </text>
<text top="354" left="142" width="85" height="14" font="23">IDAR9.asm  </text>
<text top="354" left="243" width="85" height="14" font="23">IDAN9.asm  </text>
<text top="354" left="363" width="42" height="14" font="23">0.761 </text>
<text top="374" left="142" width="190" height="14" font="23">IDAR10.asm  IDAN10.asm </text>
<text top="374" left="363" width="42" height="14" font="23">0.701 </text>
<text top="394" left="142" width="190" height="14" font="23">IDAR11.asm  IDAN11.asm </text>
<text top="394" left="363" width="42" height="14" font="23">0.677 </text>
<text top="413" left="142" width="190" height="14" font="23">IDAR12.asm  IDAN12.asm </text>
<text top="413" left="363" width="42" height="14" font="23">0.722 </text>
<text top="433" left="142" width="190" height="14" font="23">IDAR13.asm  IDAN13.asm </text>
<text top="433" left="363" width="42" height="14" font="23">0.666 </text>
<text top="453" left="142" width="190" height="14" font="23">IDAR14.asm  IDAN14.asm </text>
<text top="453" left="363" width="42" height="14" font="23">0.856 </text>
<text top="473" left="142" width="190" height="14" font="23">IDAR15.asm  IDAN15.asm </text>
<text top="473" left="363" width="42" height="14" font="23">0.714 </text>
<text top="493" left="142" width="190" height="14" font="23">IDAR16.asm  IDAN16.asm </text>
<text top="493" left="363" width="42" height="14" font="23">0.615 </text>
<text top="513" left="142" width="190" height="14" font="23">IDAR17.asm  IDAN17.asm </text>
<text top="513" left="371" width="33" height="14" font="23">0.64 </text>
<text top="533" left="142" width="190" height="14" font="23">IDAR18.asm  IDAN18.asm </text>
<text top="533" left="363" width="42" height="14" font="23">0.632 </text>
<text top="553" left="142" width="190" height="14" font="23">IDAR19.asm  IDAN19.asm </text>
<text top="553" left="380" width="25" height="14" font="23">0.7 </text>
<text top="573" left="142" width="190" height="14" font="23">IDAR20.asm  IDAN20.asm </text>
<text top="573" left="363" width="42" height="14" font="23">0.725 </text>
<text top="592" left="142" width="190" height="14" font="23">IDAR21.asm  IDAN21.asm </text>
<text top="592" left="380" width="25" height="14" font="23">0.7 </text>
<text top="612" left="142" width="190" height="14" font="23">IDAR22.asm  IDAN22.asm </text>
<text top="612" left="363" width="42" height="14" font="23">0.705 </text>
<text top="632" left="142" width="190" height="14" font="23">IDAR23.asm  IDAN23.asm </text>
<text top="632" left="371" width="33" height="14" font="23">0.66 </text>
<text top="652" left="142" width="190" height="14" font="23">IDAR24.asm  IDAN24.asm </text>
<text top="652" left="363" width="42" height="14" font="23">0.881 </text>
<text top="672" left="142" width="190" height="14" font="23">IDAR25.asm  IDAN25.asm </text>
<text top="672" left="363" width="42" height="14" font="23">0.803 </text>
<text top="692" left="142" width="190" height="14" font="23">IDAR26.asm  IDAN26.asm </text>
<text top="692" left="363" width="42" height="14" font="23">0.746 </text>
<text top="712" left="142" width="190" height="14" font="23">IDAR27.asm  IDAN27.asm </text>
<text top="712" left="363" width="42" height="14" font="23">0.663 </text>
<text top="731" left="142" width="190" height="14" font="23">IDAR28.asm  IDAN28.asm </text>
<text top="731" left="363" width="42" height="14" font="23">0.632 </text>
<text top="751" left="142" width="190" height="14" font="23">IDAR29.asm  IDAN29.asm </text>
<text top="751" left="363" width="42" height="14" font="23">0.695 </text>
<text top="771" left="142" width="190" height="14" font="23">IDAR30.asm  IDAN30.asm </text>
<text top="771" left="371" width="33" height="14" font="23">0.77 </text>
<text top="791" left="142" width="190" height="14" font="23">IDAR31.asm  IDAN31.asm </text>
<text top="791" left="363" width="42" height="14" font="23">0.759 </text>
<text top="811" left="142" width="190" height="14" font="23">IDAR32.asm  IDAN32.asm </text>
<text top="811" left="363" width="42" height="14" font="23">0.643 </text>
<text top="831" left="142" width="190" height="14" font="23">IDAR33.asm  IDAN33.asm </text>
<text top="831" left="363" width="42" height="14" font="23">0.725 </text>
<text top="851" left="142" width="190" height="14" font="23">IDAR34.asm  IDAN34.asm </text>
<text top="851" left="363" width="42" height="14" font="23">0.966 </text>
<text top="871" left="142" width="190" height="14" font="23">IDAR35.asm  IDAN35.asm </text>
<text top="871" left="363" width="42" height="14" font="23">0.806 </text>
<text top="890" left="142" width="190" height="14" font="23">IDAR36.asm  IDAN36.asm </text>
<text top="890" left="363" width="42" height="14" font="23">0.705 </text>
<text top="910" left="142" width="190" height="14" font="23">IDAR37.asm  IDAN37.asm </text>
<text top="910" left="363" width="42" height="14" font="23">0.783 </text>
<text top="930" left="142" width="190" height="14" font="23">IDAR38.asm  IDAN38.asm </text>
<text top="930" left="363" width="42" height="14" font="23">0.896 </text>
<text top="950" left="142" width="190" height="14" font="23">IDAR39.asm  IDAN39.asm </text>
<text top="950" left="371" width="33" height="14" font="23">0.79 </text>
<text top="970" left="142" width="190" height="14" font="23">IDAR40.asm  IDAN40.asm </text>
<text top="970" left="363" width="42" height="14" font="23">0.912 </text>
<text top="988" left="67" width="4" height="17" font="10"> </text>
<text top="1009" left="67" width="4" height="17" font="10"> </text>
</page>
<page number="91" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">77 </text>
<text top="392" left="782" width="4" height="17" font="10"> </text>
<text top="408" left="67" width="4" height="17" font="10"> </text>
<text top="429" left="67" width="4" height="17" font="10"> </text>
<text top="451" left="326" width="271" height="16" font="13"><b>Figure 40: 30% junk code inserted </b></text>
<text top="470" left="135" width="4" height="17" font="10"> </text>
<text top="791" left="783" width="4" height="17" font="10"> </text>
<text top="807" left="67" width="4" height="17" font="10"> </text>
<text top="829" left="325" width="272" height="16" font="13"><b>Figure 41: 30% dead code inserted </b></text>
<text top="849" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="92" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">78 </text>
<text top="412" left="770" width="4" height="14" font="23"> </text>
<text top="426" left="135" width="4" height="17" font="10"> </text>
<text top="448" left="325" width="272" height="16" font="13"><b>Figure 42: 40% dead code inserted </b></text>
<text top="468" left="135" width="4" height="17" font="10"> </text>
<text top="770" left="782" width="4" height="17" font="10"> </text>
<text top="786" left="135" width="4" height="17" font="10"> </text>
<text top="807" left="135" width="4" height="17" font="10"> </text>
<text top="829" left="326" width="271" height="16" font="13"><b>Figure 43: 40% junk code inserted </b></text>
<text top="849" left="135" width="4" height="17" font="10"> </text>
<text top="869" left="135" width="4" height="17" font="10"> </text>
<text top="890" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="93" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">79 </text>
<text top="433" left="782" width="4" height="17" font="10"> </text>
<text top="450" left="164" width="598" height="16" font="13"><b>Figure 44: Consolidated block morph HMM results for metamorphic viruses  </b></text>
<text top="469" left="135" width="4" height="17" font="10"> </text>
<text top="490" left="135" width="4" height="17" font="10"> </text>
<text top="824" left="783" width="4" height="17" font="10"> </text>
<text top="842" left="201" width="520" height="16" font="13"><b>Figure 45: Consolidated block morph HMM results for benign files </b></text>
<text top="861" left="135" width="4" height="17" font="10"> </text>
<text top="882" left="135" width="4" height="17" font="10"> </text>
</page>
<page number="94" position="absolute" top="0" left="0" height="1188" width="918">
<text top="1117" left="459" width="4" height="17" font="10"> </text>
<text top="1117" left="450" width="22" height="17" font="10">80 </text>
<text top="112" left="135" width="4" height="16" font="13"><b> </b></text>
<text top="461" left="782" width="4" height="16" font="13"><b> </b></text>
<text top="477" left="155" width="613" height="16" font="13"><b>Figure 46: Consolidated random morph HMM results for metamorphic viruses </b></text>
<text top="497" left="135" width="4" height="17" font="10"> </text>
<text top="518" left="135" width="4" height="17" font="10"> </text>
<text top="865" left="783" width="4" height="17" font="10"> </text>
<text top="882" left="192" width="539" height="16" font="13"><b>Figure 47: Consolidated random morph HMM results for benign files </b></text>
</page>
</pdf2xml>
