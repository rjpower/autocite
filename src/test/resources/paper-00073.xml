<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml>
<page number="1" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="0" size="35" family="Times" color="#000000"/>
	<fontspec id="1" size="15" family="Times" color="#000000"/>
	<fontspec id="2" size="23" family="Times" color="#000000"/>
<text top="274" left="129" width="674" height="33" font="0">Towards High Speed Aerial Tracking</text>
<text top="319" left="320" width="292" height="33" font="0">of Agile Targets</text>
<text top="405" left="456" width="19" height="16" font="1">by</text>
<text top="475" left="393" width="146" height="23" font="2">Yassir Rizwan</text>
<text top="630" left="435" width="62" height="16" font="1">A thesis</text>
<text top="652" left="313" width="305" height="16" font="1">presented to the University of Waterloo</text>
<text top="673" left="391" width="149" height="16" font="1">in fulﬁllment of the</text>
<text top="695" left="330" width="272" height="16" font="1">thesis requirement for the degree of</text>
<text top="717" left="365" width="201" height="16" font="1">Master of Applied Science</text>
<text top="738" left="458" width="15" height="16" font="1">in</text>
<text top="760" left="374" width="183" height="16" font="1">Mechanical Engineering</text>
<text top="867" left="338" width="255" height="16" font="1">Waterloo, Ontario, Canada, 2011</text>
<text top="930" left="384" width="168" height="16" font="1">c Yassir Rizwan 2011</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis,</text>
<text top="213" left="122" width="523" height="16" font="1">including any required ﬁnal revisions, as accepted by my examiners.</text>
<text top="261" left="122" width="611" height="16" font="1">I understand that my thesis may be made electronically available to the public.</text>
<text top="1038" left="461" width="10" height="16" font="1">ii</text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="427" width="77" height="16" font="1">Abstract</text>
<text top="241" left="148" width="662" height="16" font="1">In order to provide a novel perspective for videography of high speed sporting events, a</text>
<text top="263" left="121" width="688" height="16" font="1">highly capable trajectory tracking control methodology is developed for a custom designed</text>
<text top="284" left="121" width="689" height="16" font="1">Kadet Senior Unmanned Aerial Vehicle (UAV). The accompanying high ﬁdelity system</text>
<text top="306" left="121" width="688" height="16" font="1">identiﬁcation ensures that accurate ﬂight models are used to design the control laws. A</text>
<text top="328" left="121" width="689" height="16" font="1">parallel vision based target tracking technique is also demonstrated and implemented on a</text>
<text top="349" left="121" width="604" height="16" font="1">Graphical Processing Unit (GPU), to assist in real-time tracking of the target.</text>
<text top="380" left="148" width="662" height="16" font="1">Nonlinear control techniques like feedback linearization require a detailed and accurate</text>
<text top="402" left="121" width="689" height="16" font="1">system model. This thesis discusses techniques used for estimating these models using</text>
<text top="423" left="121" width="689" height="16" font="1">data collected during planned test ﬂights. A class of methods known as the Output Error</text>
<text top="445" left="121" width="689" height="16" font="1">Methods are discussed with extensions for dealing with wind turbulence. Implementation</text>
<text top="467" left="121" width="689" height="16" font="1">of these methods, including data acquisition details, on the Kadet Senior are also discussed.</text>
<text top="488" left="121" width="689" height="16" font="1">Results for this UAV are provided. For comparison, additional results using data from a</text>
<text top="510" left="121" width="688" height="16" font="1">BAC-221 simulation are also provided as well as typical results from the work done at the</text>
<text top="532" left="121" width="245" height="16" font="1">Dryden Flight Research Center.</text>
<text top="562" left="148" width="662" height="16" font="1">The proposed controller combines feedback linearization with linear tracking control</text>
<text top="584" left="121" width="689" height="16" font="1">using the internal model approach, and relies on a trajectory generating exosystem. Three</text>
<text top="606" left="121" width="688" height="16" font="1">diﬀerent aircraft models are presented each with increasing levels of complexity, in an</text>
<text top="627" left="121" width="688" height="16" font="1">eﬀort to identify the simplest controller that yields acceptable performance. The dynamic</text>
<text top="649" left="121" width="689" height="16" font="1">inversion and linear tracking control laws are derived for each model, and simulation results</text>
<text top="671" left="121" width="648" height="16" font="1">are presented for tracking of elliptical and periodic trajectories on the Kadet Senior.</text>
<text top="1038" left="458" width="15" height="16" font="1">iii</text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="382" width="167" height="16" font="1">Acknowledgements</text>
<text top="241" left="148" width="662" height="16" font="1">I would like to thank Professor Steven L. Waslander and Professor Sebastian Fischmeis-</text>
<text top="263" left="121" width="689" height="16" font="1">ter for their wisdom, guidance, patience and continued support throughout the last couple</text>
<text top="284" left="121" width="689" height="16" font="1">years. I would also like to thank my labmates who helped with this research, namely,</text>
<text top="306" left="121" width="688" height="16" font="1">Pie, for system identiﬁcation, Carlos, for vision, Kyel, PJ, Arun and Yan for hardware</text>
<text top="328" left="121" width="689" height="16" font="1">development, John D., for his expert advice and Mike T., for ﬂight tests. Outside the</text>
<text top="349" left="121" width="689" height="16" font="1">lab I would like to thank Steve Buchanan, for ﬂying the Kadet Senior bare handed in the</text>
<text top="371" left="121" width="688" height="16" font="1">middle of winter. I would also like to thank Ryan and Sid for creating a good atmosphere</text>
<text top="393" left="121" width="305" height="16" font="1">of collaborative research within the lab.</text>
<text top="423" left="148" width="662" height="16" font="1">Above all, I’d like to thank my family and friends for their unconditional and continued</text>
<text top="445" left="121" width="394" height="16" font="1">support. This would not be possible without them.</text>
<text top="1038" left="459" width="14" height="16" font="1">iv</text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="418" width="95" height="16" font="1">Dedication</text>
<text top="241" left="122" width="689" height="16" font="1">This thesis is dedicated to my late friend Jeﬀrey Aho and to the peaceful use of UAV</text>
<text top="263" left="122" width="85" height="16" font="1">technology.</text>
<text top="1038" left="461" width="9" height="16" font="1">v</text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1188" width="918">
<text top="306" left="122" width="325" height="33" font="0">Table of Contents</text>
<text top="427" left="122" width="128" height="16" font="1"><a href="pdfxml.html#8">List of Figures</a></text>
<text top="427" left="783" width="27" height="16" font="1">viii</text>
<text top="474" left="122" width="10" height="16" font="1"><a href="pdfxml.html#10">1</a></text>
<text top="474" left="148" width="111" height="16" font="1"><a href="pdfxml.html#10">Introduction</a></text>
<text top="474" left="800" width="10" height="16" font="1">1</text>
<text top="505" left="148" width="22" height="16" font="1"><a href="pdfxml.html#13">1.1</a></text>
<text top="505" left="188" width="579" height="16" font="1"><a href="pdfxml.html#13">Contributions </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="505" left="801" width="9" height="16" font="1">4</text>
<text top="535" left="148" width="22" height="16" font="1"><a href="pdfxml.html#13">1.2</a></text>
<text top="535" left="188" width="579" height="16" font="1"><a href="pdfxml.html#13">Outline of the Thesis </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="535" left="801" width="9" height="16" font="1">4</text>
<text top="583" left="122" width="10" height="16" font="1"><a href="pdfxml.html#15">2</a></text>
<text top="583" left="148" width="250" height="16" font="1"><a href="pdfxml.html#15">GPU Based Vision Tracking</a></text>
<text top="583" left="800" width="10" height="16" font="1">6</text>
<text top="613" left="148" width="22" height="16" font="1"><a href="pdfxml.html#15">2.1</a></text>
<text top="613" left="188" width="579" height="16" font="1"><a href="pdfxml.html#15">Motivation </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="613" left="801" width="9" height="16" font="1">6</text>
<text top="643" left="148" width="22" height="16" font="1"><a href="pdfxml.html#15">2.2</a></text>
<text top="643" left="188" width="579" height="16" font="1"><a href="pdfxml.html#15">Current Work in GPU Based Computer Vision </a>. . . . . . . . . . . . . . . .</text>
<text top="643" left="801" width="9" height="16" font="1">6</text>
<text top="673" left="148" width="22" height="16" font="1"><a href="pdfxml.html#19">2.3</a></text>
<text top="673" left="188" width="156" height="16" font="1"><a href="pdfxml.html#19">OpenCL Framework</a></text>
<text top="673" left="361" width="406" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="673" left="792" width="18" height="16" font="1">10</text>
<text top="703" left="148" width="22" height="16" font="1"><a href="pdfxml.html#25">2.4</a></text>
<text top="703" left="188" width="579" height="16" font="1"><a href="pdfxml.html#25">Target Tracking Algorithm </a>. . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="703" left="792" width="18" height="16" font="1">16</text>
<text top="734" left="148" width="22" height="16" font="1"><a href="pdfxml.html#26">2.5</a></text>
<text top="734" left="188" width="579" height="16" font="1"><a href="pdfxml.html#26">Algorithm Description and Implementation </a>. . . . . . . . . . . . . . . . . .</text>
<text top="734" left="792" width="18" height="16" font="1">17</text>
<text top="764" left="148" width="22" height="16" font="1"><a href="pdfxml.html#31">2.6</a></text>
<text top="764" left="188" width="579" height="16" font="1"><a href="pdfxml.html#31">Results </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="764" left="792" width="18" height="16" font="1">22</text>
<text top="812" left="122" width="10" height="16" font="1"><a href="pdfxml.html#33">3</a></text>
<text top="812" left="148" width="187" height="16" font="1"><a href="pdfxml.html#33">System Identiﬁcation</a></text>
<text top="812" left="790" width="20" height="16" font="1">24</text>
<text top="842" left="148" width="22" height="16" font="1"><a href="pdfxml.html#33">3.1</a></text>
<text top="842" left="188" width="579" height="16" font="1"><a href="pdfxml.html#33">Introduction </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="842" left="792" width="18" height="16" font="1">24</text>
<text top="872" left="148" width="22" height="16" font="1"><a href="pdfxml.html#35">3.2</a></text>
<text top="872" left="188" width="240" height="16" font="1"><a href="pdfxml.html#35">General 9 State Aircraft Model</a></text>
<text top="872" left="444" width="323" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="872" left="792" width="18" height="16" font="1">26</text>
<text top="902" left="148" width="22" height="16" font="1"><a href="pdfxml.html#40">3.3</a></text>
<text top="902" left="188" width="579" height="16" font="1"><a href="pdfxml.html#40">System Identiﬁcation Using the Output Error Method </a>. . . . . . . . . . . .</text>
<text top="902" left="792" width="18" height="16" font="1">31</text>
<text top="932" left="188" width="36" height="16" font="1"><a href="pdfxml.html#40">3.3.1</a></text>
<text top="932" left="244" width="523" height="16" font="1"><a href="pdfxml.html#40">System Setup </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="932" left="792" width="18" height="16" font="1">31</text>
<text top="963" left="188" width="36" height="16" font="1"><a href="pdfxml.html#41">3.3.2</a></text>
<text top="963" left="244" width="523" height="16" font="1"><a href="pdfxml.html#41">Deﬁning the Cost Function </a>. . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="963" left="792" width="18" height="16" font="1">32</text>
<text top="993" left="188" width="36" height="16" font="1"><a href="pdfxml.html#42">3.3.3</a></text>
<text top="993" left="244" width="523" height="16" font="1"><a href="pdfxml.html#42">Optimization Methods </a>. . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="993" left="792" width="18" height="16" font="1">33</text>
<text top="1038" left="459" width="14" height="16" font="1">vi</text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="188" width="36" height="16" font="1"><a href="pdfxml.html#43">3.3.4</a></text>
<text top="191" left="244" width="523" height="16" font="1"><a href="pdfxml.html#43">Algorithm Steps </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="191" left="792" width="18" height="16" font="1">34</text>
<text top="219" left="188" width="36" height="16" font="1"><a href="pdfxml.html#44">3.3.5</a></text>
<text top="219" left="244" width="523" height="16" font="1"><a href="pdfxml.html#44">Flight Maneuvers </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="219" left="792" width="18" height="16" font="1">35</text>
<text top="246" left="148" width="22" height="16" font="1"><a href="pdfxml.html#45">3.4</a></text>
<text top="246" left="188" width="579" height="16" font="1"><a href="pdfxml.html#45">Atmospheric Turbulence </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="246" left="792" width="18" height="16" font="1">36</text>
<text top="274" left="148" width="22" height="16" font="1"><a href="pdfxml.html#48">3.5</a></text>
<text top="274" left="188" width="579" height="16" font="1"><a href="pdfxml.html#48">Results from BAC-221 Simulation </a>. . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="274" left="792" width="18" height="16" font="1">39</text>
<text top="302" left="148" width="22" height="16" font="1"><a href="pdfxml.html#49">3.6</a></text>
<text top="302" left="188" width="579" height="16" font="1"><a href="pdfxml.html#49">Data Collection </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="302" left="792" width="18" height="16" font="1">40</text>
<text top="330" left="188" width="36" height="16" font="1"><a href="pdfxml.html#51">3.6.1</a></text>
<text top="330" left="244" width="210" height="16" font="1"><a href="pdfxml.html#51">Attitude and Wind Sensors</a></text>
<text top="330" left="472" width="296" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . .</text>
<text top="330" left="792" width="18" height="16" font="1">42</text>
<text top="357" left="188" width="36" height="16" font="1"><a href="pdfxml.html#52">3.6.2</a></text>
<text top="357" left="244" width="523" height="16" font="1"><a href="pdfxml.html#52">Ground Control and Monitoring </a>. . . . . . . . . . . . . . . . . . . .</text>
<text top="357" left="792" width="18" height="16" font="1">43</text>
<text top="385" left="188" width="36" height="16" font="1"><a href="pdfxml.html#54">3.6.3</a></text>
<text top="385" left="244" width="523" height="16" font="1"><a href="pdfxml.html#54">Real-time Thread Execution in QNX </a>. . . . . . . . . . . . . . . . .</text>
<text top="385" left="792" width="18" height="16" font="1">45</text>
<text top="413" left="148" width="22" height="16" font="1"><a href="pdfxml.html#55">3.7</a></text>
<text top="413" left="188" width="579" height="16" font="1"><a href="pdfxml.html#55">Results from Kadet Senior </a>. . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="413" left="792" width="18" height="16" font="1">46</text>
<text top="441" left="188" width="36" height="16" font="1"><a href="pdfxml.html#55">3.7.1</a></text>
<text top="441" left="244" width="523" height="16" font="1"><a href="pdfxml.html#55">Simplifying the Model and Reducing Identiﬁcation Errors </a>. . . . . .</text>
<text top="441" left="792" width="18" height="16" font="1">46</text>
<text top="468" left="148" width="22" height="16" font="1"><a href="pdfxml.html#59">3.8</a></text>
<text top="468" left="188" width="579" height="16" font="1"><a href="pdfxml.html#59">Conclusions </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="468" left="792" width="18" height="16" font="1">50</text>
<text top="514" left="122" width="10" height="16" font="1"><a href="pdfxml.html#66">4</a></text>
<text top="514" left="148" width="184" height="16" font="1"><a href="pdfxml.html#66">Nonlinear Controller</a></text>
<text top="514" left="790" width="20" height="16" font="1">57</text>
<text top="541" left="148" width="22" height="16" font="1"><a href="pdfxml.html#66">4.1</a></text>
<text top="541" left="188" width="579" height="16" font="1"><a href="pdfxml.html#66">Introduction </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="541" left="792" width="18" height="16" font="1">57</text>
<text top="569" left="148" width="22" height="16" font="1"><a href="pdfxml.html#68">4.2</a></text>
<text top="569" left="188" width="211" height="16" font="1"><a href="pdfxml.html#68">Aircraft and Target Models</a></text>
<text top="569" left="417" width="351" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="569" left="792" width="18" height="16" font="1">59</text>
<text top="597" left="188" width="36" height="16" font="1"><a href="pdfxml.html#68">4.2.1</a></text>
<text top="597" left="244" width="523" height="16" font="1"><a href="pdfxml.html#68">Simple Flight Model </a>. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="597" left="792" width="18" height="16" font="1">59</text>
<text top="625" left="188" width="36" height="16" font="1"><a href="pdfxml.html#68">4.2.2</a></text>
<text top="625" left="244" width="523" height="16" font="1"><a href="pdfxml.html#68">Coordinated Flight Model </a>. . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="625" left="792" width="18" height="16" font="1">59</text>
<text top="652" left="188" width="36" height="16" font="1"><a href="pdfxml.html#69">4.2.3</a></text>
<text top="652" left="244" width="523" height="16" font="1"><a href="pdfxml.html#69">Full Aerodynamic Model </a>. . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="652" left="792" width="18" height="16" font="1">60</text>
<text top="680" left="188" width="36" height="16" font="1"><a href="pdfxml.html#69">4.2.4</a></text>
<text top="680" left="244" width="523" height="16" font="1"><a href="pdfxml.html#69">Target Models </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="680" left="792" width="18" height="16" font="1">60</text>
<text top="708" left="148" width="22" height="16" font="1"><a href="pdfxml.html#72">4.3</a></text>
<text top="708" left="188" width="157" height="16" font="1"><a href="pdfxml.html#72">Tracking Controllers</a></text>
<text top="708" left="361" width="406" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="708" left="792" width="18" height="16" font="1">63</text>
<text top="736" left="188" width="36" height="16" font="1"><a href="pdfxml.html#72">4.3.1</a></text>
<text top="736" left="244" width="523" height="16" font="1"><a href="pdfxml.html#72">Inverse Dynamics and Output Tracking </a>. . . . . . . . . . . . . . . .</text>
<text top="736" left="792" width="18" height="16" font="1">63</text>
<text top="763" left="188" width="36" height="16" font="1"><a href="pdfxml.html#75">4.3.2</a></text>
<text top="763" left="244" width="523" height="16" font="1"><a href="pdfxml.html#75">Simple Flight Model </a>. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="763" left="792" width="18" height="16" font="1">66</text>
<text top="791" left="188" width="36" height="16" font="1"><a href="pdfxml.html#76">4.3.3</a></text>
<text top="791" left="244" width="523" height="16" font="1"><a href="pdfxml.html#76">Coordinated Flight Model </a>. . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="791" left="792" width="18" height="16" font="1">67</text>
<text top="819" left="188" width="36" height="16" font="1"><a href="pdfxml.html#76">4.3.4</a></text>
<text top="819" left="244" width="523" height="16" font="1"><a href="pdfxml.html#76">Full Aerodynamic Model </a>. . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="819" left="792" width="18" height="16" font="1">67</text>
<text top="847" left="188" width="36" height="16" font="1"><a href="pdfxml.html#77">4.3.5</a></text>
<text top="847" left="244" width="523" height="16" font="1"><a href="pdfxml.html#77">Subset of the Consolidated Model </a>. . . . . . . . . . . . . . . . . . .</text>
<text top="847" left="792" width="18" height="16" font="1">68</text>
<text top="874" left="148" width="22" height="16" font="1"><a href="pdfxml.html#78">4.4</a></text>
<text top="874" left="188" width="579" height="16" font="1"><a href="pdfxml.html#78">Results </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="874" left="792" width="18" height="16" font="1">69</text>
<text top="902" left="148" width="22" height="16" font="1"><a href="pdfxml.html#81">4.5</a></text>
<text top="902" left="188" width="579" height="16" font="1"><a href="pdfxml.html#81">Conclusions </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="902" left="792" width="18" height="16" font="1">72</text>
<text top="947" left="122" width="10" height="16" font="1"><a href="pdfxml.html#87">5</a></text>
<text top="947" left="148" width="97" height="16" font="1"><a href="pdfxml.html#87">Conclusion</a></text>
<text top="947" left="790" width="20" height="16" font="1">78</text>
<text top="993" left="122" width="94" height="16" font="1"><a href="pdfxml.html#89">References</a></text>
<text top="993" left="790" width="20" height="16" font="1">80</text>
<text top="1038" left="456" width="19" height="16" font="1">vii</text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="3" size="9" family="Times" color="#000000"/>
<text top="306" left="122" width="266" height="33" font="0">List of Figures</text>
<text top="410" left="148" width="22" height="16" font="1"><a href="pdfxml.html#12">1.1</a></text>
<text top="410" left="188" width="577" height="16" font="1"><a href="pdfxml.html#12">An overview of the proposed methodology and thesis contributions. Note,</a></text>
<text top="432" left="188" width="579" height="16" font="1"><a href="pdfxml.html#12">the high level planner is not part of this research. </a>. . . . . . . . . . . . . .</text>
<text top="432" left="801" width="9" height="16" font="1">3</text>
<text top="477" left="148" width="22" height="16" font="1"><a href="pdfxml.html#18">2.1</a></text>
<text top="477" left="188" width="579" height="16" font="1"><a href="pdfxml.html#18">Future of Heterogenous Systems [1]. </a>. . . . . . . . . . . . . . . . . . . . . .</text>
<text top="477" left="801" width="9" height="16" font="1">9</text>
<text top="508" left="148" width="22" height="16" font="1"><a href="pdfxml.html#19">2.2</a></text>
<text top="508" left="188" width="418" height="16" font="1"><a href="pdfxml.html#19">Bandwidth constraints in IGP chipsets vs an APU [1].</a></text>
<text top="508" left="624" width="143" height="16" font="1">. . . . . . . . . . .</text>
<text top="508" left="792" width="18" height="16" font="1">10</text>
<text top="538" left="148" width="22" height="16" font="1"><a href="pdfxml.html#20">2.3</a></text>
<text top="538" left="188" width="579" height="16" font="1"><a href="pdfxml.html#20">Computed devices, compute units and processing elements [2]. </a>. . . . . . .</text>
<text top="538" left="792" width="18" height="16" font="1">11</text>
<text top="569" left="148" width="22" height="16" font="1"><a href="pdfxml.html#21">2.4</a></text>
<text top="569" left="188" width="579" height="16" font="1"><a href="pdfxml.html#21">Block diagram of an AMD GPU compute device [2]. </a>. . . . . . . . . . . . .</text>
<text top="569" left="792" width="18" height="16" font="1">12</text>
<text top="600" left="148" width="22" height="16" font="1"><a href="pdfxml.html#22">2.5</a></text>
<text top="600" left="188" width="579" height="16" font="1"><a href="pdfxml.html#22">NDRange, Work-Group, and Work-Items [2]. </a>. . . . . . . . . . . . . . . . .</text>
<text top="600" left="792" width="18" height="16" font="1">13</text>
<text top="630" left="148" width="22" height="16" font="1"><a href="pdfxml.html#23">2.6</a></text>
<text top="630" left="188" width="579" height="16" font="1"><a href="pdfxml.html#23">OpenCL Memory Structure [27]. </a>. . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="630" left="792" width="18" height="16" font="1">14</text>
<text top="661" left="148" width="22" height="16" font="1"><a href="pdfxml.html#25">2.7</a></text>
<text top="661" left="188" width="579" height="16" font="1"><a href="pdfxml.html#25">Parallel vector addition kernel. </a>. . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="661" left="792" width="18" height="16" font="1">16</text>
<text top="692" left="148" width="22" height="16" font="1"><a href="pdfxml.html#30">2.8</a></text>
<text top="692" left="188" width="579" height="16" font="1"><a href="pdfxml.html#30">Host computations. </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="692" left="792" width="18" height="16" font="1">21</text>
<text top="722" left="148" width="22" height="16" font="1"><a href="pdfxml.html#31">2.9</a></text>
<text top="722" left="188" width="579" height="16" font="1"><a href="pdfxml.html#31">Kernel computations. </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="722" left="792" width="18" height="16" font="1">22</text>
<text top="753" left="148" width="620" height="16" font="1"><a href="pdfxml.html#32">2.10 Keychain tracking results. </a>. . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="753" left="792" width="18" height="16" font="1">23</text>
<text top="784" left="148" width="620" height="16" font="1"><a href="pdfxml.html#32">2.11 Aircraft tracking results. </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="784" left="792" width="18" height="16" font="1">23</text>
<text top="829" left="148" width="22" height="16" font="1"><a href="pdfxml.html#35">3.1</a></text>
<text top="829" left="188" width="579" height="16" font="1"><a href="pdfxml.html#35">Flight path climb angle and the angle of attack. </a>. . . . . . . . . . . . . . .</text>
<text top="829" left="792" width="18" height="16" font="1">26</text>
<text top="860" left="148" width="22" height="16" font="1"><a href="pdfxml.html#36">3.2</a></text>
<text top="860" left="188" width="579" height="16" font="1"><a href="pdfxml.html#36">Flight path heading angle and the side-slip angle. </a>. . . . . . . . . . . . . .</text>
<text top="860" left="792" width="18" height="16" font="1">27</text>
<text top="890" left="148" width="22" height="16" font="1"><a href="pdfxml.html#39">3.3</a></text>
<text top="890" left="188" width="13" height="16" font="1"><a href="pdfxml.html#39">C</a></text>
<text top="897" left="201" width="11" height="11" font="3"><a href="pdfxml.html#39">l0</a></text>
<text top="890" left="218" width="28" height="16" font="1"><a href="pdfxml.html#39">= k</a></text>
<text top="897" left="245" width="6" height="11" font="3"><a href="pdfxml.html#39">1</a></text>
<text top="890" left="252" width="42" height="16" font="1"><a href="pdfxml.html#39">α + k</a></text>
<text top="897" left="294" width="6" height="11" font="3"><a href="pdfxml.html#39">2</a></text>
<text top="890" left="302" width="42" height="16" font="1"><a href="pdfxml.html#39">β + k</a></text>
<text top="897" left="343" width="6" height="11" font="3"><a href="pdfxml.html#39">3</a></text>
<text top="890" left="350" width="53" height="16" font="1"><a href="pdfxml.html#39">αβ + k</a></text>
<text top="897" left="403" width="6" height="11" font="3"><a href="pdfxml.html#39">4</a></text>
<text top="890" left="417" width="351" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="890" left="792" width="18" height="16" font="1">30</text>
<text top="921" left="148" width="22" height="16" font="1"><a href="pdfxml.html#41">3.4</a></text>
<text top="921" left="188" width="169" height="16" font="1"><a href="pdfxml.html#41">Output Error Method</a></text>
<text top="921" left="375" width="393" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="921" left="792" width="18" height="16" font="1">32</text>
<text top="952" left="148" width="22" height="16" font="1"><a href="pdfxml.html#44">3.5</a></text>
<text top="952" left="188" width="579" height="16" font="1"><a href="pdfxml.html#44">Frequency Spectrum of Various Maneuvers [32]. </a>. . . . . . . . . . . . . . .</text>
<text top="952" left="792" width="18" height="16" font="1">35</text>
<text top="982" left="148" width="22" height="16" font="1"><a href="pdfxml.html#45">3.6</a></text>
<text top="982" left="188" width="579" height="16" font="1"><a href="pdfxml.html#45">Maneuvers to excite diﬀerent modes on an aircraft [32]. </a>. . . . . . . . . . .</text>
<text top="982" left="792" width="18" height="16" font="1">36</text>
<text top="1038" left="454" width="24" height="16" font="1">viii</text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="148" width="22" height="16" font="1"><a href="pdfxml.html#47">3.7</a></text>
<text top="191" left="188" width="579" height="16" font="1"><a href="pdfxml.html#47">Dryden Wind Gust model applied to OEM </a>. . . . . . . . . . . . . . . . . .</text>
<text top="191" left="792" width="18" height="16" font="1">38</text>
<text top="222" left="148" width="22" height="16" font="1"><a href="pdfxml.html#48">3.8</a></text>
<text top="222" left="188" width="155" height="16" font="1"><a href="pdfxml.html#48">Filter Error Method</a></text>
<text top="222" left="361" width="406" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="222" left="792" width="18" height="16" font="1">39</text>
<text top="252" left="148" width="22" height="16" font="1"><a href="pdfxml.html#49">3.9</a></text>
<text top="252" left="188" width="579" height="16" font="1"><a href="pdfxml.html#49">Inputs to the BAC-221 nonlinear simulation. </a>. . . . . . . . . . . . . . . . .</text>
<text top="252" left="792" width="18" height="16" font="1">40</text>
<text top="283" left="148" width="620" height="16" font="1"><a href="pdfxml.html#50">3.10 Output Error Method ﬁt on the BAC-221. </a>. . . . . . . . . . . . . . . . . .</text>
<text top="283" left="792" width="18" height="16" font="1">41</text>
<text top="314" left="148" width="620" height="16" font="1"><a href="pdfxml.html#52">3.11 Wind Sensors </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="314" left="792" width="18" height="16" font="1">43</text>
<text top="344" left="148" width="620" height="16" font="1"><a href="pdfxml.html#53">3.12 Sensor input hardware </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="344" left="792" width="18" height="16" font="1">44</text>
<text top="375" left="148" width="620" height="16" font="1"><a href="pdfxml.html#53">3.13 Long range communications </a>. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="375" left="792" width="18" height="16" font="1">44</text>
<text top="405" left="148" width="620" height="16" font="1"><a href="pdfxml.html#55">3.14 CPU usage comparison </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="405" left="792" width="18" height="16" font="1">46</text>
<text top="436" left="148" width="662" height="16" font="1"><a href="pdfxml.html#56">3.15 Timing diagram showing uniform and synchronized thread execution at 75Hz. </a>47</text>
<text top="467" left="148" width="620" height="16" font="1"><a href="pdfxml.html#57">3.16 Results from Kadet Senior UAV - 1 </a>. . . . . . . . . . . . . . . . . . . . . .</text>
<text top="467" left="792" width="18" height="16" font="1">48</text>
<text top="497" left="148" width="620" height="16" font="1"><a href="pdfxml.html#60">3.17 Kadet Senior Data -1 </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="497" left="792" width="18" height="16" font="1">51</text>
<text top="528" left="148" width="620" height="16" font="1"><a href="pdfxml.html#61">3.18 Kadet Senior Data -2 </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="528" left="792" width="18" height="16" font="1">52</text>
<text top="559" left="148" width="620" height="16" font="1"><a href="pdfxml.html#62">3.19 Kadet Senior Data -3 </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="559" left="792" width="18" height="16" font="1">53</text>
<text top="589" left="148" width="620" height="16" font="1"><a href="pdfxml.html#63">3.20 Kadet Senior Data -4 </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="589" left="792" width="18" height="16" font="1">54</text>
<text top="620" left="148" width="620" height="16" font="1"><a href="pdfxml.html#64">3.21 Results from Kadet Senior UAV - 2 </a>. . . . . . . . . . . . . . . . . . . . . .</text>
<text top="620" left="792" width="18" height="16" font="1">55</text>
<text top="665" left="148" width="22" height="16" font="1"><a href="pdfxml.html#79">4.1</a></text>
<text top="665" left="188" width="579" height="16" font="1"><a href="pdfxml.html#79">Simulation Results for the Simple Flight Model. </a>. . . . . . . . . . . . . . .</text>
<text top="665" left="792" width="18" height="16" font="1">70</text>
<text top="696" left="148" width="22" height="16" font="1"><a href="pdfxml.html#79">4.2</a></text>
<text top="696" left="188" width="579" height="16" font="1"><a href="pdfxml.html#79">Simulation Results for the Coordinated Flight Model. </a>. . . . . . . . . . . .</text>
<text top="696" left="792" width="18" height="16" font="1">70</text>
<text top="727" left="148" width="22" height="16" font="1"><a href="pdfxml.html#80">4.3</a></text>
<text top="727" left="188" width="579" height="16" font="1"><a href="pdfxml.html#80">BAC-221 Tracking Ski Slope </a>. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="727" left="792" width="18" height="16" font="1">71</text>
<text top="757" left="148" width="22" height="16" font="1"><a href="pdfxml.html#81">4.4</a></text>
<text top="757" left="188" width="579" height="16" font="1"><a href="pdfxml.html#81">β being regulated to zero for the BAC-221. </a>. . . . . . . . . . . . . . . . . .</text>
<text top="757" left="792" width="18" height="16" font="1">72</text>
<text top="788" left="148" width="22" height="16" font="1"><a href="pdfxml.html#82">4.5</a></text>
<text top="788" left="188" width="579" height="16" font="1"><a href="pdfxml.html#82">Kadet Senior Spiral </a>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="788" left="792" width="18" height="16" font="1">73</text>
<text top="819" left="148" width="22" height="16" font="1"><a href="pdfxml.html#82">4.6</a></text>
<text top="819" left="188" width="170" height="16" font="1"><a href="pdfxml.html#82">Kadet Senior Figure 8</a></text>
<text top="819" left="375" width="392" height="16" font="1">. . . . . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="819" left="792" width="18" height="16" font="1">73</text>
<text top="849" left="148" width="22" height="16" font="1"><a href="pdfxml.html#83">4.7</a></text>
<text top="849" left="188" width="579" height="16" font="1"><a href="pdfxml.html#83">Kadet Senior Displacement Roll </a>. . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="849" left="792" width="18" height="16" font="1">74</text>
<text top="880" left="148" width="22" height="16" font="1"><a href="pdfxml.html#84">4.8</a></text>
<text top="880" left="188" width="579" height="16" font="1"><a href="pdfxml.html#84">Kadet Senior Linear Control </a>. . . . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="880" left="792" width="18" height="16" font="1">75</text>
<text top="911" left="148" width="22" height="16" font="1"><a href="pdfxml.html#84">4.9</a></text>
<text top="911" left="188" width="579" height="16" font="1"><a href="pdfxml.html#84">Kadet Senior taxiing at the ﬂying ﬁeld. </a>. . . . . . . . . . . . . . . . . . . .</text>
<text top="911" left="792" width="18" height="16" font="1">75</text>
<text top="941" left="148" width="620" height="16" font="1"><a href="pdfxml.html#85">4.10 Kadet Senior in Autopilot Mode </a>. . . . . . . . . . . . . . . . . . . . . . . .</text>
<text top="941" left="792" width="18" height="16" font="1">76</text>
<text top="1038" left="459" width="14" height="16" font="1">ix</text>
</page>
<page number="10" position="absolute" top="0" left="0" height="1188" width="918">
<text top="306" left="122" width="184" height="33" font="0">Chapter 1</text>
<text top="390" left="122" width="230" height="33" font="0">Introduction</text>
<text top="494" left="122" width="689" height="16" font="1">The quest for an optimal viewing angle for a sporting event or a movie has always led to</text>
<text top="515" left="122" width="689" height="16" font="1">huge capital expenditures. The Romans built the Colosseum for breathtaking views of the</text>
<text top="537" left="122" width="689" height="16" font="1">live action directly below, unhindered by the crowds in front and behind. The modern day</text>
<text top="559" left="122" width="689" height="16" font="1">equivalent includes cameras, televisions and cleverly placed jigs all around the stadium</text>
<text top="580" left="122" width="688" height="16" font="1">or the ﬁlm set. Skiing events during the Winter Olympics, for example, are ﬁlmed using</text>
<text top="602" left="122" width="689" height="16" font="1">extensive cable and track systems and manned helicopters. Movies as diverse as Top Gun,</text>
<text top="624" left="122" width="689" height="16" font="1">Beautiful Mind and 007 The World is Not Enough all have scenes that were shot using</text>
<text top="645" left="122" width="427" height="16" font="1">manned and remotely piloted airplanes and helicopters.</text>
<text top="676" left="148" width="662" height="16" font="1">Third person perspective, a view located directly behind and above the target, remains</text>
<text top="698" left="122" width="689" height="16" font="1">diﬃcult to achieve due to the high speed of the action, the rapid changes in direction and the</text>
<text top="719" left="122" width="688" height="16" font="1">resulting safety concerns that arise from tracking at close range, particularly with manned</text>
<text top="741" left="122" width="688" height="16" font="1">aircraft. In recent years, there has been a signiﬁcant surge in the use of remotely piloted</text>
<text top="763" left="122" width="689" height="16" font="1">helicopters with stabilized cameras in the production of movies, not only for high speed</text>
<text top="784" left="122" width="689" height="16" font="1">chases, but for precise aerial shots that would be diﬃcult to achieve otherwise. Currently</text>
<text top="806" left="122" width="688" height="16" font="1">only a handful of pilots can remotely control a vehicle precisely enough to achieve these</text>
<text top="828" left="122" width="688" height="16" font="1">objectives. The use of small autonomous Unmanned Aerial Vehicles (UAVs), on the other</text>
<text top="849" left="122" width="688" height="16" font="1">hand, may open an aﬀordable door to such a perspective for sports networks and movie</text>
<text top="871" left="122" width="71" height="16" font="1">directors.</text>
<text top="902" left="148" width="662" height="16" font="1">In addition to the requirement of agility and high speed, there is a fundamental need</text>
<text top="923" left="122" width="689" height="16" font="1">to ensure safety during high speed operations. Transport Canada strictly regulates the use</text>
<text top="945" left="122" width="688" height="16" font="1">of any unmanned vehicles, whether remotely piloted or autonomous, for commercial use.</text>
<text top="967" left="122" width="689" height="16" font="1">With more and more movies being shot in Canada, Transport Canada has devised a set of</text>
<text top="988" left="122" width="689" height="16" font="1">rules that govern the operation of the vehicles in crowded areas. For an autonomous vehicle</text>
<text top="1038" left="461" width="9" height="16" font="1">1</text>
</page>
<page number="11" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">to replace a skilled ground pilot, the autopilot system has to be exceptionally safe, with</text>
<text top="213" left="122" width="689" height="16" font="1">very low chances of an error or a software hiccup. Two conclusions can be drawn, ﬁrst,</text>
<text top="234" left="122" width="689" height="16" font="1">the autonomous vehicle must be highly maneuverable, able to track required trajectories</text>
<text top="256" left="122" width="689" height="16" font="1">without human input, and second, it must do so without compromising the safety of the</text>
<text top="278" left="122" width="143" height="16" font="1">crew or the target.</text>
<text top="307" left="148" width="662" height="16" font="1">A complete UAV system that can aggressively follow a target at close range is not</text>
<text top="328" left="122" width="688" height="16" font="1">known to exist. Such a system would include a robust computer vision tracker that detects</text>
<text top="350" left="122" width="688" height="16" font="1">and tracks aggressive high speed ground targets. This tracker would provide reference</text>
<text top="372" left="122" width="689" height="16" font="1">trajectories to a highly capable autopilot that would keep the aircraft stable under extreme</text>
<text top="393" left="122" width="689" height="16" font="1">maneuvers. Recent advances in computing power, vision algorithms and control techniques</text>
<text top="415" left="122" width="363" height="16" font="1">have brought such a system closer to existence.</text>
<text top="444" left="148" width="662" height="16" font="1">In 2003, Saripalli et. al. <a href="pdfxml.html#93">[49] </a>successfully landed a helicopter on a marked target using</text>
<text top="465" left="122" width="689" height="16" font="1">vision based algorithms. The target was stationery but the research demonstrated success-</text>
<text top="487" left="122" width="688" height="16" font="1">ful use of small cameras and oﬀ the shelf computing power to collectively approach a target.</text>
<text top="509" left="122" width="689" height="16" font="1">In 2007, Edwards et. al. <a href="pdfxml.html#90">[12] </a>demonstrate a ﬁxed wing UAV that can land autonomously</text>
<text top="530" left="122" width="689" height="16" font="1">on a truck bed that is painted red. They show cases where the truck is stationary and</text>
<text top="552" left="122" width="688" height="16" font="1">where it is moving steadily forward at 10 to 15 mph. The vision system is implemented</text>
<text top="574" left="122" width="689" height="16" font="1">on an FPGA running two 400MHz CPU cores. The algorithm uses color based segmen-</text>
<text top="595" left="122" width="689" height="16" font="1">tation followed by a connected component algorithm where they ﬁnd the target’s center</text>
<text top="617" left="122" width="688" height="16" font="1">of mass. They use an oﬀ-the-shelf autopilot from Procerus Technologies. Also in 2007,</text>
<text top="639" left="122" width="689" height="16" font="1">Campbell et. al. <a href="pdfxml.html#89">[5][</a><a href="pdfxml.html#94">60], </a>use a military Scan Eagle UAV with an onboard camera gimbal</text>
<text top="660" left="122" width="689" height="16" font="1">developed by the Insitu Group. They use a square root, sigma point information ﬁlter</text>
<text top="682" left="122" width="688" height="16" font="1">and validate results for cooperative and non-cooperative ground targets. They show large</text>
<text top="704" left="122" width="688" height="16" font="1">errors in tracking during sharp corners or changes in velocity. In 2008, Theodorakopoulos</text>
<text top="726" left="122" width="689" height="16" font="1">and Lacroix <a href="pdfxml.html#93">[55] </a>develop high level kinematic controllers that rely on a low level autopilot.</text>
<text top="747" left="122" width="689" height="16" font="1">They limit the aircraft roll angle and its lateral velocity. It results in the aircraft circling</text>
<text top="769" left="122" width="689" height="16" font="1">the target in concentric circles that converge towards the target. The strategy was demon-</text>
<text top="791" left="122" width="688" height="16" font="1">strated to work well for stationary or slow moving targets. The authors assert that evasive</text>
<text top="812" left="122" width="688" height="16" font="1">and aggressive targets are an area of future work. This year, Teuliere et. al. <a href="pdfxml.html#93">[54], </a>tracked</text>
<text top="834" left="122" width="688" height="16" font="1">a remote control car with a quadrotor using visual information. Their vision system uses</text>
<text top="856" left="122" width="688" height="16" font="1">color-based tracking with particle ﬁltering. Their ﬂight controller uses linear proportional</text>
<text top="877" left="122" width="622" height="16" font="1">gains on position error to successfully track the car in controlled steady motions.</text>
<text top="906" left="148" width="662" height="16" font="1">This thesis presents work done towards achieving the goal of autonomous tracking of an</text>
<text top="928" left="122" width="688" height="16" font="1">aggressively moving ground target. It includes detailed aerodynamic models of the vehicle,</text>
<text top="949" left="122" width="689" height="16" font="1">system identiﬁcation, vision based tracking, a controller capable of tracking aggressive</text>
<text top="971" left="122" width="689" height="16" font="1">trajectories, its hardware implementation on custom designed electronics and a QNX based</text>
<text top="993" left="122" width="314" height="16" font="1">real-time autopilot software architecture.</text>
<text top="1038" left="461" width="9" height="16" font="1">2</text>
</page>
<page number="12" position="absolute" top="0" left="0" height="1188" width="918">
<text top="792" left="122" width="689" height="16" font="1">Figure 1.1: An overview of the proposed methodology and thesis contributions. Note, the</text>
<text top="813" left="122" width="350" height="16" font="1">high level planner is not part of this research.</text>
<text top="1038" left="461" width="9" height="16" font="1">3</text>
</page>
<page number="13" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="148" width="662" height="16" font="1">A high ﬁdelity system identiﬁcation procedure is described and performed on the custom</text>
<text top="213" left="122" width="689" height="16" font="1">designed Kadet Senior UAV. Nonlinear control techniques are then applied to these models</text>
<text top="234" left="122" width="689" height="16" font="1">in simulation. Linear controls are implemented on the UAV to test various systems on the</text>
<text top="256" left="122" width="688" height="16" font="1">autopilot. A high speed robust vision tracking solution is also developed. These pieces will</text>
<text top="278" left="122" width="689" height="16" font="1">eventually be linked using a high level planner which is an active area of research at the</text>
<text top="299" left="122" width="688" height="16" font="1">Waterloo Autonomous Vehicles Lab (WAVE). Such a system, would extract information</text>
<text top="321" left="122" width="688" height="16" font="1">from the high speed video tracking, and predict the motion of the target. It would then</text>
<text top="343" left="122" width="689" height="16" font="1">plan an aircraft trajectory using a bank of ‘motion primitives’ that are designed in this</text>
<text top="364" left="122" width="688" height="16" font="1">thesis. Motion primitives are basic predetermined trajectories that the aircraft can follow.</text>
<text top="386" left="122" width="688" height="16" font="1">With suﬃcient motion primitives, the high level planner will be able to keep the aircraft</text>
<text top="408" left="122" width="653" height="16" font="1">on the appropriate trajectory to chase the target. This idea is shown in Figure <a href="pdfxml.html#12">(1.1).</a></text>
<text top="471" left="122" width="37" height="23" font="2">1.1</text>
<text top="471" left="188" width="176" height="23" font="2">Contributions</text>
<text top="525" left="122" width="688" height="16" font="1">The main contributions of this thesis and the accompnying research project are the follow-</text>
<text top="547" left="122" width="28" height="16" font="1">ing:</text>
<text top="596" left="148" width="662" height="17" font="1">• GPU based robust vision tracker, capable of tracking multiple targets simultaneously.</text>
<text top="632" left="148" width="662" height="17" font="1">• Comparison of two diﬀerent aircraft models for system identiﬁcation of Kadet Senior,</text>
<text top="655" left="165" width="263" height="16" font="1">suitable for feedback linearization.</text>
<text top="691" left="148" width="657" height="17" font="1">• A method to produce high ﬁdelity simulation for BAC-221 using wind tunnel data.</text>
<text top="727" left="148" width="662" height="17" font="1">• Application of feedback linearization to 3 progressively complex aircraft models,</text>
<text top="750" left="165" width="188" height="16" font="1">based on BAC-221 data.</text>
<text top="785" left="148" width="597" height="17" font="1">• Simulation of the nonlinear control techniques applied to the Kadet Senior.</text>
<text top="822" left="148" width="662" height="17" font="1">• QNX based autopilot, with long range communications, remote in-ﬂight debugging,</text>
<text top="845" left="165" width="608" height="16" font="1">custom fast boot bios, real time characterization for crucial timing veriﬁcation.</text>
<text top="908" left="122" width="37" height="23" font="2">1.2</text>
<text top="908" left="188" width="269" height="23" font="2">Outline of the Thesis</text>
<text top="962" left="122" width="689" height="16" font="1">The thesis begins with a description of the vision tracking algorithm and implementation</text>
<text top="984" left="122" width="689" height="16" font="1">in Chapter 2. System identiﬁcation methods and results are presented in Chapter 3 for the</text>
<text top="1038" left="461" width="9" height="16" font="1">4</text>
</page>
<page number="14" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">Kadet Senior platform. Chapter 4 shows the design, simulation and results of a nonlinear</text>
<text top="213" left="122" width="688" height="16" font="1">controller which uses target trajectories from Chapter 2 and aerodynamic models from</text>
<text top="234" left="122" width="689" height="16" font="1">Chapter 3 to control the ﬁxed wing Kadet Senior Unmanned Aerial Vehicle (UAV). Lastly,</text>
<text top="256" left="122" width="689" height="16" font="1">the main contributions are summarized and avenues for future work to complete the main</text>
<text top="278" left="122" width="251" height="16" font="1">goals of the project are outlined.</text>
<text top="1038" left="461" width="9" height="16" font="1">5</text>
</page>
<page number="15" position="absolute" top="0" left="0" height="1188" width="918">
<text top="304" left="122" width="184" height="33" font="0">Chapter 2</text>
<text top="385" left="122" width="518" height="33" font="0">GPU Based Vision Tracking</text>
<text top="492" left="122" width="37" height="23" font="2">2.1</text>
<text top="492" left="188" width="139" height="23" font="2">Motivation</text>
<text top="544" left="122" width="689" height="16" font="1">The goal of this chapter is to implement an algorithm that would utilize the parallel</text>
<text top="565" left="122" width="689" height="16" font="1">processing capabilities of a Graphical Processing Unit (GPU) to achieve robust vision</text>
<text top="587" left="122" width="689" height="16" font="1">based tracking of a target. The information from the target can be used to generate</text>
<text top="609" left="122" width="689" height="16" font="1">reference trajectories by a high level planner, which are followed by the aircraft tracking</text>
<text top="630" left="122" width="376" height="16" font="1">controllers developed in the subsequent chapters.</text>
<text top="658" left="148" width="662" height="16" font="1">This chapter proceeds as follows. Section (2.2) provides an overview of the current</text>
<text top="680" left="122" width="688" height="16" font="1">research in GPU based vision systems. OpenCL is introduced and a brief introduction</text>
<text top="702" left="122" width="688" height="16" font="1">to GPU programming is provided in Section (2.3). A state of the art vision based target</text>
<text top="723" left="122" width="689" height="16" font="1">tracking algorithm is discussed in Section (2.4) and its parallel implementation is described</text>
<text top="745" left="122" width="639" height="16" font="1">in Section (2.5). Lastly, tracking results and discussion of future work is presented.</text>
<text top="805" left="122" width="37" height="23" font="2">2.2</text>
<text top="805" left="188" width="602" height="23" font="2">Current Work in GPU Based Computer Vision</text>
<text top="856" left="122" width="688" height="16" font="1">GPUs were originally meant to convert numbers into graphics for digital screens. Standards</text>
<text top="878" left="122" width="688" height="16" font="1">like Open Graphics Library (OpenGL) were used with languages like C for Graphics (Cg)</text>
<text top="900" left="122" width="688" height="16" font="1">to produce 2D and 3D computer graphics. OpenGL was developed by Silicon Graphics</text>
<text top="921" left="122" width="689" height="16" font="1">Inc. (SGI) in 1992 and is mainly used for displaying graphics in CAD packages, scientiﬁc</text>
<text top="943" left="122" width="230" height="16" font="1">simulations, and video games.</text>
<text top="971" left="148" width="662" height="16" font="1">In recent years there has been a signiﬁcant surge in the performance of GPUs, outpacing</text>
<text top="993" left="122" width="689" height="16" font="1">even Moore’s Law <a href="pdfxml.html#89">[8]. </a>The latest 6 core Intel i7-980X CPU performs at roughly 107</text>
<text top="1038" left="461" width="9" height="16" font="1">6</text>
</page>
<page number="16" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="4" size="8" family="Times" color="#000000"/>
	<fontspec id="5" size="12" family="Times" color="#000000"/>
<text top="191" left="122" width="72" height="16" font="1"><a href="pdfxml.html#16">GFLOPS</a></text>
<text top="189" left="193" width="6" height="11" font="3"><a href="pdfxml.html#16">1</a></text>
<text top="191" left="207" width="603" height="16" font="1"><a href="pdfxml.html#94">[57] </a>and costs almost $1000, compared to the latest AMD HD5870 GPU that</text>
<text top="213" left="122" width="419" height="16" font="1">performs at 544 GFLOPS <a href="pdfxml.html#89">[8] </a>and costs less than $400.</text>
<text top="242" left="148" width="662" height="16" font="1">These advances have allowed a certain set of GPU users to go in reverse, i.e. graphics</text>
<text top="264" left="122" width="689" height="16" font="1">to numbers, opening the way to a new ﬁeld known as General Purpose GPU computing or</text>
<text top="285" left="122" width="688" height="16" font="1">GPGPU for short. The use of GPGPU for vision processing has been steadily increasing</text>
<text top="307" left="122" width="689" height="16" font="1">in the last few years. It started and still continues with the use of OpenGL and Cg. Here,</text>
<text top="329" left="122" width="648" height="16" font="1">the programmer “fools” the GPU into thinking that it is in fact producing graphics.</text>
<text top="358" left="148" width="662" height="16" font="1">In 2005, Fung, Mann and Aimone <a href="pdfxml.html#91">[31] </a>demonstrated the use of OpenGL and Cg, to</text>
<text top="380" left="122" width="689" height="16" font="1">build an open source parallel computer vision library, known as OpenVIDIA, that ran on</text>
<text top="401" left="122" width="689" height="16" font="1">NVIDIA GPUs. They implemented Canny edge detection, ﬁltering, image feature handling</text>
<text top="423" left="122" width="689" height="16" font="1">and image registration amongst others. GPU-KLT, a very popular parallel implementation</text>
<text top="445" left="122" width="688" height="16" font="1">of Kanade-Lucas-Tomasi Feature Tracker (KLT) <a href="pdfxml.html#92">[42] </a><a href="pdfxml.html#93">[50] </a>was programmed using OpenGL</text>
<text top="466" left="122" width="688" height="16" font="1">and Cg as well by Sinha et. al. <a href="pdfxml.html#93">[52] </a>in 2006. The authors showed a 20 times improvement</text>
<text top="488" left="122" width="689" height="16" font="1">over CPU in tracking about one thousand features at 30Hz on a 1024x768 resolution</text>
<text top="510" left="122" width="688" height="16" font="1">video. They also showed a 10Hz GPU based Scale Invariant Feature Transform (SIFT) <a href="pdfxml.html#92">[41]</a></text>
<text top="531" left="122" width="689" height="16" font="1">implementation with a 10 times improvement over an optimized CPU. Another signiﬁcant</text>
<text top="553" left="122" width="689" height="16" font="1">eﬀort came in 2006, with Farrugia et. al. developing GPUCV <a href="pdfxml.html#90">[14], </a>a GPU library that</text>
<text top="575" left="122" width="636" height="16" font="1">used primitives from OpenCV and was designed to be familiar to its current users.</text>
<text top="604" left="148" width="662" height="16" font="1">In 2007 Lalonde et. al. <a href="pdfxml.html#92">[38] </a>used the OpenVIDIA library, which by this time had a SIFT</text>
<text top="625" left="122" width="688" height="16" font="1">implementation of its own, to build an eye blink detector. They were able to achieve a 10</text>
<text top="647" left="122" width="688" height="16" font="1">times speedup from a CPU, and hence performed it in real time at about 25 Hz on a 640x480</text>
<text top="669" left="122" width="688" height="16" font="1">pixel image. In 2008, another GPU based vision library surfaced called MinGPU <a href="pdfxml.html#89">[4]. </a>This</text>
<text top="690" left="122" width="689" height="16" font="1">one diﬀered from OpenVIDIA in being usable on ATI and NVIDIA hardware alike and</text>
<text top="712" left="122" width="689" height="16" font="1">claimed to be easier to use than OpenVIDIA. The authors implemented image derivatives,</text>
<text top="734" left="122" width="591" height="16" font="1">pyramid operations and 3D homography transformations between two views.</text>
<text top="763" left="148" width="662" height="16" font="1">OpenVIDIA, GPUCV, MinGPU and other parallel vision libraries were developed using</text>
<text top="785" left="122" width="688" height="16" font="1">low level knowledge and dependence of the graphics pipeline. Compute Uniﬁed Device</text>
<text top="806" left="122" width="689" height="16" font="1">Architecture (CUDA) <a href="pdfxml.html#89">[9] </a>was made public in 2007 by NVIDIA and changed the landscape</text>
<text top="828" left="122" width="689" height="16" font="1">of GPGPU programming. It allowed programmers to write C programs without the low</text>
<text top="850" left="122" width="688" height="16" font="1">level knowledge of thread execution. It also allowed programmers control over memory</text>
<text top="871" left="122" width="514" height="16" font="1">access while shielding the intricacies of low level memory handling.</text>
<text top="901" left="148" width="662" height="16" font="1">CUDA is a proprietary framework and hence only works on NVIDIA GPUs. It is now</text>
<text top="922" left="122" width="689" height="16" font="1">widely supported in the scientiﬁc community, including its use by the Matlab’s Paral-</text>
<text top="944" left="122" width="688" height="16" font="1">lel Processing Toolbox. Fung and Mann have also included CUDA in their OpenVIDIA</text>
<text top="975" left="142" width="6" height="9" font="4">1</text>
<text top="977" left="148" width="662" height="13" font="5">Floating Point Operations per Second. These numbers are for double precision. For single precision</text>
<text top="995" left="122" width="296" height="13" font="5">the GPUs can achieve up to 2.72 <a href="pdfxml.html#89">TFPLOS[8]</a></text>
<text top="1038" left="461" width="9" height="16" font="1">7</text>
</page>
<page number="17" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">framework <a href="pdfxml.html#90">[18]. </a>Huang et. al. <a href="pdfxml.html#91">[24] </a>made use of CUDA for implementing a robust motion</text>
<text top="213" left="122" width="688" height="16" font="1">tracking algorithm known as Vector Coherence Mapping (VCM). VCM was introduced</text>
<text top="234" left="122" width="689" height="16" font="1">by Quek and Bryll <a href="pdfxml.html#93">[48] </a>in 1997 as a method to extract optical ﬂow ﬁelds from image se-</text>
<text top="256" left="122" width="688" height="16" font="1">quences. By parallelizing it, Huang et. al. show that the GPU accelerated the algorithm</text>
<text top="278" left="122" width="689" height="16" font="1">by 41 times when compared to the then state-of-the-art desktop CPUs. Luo and Du-</text>
<text top="299" left="122" width="688" height="16" font="1">raiswami <a href="pdfxml.html#92">[43] </a>implemented the popular Canny edge detector <a href="pdfxml.html#89">[6] </a>from 1986 and showed an</text>
<text top="321" left="122" width="689" height="16" font="1">improvement of over 3 times for a 2048x2048 image when compared to OpenCV. They also</text>
<text top="343" left="122" width="689" height="16" font="1">contend, as hinted earlier, that the Canny implementations in OpenVIDIA and GPUCV</text>
<text top="364" left="122" width="689" height="16" font="1">are now considered obsolete. The CUDA implementation on the other hand promises to</text>
<text top="386" left="122" width="689" height="16" font="1">last longer since it uses a purpose built GPGPU framework that will be supported for many</text>
<text top="408" left="122" width="689" height="16" font="1">years by NVIDIA. In 2009, Kim, Hwangbo and Kanade implemented the KLT algorithm</text>
<text top="429" left="122" width="688" height="16" font="1">in CUDA <a href="pdfxml.html#92">[37]. </a>They also merge rotation information from an Inertial Measurement Unit</text>
<text top="451" left="122" width="688" height="16" font="1">(IMU) to make the algorithm immune to rotations around the camera focal point. This</text>
<text top="473" left="122" width="688" height="16" font="1">fusion was previously not possible because of the increased complexity of the algorithm.</text>
<text top="494" left="122" width="688" height="16" font="1">The authors also mention advantages of a hybrid framework where some information is</text>
<text top="516" left="122" width="688" height="16" font="1">processed on a CPU. Amongst others, Li and Xiao <a href="pdfxml.html#92">[40] </a>demonstrate a mean shift tracking</text>
<text top="538" left="122" width="554" height="16" font="1">algorithm using CUDA, implemented on a NVIDIA GeForce 8800 GTS.</text>
<text top="568" left="148" width="662" height="16" font="1">Open Computing Language (OpenCL) was developed by Apple and released in 2008.</text>
<text top="590" left="122" width="689" height="16" font="1">It is the most recent and promises to be the most powerful of all GPGPU frameworks. It is</text>
<text top="612" left="122" width="688" height="16" font="1">an open standard framework maintained by the Khronos Group and is supported by AMD</text>
<text top="633" left="122" width="688" height="16" font="1">and NVIDIA alike. Its contributors include AMD, Intel and NVIDIA, amongst others.</text>
<text top="655" left="122" width="688" height="16" font="1">Similar to CUDA, OpenCL provides a C based SDK that abstracts the low level opera-</text>
<text top="677" left="122" width="689" height="16" font="1">tions from the user. Unlike CUDA, not only does OpenCL run on GPUs made by both ATI</text>
<text top="698" left="122" width="689" height="16" font="1">and NVIDIA, it also runs on multi-core CPUs and cell processors. This is known as het-</text>
<text top="720" left="122" width="689" height="16" font="1">erogeneous computing where the algorithm is divided into sections which are best for CPU</text>
<text top="742" left="122" width="689" height="16" font="1">and GPU. AMD has recently announced their Fusion platform, which is a heterogeneous</text>
<text top="763" left="122" width="688" height="16" font="1">computing platform that includes both a CPU and a GPU. It is also more generally known</text>
<text top="785" left="122" width="688" height="16" font="1">as an Accelerated Processing Unit, or APU for short. The Fusion platform is targeted for</text>
<text top="807" left="122" width="688" height="16" font="1">OpenCL based parallel applications that can take advantage of its CPU/GPU architec-</text>
<text top="828" left="122" width="688" height="16" font="1">ture. OpenCL’s strengths are its practicality, ﬂexibility and retargetability <a href="pdfxml.html#91">[28]. </a>However,</text>
<text top="850" left="122" width="688" height="16" font="1">OpenCL is new and in preliminary stages of development, with only early adopters using</text>
<text top="872" left="122" width="212" height="16" font="1">it for GPGPU applications.</text>
<text top="902" left="148" width="662" height="16" font="1">At this time vision based algorithms implemented on OpenCL are very rare. This</text>
<text top="924" left="122" width="689" height="16" font="1">is mainly due to the inertia that the CUDA based vision community has picked up as</text>
<text top="946" left="122" width="688" height="16" font="1">described above. GPGPU applications for other research have however started to surface</text>
<text top="967" left="122" width="688" height="16" font="1">recently. In 2010, Shimobaba et. al. <a href="pdfxml.html#93">[51] </a>showed the use of an AMD HD5000 with OpenCL</text>
<text top="989" left="122" width="688" height="16" font="1">to produce 3D holograms at twice the speed of an equivalent CUDA based NVIDIA GPU.</text>
<text top="1038" left="461" width="9" height="16" font="1">8</text>
</page>
<page number="18" position="absolute" top="0" left="0" height="1188" width="918">
<text top="519" left="282" width="368" height="16" font="1">Figure 2.1: Future of Heterogenous Systems <a href="pdfxml.html#89">[1].</a></text>
<text top="591" left="122" width="689" height="16" font="1">This is partly conﬁrmed by <a href="pdfxml.html#90">[22], </a>where Harvey and Fabritiis provide a tool to convert CUDA</text>
<text top="612" left="122" width="689" height="16" font="1">programs into OpenCL for cross platform portability as well as almost 50% improvement</text>
<text top="634" left="122" width="120" height="16" font="1">in performance.</text>
<text top="665" left="148" width="662" height="16" font="1">In addition, documents from AMD show a promising future and support for OpenCL.</text>
<text top="686" left="122" width="689" height="16" font="1">Figure <a href="pdfxml.html#18">(2.1) </a>shows the trend that AMD is projecting, pegging the Fusion class of processors</text>
<text top="708" left="122" width="354" height="16" font="1">as the direct descendants of GPUs and CPUs.</text>
<text top="739" left="148" width="662" height="16" font="1">Figure <a href="pdfxml.html#19">(2.2) </a>shows another reason why heterogeneous computing will eventually dom-</text>
<text top="760" left="122" width="688" height="16" font="1">inate. A GPGPU capable GPU on the same chipset as the CPU has a much faster data</text>
<text top="782" left="122" width="689" height="16" font="1">transfer rate to the on board memory, which is crucial for real time image analysis. Pre-</text>
<text top="804" left="122" width="689" height="16" font="1">vious oﬀerings by vendors have included Integrated Graphics Processors (IGP) on the</text>
<text top="825" left="122" width="689" height="16" font="1">motherboards, which use oﬀ chip system memory and slow transfer rates that bottle neck</text>
<text top="847" left="122" width="674" height="16" font="1">their performance. OpenCL, which supports such platforms is the only choice to adopt.</text>
<text top="878" left="148" width="662" height="16" font="1">This, together with the fact that the new AMD Fusion platform is a very light weight</text>
<text top="899" left="122" width="689" height="16" font="1">and ﬂyable piece of hardware, was the reason why OpenCL was selected as the basis for a</text>
<text top="921" left="122" width="362" height="16" font="1">vision based tracking solution for this research.</text>
<text top="1038" left="461" width="9" height="16" font="1">9</text>
</page>
<page number="19" position="absolute" top="0" left="0" height="1188" width="918">
<text top="543" left="211" width="509" height="16" font="1">Figure 2.2: Bandwidth constraints in IGP chipsets vs an APU <a href="pdfxml.html#89">[1].</a></text>
<text top="607" left="122" width="37" height="23" font="2">2.3</text>
<text top="607" left="188" width="257" height="23" font="2">OpenCL Framework</text>
<text top="660" left="122" width="688" height="16" font="1">As mentioned earlier, OpenCL can be used just as well over multiple cores of a CPU as</text>
<text top="681" left="122" width="688" height="16" font="1">it can over multiple cores in a GPU. OpenCL classiﬁes these as compute devices. Each</text>
<text top="703" left="122" width="689" height="16" font="1">compute device consists of compute units and processing elements. A GPU compute device</text>
<text top="725" left="122" width="688" height="16" font="1">would include more processing elements than a CPU. Each processing element in a GPU</text>
<text top="746" left="122" width="689" height="16" font="1">however, is much weaker than a single processing element in a CPU <a href="pdfxml.html#89">[8]. </a>The improved</text>
<text top="768" left="122" width="689" height="16" font="1">performance mentioned earlier, is achieved by a larger number of processing elements in</text>
<text top="790" left="122" width="689" height="16" font="1">the GPU. The latest AMD GPUs consist of stream cores which are essentially Single</text>
<text top="811" left="122" width="688" height="16" font="1">Instruction Multiple Data (SIMD) engines. A SIMD engine performs the same operation</text>
<text top="833" left="122" width="588" height="16" font="1">on multiple data simultaneously. This classiﬁcation is shown in Figure <a href="pdfxml.html#20">(2.3).</a></text>
<text top="863" left="148" width="662" height="16" font="1">For the purpose of this research, the latest AMD GPU at the time, HD5870, was cho-</text>
<text top="884" left="122" width="688" height="16" font="1">sen. This GPU consists of 20 compute units, each with 16 stream cores, each of which in</text>
<text top="906" left="122" width="688" height="16" font="1">turn have 5 processing elements as seen in Figure <a href="pdfxml.html#21">(2.4). </a>This is a total of 1600 processing</text>
<text top="928" left="122" width="689" height="16" font="1">elements. Each processing element can execute single-precision ﬂoating point or integer</text>
<text top="949" left="122" width="689" height="16" font="1">operations. One of the 5 processing elements can also perform special operations like sine,</text>
<text top="971" left="122" width="688" height="16" font="1">cosine and logarithms. Double precision ﬂoating point operations are performed by con-</text>
<text top="993" left="122" width="688" height="16" font="1">necting two or four of the processing elements <a href="pdfxml.html#89">[2]. </a>All stream cores within a compute unit</text>
<text top="1038" left="457" width="18" height="16" font="1">10</text>
</page>
<page number="20" position="absolute" top="0" left="0" height="1188" width="918">
<text top="458" left="181" width="570" height="16" font="1">Figure 2.3: Computed devices, compute units and processing elements <a href="pdfxml.html#89">[2].</a></text>
<text top="530" left="122" width="689" height="16" font="1">execute the same instruction, diﬀerent compute units can execute diﬀerent instructions.</text>
<text top="551" left="122" width="688" height="16" font="1">The instructions are programmed using stream kernels, or simply kernels. A kernel is a</text>
<text top="573" left="122" width="688" height="16" font="1">small, user-developed program that is run repeatedly on a stream of data. It is a parallel</text>
<text top="595" left="122" width="688" height="16" font="1">function that operates on every element of input streams. The GPU maps each execu-</text>
<text top="616" left="122" width="689" height="16" font="1">tion of the kernel onto compute units. Arrays of input data waiting to be processed are</text>
<text top="638" left="122" width="689" height="16" font="1">stored in memory and are accessible by the compute units. Each instance of the kernel</text>
<text top="660" left="122" width="688" height="16" font="1">running within a compute unit is called a work-item. The work-items are mapped to an</text>
<text top="681" left="122" width="688" height="16" font="1">n-dimensional index space known as NDRange, and subdivided into workgroups. The GPU</text>
<text top="703" left="122" width="688" height="16" font="1">schedules the work-items on the stream cores until all have been processed. Subsequent</text>
<text top="725" left="122" width="443" height="16" font="1">kernels are then executed until the application completes.</text>
<text top="755" left="148" width="662" height="16" font="1">Groups of work-items executed in lock-step inside a compute unit are called wavefronts.</text>
<text top="777" left="122" width="689" height="16" font="1">The number of work-items within a wavefront is speciﬁc to the GPU hardware. For the</text>
<text top="799" left="122" width="688" height="16" font="1">HD5870, up-to four work-items are pipelined to each stream core and are processed for four</text>
<text top="820" left="122" width="689" height="16" font="1">cycles. This is done to abstract out the low level memory latency and processing element</text>
<text top="842" left="122" width="688" height="16" font="1">operations from the user. With 16 stream cores per compute unit this implies a wavefront</text>
<text top="864" left="122" width="689" height="16" font="1">size of 64 work-items. Figure <a href="pdfxml.html#22">(2.5) </a>shows a summary of this classiﬁcation. The intermediate</text>
<text top="885" left="122" width="688" height="16" font="1">classiﬁcation of wavefronts within workgroups is meant for memory management and for</text>
<text top="907" left="122" width="260" height="16" font="1">more control over their execution.</text>
<text top="938" left="148" width="662" height="16" font="1">The NDRange can be a grid of one, two, or three dimensions. This selection is depen-</text>
<text top="959" left="122" width="686" height="16" font="1">dent on the user, and is usually dictated by the size of the output. For example, for a W</text>
<text top="981" left="122" width="688" height="16" font="1">x H pixel intensity image input, with a Canny edge detection kernel, the output will also</text>
<text top="1038" left="457" width="18" height="16" font="1">11</text>
</page>
<page number="21" position="absolute" top="0" left="0" height="1188" width="918">
<text top="972" left="219" width="493" height="16" font="1">Figure 2.4: Block diagram of an AMD GPU compute device <a href="pdfxml.html#89">[2].</a></text>
<text top="1038" left="457" width="18" height="16" font="1">12</text>
</page>
<page number="22" position="absolute" top="0" left="0" height="1188" width="918">
<text top="927" left="248" width="436" height="16" font="1">Figure 2.5: NDRange, Work-Group, and Work-Items <a href="pdfxml.html#89">[2].</a></text>
<text top="1038" left="457" width="18" height="16" font="1">13</text>
</page>
<page number="23" position="absolute" top="0" left="0" height="1188" width="918">
<text top="445" left="295" width="341" height="16" font="1">Figure 2.6: OpenCL Memory Structure <a href="pdfxml.html#91">[27].</a></text>
<text top="516" left="122" width="688" height="16" font="1">be a W x H pixel image. W x H intensity values translate to a ﬂoat or double matrix of</text>
<text top="538" left="122" width="687" height="16" font="1">size W x H. This can be represented by either a one dimensional array of size 1 x W H</text>
<text top="560" left="122" width="688" height="16" font="1">or a two dimensional array of size W x H. The choice depends on the user, and will be</text>
<text top="581" left="122" width="689" height="16" font="1">the size and dimension of NDRange. The number of workgroups, and hence work-items</text>
<text top="603" left="122" width="688" height="16" font="1">per workgroup can also be selected by the user or left for the GPU to decide. The choice</text>
<text top="625" left="122" width="689" height="16" font="1">should result to maximize the use of compute units. For example, a good choice would</text>
<text top="646" left="122" width="688" height="16" font="1">be one that results in 64 work-items per wavefront, because this ensures that the entire</text>
<text top="668" left="122" width="187" height="16" font="1">compute unit is utilized.</text>
<text top="699" left="148" width="662" height="16" font="1">Figure <a href="pdfxml.html#23">(2.6) </a>shows the classiﬁcation of memory in OpenCL. Private memory is speciﬁc</text>
<text top="720" left="122" width="124" height="16" font="1">to a work-item.</text>
<text top="720" left="261" width="295" height="16" font="1">It is not visible to other work-items.</text>
<text top="720" left="572" width="238" height="16" font="1">Local memory is speciﬁc to a</text>
<text top="742" left="122" width="689" height="16" font="1">work-group, accessible by work-items belonging to that work-group. Global memory is a</text>
<text top="764" left="122" width="689" height="16" font="1">read/write memory that is accessible to all work-items in a context. Constant memory is</text>
<text top="785" left="122" width="689" height="16" font="1">a read-only region for memory items that are passed from the host and are not changed</text>
<text top="807" left="122" width="689" height="16" font="1">during the kernel’s execution (for example, the input image for Canny edge detection</text>
<text top="829" left="122" width="688" height="16" font="1">above). Host memory is the CPU accessible memory for an application’s data structures</text>
<text top="850" left="122" width="143" height="16" font="1">and program data.</text>
<text top="881" left="148" width="662" height="16" font="1">For the HD5870, accessing the 32 kB of local memory (8 bytes/cycle) per compute unit</text>
<text top="903" left="122" width="689" height="16" font="1">is an order of magnitude faster then accessing the 1 GB of global memory (0.6 bytes/-</text>
<text top="924" left="122" width="688" height="16" font="1">cycle) <a href="pdfxml.html#89">[2]. </a>Private memory is fastest at 48 bytes/cycle. However, private memory, which</text>
<text top="946" left="122" width="689" height="16" font="1">is physically stored in hardware General Purpose Registers (GPR) is limited to 256 kB</text>
<text top="968" left="122" width="688" height="16" font="1">per compute unit. This translates to 5120 kB per GPU. When executing 64 kernels per</text>
<text top="989" left="122" width="688" height="16" font="1">compute unit this implies 4kB of memory that can be manipulated within a kernel. In</text>
<text top="1038" left="457" width="18" height="16" font="1">14</text>
</page>
<page number="24" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">the event that the GPR ﬁlls up, private memory is mapped to a speacial region known as</text>
<text top="213" left="122" width="477" height="16" font="1">“scratch”, which has the same performance as global memory.</text>
<text top="243" left="148" width="662" height="16" font="1">This is one of the main design considerations when programming kernels. If values can</text>
<text top="265" left="122" width="688" height="16" font="1">be hard coded, they should be, if loops can be unrolled to save the memory required for a</text>
<text top="287" left="122" width="689" height="16" font="1">counter, they should be <a href="pdfxml.html#89">[2]. </a>This can be problematic in research applications where image</text>
<text top="308" left="122" width="490" height="16" font="1">sizes or other variables need to be changed for experimentation.</text>
<text top="339" left="148" width="662" height="16" font="1">The kernel is compiled at runtime by the OpenCL compiler every time the host program</text>
<text top="361" left="122" width="688" height="16" font="1">is executed. During execution, memory from the host (for example, an image intensity</text>
<text top="382" left="122" width="688" height="16" font="1">matrix) is transferred through a buﬀer and into the appropriate memory of the GPU. At</text>
<text top="404" left="122" width="688" height="16" font="1">the end of each kernel, the appropriate result is mapped to the corresponding location on</text>
<text top="426" left="122" width="688" height="16" font="1">an output array. Once all the kernels are ﬁnished executing the output array is passed</text>
<text top="447" left="122" width="438" height="16" font="1">through the buﬀer and to the host memory for the CPU.</text>
<text top="478" left="148" width="662" height="16" font="1">A simple example for vector addition can demonstrate these concepts. vec add CPU</text>
<text top="500" left="122" width="689" height="16" font="1">is a program that would normally be used to add two 1-d vectors, a and b, with the result</text>
<text top="521" left="121" width="689" height="16" font="1">being written to vector c. When the vector size, n, is small the CPU is fairly eﬃcient at</text>
<text top="543" left="121" width="490" height="16" font="1">looping through each element, adding and assigning the results.</text>
<text top="573" left="107" width="596" height="13" font="5">1 void vec add CPU ( i n t n , const f l o a t ∗a , const f l o a t ∗b , f l o a t ∗ c )</text>
<text top="591" left="107" width="23" height="13" font="5">2 {</text>
<text top="609" left="107" width="7" height="13" font="5">3</text>
<text top="609" left="141" width="50" height="13" font="5">i n t i ;</text>
<text top="627" left="107" width="7" height="13" font="5">4</text>
<text top="627" left="141" width="151" height="13" font="5">f o r ( i =0; i &lt;n ; i +−)</text>
<text top="645" left="107" width="7" height="13" font="5">5</text>
<text top="645" left="159" width="130" height="13" font="5">c [ i ]= a [ i ]+b [ i ] ;</text>
<text top="663" left="107" width="23" height="13" font="5">6 }</text>
<text top="706" left="148" width="662" height="16" font="1">However, when n becomes large, say 128,000 elements, a parallel execution method is</text>
<text top="727" left="121" width="689" height="16" font="1">more justiﬁed. This is shown in vec add GPU. This is the kernel. Before the kernel is</text>
<text top="749" left="122" width="689" height="16" font="1">executed, the a and b matrices are passed into the constant section of the global memory.</text>
<text top="771" left="122" width="689" height="16" font="1">Output array c is also passed to the global memory, but not as a constant, since it needs</text>
<text top="792" left="122" width="689" height="16" font="1">to be written to. The NDRange is one dimensional with a size of 1 x 128, 000 work-items</text>
<text top="814" left="122" width="661" height="16" font="1">(the size of output vector c). The kernel is compiled and also transferred to the GPU.</text>
<text top="845" left="148" width="662" height="16" font="1">Each instance of the kernel’s execution (work-item) will call get global id(0) which</text>
<text top="866" left="122" width="689" height="16" font="1">will let it discover its position in the NDRange and hence its position in the output vector</text>
<text top="888" left="122" width="688" height="16" font="1">c. It will perform the addition of two corresponding elements from vectors, b and c, and</text>
<text top="910" left="122" width="689" height="16" font="1">return the result to the appropriate position in vector c, as shown in Figure <a href="pdfxml.html#25">(2.7). </a>Once all</text>
<text top="931" left="122" width="689" height="16" font="1">work-items are done, the vector c will be full, and will be passed through the output buﬀer</text>
<text top="953" left="122" width="689" height="16" font="1">and into the host memory, where the host application on the CPU will read and display</text>
<text top="975" left="122" width="78" height="16" font="1">the result.</text>
<text top="1038" left="457" width="18" height="16" font="1">15</text>
</page>
<page number="25" position="absolute" top="0" left="0" height="1188" width="918">
<text top="420" left="302" width="327" height="16" font="1">Figure 2.7: Parallel vector addition kernel.</text>
<text top="493" left="107" width="443" height="13" font="5">1 k e r n e l void vec add GPU ( g l o b a l const f l o a t ∗a ,</text>
<text top="511" left="107" width="7" height="13" font="5">2</text>
<text top="511" left="195" width="193" height="13" font="5">g l o b a l const f l o a t ∗b ,</text>
<text top="529" left="107" width="7" height="13" font="5">3</text>
<text top="529" left="195" width="140" height="13" font="5">g l o b a l f l o a t ∗ c )</text>
<text top="546" left="107" width="23" height="13" font="5">4 {</text>
<text top="564" left="107" width="7" height="13" font="5">5</text>
<text top="564" left="141" width="229" height="13" font="5">i n t g i d= g e t g l o b a l i d ( 0 ) ;</text>
<text top="582" left="107" width="7" height="13" font="5">6</text>
<text top="582" left="141" width="184" height="13" font="5">c [ g i d ]= a [ g i d ]+b [ g i d ] ;</text>
<text top="600" left="107" width="23" height="13" font="5">7 }</text>
<text top="643" left="148" width="662" height="16" font="1">There are no loops required in this implementation. 40 workgroups can be chosen with</text>
<text top="665" left="122" width="689" height="16" font="1">a workgroup size of 3200 work-items. This results in 50 wavefronts per workgroup with the</text>
<text top="687" left="122" width="621" height="16" font="1">optimum 64 work-items per wave-front. With 20 compute units, this results in 50∗</text>
<text top="684" left="746" width="13" height="11" font="3">40</text>
<text top="697" left="746" width="13" height="11" font="3">20</text>
<text top="687" left="765" width="45" height="16" font="1">= 100</text>
<text top="708" left="122" width="470" height="16" font="1">sequential computations vs 128,000 as in the case for a CPU.</text>
<text top="772" left="122" width="37" height="23" font="2">2.4</text>
<text top="772" left="188" width="343" height="23" font="2">Target Tracking Algorithm</text>
<text top="825" left="122" width="689" height="16" font="1">Vision based target tracking is the technique of ﬁnding regions corresponding to given</text>
<text top="847" left="122" width="689" height="16" font="1">objects in a sequence of image frames. The objects can move, change their pose, occlude</text>
<text top="869" left="122" width="688" height="16" font="1">for a portion of time, merge with each other or display other erratic behavior from frame</text>
<text top="890" left="122" width="70" height="16" font="1">to frame.</text>
<text top="921" left="148" width="662" height="16" font="1">Covariance based tracking was developed at Mitsubishi Electric Research Laboratories</text>
<text top="943" left="122" width="688" height="16" font="1">by Porikli and Tuzel <a href="pdfxml.html#93">[47]. </a>They use a covariance matrix to group a number of image</text>
<text top="964" left="122" width="137" height="16" font="1">features together.</text>
<text top="964" left="275" width="535" height="16" font="1">They claim that the covariance matrix is an eﬃcient descriptor of</text>
<text top="986" left="122" width="688" height="16" font="1">features because it is enough to match the region in diﬀerent views and poses and is</text>
<text top="1038" left="457" width="18" height="16" font="1">16</text>
</page>
<page number="26" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">low dimensional compared to other descriptors. They are also scale invariant and are</text>
<text top="213" left="122" width="689" height="16" font="1">mostly immune to ordering and inherit a certain rotation invariance <a href="pdfxml.html#94">[58]. </a>To locate the</text>
<text top="234" left="122" width="689" height="16" font="1">target, a predetermined covariance matrix is compared against the covariance matrices of</text>
<text top="256" left="122" width="272" height="16" font="1">all prospect regions within a frame.</text>
<text top="285" left="148" width="662" height="16" font="1">The algorithm can be used to track multiple targets from a single non-stationary cam-</text>
<text top="307" left="122" width="689" height="16" font="1">era. The camera can be monochrome, color or hyper-spectral. It has been shown to</text>
<text top="328" left="122" width="689" height="16" font="1">be better than mean-shift, template matching and sub-window methods <a href="pdfxml.html#94">[58]. </a>However,</text>
<text top="350" left="122" width="688" height="16" font="1">the computation power required has so far limited its applications in real-time tracking,</text>
<text top="372" left="122" width="268" height="16" font="1">necessary for robotics applications.</text>
<text top="400" left="148" width="662" height="16" font="1">Until now, most attempts around optimizing this algorithm were focused on novel</text>
<text top="422" left="122" width="688" height="16" font="1">search methods, limited search regions, target motion models and Kalman ﬁlters <a href="pdfxml.html#93">[46].</a></text>
<text top="444" left="122" width="688" height="16" font="1">While helpful, each attempt at optimizing tried to reduce the series computation load on</text>
<text top="465" left="122" width="689" height="16" font="1">a CPU. However, what was needed and what could prove to be a much higher return on</text>
<text top="487" left="122" width="688" height="16" font="1">investment, is the implementation of this algorithm on a GPU. This thesis shows such an</text>
<text top="509" left="122" width="689" height="16" font="1">implementation for the very ﬁrst time using the AMD HD5870 GPU, which was described</text>
<text top="530" left="122" width="178" height="16" font="1">in the previous section.</text>
<text top="559" left="148" width="662" height="16" font="1">Porikli et al. <a href="pdfxml.html#93">[47] </a>show that a 320 x 240 image can track a target at roughly 600</text>
<text top="581" left="122" width="688" height="16" font="1">msec/frame when the algorithm is implemented on a 3.2 GHz Pentium CPU. They show</text>
<text top="602" left="122" width="282" height="16" font="1">the complexity to be O(320 x 240 x d</text>
<text top="600" left="403" width="6" height="11" font="3">2</text>
<text top="602" left="410" width="114" height="16" font="1">+320 x 240 x d</text>
<text top="600" left="524" width="6" height="11" font="3">3</text>
<text top="602" left="531" width="279" height="16" font="1">). In 2006 Porikli <a href="pdfxml.html#93">[46] </a>suggested that</text>
<text top="624" left="122" width="688" height="16" font="1">this algorithm could beneﬁt greatly from a parallel implementation on an FPGA, DSP or</text>
<text top="646" left="122" width="58" height="16" font="1">a GPU.</text>
<text top="706" left="122" width="37" height="23" font="2">2.5</text>
<text top="706" left="188" width="553" height="23" font="2">Algorithm Description and Implementation</text>
<text top="759" left="122" width="689" height="16" font="1">An adaptation of the covariance tracking algorithm is described below together with its</text>
<text top="780" left="122" width="689" height="16" font="1">parallel implementation on a GPU. For the purpose of this thesis, consider an image,</text>
<text top="802" left="122" width="331" height="16" font="1">deﬁned by a W x H sized intensity matrix, I</text>
<text top="800" left="453" width="6" height="11" font="3">v</text>
<text top="801" left="466" width="30" height="20" font="1">∈ R</text>
<text top="800" left="496" width="48" height="11" font="3">W XH <a href="pdfxml.html#26">2</a></text>
<text top="802" left="544" width="266" height="16" font="1"><a href="pdfxml.html#26">. </a>This matrix includes the intensity</text>
<text top="824" left="122" width="689" height="16" font="1">values from a W x H pixel, monochrome image frame, acquired from a small camera.</text>
<text top="845" left="122" width="688" height="16" font="1">Features of interest within this matrix can include intensity values, image gradients, edge</text>
<text top="867" left="122" width="689" height="16" font="1">magnitude, edge orientation, multi-spectral intensity values (like from infrared cameras)</text>
<text top="889" left="122" width="398" height="16" font="1">and ﬁlter responses. A W x H x d feature matrix F</text>
<text top="886" left="522" width="6" height="11" font="3">v</text>
<text top="889" left="535" width="183" height="16" font="1">can be extracted from I</text>
<text top="886" left="719" width="6" height="11" font="3">v</text>
<text top="889" left="733" width="77" height="16" font="1">where d is</text>
<text top="910" left="122" width="252" height="16" font="1">the number of features per pixel.</text>
<text top="943" left="352" width="11" height="16" font="1">F</text>
<text top="940" left="366" width="6" height="11" font="3">v</text>
<text top="943" left="373" width="17" height="16" font="1">(x</text>
<text top="940" left="390" width="6" height="11" font="3">v</text>
<text top="943" left="397" width="16" height="16" font="1">, y</text>
<text top="940" left="414" width="6" height="11" font="3">v</text>
<text top="943" left="422" width="41" height="16" font="1">) = φ</text>
<text top="940" left="463" width="6" height="11" font="3">v</text>
<text top="943" left="470" width="15" height="16" font="1">(I</text>
<text top="940" left="486" width="6" height="11" font="3">v</text>
<text top="943" left="493" width="18" height="16" font="1">, x</text>
<text top="940" left="511" width="6" height="11" font="3">v</text>
<text top="943" left="518" width="16" height="16" font="1">, y</text>
<text top="940" left="536" width="6" height="11" font="3">v</text>
<text top="943" left="543" width="7" height="16" font="1">)</text>
<text top="943" left="774" width="36" height="16" font="1">(2.1)</text>
<text top="975" left="142" width="6" height="9" font="4">2</text>
<text top="977" left="148" width="662" height="13" font="5">The use of the v superscript here and elsewhere on variables is meant to diﬀerentiate them from similar</text>
<text top="995" left="122" width="430" height="13" font="5">variables used in aircraft models and controllers in later chapters.</text>
<text top="1038" left="457" width="18" height="16" font="1">17</text>
</page>
<page number="27" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="66" height="16" font="1">where (x</text>
<text top="189" left="188" width="6" height="11" font="3">v</text>
<text top="191" left="195" width="16" height="16" font="1">, y</text>
<text top="189" left="212" width="6" height="11" font="3">v</text>
<text top="191" left="220" width="359" height="19" font="1">) are the coordinates of a single pixel, and φ : R</text>
<text top="189" left="579" width="36" height="11" font="3">W XH</text>
<text top="190" left="621" width="36" height="20" font="1">→ R</text>
<text top="189" left="657" width="54" height="11" font="3">W XHXd</text>
<text top="191" left="717" width="93" height="16" font="1">is a function</text>
<text top="213" left="122" width="688" height="16" font="1">that maps the pixel location to its features. The target to be tracked is an unknown region</text>
<text top="234" left="122" width="152" height="16" font="1">within the image, I</text>
<text top="232" left="275" width="6" height="11" font="3">v</text>
<text top="234" left="282" width="528" height="16" font="1">, that is deﬁned as a collection of these speciﬁc features. It can be</text>
<text top="256" left="122" width="689" height="16" font="1">deﬁned at the start of the video input, by drawing a rectangle around something of interest,</text>
<text top="278" left="122" width="688" height="16" font="1">like a car on the highway. The video input can be a stream coming from an airborne camera.</text>
<text top="299" left="122" width="689" height="16" font="1">The target is conﬁned or can be suﬃciently described inside a m x n region around the</text>
<text top="321" left="122" width="152" height="16" font="1">pixel coordinates (x</text>
<text top="319" left="274" width="6" height="11" font="3">v</text>
<text top="330" left="274" width="5" height="11" font="3">t</text>
<text top="321" left="281" width="16" height="16" font="1">, y</text>
<text top="319" left="298" width="6" height="11" font="3">v</text>
<text top="330" left="298" width="5" height="11" font="3">t</text>
<text top="321" left="306" width="12" height="16" font="1">).</text>
<text top="352" left="148" width="206" height="16" font="1">For any m x n region, R⊂I</text>
<text top="349" left="356" width="6" height="11" font="3">v</text>
<text top="352" left="363" width="447" height="16" font="1">, a total of m ∗ n, feature vectors can be extracted. For the</text>
<text top="373" left="122" width="564" height="16" font="1">target tracker used in this work, the following seven features are selected:</text>
<text top="412" left="168" width="9" height="16" font="1">f</text>
<text top="419" left="177" width="7" height="11" font="3">k</text>
<text top="412" left="190" width="14" height="16" font="1">=</text>
<text top="412" left="223" width="10" height="16" font="1">x</text>
<text top="410" left="233" width="6" height="11" font="3">v</text>
<text top="412" left="256" width="9" height="16" font="1">y</text>
<text top="410" left="265" width="6" height="11" font="3">v</text>
<text top="412" left="287" width="8" height="16" font="1">I</text>
<text top="410" left="296" width="6" height="11" font="3">v</text>
<text top="412" left="304" width="17" height="16" font="1">(x</text>
<text top="410" left="320" width="6" height="11" font="3">v</text>
<text top="412" left="328" width="16" height="16" font="1">, y</text>
<text top="410" left="345" width="6" height="11" font="3">v</text>
<text top="412" left="352" width="30" height="16" font="1">) I</text>
<text top="410" left="383" width="6" height="11" font="3">v</text>
<text top="421" left="382" width="7" height="11" font="3">x</text>
<text top="412" left="391" width="17" height="16" font="1">(x</text>
<text top="410" left="407" width="6" height="11" font="3">v</text>
<text top="412" left="415" width="16" height="16" font="1">, y</text>
<text top="410" left="432" width="6" height="11" font="3">v</text>
<text top="412" left="439" width="30" height="16" font="1">) I</text>
<text top="410" left="470" width="6" height="11" font="3">v</text>
<text top="421" left="469" width="6" height="11" font="3">y</text>
<text top="412" left="477" width="17" height="16" font="1">(x</text>
<text top="410" left="494" width="6" height="11" font="3">v</text>
<text top="412" left="502" width="16" height="16" font="1">, y</text>
<text top="410" left="519" width="6" height="11" font="3">v</text>
<text top="412" left="526" width="30" height="16" font="1">) I</text>
<text top="410" left="557" width="6" height="11" font="3">v</text>
<text top="421" left="556" width="14" height="11" font="3">xx</text>
<text top="412" left="571" width="17" height="16" font="1">(x</text>
<text top="410" left="587" width="6" height="11" font="3">v</text>
<text top="412" left="595" width="16" height="16" font="1">, y</text>
<text top="410" left="612" width="6" height="11" font="3">v</text>
<text top="412" left="619" width="30" height="16" font="1">) I</text>
<text top="410" left="650" width="6" height="11" font="3">v</text>
<text top="421" left="649" width="13" height="11" font="3">yy</text>
<text top="412" left="663" width="17" height="16" font="1">(x</text>
<text top="410" left="680" width="6" height="11" font="3">v</text>
<text top="412" left="687" width="16" height="16" font="1">, y</text>
<text top="410" left="704" width="6" height="11" font="3">v</text>
<text top="412" left="711" width="7" height="16" font="1">)</text>
<text top="412" left="774" width="36" height="16" font="1">(2.2)</text>
<text top="461" left="148" width="179" height="16" font="1">where k = 1 . . . mn and</text>
<text top="506" left="174" width="8" height="16" font="1">I</text>
<text top="503" left="183" width="6" height="11" font="3">v</text>
<text top="515" left="182" width="7" height="11" font="3">x</text>
<text top="506" left="196" width="14" height="16" font="1">=</text>
<text top="494" left="216" width="17" height="16" font="1">dI</text>
<text top="492" left="234" width="6" height="11" font="3">v</text>
<text top="494" left="242" width="17" height="16" font="1">(x</text>
<text top="492" left="258" width="6" height="11" font="3">v</text>
<text top="494" left="266" width="16" height="16" font="1">, y</text>
<text top="492" left="283" width="6" height="11" font="3">v</text>
<text top="494" left="290" width="7" height="16" font="1">)</text>
<text top="518" left="243" width="19" height="16" font="1">dx</text>
<text top="517" left="262" width="6" height="11" font="3">v</text>
<text top="506" left="299" width="16" height="16" font="1">, I</text>
<text top="503" left="316" width="6" height="11" font="3">v</text>
<text top="515" left="314" width="6" height="11" font="3">y</text>
<text top="506" left="328" width="14" height="16" font="1">=</text>
<text top="494" left="349" width="17" height="16" font="1">dI</text>
<text top="492" left="367" width="6" height="11" font="3">v</text>
<text top="494" left="374" width="17" height="16" font="1">(x</text>
<text top="492" left="391" width="6" height="11" font="3">v</text>
<text top="494" left="398" width="16" height="16" font="1">, y</text>
<text top="492" left="416" width="6" height="11" font="3">v</text>
<text top="494" left="423" width="7" height="16" font="1">)</text>
<text top="518" left="376" width="18" height="16" font="1">dy</text>
<text top="517" left="395" width="6" height="11" font="3">v</text>
<text top="506" left="432" width="16" height="16" font="1">, I</text>
<text top="503" left="449" width="6" height="11" font="3">v</text>
<text top="515" left="447" width="14" height="11" font="3">xx</text>
<text top="506" left="467" width="14" height="16" font="1">=</text>
<text top="494" left="488" width="9" height="16" font="1">d</text>
<text top="492" left="497" width="6" height="11" font="3">2</text>
<text top="494" left="504" width="8" height="16" font="1">I</text>
<text top="492" left="513" width="6" height="11" font="3">v</text>
<text top="494" left="520" width="17" height="16" font="1">(x</text>
<text top="492" left="537" width="6" height="11" font="3">v</text>
<text top="494" left="544" width="16" height="16" font="1">, y</text>
<text top="492" left="562" width="6" height="11" font="3">v</text>
<text top="494" left="569" width="7" height="16" font="1">)</text>
<text top="518" left="508" width="26" height="16" font="1">d(x</text>
<text top="517" left="534" width="6" height="11" font="3">v</text>
<text top="518" left="541" width="7" height="16" font="1">)</text>
<text top="517" left="548" width="6" height="11" font="3">2</text>
<text top="506" left="578" width="16" height="16" font="1">, I</text>
<text top="503" left="595" width="6" height="11" font="3">v</text>
<text top="515" left="593" width="13" height="11" font="3">yy</text>
<text top="506" left="612" width="14" height="16" font="1">=</text>
<text top="494" left="633" width="9" height="16" font="1">d</text>
<text top="492" left="642" width="6" height="11" font="3">2</text>
<text top="494" left="649" width="8" height="16" font="1">I</text>
<text top="492" left="658" width="6" height="11" font="3">v</text>
<text top="494" left="665" width="17" height="16" font="1">(x</text>
<text top="492" left="682" width="6" height="11" font="3">v</text>
<text top="494" left="690" width="16" height="16" font="1">, y</text>
<text top="492" left="707" width="6" height="11" font="3">v</text>
<text top="494" left="714" width="7" height="16" font="1">)</text>
<text top="518" left="654" width="25" height="16" font="1">d(y</text>
<text top="517" left="679" width="6" height="11" font="3">v</text>
<text top="518" left="686" width="7" height="16" font="1">)</text>
<text top="517" left="693" width="6" height="11" font="3">2</text>
<text top="506" left="723" width="5" height="16" font="1">.</text>
<text top="506" left="774" width="36" height="16" font="1">(2.3)</text>
<text top="554" left="122" width="689" height="16" font="1">Each of these features can be found numerically using central diﬀerence approximation.</text>
<text top="576" left="122" width="356" height="16" font="1">The mean of these features for all the pixels is</text>
<text top="628" left="390" width="11" height="16" font="1">µ</text>
<text top="635" left="400" width="10" height="11" font="3">R</text>
<text top="628" left="416" width="14" height="16" font="1">=</text>
<text top="616" left="445" width="9" height="16" font="1">1</text>
<text top="640" left="436" width="26" height="16" font="1">mn</text>
<text top="610" left="470" width="19" height="11" font="3">mn</text>
<text top="653" left="468" width="23" height="11" font="3">k=1</text>
<text top="628" left="496" width="9" height="16" font="1">f</text>
<text top="635" left="504" width="7" height="11" font="3">k</text>
<text top="628" left="774" width="36" height="16" font="1">(2.4)</text>
<text top="682" left="121" width="689" height="16" font="1">where mn is the total number of pixels in R. A d x d feature covariance matrix for R can</text>
<text top="704" left="121" width="280" height="16" font="1">now be deﬁned in the usual manner,</text>
<text top="756" left="318" width="13" height="16" font="1">C</text>
<text top="763" left="331" width="10" height="11" font="3">R</text>
<text top="756" left="346" width="14" height="16" font="1">=</text>
<text top="744" left="375" width="9" height="16" font="1">1</text>
<text top="768" left="366" width="26" height="16" font="1">mn</text>
<text top="738" left="401" width="19" height="11" font="3">mn</text>
<text top="781" left="398" width="23" height="11" font="3">k=1</text>
<text top="756" left="423" width="15" height="16" font="1">(f</text>
<text top="763" left="438" width="7" height="11" font="3">k</text>
<text top="755" left="450" width="28" height="17" font="1">− µ</text>
<text top="763" left="479" width="10" height="11" font="3">R</text>
<text top="756" left="489" width="22" height="16" font="1">)(f</text>
<text top="763" left="511" width="7" height="11" font="3">k</text>
<text top="755" left="523" width="28" height="17" font="1">− µ</text>
<text top="763" left="552" width="10" height="11" font="3">R</text>
<text top="756" left="562" width="7" height="16" font="1">)</text>
<text top="753" left="569" width="7" height="11" font="3">T</text>
<text top="756" left="579" width="5" height="16" font="1">.</text>
<text top="756" left="774" width="36" height="16" font="1">(2.5)</text>
<text top="811" left="122" width="160" height="16" font="1">Within the matrix, I</text>
<text top="808" left="283" width="6" height="11" font="3">v</text>
<text top="811" left="291" width="519" height="16" font="1">, two distinct types of region R can be deﬁned: ones that are being</text>
<text top="832" left="122" width="689" height="16" font="1">searched for the target features and the one that best describes the target features. These</text>
<text top="854" left="122" width="190" height="16" font="1">can be represented as R</text>
<text top="861" left="311" width="6" height="11" font="3">p</text>
<text top="854" left="325" width="49" height="16" font="1">and R</text>
<text top="861" left="374" width="5" height="11" font="3">t</text>
<text top="854" left="387" width="423" height="16" font="1">respectively, where p stands for a prospect region and</text>
<text top="876" left="122" width="621" height="16" font="1">t stands for target region. Feature covariance matrices can be found for both R</text>
<text top="882" left="743" width="6" height="11" font="3">p</text>
<text top="876" left="756" width="48" height="16" font="1">and R</text>
<text top="882" left="805" width="5" height="11" font="3">t</text>
<text top="897" left="122" width="233" height="16" font="1">using Equations <a href="pdfxml.html#27">(2.2) </a>to <a href="pdfxml.html#27">(2.5).</a></text>
<text top="928" left="148" width="103" height="16" font="1">The matrix, I</text>
<text top="925" left="252" width="6" height="11" font="3">v</text>
<text top="928" left="260" width="380" height="16" font="1">, includes (W −m) x (H −n) regions classiﬁed as R</text>
<text top="935" left="640" width="6" height="11" font="3">p</text>
<text top="928" left="647" width="163" height="16" font="1">. One of these regions</text>
<text top="949" left="122" width="688" height="16" font="1">is the location of the target, provided that the target is in the frame. If a comparison can be</text>
<text top="971" left="122" width="372" height="16" font="1">made between the feature covariance for every R</text>
<text top="978" left="494" width="6" height="11" font="3">p</text>
<text top="971" left="506" width="304" height="16" font="1">to the predetermined feature covariance</text>
<text top="993" left="122" width="596" height="16" font="1">of the target then it should be possible to identify the location of that target.</text>
<text top="1038" left="457" width="18" height="16" font="1">18</text>
</page>
<page number="28" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="148" width="662" height="16" font="1">Despite all their aforementioned advantages, covariance matrices are not elements of the</text>
<text top="213" left="122" width="689" height="16" font="1">Euclidean space, and therefore require special methods to compare and evaluate. Forstner</text>
<text top="234" left="122" width="689" height="16" font="1">and Moonen <a href="pdfxml.html#90">[15] </a>presented proofs of an optimal distance metric, that can be used to com-</text>
<text top="256" left="122" width="689" height="16" font="1">pare covariance matrices of arbitrary dimensions. The authors show that their proposed</text>
<text top="278" left="122" width="367" height="16" font="1">distance, d, between two covariance matrices, A</text>
<text top="275" left="489" width="6" height="11" font="3">v</text>
<text top="278" left="502" width="47" height="16" font="1">and B</text>
<text top="275" left="550" width="6" height="11" font="3">v</text>
<text top="278" left="558" width="23" height="16" font="1">, is</text>
<text top="322" left="148" width="580" height="17" font="1">• invariant with respect to aﬃne transformations of the coordinate system,</text>
<text top="359" left="148" width="431" height="17" font="1">• invariant with respect to an inversion of the matrices,</text>
<text top="395" left="148" width="359" height="17" font="1">• indeed a metric by proving positivity: d(A</text>
<text top="394" left="506" width="6" height="11" font="3">v</text>
<text top="396" left="514" width="21" height="16" font="1">, B</text>
<text top="394" left="536" width="6" height="11" font="3">v</text>
<text top="396" left="543" width="125" height="16" font="1">) ≥ 0, and d(A</text>
<text top="394" left="668" width="6" height="11" font="3">v</text>
<text top="396" left="676" width="21" height="16" font="1">, B</text>
<text top="394" left="698" width="6" height="11" font="3">v</text>
<text top="396" left="705" width="105" height="16" font="1">) = 0 only if</text>
<text top="418" left="165" width="13" height="16" font="1">A</text>
<text top="416" left="179" width="6" height="11" font="3">v</text>
<text top="418" left="191" width="32" height="16" font="1">= B</text>
<text top="416" left="224" width="6" height="11" font="3">v</text>
<text top="418" left="231" width="128" height="16" font="1">, symmetry: d(A</text>
<text top="416" left="359" width="6" height="11" font="3">v</text>
<text top="418" left="367" width="21" height="16" font="1">, B</text>
<text top="416" left="389" width="6" height="11" font="3">v</text>
<text top="418" left="396" width="60" height="16" font="1">) = d(B</text>
<text top="416" left="457" width="6" height="11" font="3">v</text>
<text top="418" left="464" width="21" height="16" font="1">, A</text>
<text top="416" left="485" width="6" height="11" font="3">v</text>
<text top="418" left="493" width="257" height="16" font="1">) and the triangle inequality: d(A</text>
<text top="416" left="750" width="6" height="11" font="3">v</text>
<text top="418" left="757" width="21" height="16" font="1">, B</text>
<text top="416" left="779" width="6" height="11" font="3">v</text>
<text top="418" left="786" width="24" height="16" font="1">) +</text>
<text top="440" left="165" width="29" height="16" font="1">d(A</text>
<text top="437" left="195" width="6" height="11" font="3">v</text>
<text top="440" left="202" width="20" height="16" font="1">, C</text>
<text top="437" left="224" width="6" height="11" font="3">v</text>
<text top="440" left="231" width="60" height="16" font="1">) ≥ d(B</text>
<text top="437" left="292" width="6" height="11" font="3">v</text>
<text top="440" left="299" width="20" height="16" font="1">, C</text>
<text top="437" left="321" width="6" height="11" font="3">v</text>
<text top="440" left="328" width="81" height="16" font="1">), where C</text>
<text top="437" left="410" width="6" height="11" font="3">v</text>
<text top="440" left="424" width="223" height="16" font="1">is another covariance matrix.</text>
<text top="485" left="122" width="265" height="16" font="1">Their distance metric is deﬁned as</text>
<text top="544" left="327" width="29" height="16" font="1">d(A</text>
<text top="541" left="356" width="6" height="11" font="3">v</text>
<text top="544" left="363" width="21" height="16" font="1">, B</text>
<text top="541" left="385" width="6" height="11" font="3">v</text>
<text top="544" left="393" width="25" height="16" font="1">) =</text>
<text top="526" left="452" width="7" height="11" font="3">d</text>
<text top="569" left="445" width="21" height="11" font="3">i=1</text>
<text top="544" left="471" width="15" height="16" font="1">ln</text>
<text top="541" left="486" width="6" height="11" font="3">2</text>
<text top="544" left="496" width="10" height="16" font="1">λ</text>
<text top="551" left="506" width="4" height="11" font="3">i</text>
<text top="544" left="511" width="20" height="16" font="1">(A</text>
<text top="543" left="531" width="6" height="11" font="3">v</text>
<text top="544" left="538" width="21" height="16" font="1">, B</text>
<text top="543" left="561" width="6" height="11" font="3">v</text>
<text top="544" left="568" width="7" height="16" font="1">)</text>
<text top="544" left="774" width="36" height="16" font="1">(2.6)</text>
<text top="603" left="122" width="457" height="16" font="1">where d is the dimension of the covariance matrices and λ</text>
<text top="610" left="578" width="4" height="11" font="3">i</text>
<text top="603" left="583" width="20" height="16" font="1">(A</text>
<text top="601" left="603" width="6" height="11" font="3">v</text>
<text top="603" left="611" width="21" height="16" font="1">, B</text>
<text top="601" left="633" width="6" height="11" font="3">v</text>
<text top="603" left="640" width="170" height="16" font="1">) is the ith eigenvalue</text>
<text top="625" left="122" width="384" height="16" font="1">found by solving a generalized eigenvalue problem</text>
<text top="664" left="376" width="54" height="16" font="1">det(λB</text>
<text top="661" left="431" width="6" height="11" font="3">v</text>
<text top="663" left="443" width="31" height="17" font="1">− A</text>
<text top="661" left="474" width="6" height="11" font="3">v</text>
<text top="664" left="481" width="44" height="16" font="1">) = 0.</text>
<text top="664" left="774" width="36" height="16" font="1">(2.7)</text>
<text top="713" left="148" width="662" height="16" font="1">The smaller the value for d, the “closer” the two covariance matrices are to each other.</text>
<text top="734" left="122" width="655" height="16" font="1">In other words, this metric is a good way to compare whether a prospect region, R</text>
<text top="741" left="776" width="6" height="11" font="3">p</text>
<text top="734" left="783" width="27" height="16" font="1">, in</text>
<text top="756" left="121" width="331" height="16" font="1">the image is similar to the target region, R</text>
<text top="763" left="452" width="5" height="11" font="3">t</text>
<text top="756" left="457" width="321" height="16" font="1">. Proofs of these claims can found in <a href="pdfxml.html#90">[15].</a></text>
<text top="787" left="148" width="662" height="16" font="1">The most computationally intensive calculation involves a Cholesky decomposition and</text>
<text top="808" left="121" width="689" height="16" font="1">a Jacobi cyclic method implementation, required to solve the generalized eigenvalue prob-</text>
<text top="830" left="121" width="583" height="16" font="1">lem in Equation <a href="pdfxml.html#28">(2.7). </a>This computation is repeated for every pair of R</text>
<text top="837" left="705" width="6" height="11" font="3">p</text>
<text top="830" left="720" width="50" height="16" font="1">and R</text>
<text top="837" left="769" width="5" height="11" font="3">t</text>
<text top="830" left="775" width="35" height="16" font="1">. In</text>
<text top="852" left="122" width="174" height="16" font="1">the intensity matrix, I</text>
<text top="849" left="297" width="6" height="11" font="3">v</text>
<text top="852" left="304" width="506" height="16" font="1">, there are (W − m) x (H − n) pairs, if the entire image is being</text>
<text top="873" left="122" width="688" height="16" font="1">searched. These calculations need to be repeated for every frame. A typical 640 x 480</text>
<text top="895" left="122" width="224" height="16" font="1">camera, with 20 x 20 sized R</text>
<text top="902" left="345" width="6" height="11" font="3">p</text>
<text top="895" left="358" width="452" height="16" font="1">regions, would result in 285,200 search pairs. For real-time</text>
<text top="917" left="122" width="490" height="16" font="1">tracking, this will need to be done live for every received frame.</text>
<text top="947" left="148" width="662" height="16" font="1">In order to parallelize this algorithm, certain calculations are best run on the CPU,</text>
<text top="969" left="122" width="688" height="16" font="1">while the rest are best run on the GPU. The GPU, while consisting of a massive number of</text>
<text top="991" left="122" width="689" height="16" font="1">cores, also has lower computation capabilities per core when compared to a CPU. Hence,</text>
<text top="1038" left="457" width="18" height="16" font="1">19</text>
</page>
<page number="29" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">a calculation that only needs to happen once per frame should remain on a CPU while the</text>
<text top="213" left="122" width="491" height="16" font="1">frequently repeated calculations can be transferred to the GPU.</text>
<text top="243" left="148" width="397" height="16" font="1">For ﬁnding the target within the intensity matrix, I</text>
<text top="240" left="546" width="6" height="11" font="3">v</text>
<text top="243" left="554" width="256" height="16" font="1">, the NDRange is set as (W − m)</text>
<text top="264" left="122" width="689" height="16" font="1">x (H − n), the dimensions of the output as described above. This way, every m x n sized</text>
<text top="286" left="122" width="72" height="16" font="1">region, R</text>
<text top="293" left="194" width="6" height="11" font="3">p</text>
<text top="286" left="201" width="609" height="16" font="1">, can be assigned to a work-item, where the common instruction set would be</text>
<text top="308" left="122" width="552" height="16" font="1">to solve the generalized eigenvalue problem and ﬁnd the metric d to R</text>
<text top="315" left="673" width="5" height="11" font="3">t</text>
<text top="308" left="679" width="131" height="16" font="1">. The size of the</text>
<text top="329" left="122" width="689" height="16" font="1">workgroup can be chosen based on the discussion above. For a 640 x 480 image, with 20</text>
<text top="351" left="122" width="689" height="16" font="1">x 20 regions, a one dimensional NDRange is 1 x 285,200. A workgroup size of 2560 work-</text>
<text top="373" left="122" width="689" height="16" font="1">items will result in 112 workgroups, with an optimum 64 work-items per wavefront. The</text>
<text top="394" left="122" width="688" height="16" font="1">last workgroup will have (112 ∗ 2560) − 285, 200 = 1520 idle work-items. For 20 compute</text>
<text top="416" left="121" width="190" height="16" font="1">units, this results in 40 ∗</text>
<text top="413" left="317" width="19" height="11" font="3">112</text>
<text top="426" left="320" width="13" height="11" font="3">20</text>
<text top="416" left="343" width="241" height="16" font="1">= 224 sequential computations.</text>
<text top="446" left="148" width="182" height="16" font="1">The distance of each, R</text>
<text top="453" left="330" width="6" height="11" font="3">p</text>
<text top="446" left="337" width="24" height="16" font="1">, R</text>
<text top="453" left="361" width="5" height="11" font="3">t</text>
<text top="446" left="367" width="443" height="16" font="1">, pair can be sent back to the host memory (Figure <a href="pdfxml.html#23">(2.6))</a></text>
<text top="468" left="122" width="564" height="16" font="1">where the smallest d is assigned the most probable location of the target.</text>
<text top="498" left="148" width="662" height="16" font="1">The generalized eigenvalue problem from Equation <a href="pdfxml.html#28">(2.7) </a>is solved by ﬁrst reducing it</text>
<text top="520" left="122" width="689" height="16" font="1">to the standard eigenvalue problem and then using the Jacobi-Cyclic method. It can be</text>
<text top="541" left="122" width="115" height="16" font="1">re-expressed as</text>
<text top="579" left="399" width="13" height="16" font="1">A</text>
<text top="576" left="413" width="6" height="11" font="3">v</text>
<text top="579" left="420" width="58" height="16" font="1">v = λB</text>
<text top="576" left="479" width="6" height="11" font="3">v</text>
<text top="579" left="486" width="16" height="16" font="1">v,</text>
<text top="579" left="774" width="36" height="16" font="1">(2.8)</text>
<text top="617" left="122" width="521" height="16" font="1">where v is an eigenvector that corresponds to an eigenvalue λ. B</text>
<text top="615" left="644" width="6" height="11" font="3">v</text>
<text top="617" left="659" width="151" height="16" font="1">can be decomposed</text>
<text top="639" left="122" width="688" height="16" font="1">into a product of an upper triangular matrix, U, and its transpose by using a Choleski</text>
<text top="660" left="122" width="115" height="16" font="1">decomposition,</text>
<text top="698" left="408" width="13" height="16" font="1">B</text>
<text top="695" left="422" width="6" height="11" font="3">v</text>
<text top="698" left="435" width="31" height="16" font="1">= U</text>
<text top="695" left="467" width="7" height="11" font="3">T</text>
<text top="698" left="477" width="17" height="16" font="1">U.</text>
<text top="698" left="774" width="36" height="16" font="1">(2.9)</text>
<text top="736" left="122" width="238" height="16" font="1">Substituting in Equation <a href="pdfxml.html#29">(2.8),</a></text>
<text top="774" left="387" width="13" height="16" font="1">A</text>
<text top="770" left="400" width="6" height="11" font="3">v</text>
<text top="774" left="408" width="64" height="16" font="1">v = λ(U</text>
<text top="770" left="473" width="7" height="11" font="3">T</text>
<text top="774" left="483" width="31" height="16" font="1">U )v</text>
<text top="774" left="765" width="45" height="16" font="1">(2.10)</text>
<text top="811" left="122" width="270" height="16" font="1">and multiplying both sides with (U</text>
<text top="809" left="394" width="7" height="11" font="3">T</text>
<text top="811" left="403" width="7" height="16" font="1">)</text>
<text top="808" left="410" width="16" height="11" font="3">−1</text>
<text top="811" left="427" width="5" height="16" font="1">,</text>
<text top="849" left="274" width="19" height="16" font="1">(U</text>
<text top="846" left="294" width="7" height="11" font="3">T</text>
<text top="849" left="304" width="7" height="16" font="1">)</text>
<text top="845" left="311" width="16" height="11" font="3">−1</text>
<text top="849" left="328" width="13" height="16" font="1">A</text>
<text top="846" left="341" width="6" height="11" font="3">v</text>
<text top="849" left="349" width="137" height="16" font="1">v = λU v =⇒ (U</text>
<text top="846" left="487" width="7" height="11" font="3">T</text>
<text top="849" left="497" width="7" height="16" font="1">)</text>
<text top="845" left="504" width="16" height="11" font="3">−1</text>
<text top="849" left="521" width="13" height="16" font="1">A</text>
<text top="846" left="534" width="6" height="11" font="3">v</text>
<text top="849" left="541" width="12" height="16" font="1">U</text>
<text top="845" left="555" width="16" height="11" font="3">−1</text>
<text top="849" left="572" width="55" height="16" font="1">v = λv</text>
<text top="849" left="765" width="45" height="16" font="1">(2.11)</text>
<text top="887" left="122" width="234" height="16" font="1">and then substituting, D = (U</text>
<text top="885" left="358" width="7" height="11" font="3">T</text>
<text top="887" left="367" width="7" height="16" font="1">)</text>
<text top="884" left="374" width="16" height="11" font="3">−1</text>
<text top="887" left="391" width="13" height="16" font="1">A</text>
<text top="885" left="404" width="6" height="11" font="3">v</text>
<text top="887" left="412" width="12" height="16" font="1">U</text>
<text top="884" left="426" width="16" height="11" font="3">−1</text>
<text top="887" left="443" width="308" height="16" font="1">, gives the standard eigenvalue problem,</text>
<text top="925" left="413" width="76" height="16" font="1">Dv = λv.</text>
<text top="925" left="765" width="45" height="16" font="1">(2.12)</text>
<text top="971" left="148" width="662" height="16" font="1">This problem can now be solved using the Jacobi Cyclic method <a href="pdfxml.html#90">[19] </a>to give eigenvalues.</text>
<text top="993" left="122" width="688" height="16" font="1">The Jacobi Cyclic method is a well known iterative method for ﬁnding eigenvalues and</text>
<text top="1038" left="457" width="18" height="16" font="1">20</text>
</page>
<page number="30" position="absolute" top="0" left="0" height="1188" width="918">
<text top="514" left="122" width="689" height="16" font="1">Figure 2.8: A brief overview of the calculations on the host, and transfer of required</text>
<text top="536" left="122" width="688" height="16" font="1">matrices to the GPU. Once the GPU ﬁnishes its computations, the host is also responsible</text>
<text top="558" left="122" width="526" height="16" font="1">for reading back the result and evaluating the position of the target.</text>
<text top="629" left="122" width="362" height="16" font="1">eigenvectors of real symmetric matrices. If B</text>
<text top="626" left="485" width="6" height="11" font="3">v</text>
<text top="629" left="500" width="305" height="16" font="1">is assigned the covariance matrix of R</text>
<text top="635" left="805" width="5" height="11" font="3">t</text>
<text top="650" left="121" width="689" height="16" font="1">then the Choleski decomposition and the required matrix inverse can be performed once</text>
<text top="672" left="121" width="689" height="16" font="1">on the CPU. This gives the d x d covariance feature matrix deﬁning the target, as well as</text>
<text top="694" left="121" width="221" height="16" font="1">the intermediate matrices (U</text>
<text top="691" left="344" width="16" height="11" font="3">−1</text>
<text top="694" left="367" width="53" height="16" font="1">and (U</text>
<text top="691" left="422" width="7" height="11" font="3">T</text>
<text top="694" left="432" width="7" height="16" font="1">)</text>
<text top="691" left="438" width="16" height="11" font="3">−1</text>
<text top="694" left="455" width="355" height="16" font="1">) required for calculating the eigenvalues. The</text>
<text top="715" left="122" width="70" height="16" font="1">matrix A</text>
<text top="713" left="192" width="6" height="11" font="3">v</text>
<text top="715" left="205" width="375" height="16" font="1">is assigned the covariance matrix of one of the R</text>
<text top="722" left="580" width="6" height="11" font="3">p</text>
<text top="715" left="592" width="218" height="16" font="1">regions, depending on which</text>
<text top="737" left="122" width="689" height="16" font="1">instance of the kernel it is called from. The matrix multiplication in Equation <a href="pdfxml.html#29">(2.11) </a>and</text>
<text top="759" left="122" width="514" height="16" font="1">the Jacobi Cyclic method (not shown here) is repeated for every R</text>
<text top="765" left="636" width="6" height="11" font="3">p</text>
<text top="759" left="649" width="136" height="16" font="1">within the kernel.</text>
<text top="789" left="148" width="662" height="16" font="1">A simpliﬁed block diagram of these operations is shown in Figures <a href="pdfxml.html#30">(2.8) </a>and <a href="pdfxml.html#31">(2.9).</a></text>
<text top="811" left="122" width="688" height="16" font="1">Each instance of the kernel has access to the matrices that are computed on the host</text>
<text top="833" left="122" width="689" height="16" font="1">CPU through the GPU constant memory. These include, dI, the main image intensity</text>
<text top="854" left="122" width="689" height="16" font="1">matrix, Ix, Iy, Ixx and Iyy, which are the outputs of appropriate feature operations on</text>
<text top="876" left="122" width="369" height="16" font="1">the intensity matrix (from Equation <a href="pdfxml.html#27">(2.3)) </a>and U</text>
<text top="873" left="492" width="16" height="11" font="3">−1</text>
<text top="876" left="514" width="52" height="16" font="1">and (U</text>
<text top="874" left="567" width="7" height="11" font="3">T</text>
<text top="876" left="577" width="7" height="16" font="1">)</text>
<text top="873" left="584" width="16" height="11" font="3">−1</text>
<text top="876" left="605" width="205" height="16" font="1">which are outputs from the</text>
<text top="898" left="122" width="689" height="16" font="1">above calculations. The feature operations are performed on the CPU because algorithms</text>
<text top="919" left="122" width="689" height="16" font="1">for those already work in real-time. If done in parallel on the GPU, the work-item barriers</text>
<text top="941" left="122" width="688" height="16" font="1">required to synchronize their intermediate steps would slow down the main kernel <a href="pdfxml.html#89">[2]. </a>The</text>
<text top="963" left="122" width="689" height="16" font="1">constant memory allows accessible fast read-only memory so there are limited memory</text>
<text top="984" left="122" width="364" height="16" font="1">issues on accessing the multiple input matrices.</text>
<text top="1038" left="457" width="18" height="16" font="1">21</text>
</page>
<page number="31" position="absolute" top="0" left="0" height="1188" width="918">
<text top="455" left="122" width="689" height="16" font="1">Figure 2.9: A brief overview of the calculations on the kernel, and the transfer of results</text>
<text top="476" left="122" width="524" height="16" font="1">to the host. This set of calculations is repeated for every work-item.</text>
<text top="547" left="148" width="662" height="16" font="1">Once all the individual comparison results are calculated, they are transfered to the</text>
<text top="568" left="122" width="688" height="16" font="1">host memory (Figure <a href="pdfxml.html#23">(2.6) </a>where the smallest distance is picked as the most likely target</text>
<text top="590" left="122" width="66" height="16" font="1">location.</text>
<text top="653" left="122" width="37" height="23" font="2">2.6</text>
<text top="653" left="188" width="93" height="23" font="2">Results</text>
<text top="707" left="122" width="540" height="16" font="1">Screen shots from the results can be seen in Figures <a href="pdfxml.html#32">(2.11) </a>and <a href="pdfxml.html#32">(2.10).</a></text>
<text top="737" left="148" width="662" height="16" font="1">The ﬁrst example tracks a set of keys on a key-chain through rotations and trans-</text>
<text top="759" left="122" width="689" height="16" font="1">formations. Part of the set is selected as a target, with no particular identifying color</text>
<text top="780" left="122" width="689" height="16" font="1">or structure. The algorithm maintains real-time tracking even when the keys have been</text>
<text top="802" left="122" width="689" height="16" font="1">picked and shuﬄed. It also diﬀerentiates the key set from a shoe that looks very similar in</text>
<text top="824" left="122" width="689" height="16" font="1">color and arrangement. The key is also obscured and then made visible again, the tracker</text>
<text top="845" left="122" width="274" height="16" font="1">automatically reacquires the target.</text>
<text top="876" left="148" width="662" height="16" font="1">The second example tracks a high speed aircraft while it is ﬂying at over 80 km/h, with</text>
<text top="897" left="122" width="688" height="16" font="1">aggressive maneuvers and sharp turns. The aircraft also comes very and then ﬂies oﬀ far,</text>
<text top="919" left="122" width="640" height="16" font="1">with the vision system maintaining tracking at all times through the scale changes.</text>
<text top="949" left="148" width="662" height="16" font="1">Porikli et al. <a href="pdfxml.html#93">[47] </a>implied that for a 640 x 480 image, the computational load on the</text>
<text top="971" left="122" width="688" height="16" font="1">CPU would cause it to run at 1,200 msec/frame. The GPU implementation described here</text>
<text top="993" left="122" width="554" height="16" font="1">performs at roughly 100 msec/frame - an improvement of over 10 times.</text>
<text top="1038" left="457" width="18" height="16" font="1">22</text>
</page>
<page number="32" position="absolute" top="0" left="0" height="1188" width="918">
<text top="345" left="122" width="688" height="16" font="1">Figure 2.10: Keychain Tracking - real-time and showing robustness through deformations.</text>
<text top="556" left="122" width="689" height="16" font="1">Figure 2.11: High Speed Aircraft Tracking - real-time and showing robustness through</text>
<text top="577" left="122" width="214" height="16" font="1">rotations and scale changes.</text>
<text top="648" left="148" width="662" height="16" font="1">With a monochrome image, and the resulting intensity matrix, color information is</text>
<text top="670" left="122" width="688" height="16" font="1">ignored. When implemented like this, cluttered background can result in erroneous track-</text>
<text top="691" left="122" width="688" height="16" font="1">ing. However, when color is used, the performance of the tracker is improved signiﬁcantly.</text>
<text top="713" left="122" width="689" height="16" font="1">Porikli <a href="pdfxml.html#93">[46] </a>shows the algorithm to work through cluttered environments, grainy video and</text>
<text top="735" left="122" width="689" height="16" font="1">complete occlusion. However, the GPU implementation of color video streams is left for</text>
<text top="756" left="122" width="689" height="16" font="1">future work, and may require signiﬁcant optimization of the kernel algorithm to still run</text>
<text top="778" left="122" width="148" height="16" font="1">at 100 msec/frame.</text>
<text top="809" left="148" width="662" height="16" font="1">In the future, adding advanced search methods, limiting the number of prospect regions</text>
<text top="830" left="122" width="688" height="16" font="1">searched for the target, and adding a motion model for the target would bring even more</text>
<text top="852" left="122" width="688" height="16" font="1">signiﬁcant improvements (all these enhancements have been done before on CPU based</text>
<text top="874" left="122" width="138" height="16" font="1">implementations).</text>
<text top="904" left="148" width="662" height="16" font="1">The target information acquired can be passed to a high level planner which derives</text>
<text top="926" left="122" width="688" height="16" font="1">its relative position to the aircraft. This information is then transferred to the tracking</text>
<text top="948" left="122" width="547" height="16" font="1">controllers developed in the subsequent chapters to follow a live target.</text>
<text top="1038" left="457" width="18" height="16" font="1">23</text>
</page>
<page number="33" position="absolute" top="0" left="0" height="1188" width="918">
<text top="304" left="122" width="184" height="33" font="0">Chapter 3</text>
<text top="386" left="122" width="388" height="33" font="0">System Identiﬁcation</text>
<text top="493" left="122" width="37" height="23" font="2">3.1</text>
<text top="493" left="188" width="160" height="23" font="2">Introduction</text>
<text top="545" left="122" width="688" height="16" font="1">The vision tracking system, deﬁned in Chapter 2, gives the real-time location of a high</text>
<text top="567" left="122" width="688" height="16" font="1">speed moving target on the ground. The aircraft now needs to be able to follow the target</text>
<text top="589" left="122" width="688" height="16" font="1">through a trajectory tracking controller that can maintain the stability of the aircraft</text>
<text top="610" left="122" width="689" height="16" font="1">during high speed aggressive turns. Such a controller can be realized using nonlinear</text>
<text top="632" left="122" width="688" height="16" font="1">control techniques like feedback linearization and backstepping. Both of these methods</text>
<text top="654" left="122" width="688" height="16" font="1">rely on canceling the nonlinearities in the system using inverse terms calculated using</text>
<text top="675" left="122" width="250" height="16" font="1">precise knowledge of the system.</text>
<text top="704" left="148" width="662" height="16" font="1">This chapter presents a method to obtain such knowledge for a small scale Unmanned</text>
<text top="726" left="122" width="689" height="16" font="1">Aerial Vehicle (UAV). It relies on tried and tested methods of system identiﬁcation to</text>
<text top="747" left="122" width="689" height="16" font="1">extract stability and control derivatives from the ﬂight data. The ﬂight data is obtained</text>
<text top="769" left="122" width="689" height="16" font="1">through a series of carefully planned ﬂights with custom designed on-board sensors to</text>
<text top="791" left="122" width="689" height="16" font="1">record airspeed, wind ﬂow angles, attitude and control inputs. The ﬂight is coordinated</text>
<text top="812" left="122" width="689" height="16" font="1">through a series of ground links making it possible to conduct multiple experiments without</text>
<text top="834" left="122" width="61" height="16" font="1">landing.</text>
<text top="863" left="148" width="662" height="16" font="1">Early work on the development of these methods was conducted at the Dryden Flight</text>
<text top="884" left="122" width="688" height="16" font="1">Research Center in the 1960’s <a href="pdfxml.html#91">[26]. </a>At the time, the estimated ﬂight parameters like</text>
<text top="906" left="122" width="688" height="16" font="1">control derivatives and inertia were used to verify wind tunnel predictions and evaluate</text>
<text top="928" left="122" width="688" height="16" font="1">aircraft performance. They were also used to improve aircraft simulators and basic ﬂight</text>
<text top="949" left="122" width="688" height="16" font="1">control systems. In the last couple decades these methods have been used to expand</text>
<text top="971" left="122" width="688" height="16" font="1">ﬂight envelopes, generate high-ﬁdelity aerodynamic derivatives and develop controllers for</text>
<text top="993" left="122" width="131" height="16" font="1">unstable aircraft.</text>
<text top="1038" left="457" width="18" height="16" font="1">24</text>
</page>
<page number="34" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="148" width="662" height="16" font="1">There are now two main classes of methods for aircraft system identiﬁcation: online and</text>
<text top="213" left="122" width="688" height="16" font="1">oﬄine. Online methods process the aircraft measurements as they become available until</text>
<text top="234" left="122" width="689" height="16" font="1">the parameters converge. Oﬄine methods require a complete time history of measured</text>
<text top="256" left="122" width="592" height="16" font="1">data and the method is iterated over the data until the parameters converge.</text>
<text top="287" left="148" width="662" height="16" font="1">The maximum likelihood method is one of the most popular oﬄine methods. It is based</text>
<text top="308" left="122" width="688" height="16" font="1">on a probabilistic analysis of the parameters and takes measurement noise into account. In</text>
<text top="330" left="122" width="689" height="16" font="1">a 1987 lecture, Ilif <a href="pdfxml.html#91">[25] </a>demonstrated the usefulness of the maximum likelihood estimate,</text>
<text top="352" left="122" width="688" height="16" font="1">also known as the Output Error Method, and showed 3D graphs of the cost functions.</text>
<text top="373" left="122" width="688" height="16" font="1">He also showed results from NASA’s work on the F-14, HiMAT and the Space Shuttle</text>
<text top="395" left="122" width="688" height="16" font="1">using this method. In 1988, Jategaonkar and Plaetchke <a href="pdfxml.html#91">[33] </a>showed the use of an EKF to</text>
<text top="417" left="122" width="688" height="16" font="1">estimate parameters. They applied this to the maximum likelihood method, the resulting</text>
<text top="438" left="122" width="688" height="16" font="1">method was called the Filter Error Method. In 1998 Hamel and Jategaonkar <a href="pdfxml.html#90">[21], </a>show</text>
<text top="460" left="122" width="688" height="16" font="1">that these class of methods had reached a maturity level. Their applications had widened</text>
<text top="482" left="122" width="688" height="16" font="1">from general linear use to nonlinear, high ﬁdelity and unstable aircraft. More recently,</text>
<text top="503" left="122" width="689" height="16" font="1">Naruoka et al. showed that these methods are still superior than the more recent methods</text>
<text top="525" left="122" width="336" height="16" font="1">based on the Unscented Kalman Filter <a href="pdfxml.html#92">[45].</a></text>
<text top="556" left="148" width="662" height="16" font="1">With the recent advances in computational power online methods have gained popular-</text>
<text top="577" left="122" width="689" height="16" font="1">ity. In 2010, Meng et. al. <a href="pdfxml.html#92">[44] </a>show an online method that uses a recursive technique with</text>
<text top="599" left="122" width="689" height="16" font="1">an EKF. Also, in 2010, Chowdhary and Jategaonkar <a href="pdfxml.html#89">[7] </a>showed that the online recursive</text>
<text top="621" left="122" width="689" height="16" font="1">methods using an EKF were just as good as the UKF methods, and were computationally</text>
<text top="642" left="122" width="111" height="16" font="1">less expensive.</text>
<text top="673" left="148" width="662" height="16" font="1">The algorithms presented in this chapter are based on the oﬄine maximum likelihood</text>
<text top="695" left="122" width="689" height="16" font="1">method and require large amounts of processing time, on the scale of half a day to a</text>
<text top="716" left="122" width="689" height="16" font="1">few days. For data recorded at 100Hz for a period of just 10s, the total number of data</text>
<text top="738" left="122" width="689" height="16" font="1">points is 130,000 (9 outputs and 4 control inputs). Small sampling times are necessary for</text>
<text top="760" left="122" width="689" height="16" font="1">developing models that will be useful for nonlinear controllers. The work at Dryden was</text>
<text top="781" left="122" width="688" height="16" font="1">usually done at 25 to 30 Hz but this has increased signiﬁcantly over the years with new</text>
<text top="803" left="122" width="493" height="16" font="1">applications, improved sensors and the rise in computing power.</text>
<text top="834" left="148" width="662" height="16" font="1">This chapter proceeds as follows. Section <a href="pdfxml.html#35">(3.2) </a>describes the general 9 state aircraft</text>
<text top="855" left="122" width="688" height="16" font="1">model with aerodynamic derivatives and their respective parameters. Section <a href="pdfxml.html#40">(3.3) </a>goes</text>
<text top="877" left="122" width="688" height="16" font="1">through the most popular system identiﬁcation technique, namely, the Output Error</text>
<text top="899" left="122" width="689" height="16" font="1">Method. Eﬀects of wind turbulence are dealt with in Section <a href="pdfxml.html#45">(3.4). </a>Proof of concept</text>
<text top="920" left="122" width="689" height="16" font="1">results using a nonlinear simulation of the BAC-221 jet are shown in Section <a href="pdfxml.html#48">(3.5). </a>Sec-</text>
<text top="942" left="122" width="688" height="16" font="1">tions <a href="pdfxml.html#49">(3.6) </a>and <a href="pdfxml.html#55">(3.7) </a>show the implementation and ﬂight test results using a Kadet Senior</text>
<text top="964" left="122" width="130" height="16" font="1">small scale UAV.</text>
<text top="1038" left="457" width="18" height="16" font="1">25</text>
</page>
<page number="35" position="absolute" top="0" left="0" height="1188" width="918">
<text top="457" left="236" width="459" height="16" font="1">Figure 3.1: Flight path climb angle and the angle of attack.</text>
<text top="522" left="121" width="37" height="23" font="2">3.2</text>
<text top="522" left="188" width="400" height="23" font="2">General 9 State Aircraft Model</text>
<text top="576" left="121" width="688" height="16" font="1">Three distinct coordinate frames are used to deﬁne the aircraft model in order to specify</text>
<text top="598" left="121" width="688" height="16" font="1">forces and moments in a straightforward manner. Aerodynamic forces and moments are</text>
<text top="620" left="121" width="221" height="16" font="1">deﬁned in the wind frame F</text>
<text top="626" left="342" width="11" height="11" font="3">w</text>
<text top="620" left="354" width="456" height="16" font="1">, i.e., vehicle carried axes aligned with the direction of the</text>
<text top="641" left="121" width="537" height="16" font="1">oncoming free-stream velocity, or in a vehicle carried vertical frame F</text>
<text top="648" left="659" width="8" height="11" font="3">v</text>
<text top="641" left="668" width="142" height="16" font="1">. The body frame,</text>
<text top="663" left="122" width="13" height="16" font="1">F</text>
<text top="670" left="134" width="8" height="11" font="3">b</text>
<text top="663" left="143" width="667" height="16" font="1">, is also needed to deﬁne angular rates as measured by the Inertial Measurement Unit</text>
<text top="685" left="122" width="54" height="16" font="1">(IMU).</text>
<text top="715" left="148" width="473" height="16" font="1">In the sense of Euler angles (3-2-1 convention), the frames F</text>
<text top="722" left="621" width="11" height="11" font="3">w</text>
<text top="715" left="639" width="48" height="16" font="1">and F</text>
<text top="722" left="687" width="8" height="11" font="3">b</text>
<text top="715" left="702" width="108" height="16" font="1">are related by</text>
<text top="737" left="121" width="689" height="16" font="1">the rotation sequence (−β, α, 0) as seen in Figures <a href="pdfxml.html#35">(3.1) </a>and <a href="pdfxml.html#36">(3.2). </a>α and β denote the</text>
<text top="759" left="122" width="689" height="16" font="1">aerodynamically important angles, angle of attack and sideslip, respectively. The 3-2-1</text>
<text top="780" left="122" width="434" height="16" font="1">Euler angle sequence (ψ, γ, φ) gives the orientation of F</text>
<text top="787" left="555" width="11" height="11" font="3">w</text>
<text top="780" left="572" width="96" height="16" font="1">relative to F</text>
<text top="787" left="669" width="8" height="11" font="3">v</text>
<text top="780" left="678" width="132" height="16" font="1">. Here, γ denotes</text>
<text top="802" left="121" width="688" height="16" font="1">the ﬂight path angle of climb and ψ denotes the ﬂight path heading. Angular velocities of</text>
<text top="824" left="121" width="43" height="16" font="1">the F</text>
<text top="830" left="164" width="8" height="11" font="3">b</text>
<text top="824" left="179" width="343" height="16" font="1">frame are represented by (p, q, r) whereas (p</text>
<text top="830" left="522" width="9" height="11" font="3">w</text>
<text top="824" left="532" width="18" height="16" font="1">, q</text>
<text top="830" left="551" width="9" height="11" font="3">w</text>
<text top="824" left="561" width="18" height="16" font="1">, r</text>
<text top="830" left="579" width="9" height="11" font="3">w</text>
<text top="824" left="590" width="220" height="16" font="1">) give the angular velocity of</text>
<text top="845" left="121" width="43" height="16" font="1">the F</text>
<text top="852" left="164" width="11" height="11" font="3">w</text>
<text top="845" left="182" width="48" height="16" font="1">frame.</text>
<text top="876" left="148" width="662" height="16" font="1">In the following aircraft model, dynamics are included that link aircraft movements to</text>
<text top="898" left="121" width="688" height="16" font="1">the individual control surfaces. More importantly, aerodynamic coeﬃcients are included</text>
<text top="919" left="121" width="486" height="16" font="1">that account for lift, drag and side force created by the airﬂow.</text>
<text top="1038" left="457" width="18" height="16" font="1">26</text>
</page>
<page number="36" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="6" size="6" family="Times" color="#000000"/>
<text top="525" left="226" width="471" height="16" font="1">Figure 3.2: Flight path heading angle and the side-slip angle.</text>
<text top="572" left="122" width="206" height="16" font="1">Aerodynamic Moments</text>
<text top="612" left="122" width="174" height="16" font="1">The moments in the F</text>
<text top="619" left="296" width="8" height="11" font="3">b</text>
<text top="612" left="310" width="205" height="16" font="1">frame can be expressed as,</text>
<text top="650" left="412" width="49" height="17" font="1">L = C</text>
<text top="658" left="461" width="4" height="11" font="3">l</text>
<text top="639" left="467" width="9" height="16" font="1">1</text>
<text top="663" left="467" width="9" height="16" font="1">2</text>
<text top="651" left="478" width="19" height="16" font="1">ρV</text>
<text top="647" left="501" width="6" height="11" font="3">2</text>
<text top="651" left="508" width="16" height="16" font="1">sb</text>
<text top="692" left="403" width="58" height="17" font="1">M = C</text>
<text top="700" left="461" width="11" height="11" font="3">m</text>
<text top="681" left="475" width="9" height="16" font="1">1</text>
<text top="705" left="475" width="9" height="16" font="1">2</text>
<text top="693" left="485" width="19" height="16" font="1">ρV</text>
<text top="689" left="508" width="6" height="11" font="3">2</text>
<text top="693" left="516" width="16" height="16" font="1">sc</text>
<text top="734" left="407" width="54" height="17" font="1">N = C</text>
<text top="741" left="461" width="8" height="11" font="3">n</text>
<text top="723" left="471" width="9" height="16" font="1">1</text>
<text top="747" left="471" width="9" height="16" font="1">2</text>
<text top="735" left="482" width="19" height="16" font="1">ρV</text>
<text top="731" left="505" width="6" height="11" font="3">2</text>
<text top="735" left="512" width="16" height="16" font="1">sb</text>
<text top="691" left="774" width="36" height="16" font="1">(3.1)</text>
<text top="771" left="122" width="688" height="16" font="1">where L, M, N represent rolling, pitching and yawing moments respectively, ρ is the density</text>
<text top="793" left="122" width="689" height="16" font="1">of air, V is the freestream velocity, s, the wing area, b the wing span and c the chord</text>
<text top="814" left="122" width="362" height="16" font="1">length or characteristic length of the aircraft. C</text>
<text top="821" left="484" width="4" height="11" font="3">l</text>
<text top="814" left="488" width="23" height="16" font="1">, C</text>
<text top="821" left="511" width="11" height="11" font="3">m</text>
<text top="814" left="528" width="46" height="16" font="1">and C</text>
<text top="821" left="574" width="8" height="11" font="3">n</text>
<text top="814" left="587" width="223" height="16" font="1">represent the nondimensional</text>
<text top="836" left="122" width="309" height="16" font="1">coeﬃcients which can be represented as,</text>
<text top="866" left="386" width="13" height="16" font="1">C</text>
<text top="873" left="398" width="4" height="11" font="3">l</text>
<text top="866" left="408" width="27" height="16" font="1">= f</text>
<text top="873" left="435" width="9" height="11" font="3">C</text>
<text top="877" left="444" width="4" height="8" font="6">l</text>
<text top="866" left="450" width="103" height="16" font="1">(α, β, δR, δA)</text>
<text top="893" left="379" width="13" height="16" font="1">C</text>
<text top="899" left="391" width="11" height="11" font="3">m</text>
<text top="893" left="408" width="27" height="16" font="1">= f</text>
<text top="899" left="435" width="9" height="11" font="3">C</text>
<text top="903" left="444" width="10" height="8" font="6">m</text>
<text top="893" left="456" width="55" height="16" font="1">(α, δE)</text>
<text top="919" left="382" width="13" height="16" font="1">C</text>
<text top="926" left="395" width="8" height="11" font="3">n</text>
<text top="919" left="408" width="27" height="16" font="1">= f</text>
<text top="926" left="435" width="9" height="11" font="3">C</text>
<text top="929" left="444" width="7" height="8" font="6">n</text>
<text top="919" left="453" width="103" height="16" font="1">(α, β, δA, δR)</text>
<text top="893" left="774" width="36" height="16" font="1">(3.2)</text>
<text top="949" left="122" width="689" height="16" font="1">where δE, δA and δR are the aircraft elevator, aileron and rudder deﬂections respectively.</text>
<text top="971" left="122" width="688" height="16" font="1">Note that the pitching moment is mainly aﬀected by the elevators, where as the rolling</text>
<text top="993" left="122" width="559" height="16" font="1">and yawing moments are aﬀected mainly by the ailerons and the rudder.</text>
<text top="1038" left="457" width="18" height="16" font="1">27</text>
</page>
<page number="37" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="180" height="16" font="1">Aerodynamic Forces</text>
<text top="233" left="122" width="117" height="16" font="1">Forces in the F</text>
<text top="240" left="239" width="11" height="11" font="3">w</text>
<text top="233" left="256" width="73" height="16" font="1">frame are</text>
<text top="279" left="351" width="48" height="16" font="1">L = C</text>
<text top="286" left="399" width="9" height="11" font="3">L</text>
<text top="267" left="410" width="9" height="16" font="1">1</text>
<text top="291" left="410" width="9" height="16" font="1">2</text>
<text top="279" left="421" width="19" height="16" font="1">ρV</text>
<text top="276" left="444" width="6" height="11" font="3">2</text>
<text top="279" left="451" width="81" height="16" font="1">s + T sin α</text>
<text top="321" left="348" width="51" height="16" font="1">D = C</text>
<text top="328" left="399" width="10" height="11" font="3">D</text>
<text top="309" left="412" width="9" height="16" font="1">1</text>
<text top="333" left="412" width="9" height="16" font="1">2</text>
<text top="321" left="423" width="19" height="16" font="1">ρV</text>
<text top="318" left="446" width="6" height="11" font="3">2</text>
<text top="321" left="453" width="123" height="16" font="1">s − T cos α cos β</text>
<text top="363" left="351" width="62" height="16" font="1">S = −C</text>
<text top="370" left="413" width="8" height="11" font="3">S</text>
<text top="351" left="424" width="9" height="16" font="1">1</text>
<text top="375" left="424" width="9" height="16" font="1">2</text>
<text top="363" left="435" width="19" height="16" font="1">ρV</text>
<text top="360" left="458" width="6" height="11" font="3">2</text>
<text top="363" left="465" width="121" height="16" font="1">s + T cos α sin β</text>
<text top="320" left="774" width="36" height="16" font="1">(3.3)</text>
<text top="408" left="122" width="689" height="16" font="1">where T is the thrust, L is the lift force, D is the drag force, S is the side force (as depicted</text>
<text top="430" left="121" width="268" height="16" font="1">in Figures <a href="pdfxml.html#35">(3.1) </a>and <a href="pdfxml.html#36">(3.2)) </a>and C</text>
<text top="437" left="390" width="9" height="11" font="3">L</text>
<text top="430" left="399" width="26" height="16" font="1">, C</text>
<text top="437" left="425" width="10" height="11" font="3">D</text>
<text top="430" left="445" width="49" height="16" font="1">and C</text>
<text top="437" left="494" width="8" height="11" font="3">S</text>
<text top="430" left="512" width="298" height="16" font="1">are the corresponding nondimensional</text>
<text top="451" left="121" width="527" height="16" font="1">aerodynamic coeﬃcients. These depend on α and β as shown below,</text>
<text top="491" left="409" width="13" height="16" font="1">C</text>
<text top="498" left="422" width="9" height="11" font="3">L</text>
<text top="491" left="436" width="27" height="16" font="1">= f</text>
<text top="498" left="463" width="9" height="11" font="3">C</text>
<text top="502" left="472" width="8" height="8" font="6">L</text>
<text top="491" left="481" width="25" height="16" font="1">(α)</text>
<text top="517" left="407" width="13" height="16" font="1">C</text>
<text top="524" left="419" width="10" height="11" font="3">D</text>
<text top="517" left="436" width="27" height="16" font="1">= f</text>
<text top="524" left="463" width="9" height="11" font="3">C</text>
<text top="528" left="472" width="9" height="8" font="6">D</text>
<text top="517" left="483" width="25" height="16" font="1">(α)</text>
<text top="517" left="774" width="36" height="16" font="1">(3.4)</text>
<text top="543" left="409" width="13" height="16" font="1">C</text>
<text top="550" left="422" width="8" height="11" font="3">S</text>
<text top="543" left="436" width="27" height="16" font="1">= f</text>
<text top="550" left="463" width="9" height="11" font="3">C</text>
<text top="554" left="472" width="7" height="8" font="6">S</text>
<text top="543" left="481" width="44" height="16" font="1">(α, β)</text>
<text top="583" left="121" width="689" height="16" font="1">where the lift and drag are functions of the angle of attack as expected, and the side force</text>
<text top="605" left="121" width="689" height="16" font="1">is a function of both the angle of attack and sideslip angle. Note, the direct eﬀects of</text>
<text top="626" left="121" width="688" height="16" font="1">control surface deﬂection on the forces are neglected. The control surfaces mostly aﬀect</text>
<text top="648" left="121" width="688" height="16" font="1">the moments which in turn aﬀect the forces. It can be shown that if the eﬀects of control</text>
<text top="670" left="121" width="689" height="16" font="1">surface deﬂection are directly included in the equations for forces, the nonlinear controllers</text>
<text top="691" left="121" width="688" height="16" font="1">will request unnecessarily large amounts of control inputs that could lead to an unstable</text>
<text top="713" left="121" width="90" height="16" font="1">system <a href="pdfxml.html#92">[39].</a></text>
<text top="744" left="148" width="303" height="16" font="1">The thrust, T, can be approximated by</text>
<text top="783" left="419" width="47" height="16" font="1">T = T</text>
<text top="790" left="466" width="25" height="11" font="3">max</text>
<text top="783" left="491" width="19" height="16" font="1">δT</text>
<text top="783" left="774" width="36" height="16" font="1">(3.5)</text>
<text top="823" left="121" width="293" height="16" font="1">where δT is the throttle setting and T</text>
<text top="830" left="414" width="25" height="11" font="3">max</text>
<text top="823" left="446" width="364" height="16" font="1">is the maximum engine thrust. A more compli-</text>
<text top="845" left="121" width="689" height="16" font="1">cated engine model can be used here without loss of generality (see, for example, Ducard</text>
<text top="866" left="121" width="84" height="16" font="1">et al. <a href="pdfxml.html#90">[11]).</a></text>
<text top="922" left="121" width="181" height="16" font="1">Equations of Motion</text>
<text top="964" left="121" width="689" height="16" font="1">Ignoring the eﬀects of Earth’s curvature (ﬂat-earth approximation <a href="pdfxml.html#90">[13]) </a>and using combined</text>
<text top="986" left="121" width="689" height="16" font="1">wind and body frames for forces, angles and angular rates <a href="pdfxml.html#92">[39], </a>the equations of motion</text>
<text top="1038" left="457" width="18" height="16" font="1">28</text>
</page>
<page number="38" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">for an aircraft can now be deﬁned. These equations were developed by Etkin <a href="pdfxml.html#90">[13] </a>and are</text>
<text top="213" left="122" width="621" height="16" font="1">reproduced here for reference. The model consists of nine states and four inputs.</text>
<text top="241" left="148" width="662" height="16" font="1">Kinematically important terms, airspeed, V , ﬂight path climb angle, γ, and ﬂight path</text>
<text top="262" left="122" width="516" height="16" font="1">heading, ψ, can be deﬁned in terms of forces and angular velocities</text>
<text top="296" left="359" width="5" height="16" font="1">˙</text>
<text top="300" left="354" width="52" height="16" font="1">V = −</text>
<text top="288" left="408" width="15" height="16" font="1">D</text>
<text top="313" left="408" width="15" height="16" font="1">m</text>
<text top="299" left="429" width="64" height="17" font="1">− g sin γ</text>
<text top="334" left="361" width="39" height="16" font="1">˙γ = q</text>
<text top="341" left="400" width="9" height="11" font="3">w</text>
<text top="334" left="413" width="67" height="16" font="1">cos φ − r</text>
<text top="341" left="480" width="9" height="11" font="3">w</text>
<text top="334" left="493" width="35" height="16" font="1">sin φ</text>
<text top="358" left="362" width="5" height="16" font="1">˙</text>
<text top="363" left="357" width="50" height="16" font="1">ψ = (q</text>
<text top="370" left="407" width="9" height="11" font="3">w</text>
<text top="363" left="420" width="64" height="16" font="1">sin φ + r</text>
<text top="370" left="485" width="9" height="11" font="3">w</text>
<text top="363" left="498" width="81" height="16" font="1">cos φ) sec γ</text>
<text top="327" left="774" width="36" height="16" font="1">(3.6)</text>
<text top="392" left="122" width="400" height="16" font="1">where the angles and angular velocities are in the F</text>
<text top="399" left="521" width="11" height="11" font="3">w</text>
<text top="392" left="539" width="48" height="16" font="1">frame.</text>
<text top="420" left="148" width="662" height="16" font="1">The angle of attack, α, the side-slip angle, β and wind-axes roll, φ are functions of</text>
<text top="442" left="122" width="221" height="16" font="1">angular velocities (in both F</text>
<text top="449" left="342" width="8" height="11" font="3">b</text>
<text top="442" left="357" width="47" height="16" font="1">and F</text>
<text top="449" left="404" width="11" height="11" font="3">w</text>
<text top="442" left="421" width="201" height="16" font="1">frames) and take the form</text>
<text top="472" left="297" width="5" height="16" font="1">˙</text>
<text top="472" left="293" width="73" height="16" font="1">α = q − q</text>
<text top="479" left="366" width="9" height="11" font="3">w</text>
<text top="472" left="380" width="261" height="16" font="1">sec β − p cos α tan β − r sin α tan β</text>
<text top="496" left="298" width="5" height="16" font="1">˙</text>
<text top="501" left="294" width="42" height="16" font="1">β = r</text>
<text top="508" left="336" width="9" height="11" font="3">w</text>
<text top="501" left="350" width="136" height="16" font="1">+ p sin α − r cos α</text>
<text top="525" left="298" width="5" height="16" font="1">˙</text>
<text top="530" left="294" width="43" height="16" font="1">φ = p</text>
<text top="537" left="337" width="9" height="11" font="3">w</text>
<text top="530" left="351" width="25" height="16" font="1">+ q</text>
<text top="537" left="377" width="9" height="11" font="3">w</text>
<text top="530" left="390" width="106" height="16" font="1">sin φ tan γ + r</text>
<text top="537" left="496" width="9" height="11" font="3">w</text>
<text top="530" left="509" width="83" height="16" font="1">cos φ tan γ.</text>
<text top="501" left="774" width="36" height="16" font="1">(3.7)</text>
<text top="559" left="122" width="393" height="16" font="1">The moment equations are best described in the F</text>
<text top="566" left="515" width="8" height="11" font="3">b</text>
<text top="559" left="530" width="280" height="16" font="1">frame to simplify the relationship to</text>
<text top="581" left="121" width="107" height="16" font="1">control inputs</text>
<text top="618" left="318" width="5" height="16" font="1">˙</text>
<text top="618" left="315" width="27" height="16" font="1">p =</text>
<text top="606" left="352" width="9" height="16" font="1">1</text>
<text top="631" left="349" width="8" height="16" font="1">I</text>
<text top="638" left="357" width="7" height="11" font="3">x</text>
<text top="618" left="366" width="49" height="16" font="1">(L + I</text>
<text top="625" left="415" width="14" height="11" font="3">zx</text>
<text top="618" left="429" width="97" height="16" font="1">( ˙r + pq) + (I</text>
<text top="625" left="526" width="6" height="11" font="3">y</text>
<text top="617" left="538" width="26" height="17" font="1">− I</text>
<text top="625" left="564" width="6" height="11" font="3">z</text>
<text top="618" left="571" width="30" height="16" font="1">)qr)</text>
<text top="663" left="318" width="5" height="16" font="1">˙</text>
<text top="663" left="315" width="27" height="16" font="1">q =</text>
<text top="651" left="352" width="9" height="16" font="1">1</text>
<text top="675" left="349" width="8" height="16" font="1">I</text>
<text top="682" left="357" width="6" height="11" font="3">y</text>
<text top="663" left="366" width="58" height="16" font="1">(M + I</text>
<text top="670" left="424" width="14" height="11" font="3">zx</text>
<text top="663" left="438" width="15" height="16" font="1">(r</text>
<text top="660" left="453" width="6" height="11" font="3">2</text>
<text top="662" left="464" width="27" height="17" font="1">− p</text>
<text top="660" left="491" width="6" height="11" font="3">2</text>
<text top="663" left="498" width="43" height="16" font="1">) + (I</text>
<text top="670" left="541" width="6" height="11" font="3">z</text>
<text top="662" left="552" width="26" height="17" font="1">− I</text>
<text top="670" left="578" width="7" height="11" font="3">x</text>
<text top="663" left="586" width="31" height="16" font="1">)rp)</text>
<text top="663" left="774" width="36" height="16" font="1">(3.8)</text>
<text top="710" left="318" width="24" height="16" font="1">˙r =</text>
<text top="698" left="352" width="9" height="16" font="1">1</text>
<text top="722" left="349" width="8" height="16" font="1">I</text>
<text top="729" left="357" width="6" height="11" font="3">z</text>
<text top="710" left="366" width="54" height="16" font="1">(N + I</text>
<text top="717" left="419" width="14" height="11" font="3">zx</text>
<text top="710" left="434" width="15" height="16" font="1">( ˙</text>
<text top="710" left="440" width="91" height="16" font="1">p − qr) + (I</text>
<text top="717" left="531" width="7" height="11" font="3">x</text>
<text top="709" left="543" width="26" height="17" font="1">− I</text>
<text top="717" left="568" width="6" height="11" font="3">y</text>
<text top="710" left="576" width="31" height="16" font="1">)pq)</text>
<text top="748" left="122" width="210" height="16" font="1">where inertia, I, is given by</text>
<text top="798" left="368" width="28" height="16" font="1">I =</text>
<text top="774" left="401" width="12" height="8" font="1"></text>
<text top="806" left="401" width="12" height="8" font="1"></text>
<text top="777" left="427" width="8" height="16" font="1">I</text>
<text top="784" left="435" width="14" height="11" font="3">xx</text>
<text top="777" left="478" width="9" height="16" font="1">0</text>
<text top="776" left="508" width="22" height="17" font="1">−I</text>
<text top="784" left="530" width="14" height="11" font="3">zx</text>
<text top="798" left="434" width="9" height="16" font="1">0</text>
<text top="798" left="471" width="8" height="16" font="1">I</text>
<text top="805" left="479" width="13" height="11" font="3">yy</text>
<text top="798" left="522" width="9" height="16" font="1">0</text>
<text top="819" left="420" width="22" height="17" font="1">−I</text>
<text top="827" left="442" width="14" height="11" font="3">zx</text>
<text top="820" left="478" width="9" height="16" font="1">0</text>
<text top="820" left="515" width="8" height="16" font="1">I</text>
<text top="827" left="523" width="12" height="11" font="3">zz</text>
<text top="774" left="552" width="12" height="8" font="1"></text>
<text top="806" left="552" width="12" height="8" font="1"></text>
<text top="798" left="774" width="36" height="16" font="1">(3.9)</text>
<text top="850" left="122" width="408" height="16" font="1">In Equations <a href="pdfxml.html#38">(3.6) </a>to <a href="pdfxml.html#38">(3.8), </a>angular velocities in the F</text>
<text top="857" left="529" width="11" height="11" font="3">w</text>
<text top="850" left="546" width="64" height="16" font="1">frame (p</text>
<text top="857" left="610" width="9" height="11" font="3">w</text>
<text top="850" left="620" width="16" height="16" font="1">, q</text>
<text top="857" left="635" width="9" height="11" font="3">w</text>
<text top="850" left="646" width="16" height="16" font="1">, r</text>
<text top="857" left="661" width="9" height="11" font="3">w</text>
<text top="850" left="672" width="138" height="16" font="1">) can be expressed</text>
<text top="872" left="122" width="445" height="16" font="1">as functions of the system states (V, γ, ψ, α, β, φ, p, q, r) as</text>
<text top="902" left="287" width="9" height="16" font="1">p</text>
<text top="909" left="296" width="9" height="11" font="3">w</text>
<text top="902" left="311" width="176" height="16" font="1">= p cos α cos β + (q − ˙</text>
<text top="902" left="479" width="165" height="16" font="1">α) sin β + r sin α cos β</text>
<text top="938" left="288" width="8" height="16" font="1">q</text>
<text top="945" left="296" width="9" height="11" font="3">w</text>
<text top="938" left="311" width="14" height="16" font="1">=</text>
<text top="926" left="342" width="9" height="16" font="1">1</text>
<text top="951" left="332" width="26" height="16" font="1">mV</text>
<text top="938" left="363" width="151" height="16" font="1">(L − mg cos γ cos φ)</text>
<text top="938" left="765" width="45" height="16" font="1">(3.10)</text>
<text top="980" left="288" width="8" height="16" font="1">r</text>
<text top="987" left="296" width="9" height="11" font="3">w</text>
<text top="980" left="311" width="33" height="16" font="1">= −</text>
<text top="968" left="356" width="9" height="16" font="1">1</text>
<text top="993" left="346" width="26" height="16" font="1">mV</text>
<text top="980" left="377" width="149" height="16" font="1">(S − mg cos γ sin φ)</text>
<text top="1038" left="457" width="18" height="16" font="1">29</text>
</page>
<page number="39" position="absolute" top="0" left="0" height="1188" width="918">
<text top="494" left="309" width="103" height="16" font="1">Figure 3.3: C</text>
<text top="501" left="412" width="11" height="11" font="3">l0</text>
<text top="494" left="429" width="28" height="16" font="1">= k</text>
<text top="501" left="457" width="6" height="11" font="3">1</text>
<text top="494" left="464" width="42" height="16" font="1">α + k</text>
<text top="501" left="506" width="6" height="11" font="3">2</text>
<text top="494" left="513" width="42" height="16" font="1">β + k</text>
<text top="501" left="555" width="6" height="11" font="3">3</text>
<text top="494" left="562" width="53" height="16" font="1">αβ + k</text>
<text top="501" left="615" width="6" height="11" font="3">4</text>
<text top="560" left="122" width="688" height="16" font="1">In summary, Equations <a href="pdfxml.html#38">(3.6) </a>to <a href="pdfxml.html#38">(3.8) </a>deﬁne the 9 states of the aircraft, driven by the</text>
<text top="582" left="122" width="688" height="16" font="1">control inputs, δT , δE, δA and δR through the moment and force deﬁnitions of Equations</text>
<text top="604" left="122" width="104" height="16" font="1"><a href="pdfxml.html#36">(3.1) </a>to <a href="pdfxml.html#37">(3.5).</a></text>
<text top="632" left="148" width="662" height="16" font="1">The non-dimensional coeﬃcients deﬁned above can be expanded into a series of un-</text>
<text top="654" left="122" width="689" height="16" font="1">known parameters. Starting with the moment equations, relationships of the following</text>
<text top="676" left="122" width="191" height="16" font="1">form can be derived <a href="pdfxml.html#92">[39],</a></text>
<text top="708" left="354" width="13" height="16" font="1">C</text>
<text top="714" left="367" width="4" height="11" font="3">l</text>
<text top="708" left="376" width="31" height="16" font="1">= C</text>
<text top="714" left="408" width="11" height="11" font="3">l0</text>
<text top="708" left="423" width="30" height="16" font="1">+ C</text>
<text top="714" left="453" width="20" height="11" font="3">lδR</text>
<text top="708" left="475" width="56" height="16" font="1">δR + C</text>
<text top="714" left="531" width="20" height="11" font="3">lδA</text>
<text top="708" left="552" width="22" height="16" font="1">δA</text>
<text top="734" left="347" width="13" height="16" font="1">C</text>
<text top="741" left="359" width="11" height="11" font="3">m</text>
<text top="734" left="376" width="31" height="16" font="1">= C</text>
<text top="741" left="408" width="18" height="11" font="3">m0</text>
<text top="734" left="431" width="30" height="16" font="1">+ C</text>
<text top="741" left="461" width="27" height="11" font="3">mδE</text>
<text top="734" left="490" width="21" height="16" font="1">δE</text>
<text top="734" left="765" width="45" height="16" font="1">(3.11)</text>
<text top="760" left="350" width="13" height="16" font="1">C</text>
<text top="767" left="363" width="8" height="11" font="3">n</text>
<text top="760" left="376" width="31" height="16" font="1">= C</text>
<text top="767" left="408" width="15" height="11" font="3">n0</text>
<text top="760" left="427" width="30" height="16" font="1">+ C</text>
<text top="767" left="457" width="24" height="11" font="3">nδA</text>
<text top="760" left="482" width="56" height="16" font="1">δA + C</text>
<text top="767" left="538" width="24" height="11" font="3">nδR</text>
<text top="760" left="563" width="22" height="16" font="1">δR</text>
<text top="792" left="122" width="102" height="16" font="1">where each C</text>
<text top="799" left="224" width="10" height="11" font="3">ij</text>
<text top="792" left="235" width="514" height="16" font="1">, with i = l, m, n and j = δE, δA, δR, represents the derivative of C</text>
<text top="799" left="750" width="4" height="11" font="3">i</text>
<text top="792" left="760" width="49" height="16" font="1">w.r.t j</text>
<text top="814" left="122" width="689" height="16" font="1">(also known as control derivatives). Each of these can be approximated as general functions</text>
<text top="835" left="122" width="166" height="16" font="1">of α and β as follows,</text>
<text top="867" left="355" width="13" height="16" font="1">C</text>
<text top="874" left="367" width="10" height="11" font="3">ij</text>
<text top="867" left="384" width="28" height="16" font="1">= k</text>
<text top="874" left="412" width="6" height="11" font="3">1</text>
<text top="867" left="419" width="42" height="16" font="1">α + k</text>
<text top="874" left="461" width="6" height="11" font="3">2</text>
<text top="867" left="468" width="42" height="16" font="1">β + k</text>
<text top="874" left="510" width="6" height="11" font="3">3</text>
<text top="867" left="517" width="53" height="16" font="1">αβ + k</text>
<text top="874" left="570" width="6" height="11" font="3">4</text>
<text top="867" left="765" width="45" height="16" font="1">(3.12)</text>
<text top="899" left="122" width="60" height="16" font="1">where k</text>
<text top="906" left="182" width="6" height="11" font="3">1</text>
<text top="899" left="192" width="33" height="16" font="1">. . . k</text>
<text top="906" left="225" width="6" height="11" font="3">4</text>
<text top="898" left="237" width="313" height="20" font="1">∈ R. As an example, the ﬁrst term of C</text>
<text top="906" left="550" width="4" height="11" font="3">l</text>
<text top="899" left="555" width="24" height="16" font="1">, C</text>
<text top="906" left="579" width="11" height="11" font="3">l0</text>
<text top="899" left="591" width="219" height="16" font="1">, for a BAC-221 can be seen</text>
<text top="921" left="122" width="117" height="16" font="1">in Figure <a href="pdfxml.html#39">(3.3).</a></text>
<text top="949" left="148" width="662" height="16" font="1">Following a similar approach, appropriate relations for the force coeﬃcients can be</text>
<text top="971" left="122" width="688" height="16" font="1">formed. The resulting expressions are presented in the 1988 paper by Lane and Stengel <a href="pdfxml.html#92">[39]</a></text>
<text top="993" left="122" width="356" height="16" font="1">and take the following form, with k = L, D, S,</text>
<text top="1038" left="457" width="18" height="16" font="1">30</text>
</page>
<page number="40" position="absolute" top="0" left="0" height="1188" width="918">
	<fontspec id="7" size="19" family="Times" color="#000000"/>
<text top="218" left="300" width="13" height="16" font="1">C</text>
<text top="225" left="313" width="7" height="11" font="3">k</text>
<text top="218" left="326" width="26" height="16" font="1">=C</text>
<text top="225" left="352" width="13" height="11" font="3">k1</text>
<text top="218" left="370" width="30" height="16" font="1">+ C</text>
<text top="225" left="400" width="13" height="11" font="3">k2</text>
<text top="218" left="414" width="45" height="16" font="1">α + C</text>
<text top="225" left="460" width="13" height="11" font="3">k3</text>
<text top="218" left="474" width="45" height="16" font="1">β + C</text>
<text top="225" left="519" width="13" height="11" font="3">k4</text>
<text top="218" left="533" width="10" height="16" font="1">β</text>
<text top="215" left="544" width="6" height="11" font="3">3</text>
<text top="218" left="555" width="30" height="16" font="1">+ C</text>
<text top="225" left="585" width="13" height="11" font="3">k4</text>
<text top="218" left="599" width="11" height="16" font="1">α</text>
<text top="215" left="610" width="6" height="11" font="3">3</text>
<text top="218" left="617" width="14" height="16" font="1">+</text>
<text top="245" left="374" width="13" height="16" font="1">C</text>
<text top="251" left="387" width="13" height="11" font="3">k5</text>
<text top="245" left="401" width="21" height="16" font="1">αβ</text>
<text top="241" left="423" width="6" height="11" font="3">3</text>
<text top="245" left="434" width="30" height="16" font="1">+ C</text>
<text top="251" left="465" width="13" height="11" font="3">k6</text>
<text top="245" left="479" width="11" height="16" font="1">α</text>
<text top="241" left="490" width="6" height="11" font="3">3</text>
<text top="245" left="497" width="45" height="16" font="1">β + C</text>
<text top="251" left="542" width="13" height="11" font="3">k7</text>
<text top="245" left="556" width="21" height="16" font="1">αβ</text>
<text top="232" left="765" width="45" height="16" font="1">(3.13)</text>
<text top="276" left="122" width="62" height="16" font="1">where C</text>
<text top="283" left="183" width="13" height="11" font="3">k1</text>
<text top="276" left="200" width="36" height="16" font="1">. . . C</text>
<text top="283" left="237" width="13" height="11" font="3">k7</text>
<text top="276" left="255" width="555" height="16" font="1">form the main force parameters. The parameters for moments are deﬁned</text>
<text top="297" left="122" width="688" height="16" font="1">above and with mass, m, and Inertia components in matrix, I, complete the parameters</text>
<text top="319" left="122" width="689" height="16" font="1">required to characterize the aircraft for nonlinear control applications. For linear con-</text>
<text top="341" left="122" width="688" height="16" font="1">trol systems designed around particular operating points, one or more of these general</text>
<text top="362" left="122" width="232" height="16" font="1">parameters can be set to zero.</text>
<text top="423" left="122" width="37" height="23" font="2">3.3</text>
<text top="423" left="188" width="674" height="23" font="2">System Identiﬁcation Using the Output Error Method</text>
<text top="474" left="122" width="689" height="16" font="1">The Output Error Method is one of the most widely used system identiﬁcation methods.</text>
<text top="496" left="122" width="688" height="16" font="1">The Dryden Flight Research Center has been using this method on experimental and new</text>
<text top="518" left="122" width="688" height="16" font="1">aircraft since the 1960’s <a href="pdfxml.html#91">[26]. </a>Although initially only used to estimate small linear models,</text>
<text top="539" left="122" width="689" height="16" font="1">the method can now be used for nonlinear models owing much of its success to increased</text>
<text top="561" left="122" width="137" height="16" font="1">computing power.</text>
<text top="617" left="122" width="50" height="19" font="7">3.3.1</text>
<text top="617" left="195" width="145" height="19" font="7">System Setup</text>
<text top="659" left="122" width="688" height="16" font="1">Figure <a href="pdfxml.html#41">(3.4) </a>shows the main idea behind the Output Error Method. A general nonlinear</text>
<text top="681" left="122" width="552" height="16" font="1">system with a time invariant vector of parameters, Θ, can be deﬁned as</text>
<text top="713" left="389" width="164" height="16" font="1">˙x(t) = f (x(t), u(t), Θ)</text>
<text top="739" left="386" width="165" height="16" font="1">y(t) = g(x(t), u(t), Θ)</text>
<text top="739" left="765" width="45" height="16" font="1">(3.14)</text>
<text top="766" left="379" width="22" height="16" font="1">z(t</text>
<text top="772" left="401" width="7" height="11" font="3">k</text>
<text top="766" left="409" width="53" height="16" font="1">) = y(t</text>
<text top="772" left="461" width="7" height="11" font="3">k</text>
<text top="766" left="469" width="51" height="16" font="1">) + v(t</text>
<text top="772" left="520" width="7" height="11" font="3">k</text>
<text top="766" left="528" width="7" height="16" font="1">)</text>
<text top="798" left="122" width="100" height="19" font="1">where x ∈ R</text>
<text top="796" left="221" width="8" height="11" font="3">n</text>
<text top="798" left="236" width="512" height="19" font="1">is the state (n = 9 in this case: V , γ, ψ, α, β, φ, p, q, r), u ∈ R</text>
<text top="796" left="748" width="11" height="11" font="3">m</text>
<text top="798" left="767" width="43" height="16" font="1">is the</text>
<text top="820" left="122" width="400" height="19" font="1">input (m = 4 in this case: δT , δE, δA, δR), y ∈ R</text>
<text top="817" left="522" width="8" height="11" font="3">n</text>
<text top="821" left="530" width="6" height="8" font="6">y</text>
<text top="820" left="544" width="125" height="16" font="1">is the output (n</text>
<text top="826" left="669" width="6" height="11" font="3">y</text>
<text top="820" left="682" width="128" height="16" font="1">= 9 in this case:</text>
<text top="841" left="122" width="316" height="19" font="1">same as the number of states) and z ∈ R</text>
<text top="839" left="438" width="8" height="11" font="3">n</text>
<text top="842" left="446" width="6" height="8" font="6">y</text>
<text top="841" left="459" width="255" height="16" font="1">is the measured response (also, n</text>
<text top="848" left="714" width="6" height="11" font="3">y</text>
<text top="841" left="727" width="83" height="16" font="1">= 9 in this</text>
<text top="863" left="122" width="689" height="16" font="1">case: measuring all the states with independent sensors). v is then the measurement error</text>
<text top="885" left="122" width="657" height="16" font="1">which is assumed to be distributed with zero mean and covariance matrix R given by</text>
<text top="917" left="377" width="85" height="16" font="1">R = E([v(t</text>
<text top="924" left="462" width="7" height="11" font="3">k</text>
<text top="917" left="470" width="44" height="16" font="1">)].[v(t</text>
<text top="924" left="514" width="7" height="11" font="3">k</text>
<text top="917" left="521" width="12" height="16" font="1">)]</text>
<text top="914" left="533" width="7" height="11" font="3">T</text>
<text top="917" left="543" width="12" height="16" font="1">).</text>
<text top="917" left="765" width="45" height="16" font="1">(3.15)</text>
<text top="949" left="122" width="689" height="16" font="1">where E() is the expected value or mean. Furthermore, u is assumed to be generated by</text>
<text top="971" left="122" width="688" height="16" font="1">an exogenous system that is not aﬀected by the system output and suﬃciently excites a</text>
<text top="993" left="122" width="348" height="16" font="1">broad spectrum of frequencies on the system.</text>
<text top="1038" left="457" width="18" height="16" font="1">31</text>
</page>
<page number="41" position="absolute" top="0" left="0" height="1188" width="918">
<text top="435" left="122" width="688" height="16" font="1">Figure 3.4: An adaptive system identiﬁcation method that changes the model based on</text>
<text top="457" left="122" width="163" height="16" font="1">the output error <a href="pdfxml.html#91">[32].</a></text>
<text top="523" left="122" width="50" height="19" font="7">3.3.2</text>
<text top="523" left="195" width="288" height="19" font="7">Deﬁning the Cost Function</text>
<text top="565" left="122" width="357" height="16" font="1">The likelihood function of z can be deﬁned as,</text>
<text top="615" left="361" width="95" height="16" font="1">P (z|Θ, R) =</text>
<text top="596" left="467" width="10" height="11" font="3">N</text>
<text top="640" left="461" width="23" height="11" font="3">k=1</text>
<text top="615" left="487" width="29" height="16" font="1">P (z</text>
<text top="622" left="516" width="7" height="11" font="3">k</text>
<text top="614" left="524" width="47" height="17" font="1">|Θ, R)</text>
<text top="615" left="765" width="45" height="16" font="1">(3.16)</text>
<text top="665" left="122" width="60" height="16" font="1">where z</text>
<text top="671" left="181" width="7" height="11" font="3">k</text>
<text top="665" left="196" width="186" height="16" font="1">is the measurement at t</text>
<text top="671" left="381" width="7" height="11" font="3">k</text>
<text top="665" left="396" width="414" height="16" font="1">and P (z|Θ, R) is the probability of z given Θ and R.</text>
<text top="686" left="122" width="688" height="16" font="1">Maximizing this function with respect to Θ would result in parameter estimates within an</text>
<text top="708" left="122" width="688" height="16" font="1">acceptable range of their true values. It is important to note that this likelihood function</text>
<text top="730" left="122" width="688" height="16" font="1">represents the probability density of the observed variables and not of the parameters. The</text>
<text top="751" left="122" width="392" height="16" font="1">maximum likelihood estimate of the parameters, Θ</text>
<text top="758" left="513" width="22" height="11" font="3">M L</text>
<text top="751" left="536" width="217" height="16" font="1">, can therefore be deﬁned as</text>
<text top="785" left="366" width="14" height="16" font="1">Θ</text>
<text top="792" left="380" width="22" height="11" font="3">M L</text>
<text top="785" left="407" width="79" height="16" font="1">= arg max</text>
<text top="804" left="451" width="10" height="11" font="3">Θ</text>
<text top="785" left="489" width="76" height="16" font="1">P (z|Θ, R)</text>
<text top="785" left="765" width="45" height="16" font="1">(3.17)</text>
<text top="827" left="127" width="298" height="16" font="1">or equivalently, in its standard form as</text>
<text top="861" left="349" width="14" height="16" font="1">Θ</text>
<text top="867" left="363" width="22" height="11" font="3">M L</text>
<text top="861" left="391" width="76" height="16" font="1">= arg min</text>
<text top="879" left="433" width="10" height="11" font="3">Θ</text>
<text top="861" left="469" width="113" height="16" font="1">(ln P (z|Θ, R)).</text>
<text top="861" left="765" width="45" height="16" font="1">(3.18)</text>
<text top="903" left="121" width="688" height="16" font="1">Solving this equation yields parameter estimates that are asymptotically unbiased and</text>
<text top="925" left="121" width="689" height="16" font="1">normally distributed around their true value (see Wald, A. <a href="pdfxml.html#94">[59]). </a>This can be expressed</text>
<text top="946" left="121" width="19" height="16" font="1">by</text>
<text top="980" left="401" width="24" height="16" font="1">lim</text>
<text top="995" left="395" width="37" height="11" font="3">N →∞</text>
<text top="980" left="435" width="35" height="16" font="1">E(Θ</text>
<text top="987" left="469" width="22" height="11" font="3">M L</text>
<text top="980" left="492" width="44" height="16" font="1">) = Θ</text>
<text top="980" left="765" width="45" height="16" font="1">(3.19)</text>
<text top="1038" left="457" width="18" height="16" font="1">32</text>
</page>
<page number="42" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="375" height="16" font="1">where N is the total number of measurements (z</text>
<text top="198" left="497" width="6" height="11" font="3">1</text>
<text top="191" left="504" width="16" height="16" font="1">, z</text>
<text top="198" left="520" width="6" height="11" font="3">2</text>
<text top="191" left="527" width="39" height="16" font="1">, ..., z</text>
<text top="198" left="565" width="10" height="11" font="3">N</text>
<text top="191" left="577" width="12" height="16" font="1">).</text>
<text top="221" left="148" width="353" height="16" font="1">Given the above system, it can be shown that</text>
<text top="273" left="284" width="113" height="16" font="1">ln P (z|Θ, R) =</text>
<text top="260" left="403" width="9" height="16" font="1">1</text>
<text top="285" left="403" width="9" height="16" font="1">2</text>
<text top="254" left="424" width="10" height="11" font="3">N</text>
<text top="298" left="418" width="23" height="11" font="3">k=1</text>
<text top="273" left="443" width="27" height="16" font="1">[v(t</text>
<text top="279" left="470" width="7" height="11" font="3">k</text>
<text top="273" left="478" width="12" height="16" font="1">)]</text>
<text top="269" left="489" width="7" height="11" font="3">T</text>
<text top="273" left="499" width="13" height="16" font="1">R</text>
<text top="269" left="513" width="16" height="11" font="3">−1</text>
<text top="273" left="530" width="27" height="16" font="1">[v(t</text>
<text top="279" left="557" width="7" height="11" font="3">k</text>
<text top="273" left="565" width="12" height="16" font="1">)]</text>
<text top="326" left="417" width="14" height="16" font="1">+</text>
<text top="314" left="436" width="14" height="16" font="1">N</text>
<text top="338" left="440" width="9" height="16" font="1">2</text>
<text top="326" left="457" width="94" height="16" font="1">ln[det(R)] +</text>
<text top="314" left="556" width="26" height="16" font="1">N n</text>
<text top="321" left="583" width="6" height="11" font="3">y</text>
<text top="338" left="569" width="9" height="16" font="1">2</text>
<text top="326" left="595" width="53" height="16" font="1">ln(2π).</text>
<text top="294" left="765" width="45" height="16" font="1">(3.20)</text>
<text top="367" left="122" width="320" height="16" font="1">A cost function, J , can now be deﬁned as</text>
<text top="403" left="377" width="178" height="16" font="1">J (Θ, R) = ln P (z|Θ, R)</text>
<text top="403" left="765" width="45" height="16" font="1">(3.21)</text>
<text top="439" left="122" width="670" height="16" font="1">whose minimization can be performed using any of the common optimization methods.</text>
<text top="496" left="122" width="50" height="19" font="7">3.3.3</text>
<text top="496" left="195" width="240" height="19" font="7">Optimization Methods</text>
<text top="540" left="122" width="299" height="16" font="1">J is minimized with respect to Θ when</text>
<text top="537" left="429" width="14" height="11" font="3">∂J</text>
<text top="550" left="428" width="17" height="11" font="3">∂Θ</text>
<text top="540" left="453" width="357" height="16" font="1">is equal to zero. Using a Taylor series approxi-</text>
<text top="561" left="121" width="264" height="16" font="1">mation, this can be represented as</text>
<text top="595" left="343" width="20" height="16" font="1">∂J</text>
<text top="620" left="342" width="24" height="16" font="1">∂Θ</text>
<text top="629" left="381" width="21" height="11" font="3">i+1</text>
<text top="606" left="407" width="14" height="17" font="1">≈</text>
<text top="595" left="442" width="20" height="16" font="1">∂J</text>
<text top="620" left="441" width="24" height="16" font="1">∂Θ</text>
<text top="629" left="480" width="4" height="11" font="3">i</text>
<text top="607" left="489" width="14" height="16" font="1">+</text>
<text top="595" left="523" width="9" height="16" font="1">∂</text>
<text top="593" left="533" width="6" height="11" font="3">2</text>
<text top="595" left="540" width="10" height="16" font="1">J</text>
<text top="620" left="522" width="24" height="16" font="1">∂Θ</text>
<text top="619" left="546" width="6" height="11" font="3">2</text>
<text top="629" left="568" width="4" height="11" font="3">i</text>
<text top="607" left="576" width="28" height="16" font="1">∆Θ</text>
<text top="607" left="765" width="45" height="16" font="1">(3.22)</text>
<text top="662" left="374" width="47" height="16" font="1">∆Θ ≈</text>
<text top="650" left="452" width="9" height="16" font="1">∂</text>
<text top="647" left="462" width="6" height="11" font="3">2</text>
<text top="650" left="469" width="10" height="16" font="1">J</text>
<text top="674" left="451" width="24" height="16" font="1">∂Θ</text>
<text top="673" left="475" width="6" height="11" font="3">2</text>
<text top="684" left="497" width="4" height="11" font="3">i</text>
<text top="644" left="511" width="16" height="11" font="3">−1</text>
<text top="650" left="547" width="20" height="16" font="1">∂J</text>
<text top="674" left="546" width="24" height="16" font="1">∂Θ</text>
<text top="684" left="585" width="4" height="11" font="3">i</text>
<text top="662" left="765" width="45" height="16" font="1">(3.23)</text>
<text top="709" left="122" width="689" height="16" font="1">Applying this to Equation <a href="pdfxml.html#42">(3.20) </a>and deriving further results in (see Jategaonkar, R. <a href="pdfxml.html#91">[32]),</a></text>
<text top="750" left="244" width="20" height="16" font="1">∂J</text>
<text top="774" left="243" width="24" height="16" font="1">∂Θ</text>
<text top="762" left="274" width="33" height="16" font="1">= −</text>
<text top="744" left="317" width="10" height="11" font="3">N</text>
<text top="787" left="311" width="23" height="11" font="3">k=1</text>
<text top="750" left="349" width="33" height="16" font="1">∂y(t</text>
<text top="757" left="382" width="7" height="11" font="3">k</text>
<text top="750" left="390" width="7" height="16" font="1">)</text>
<text top="774" left="361" width="24" height="16" font="1">∂Θ</text>
<text top="745" left="408" width="7" height="11" font="3">T</text>
<text top="762" left="421" width="13" height="16" font="1">R</text>
<text top="758" left="434" width="16" height="11" font="3">−1</text>
<text top="762" left="451" width="22" height="16" font="1">v(t</text>
<text top="769" left="474" width="7" height="11" font="3">k</text>
<text top="762" left="481" width="7" height="16" font="1">)</text>
<text top="762" left="765" width="45" height="16" font="1">(3.24)</text>
<text top="811" left="237" width="9" height="16" font="1">∂</text>
<text top="809" left="247" width="6" height="11" font="3">2</text>
<text top="811" left="254" width="10" height="16" font="1">J</text>
<text top="835" left="236" width="24" height="16" font="1">∂Θ</text>
<text top="834" left="260" width="6" height="11" font="3">2</text>
<text top="823" left="274" width="14" height="16" font="1">=</text>
<text top="805" left="300" width="10" height="11" font="3">N</text>
<text top="848" left="294" width="23" height="11" font="3">k=1</text>
<text top="811" left="333" width="33" height="16" font="1">∂y(t</text>
<text top="818" left="365" width="7" height="11" font="3">k</text>
<text top="811" left="373" width="7" height="16" font="1">)</text>
<text top="835" left="344" width="24" height="16" font="1">∂Θ</text>
<text top="806" left="391" width="7" height="11" font="3">T</text>
<text top="823" left="404" width="13" height="16" font="1">R</text>
<text top="819" left="417" width="16" height="11" font="3">−1</text>
<text top="811" left="436" width="33" height="16" font="1">∂y(t</text>
<text top="818" left="469" width="7" height="11" font="3">k</text>
<text top="811" left="476" width="7" height="16" font="1">)</text>
<text top="835" left="448" width="24" height="16" font="1">∂Θ</text>
<text top="823" left="489" width="14" height="16" font="1">+</text>
<text top="805" left="514" width="10" height="11" font="3">N</text>
<text top="848" left="508" width="23" height="11" font="3">k=1</text>
<text top="811" left="547" width="9" height="16" font="1">∂</text>
<text top="809" left="557" width="6" height="11" font="3">2</text>
<text top="811" left="564" width="22" height="16" font="1">y(t</text>
<text top="818" left="586" width="7" height="11" font="3">k</text>
<text top="811" left="594" width="7" height="16" font="1">)</text>
<text top="835" left="558" width="24" height="16" font="1">∂Θ</text>
<text top="834" left="582" width="6" height="11" font="3">2</text>
<text top="806" left="612" width="7" height="11" font="3">T</text>
<text top="823" left="625" width="13" height="16" font="1">R</text>
<text top="819" left="639" width="16" height="11" font="3">−1</text>
<text top="823" left="656" width="22" height="16" font="1">v(t</text>
<text top="830" left="678" width="7" height="11" font="3">k</text>
<text top="823" left="686" width="12" height="16" font="1">).</text>
<text top="823" left="765" width="45" height="16" font="1">(3.25)</text>
<text top="875" left="122" width="688" height="16" font="1">Referring back to the initial assumption that the measurement noise is Gaussian with zero</text>
<text top="896" left="122" width="689" height="16" font="1">mean, the second term in Equation <a href="pdfxml.html#42">(3.25) </a>will disappear as N becomes large. The second</text>
<text top="918" left="122" width="300" height="16" font="1">derivative can now be approximated as</text>
<text top="958" left="343" width="9" height="16" font="1">∂</text>
<text top="955" left="353" width="6" height="11" font="3">2</text>
<text top="958" left="360" width="10" height="16" font="1">J</text>
<text top="982" left="342" width="24" height="16" font="1">∂Θ</text>
<text top="981" left="366" width="6" height="11" font="3">2</text>
<text top="969" left="380" width="14" height="17" font="1">≈</text>
<text top="952" left="406" width="10" height="11" font="3">N</text>
<text top="995" left="400" width="23" height="11" font="3">k=1</text>
<text top="958" left="439" width="33" height="16" font="1">∂y(t</text>
<text top="965" left="471" width="7" height="11" font="3">k</text>
<text top="958" left="479" width="7" height="16" font="1">)</text>
<text top="982" left="450" width="24" height="16" font="1">∂Θ</text>
<text top="953" left="497" width="7" height="11" font="3">T</text>
<text top="970" left="510" width="13" height="16" font="1">R</text>
<text top="966" left="524" width="16" height="11" font="3">−1</text>
<text top="958" left="542" width="33" height="16" font="1">∂y(t</text>
<text top="965" left="575" width="7" height="11" font="3">k</text>
<text top="958" left="583" width="7" height="16" font="1">)</text>
<text top="982" left="554" width="24" height="16" font="1">∂Θ</text>
<text top="970" left="765" width="45" height="16" font="1">(3.26)</text>
<text top="1038" left="457" width="18" height="16" font="1">33</text>
</page>
<page number="43" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">and forms the basis for the modiﬁed Newton-Raphson method, also known as the Gauss-</text>
<text top="213" left="122" width="689" height="16" font="1">Newton method. Once the ∆Θ is found it can be used to improve the parameter vector</text>
<text top="234" left="122" width="576" height="16" font="1">for the next iteration. The R matrix is also recalculated at every iteration.</text>
<text top="263" left="148" width="662" height="16" font="1">To gain further insight into the cost function, notice that the noise covariance in Equa-</text>
<text top="285" left="122" width="235" height="16" font="1">tion <a href="pdfxml.html#40">(3.15) </a>can be rewritten as</text>
<text top="335" left="371" width="32" height="16" font="1">R =</text>
<text top="323" left="414" width="9" height="16" font="1">1</text>
<text top="348" left="410" width="14" height="16" font="1">N</text>
<text top="317" left="438" width="10" height="11" font="3">N</text>
<text top="361" left="432" width="23" height="11" font="3">k=1</text>
<text top="335" left="457" width="27" height="16" font="1">[v(t</text>
<text top="342" left="484" width="7" height="11" font="3">k</text>
<text top="335" left="492" width="39" height="16" font="1">)][v(t</text>
<text top="342" left="531" width="7" height="11" font="3">k</text>
<text top="335" left="538" width="12" height="16" font="1">)]</text>
<text top="332" left="550" width="7" height="11" font="3">T</text>
<text top="335" left="765" width="45" height="16" font="1">(3.27)</text>
<text top="385" left="122" width="340" height="16" font="1">and substituted into Equation <a href="pdfxml.html#42">(3.20) </a>to give</text>
<text top="428" left="298" width="57" height="16" font="1">J (Θ) =</text>
<text top="416" left="363" width="9" height="16" font="1">1</text>
<text top="440" left="363" width="9" height="16" font="1">2</text>
<text top="428" left="373" width="10" height="16" font="1">n</text>
<text top="435" left="384" width="6" height="11" font="3">y</text>
<text top="428" left="391" width="34" height="16" font="1">N +</text>
<text top="416" left="430" width="14" height="16" font="1">N</text>
<text top="440" left="434" width="9" height="16" font="1">2</text>
<text top="428" left="448" width="94" height="16" font="1">ln[det(R)] +</text>
<text top="416" left="548" width="26" height="16" font="1">N n</text>
<text top="422" left="575" width="6" height="11" font="3">y</text>
<text top="440" left="561" width="9" height="16" font="1">2</text>
<text top="428" left="584" width="49" height="16" font="1">ln(2π)</text>
<text top="428" left="765" width="45" height="16" font="1">(3.28)</text>
<text top="466" left="122" width="689" height="16" font="1">where the ﬁrst and third term on the right are constants and the cost function becomes</text>
<text top="488" left="122" width="689" height="16" font="1">a function of the determinant of the covariance. This method is also sometimes known</text>
<text top="509" left="122" width="688" height="16" font="1">as the Gauss-Newton method with determinant minimization and can be set up using the</text>
<text top="531" left="122" width="219" height="16" font="1">built-in functions in Matlab.</text>
<text top="560" left="148" width="662" height="16" font="1">Other optimization methods can also be used within the Output Error Method. The</text>
<text top="582" left="122" width="689" height="16" font="1">choice would depend on the size of the model being estimated and on how much apriori</text>
<text top="603" left="122" width="689" height="16" font="1">information is available. For example, the Gauss-Newton method described above performs</text>
<text top="625" left="122" width="689" height="16" font="1">poorly and may never converge if a reasonable starting point is not given. The method</text>
<text top="647" left="122" width="689" height="16" font="1">can be improved by adding Lagrange multipliers and slack variables to limit the value of</text>
<text top="668" left="122" width="688" height="16" font="1">the parameters to a predeﬁned range. This is known as the Constrained Gauss Newton</text>
<text top="690" left="122" width="64" height="16" font="1">Method.</text>
<text top="746" left="122" width="50" height="19" font="7">3.3.4</text>
<text top="746" left="195" width="174" height="19" font="7">Algorithm Steps</text>
<text top="789" left="122" width="689" height="16" font="1">Once the model and cost function are set up as above and an optimization method is</text>
<text top="811" left="122" width="685" height="16" font="1">chosen, the following steps can be implemented to converge to suitable parameter values:</text>
<text top="850" left="143" width="279" height="16" font="1">1. Input initial guesses on Θ and R.</text>
<text top="884" left="143" width="545" height="16" font="1">2. Calculate predicted output, y, and ﬁnd measurement errors (z − y).</text>
<text top="919" left="143" width="119" height="16" font="1">3. Calculate R.</text>
<text top="954" left="143" width="374" height="16" font="1">4. Minimize the cost function with respect to Θ.</text>
<text top="989" left="143" width="356" height="16" font="1">5. Go back to 2 and iterate until Θ converges.</text>
<text top="1038" left="457" width="18" height="16" font="1">34</text>
</page>
<page number="44" position="absolute" top="0" left="0" height="1188" width="918">
<text top="459" left="237" width="458" height="16" font="1">Figure 3.5: Frequency Spectrum of Various Maneuvers <a href="pdfxml.html#91">[32].</a></text>
<text top="528" left="121" width="50" height="19" font="7">3.3.5</text>
<text top="528" left="195" width="186" height="19" font="7">Flight Maneuvers</text>
<text top="573" left="121" width="688" height="16" font="1">The quality of parameter estimates and the limits of their application to ﬂight controls</text>
<text top="595" left="121" width="689" height="16" font="1">depend directly on the maneuvers performed during the test ﬂight. These methods are</text>
<text top="616" left="121" width="689" height="16" font="1">the same as the ones used for estimating the ﬂight envelope and performance parameters</text>
<text top="638" left="121" width="689" height="16" font="1">of a new aircraft. Usually the test pilot is given a preﬂight brieﬁng on the type of control</text>
<text top="660" left="121" width="689" height="16" font="1">inputs required and their purpose. For stable aircraft, it is best if no closed loop control</text>
<text top="681" left="121" width="689" height="16" font="1">aides are used during the test ﬂight. This ensures that all the natural modes are captured</text>
<text top="703" left="121" width="194" height="16" font="1">within the system model.</text>
<text top="734" left="148" width="662" height="16" font="1">The estimation and optimization methods described above assume that the control</text>
<text top="755" left="121" width="688" height="16" font="1">inputs excite a wide frequency range of the system. This would include maneuvers that</text>
<text top="777" left="121" width="689" height="16" font="1">excite the basic aircraft modes including phugoid, short period and Dutch roll. These</text>
<text top="799" left="121" width="688" height="16" font="1">modes can be achieved by applying pulse, step and multistep inputs on the control sur-</text>
<text top="820" left="121" width="688" height="16" font="1">faces. Figure <a href="pdfxml.html#44">(3.5) </a>shows the bandwidth of various control inputs where it is evident that</text>
<text top="842" left="121" width="689" height="16" font="1">multistep inputs cover a much wider range of frequency than simple step inputs as shown</text>
<text top="864" left="121" width="688" height="16" font="1">by Jategaonkar <a href="pdfxml.html#91">[32]. </a>Optimal design of these control inputs is also possible where the</text>
<text top="885" left="121" width="689" height="16" font="1">inputs cover the desired range. These can be programmed onto a ﬂight computer for open</text>
<text top="907" left="121" width="163" height="16" font="1">loop implementation.</text>
<text top="938" left="148" width="662" height="16" font="1">A typical set of maneuvers used for system identiﬁcation can be seen in Figure <a href="pdfxml.html#45">(3.6) </a><a href="pdfxml.html#91">[32].</a></text>
<text top="959" left="121" width="688" height="16" font="1">Note, the 3-2-1-1 maneuvers are a modiﬁed form of the doublet and excite the largest</text>
<text top="981" left="121" width="126" height="16" font="1">frequency range.</text>
<text top="1038" left="457" width="18" height="16" font="1">35</text>
</page>
<page number="45" position="absolute" top="0" left="0" height="1188" width="918">
<text top="496" left="207" width="517" height="16" font="1">Figure 3.6: Maneuvers to excite diﬀerent modes on an aircraft <a href="pdfxml.html#91">[32].</a></text>
<text top="562" left="122" width="37" height="23" font="2">3.4</text>
<text top="562" left="188" width="312" height="23" font="2">Atmospheric Turbulence</text>
<text top="616" left="122" width="689" height="16" font="1">Before looking at the parameter estimation results for the Kadet Senior UAV, it is worth-</text>
<text top="638" left="122" width="689" height="16" font="1">while to note the limitations of the above techniques. The Output Error Method, which</text>
<text top="659" left="122" width="688" height="16" font="1">takes into account the measurement noise, doesn’t account for unmeasurable process noise,</text>
<text top="681" left="122" width="689" height="16" font="1">or in the case of aircraft, atmospheric turbulence. Three main solutions exist for improving</text>
<text top="703" left="122" width="104" height="16" font="1">the model ﬁt:</text>
<text top="759" left="122" width="247" height="16" font="1">Measure Wind Components</text>
<text top="801" left="122" width="689" height="16" font="1">The obvious ﬁrst solution would be to derive the unmeasurable disturbances using mea-</text>
<text top="822" left="122" width="688" height="16" font="1">sured airspeed, wind ﬂow angles (α, β), attitude and inertial acceleration. This assumes</text>
<text top="844" left="121" width="689" height="16" font="1">that the eﬀect of turbulence on these measured values is known which is usually not avail-</text>
<text top="866" left="121" width="201" height="16" font="1">able for small scale UAVs.</text>
<text top="922" left="121" width="234" height="16" font="1">Dryden Wind Gust Model</text>
<text top="964" left="121" width="689" height="16" font="1">The Dryden Wind Gust model can be used in the method explained above where the</text>
<text top="985" left="121" width="688" height="16" font="1">parameters of the gust are included as part of the overall parameter estimation problem.</text>
<text top="1038" left="457" width="18" height="16" font="1">36</text>
</page>
<page number="46" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">Shown in Figure <a href="pdfxml.html#47">(3.7) </a>are results from the Dryden Flight Research Center’s work using</text>
<text top="213" left="122" width="668" height="16" font="1">similar methods performed on ﬂight data obtained during atmospheric turbulence <a href="pdfxml.html#91">[26].</a></text>
<text top="267" left="122" width="180" height="16" font="1">Filter Error Method</text>
<text top="309" left="122" width="689" height="16" font="1">The Filter Error Method falls under the general class of the Output Error Method described</text>
<text top="330" left="122" width="689" height="16" font="1">above. The general scheme is shown in Figure <a href="pdfxml.html#48">(3.8). </a>The main diﬀerence is the inclusion</text>
<text top="352" left="122" width="688" height="16" font="1">of unmeasurable process noise. This method was initially developed for linear models,</text>
<text top="374" left="122" width="688" height="16" font="1">using Kalman ﬁlters for improving the predicted state at every iteration. In the 1980’s</text>
<text top="395" left="122" width="688" height="16" font="1">Jategaonkar and Plaetschke adapted this method using a mixed version of the Extended</text>
<text top="417" left="122" width="689" height="16" font="1">Kalman Filter <a href="pdfxml.html#92">[34]. </a>Here, the prediction step relies on numerically integrating the nonlinear</text>
<text top="439" left="122" width="689" height="16" font="1">state equation using the previous state as its initial condition. The correction step, however,</text>
<text top="460" left="122" width="689" height="16" font="1">still uses linearization about the current state to calculate the Kalman gain. This can be</text>
<text top="482" left="122" width="82" height="16" font="1">written as,</text>
<text top="512" left="148" width="272" height="16" font="1">State and Measurement Prediction:</text>
<text top="556" left="314" width="9" height="16" font="1">˜</text>
<text top="556" left="313" width="23" height="16" font="1">x(t</text>
<text top="563" left="336" width="7" height="11" font="3">k</text>
<text top="556" left="344" width="40" height="16" font="1">) = ˆ</text>
<text top="556" left="375" width="23" height="16" font="1">x(t</text>
<text top="563" left="398" width="23" height="11" font="3">k−1</text>
<text top="556" left="422" width="24" height="16" font="1">) +</text>
<text top="540" left="468" width="5" height="11" font="3">t</text>
<text top="545" left="473" width="20" height="8" font="6">k+1</text>
<text top="576" left="460" width="5" height="11" font="3">t</text>
<text top="580" left="465" width="6" height="8" font="6">k</text>
<text top="556" left="497" width="78" height="16" font="1">f (x(t), u(t</text>
<text top="563" left="575" width="7" height="11" font="3">k</text>
<text top="556" left="583" width="35" height="16" font="1">), Θ)</text>
<text top="595" left="315" width="9" height="16" font="1">˜</text>
<text top="595" left="314" width="22" height="16" font="1">y(t</text>
<text top="602" left="336" width="7" height="11" font="3">k</text>
<text top="595" left="344" width="56" height="16" font="1">) = g(˜</text>
<text top="595" left="390" width="23" height="16" font="1">x(t</text>
<text top="602" left="414" width="7" height="11" font="3">k</text>
<text top="595" left="421" width="38" height="16" font="1">), u(t</text>
<text top="602" left="459" width="7" height="11" font="3">k</text>
<text top="595" left="467" width="35" height="16" font="1">), Θ)</text>
<text top="595" left="765" width="45" height="16" font="1">(3.29)</text>
<text top="641" left="148" width="86" height="16" font="1">Correction:</text>
<text top="678" left="344" width="9" height="16" font="1">ˆ</text>
<text top="678" left="343" width="23" height="16" font="1">x(t</text>
<text top="684" left="366" width="7" height="11" font="3">k</text>
<text top="678" left="374" width="40" height="16" font="1">) = ˜</text>
<text top="678" left="404" width="23" height="16" font="1">x(t</text>
<text top="684" left="427" width="7" height="11" font="3">k</text>
<text top="678" left="435" width="74" height="16" font="1">) + K(z(t</text>
<text top="684" left="509" width="7" height="11" font="3">k</text>
<text top="678" left="516" width="39" height="16" font="1">) − ˜</text>
<text top="678" left="545" width="22" height="16" font="1">y(t</text>
<text top="684" left="567" width="7" height="11" font="3">k</text>
<text top="678" left="575" width="14" height="16" font="1">))</text>
<text top="678" left="765" width="45" height="16" font="1">(3.30)</text>
<text top="715" left="122" width="59" height="16" font="1">where ˜</text>
<text top="715" left="171" width="23" height="16" font="1">x(t</text>
<text top="721" left="194" width="7" height="11" font="3">k</text>
<text top="715" left="202" width="189" height="16" font="1">) is the predicted state, ˜</text>
<text top="715" left="380" width="22" height="16" font="1">y(t</text>
<text top="721" left="403" width="7" height="11" font="3">k</text>
<text top="715" left="410" width="252" height="16" font="1">) is the predicted measurement, ˆ</text>
<text top="715" left="653" width="23" height="16" font="1">x(t</text>
<text top="721" left="676" width="7" height="11" font="3">k</text>
<text top="715" left="684" width="126" height="16" font="1">) is the corrected</text>
<text top="736" left="122" width="230" height="16" font="1">belief over the state at time, t</text>
<text top="743" left="352" width="7" height="11" font="3">k</text>
<text top="736" left="359" width="310" height="16" font="1">, and K, the Kalman gain, is deﬁned as:</text>
<text top="773" left="412" width="66" height="16" font="1">K = P C</text>
<text top="770" left="479" width="7" height="11" font="3">T</text>
<text top="773" left="489" width="13" height="16" font="1">R</text>
<text top="769" left="503" width="16" height="11" font="3">−1</text>
<text top="773" left="765" width="45" height="16" font="1">(3.31)</text>
<text top="810" left="122" width="689" height="16" font="1">where P is the covariance matrix of the state prediction error calculated from a steady-state</text>
<text top="832" left="122" width="689" height="16" font="1">form of the Ricatti equation and C is the observation matrix calculated using a ﬁrst-order</text>
<text top="854" left="122" width="116" height="16" font="1">approximation:</text>
<text top="900" left="344" width="32" height="16" font="1">C =</text>
<text top="888" left="393" width="122" height="16" font="1">∂g(x(t), u(t), Θ)</text>
<text top="912" left="444" width="20" height="16" font="1">∂x</text>
<text top="922" left="527" width="39" height="11" font="3">x(t)=˜</text>
<text top="922" left="558" width="17" height="11" font="3">x(t</text>
<text top="926" left="575" width="6" height="8" font="6">k</text>
<text top="922" left="582" width="5" height="11" font="3">)</text>
<text top="900" left="765" width="45" height="16" font="1">(3.32)</text>
<text top="950" left="127" width="475" height="16" font="1">Similar to the Output Error Method, the algorithm steps are:</text>
<text top="993" left="143" width="279" height="16" font="1">1. Input initial guesses on Θ and R.</text>
<text top="1038" left="457" width="18" height="16" font="1">37</text>
</page>
<page number="47" position="absolute" top="0" left="0" height="1188" width="918">
<text top="816" left="122" width="689" height="16" font="1">Figure 3.7: Direct application of the output error method without accounting for atmo-</text>
<text top="837" left="122" width="689" height="16" font="1">spheric turbulence on the left and accounting for turbulence using the Dryden Wind Gust</text>
<text top="859" left="122" width="181" height="16" font="1">model on the right <a href="pdfxml.html#91">[26].</a></text>
<text top="1038" left="457" width="18" height="16" font="1">38</text>
</page>
<page number="48" position="absolute" top="0" left="0" height="1188" width="918">
<text top="460" left="122" width="688" height="16" font="1">Figure 3.8: An adaptive system identiﬁcation method that changes the model based on</text>
<text top="482" left="122" width="401" height="16" font="1">the output error and accounts for process noise <a href="pdfxml.html#91">[32].</a></text>
<text top="551" left="143" width="614" height="16" font="1">2. Estimate states using the modiﬁed EKF as above and calculate errors (z − ˜</text>
<text top="551" left="747" width="21" height="16" font="1">y).</text>
<text top="586" left="143" width="118" height="16" font="1">3. Calculate R.</text>
<text top="622" left="143" width="374" height="16" font="1">4. Minimize the cost function with respect to Θ.</text>
<text top="657" left="143" width="356" height="16" font="1">5. Go back to 2 and iterate until Θ converges.</text>
<text top="698" left="148" width="662" height="16" font="1">This method leads to an optimization problem that is nearly linear, has fewer local</text>
<text top="719" left="122" width="326" height="16" font="1">minima and a faster convergence rate <a href="pdfxml.html#91">[33].</a></text>
<text top="781" left="122" width="37" height="23" font="2">3.5</text>
<text top="781" left="188" width="434" height="23" font="2">Results from BAC-221 Simulation</text>
<text top="833" left="122" width="688" height="16" font="1">The BAC-221 was a British supersonic test ﬁghter, developed in the 1970s as a precursor</text>
<text top="855" left="122" width="688" height="16" font="1">to the Concorde. It had a wingspan of 26 ft, a Rolls-Royce Avon 200 jet engine that</text>
<text top="877" left="122" width="689" height="16" font="1">produced 8000 lbf of thrust and a max speed of Mach 1.7. At the time, the Royal Aircraft</text>
<text top="898" left="122" width="689" height="16" font="1">Establishment at Farnborough produced a set of aerodynamic data from various wind</text>
<text top="920" left="122" width="689" height="16" font="1">tunnel tests ranging from Mach 0.2 to 0.955 <a href="pdfxml.html#90">[20]. </a>This detailed data was used to deﬁne a</text>
<text top="942" left="122" width="436" height="16" font="1">realistic full aerodynamic model for simulation purposes.</text>
<text top="971" left="148" width="249" height="16" font="1">This data (valid for 0 &lt; α &lt; 24</text>
<text top="968" left="397" width="6" height="11" font="3">◦</text>
<text top="971" left="411" width="116" height="16" font="1">and 0 &lt; β &lt; 8</text>
<text top="968" left="527" width="6" height="11" font="3">◦</text>
<text top="971" left="534" width="276" height="16" font="1">) can be used to generate nonlinear</text>
<text top="993" left="122" width="688" height="16" font="1">functions for standard nondimensional coeﬃcients that relate the moments and forces on</text>
<text top="1038" left="457" width="18" height="16" font="1">39</text>
</page>
<page number="49" position="absolute" top="0" left="0" height="1188" width="918">
<text top="494" left="248" width="435" height="16" font="1">Figure 3.9: Inputs to the BAC-221 nonlinear simulation.</text>
<text top="565" left="122" width="688" height="16" font="1">an aircraft to the states and control inputs. These functions can then be used to form a</text>
<text top="586" left="122" width="517" height="16" font="1">full aerodynamic model of the aircraft as discussed in section <a href="pdfxml.html#35">(3.2).</a></text>
<text top="617" left="148" width="662" height="16" font="1">As a ﬁrst test of the system identiﬁcation methods described above, a full nonlinear</text>
<text top="639" left="122" width="688" height="16" font="1">model of this aircraft was developed and simulated in Matlab with the required maneu-</text>
<text top="660" left="122" width="689" height="16" font="1">vers. The “measurements” were sampled at a ﬁxed time interval without any atmospheric</text>
<text top="682" left="122" width="689" height="16" font="1">turbulence. The model included 32 unknown parameters (from the general forms in Equa-</text>
<text top="704" left="122" width="689" height="16" font="1">tions <a href="pdfxml.html#39">(3.12) </a>and <a href="pdfxml.html#40">(3.13)) </a>with initial guesses of the same order of magnitude as the true</text>
<text top="725" left="122" width="689" height="16" font="1">parameter values. The results of the Output Error Method using Gauss-Newton opti-</text>
<text top="747" left="122" width="688" height="16" font="1">mization are shown in Figures <a href="pdfxml.html#49">(3.9) </a>and <a href="pdfxml.html#50">(3.10). </a>The predicted and measured states are</text>
<text top="769" left="122" width="689" height="16" font="1">reasonably close. Notice the poor ﬁt on V , which is mainly a result of no input on dT (in-</text>
<text top="790" left="122" width="688" height="16" font="1">suﬃcient excitation). This demonstrates the need for designing appropriate control inputs.</text>
<text top="875" left="122" width="37" height="23" font="2">3.6</text>
<text top="875" left="188" width="199" height="23" font="2">Data Collection</text>
<text top="929" left="122" width="689" height="16" font="1">The methods described above rely on in-ﬂight data collection of the system outputs and</text>
<text top="951" left="122" width="689" height="16" font="1">result in accurate estimation of parameters if the following guidelines by Jategaonkar <a href="pdfxml.html#91">[32]</a></text>
<text top="973" left="122" width="96" height="16" font="1">are followed:</text>
<text top="1038" left="457" width="18" height="16" font="1">40</text>
</page>
<page number="50" position="absolute" top="0" left="0" height="1188" width="918">
<text top="911" left="253" width="426" height="16" font="1">Figure 3.10: Output Error Method ﬁt on the BAC-221.</text>
<text top="1038" left="457" width="18" height="16" font="1">41</text>
</page>
<page number="51" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="143" width="667" height="16" font="1">1. The minimum sampling rate for data collection should be twice the frequency of</text>
<text top="213" left="165" width="364" height="16" font="1">interest (also known as the Nyquist frequency).</text>
<text top="249" left="143" width="667" height="16" font="1">2. Delays introduced in the data due to ﬁltering (post or in-ﬂight) should be kept as</text>
<text top="271" left="165" width="358" height="16" font="1">consistent as possible across all measurements.</text>
<text top="308" left="143" width="667" height="16" font="1">3. All outputs should be measured at the same sampling rate if possible. This is specially</text>
<text top="329" left="165" width="247" height="16" font="1">true for attitude and wind data.</text>
<text top="366" left="143" width="629" height="16" font="1">4. Ideally, all outputs should be measured and recorded at the same time instant.</text>
<text top="402" left="143" width="667" height="16" font="1">5. The signal to noise ratio to should be limited to below 10:1 either in ﬂight or during</text>
<text top="424" left="165" width="164" height="16" font="1">post process ﬁltering.</text>
<text top="470" left="148" width="662" height="16" font="1">Required measurements for a reasonable system identiﬁcation include all the 9 states</text>
<text top="491" left="122" width="688" height="16" font="1">in the general nonlinear aircraft model described in Section <a href="pdfxml.html#35">(3.2) </a>and can be termed as</text>
<text top="513" left="122" width="688" height="16" font="1">system outputs. In addition, the control inputs to the throttle and the control surface</text>
<text top="535" left="122" width="689" height="16" font="1">deﬂections of the elevator, aileron and rudder also need to be recorded on board the</text>
<text top="556" left="122" width="689" height="16" font="1">aircraft. Implementation details of these on a remotely piloted Kadet Senior UAV are</text>
<text top="578" left="122" width="121" height="16" font="1">provided below.</text>
<text top="637" left="122" width="50" height="19" font="7">3.6.1</text>
<text top="637" left="195" width="291" height="19" font="7">Attitude and Wind Sensors</text>
<text top="681" left="122" width="688" height="16" font="1">Airspeed can be measured using pitot tubes and MEMS based diﬀerential pressure sensors.</text>
<text top="703" left="122" width="689" height="16" font="1">They are mounted where the ﬂow is considered “free-stream” and is aﬀected minimally by</text>
<text top="725" left="122" width="314" height="16" font="1">the propeller wash and wing-tip vortices.</text>
<text top="755" left="148" width="662" height="16" font="1">α and β angles can be determined using either a multiport pitot tube or two rotary</text>
<text top="777" left="121" width="688" height="16" font="1">vanes. Multiport pitot tubes require careful calibration and are less accurate than two</text>
<text top="799" left="121" width="688" height="16" font="1">vanes connected to precision rotary encoders <a href="pdfxml.html#92">[45]. </a>However, the vanes also induce more</text>
<text top="820" left="121" width="689" height="16" font="1">drag than a multiport pitot tube. In addition, if the UAV has a pusher conﬁguration the</text>
<text top="842" left="121" width="689" height="16" font="1">multiport pitot tubes are a better choice because they can be mounted along the centerline</text>
<text top="864" left="121" width="689" height="16" font="1">and are not aﬀected by roll or yaw. Figure <a href="pdfxml.html#52">(3.11) </a>shows the custom designed angle of</text>
<text top="885" left="121" width="688" height="16" font="1">attack sensor and pitot tubes mounted on the Kadet Senior wing. The vanes use magnetic</text>
<text top="907" left="121" width="688" height="16" font="1">absolute encoders that relay readings over an analog signal. A similar assembly is used on</text>
<text top="929" left="121" width="642" height="16" font="1">the other half of the wing to measure the angle of sideslip and to balance the UAV.</text>
<text top="959" left="148" width="268" height="16" font="1">Euler angles and angular rates in F</text>
<text top="966" left="416" width="8" height="11" font="3">b</text>
<text top="959" left="430" width="380" height="16" font="1">are recorded using an IMU consisting of 3 gyros, 3</text>
<text top="981" left="122" width="486" height="16" font="1">accelerometers and 3 magnetometers. These are converted to F</text>
<text top="988" left="608" width="11" height="11" font="3">w</text>
<text top="981" left="625" width="185" height="16" font="1">using α and β measured</text>
<text top="1038" left="457" width="18" height="16" font="1">42</text>
</page>
<page number="52" position="absolute" top="0" left="0" height="1188" width="918">
<text top="412" left="122" width="689" height="16" font="1">Figure 3.11: Custom designed angle of attack vane mounted under the wing with pitot</text>
<text top="434" left="122" width="590" height="16" font="1">tubes visible in the background. A similar angle of sideslip vane is also used.</text>
<text top="504" left="122" width="689" height="16" font="1">above. This is done during post processing to minimize the eﬀect of excessive calculations</text>
<text top="526" left="122" width="138" height="16" font="1">on sampling time.</text>
<text top="556" left="148" width="662" height="16" font="1">Lastly, the control inputs from the ground are recorded on board by tapping into the RC</text>
<text top="578" left="122" width="688" height="16" font="1">receiver signals using an ATMEGA 2560 microcontroller, shown in Figure <a href="pdfxml.html#53">(3.12). </a>Control</text>
<text top="599" left="122" width="689" height="16" font="1">inputs can also be measured more precisely using rotary encoders. However, the reference</text>
<text top="621" left="122" width="688" height="16" font="1">signals to the servo motors, which run an internal position control loop, are suﬃcient</text>
<text top="643" left="122" width="397" height="16" font="1">indicators of surface deﬂections and throttle inputs.</text>
<text top="673" left="148" width="662" height="16" font="1">The airspeed, angles, α and β, and control inputs, dT , dE, dA and dR are all recorded</text>
<text top="695" left="122" width="688" height="16" font="1">using the ADC and PWM inputs on the microcontroller. The PWM inputs are programmed</text>
<text top="716" left="122" width="689" height="16" font="1">to be interrupt driven on rising and falling edges and use a 250 kHz clock to time the</text>
<text top="738" left="122" width="689" height="16" font="1">interval. The ADC inputs are also interrupt driven. All these inputs are packaged in a</text>
<text top="760" left="122" width="689" height="16" font="1">string and transmitted over USB to be recorded by an onboard computer running a QNX</text>
<text top="781" left="122" width="272" height="16" font="1">program utilizing the Termios API.</text>
<text top="839" left="122" width="50" height="19" font="7">3.6.2</text>
<text top="839" left="195" width="344" height="19" font="7">Ground Control and Monitoring</text>
<text top="884" left="122" width="689" height="16" font="1">A good ground control station can serve multiple purposes and is vital for a successful</text>
<text top="905" left="122" width="688" height="16" font="1">test ﬂight. The custom designed Kadet Senior ground control station has the following</text>
<text top="927" left="122" width="65" height="16" font="1">features:</text>
<text top="970" left="148" width="662" height="17" font="1">• Matlab based live plots showing current control inputs, airspeed, angle of attack and</text>
<text top="993" left="165" width="127" height="16" font="1">angle of sideslip.</text>
<text top="1038" left="457" width="18" height="16" font="1">43</text>
</page>
<page number="53" position="absolute" top="0" left="0" height="1188" width="918">
<text top="390" left="122" width="688" height="16" font="1">Figure 3.12: Atmega 2560 with 2 diﬀerential pressure sensors and inputs for alpha, beta</text>
<text top="411" left="122" width="413" height="16" font="1">vanes as well as 4 PWM inputs from the RC receiver.</text>
<text top="625" left="122" width="688" height="16" font="1">Figure 3.13: Low cost, custom designed communication stack for the UAV allowing multiple</text>
<text top="647" left="122" width="279" height="16" font="1">channels through a single serial line.</text>
<text top="716" left="148" width="662" height="17" font="1">• Telnet terminal with access to on-board QNX and the ability to start and stop</text>
<text top="739" left="165" width="303" height="16" font="1">diﬀerent recording programs mid-ﬂight.</text>
<text top="775" left="148" width="351" height="17" font="1">• In-ﬂight remote debugging of new software.</text>
<text top="811" left="148" width="533" height="17" font="1">• Mid-ﬂight review of recorded data, by direct access to the text ﬁle.</text>
<text top="848" left="148" width="536" height="17" font="1">• Other TCP/IP connections using the on-board BSD Socket library.</text>
<text top="894" left="148" width="662" height="16" font="1">These features are all accessed through a single low cost (&lt;$50) serial modem with a</text>
<text top="916" left="122" width="688" height="16" font="1">10km line of sight range. Since serial ports only allow access to one program at a time a</text>
<text top="938" left="122" width="688" height="16" font="1">TCP/IP layer is added to allow multiple connections. Matlab communicates with QNX</text>
<text top="959" left="122" width="688" height="16" font="1">over sockets running on this layer. Similarly, the remote debugging and Telnet sessions</text>
<text top="981" left="122" width="597" height="16" font="1">also require the TCP/IP layer. Figure <a href="pdfxml.html#53">(3.13) </a>shows the communication stack.</text>
<text top="1038" left="457" width="18" height="16" font="1">44</text>
</page>
<page number="54" position="absolute" top="0" left="0" height="1188" width="918">
<text top="189" left="122" width="50" height="19" font="7">3.6.3</text>
<text top="189" left="195" width="393" height="19" font="7">Real-time Thread Execution in QNX</text>
<text top="233" left="122" width="689" height="16" font="1">The rate at which the data is recorded plays a pivotal role in identifying an accurate</text>
<text top="255" left="122" width="688" height="16" font="1">model. Data that is collected at a lower and inconsistent rate is bound to only provide</text>
<text top="277" left="122" width="689" height="16" font="1">a model that is useful for ﬂight controls requiring low update rates. Since the intention</text>
<text top="298" left="122" width="688" height="16" font="1">here is to eventually implement an aggressive nonlinear feedback linearizing controller, the</text>
<text top="320" left="122" width="688" height="16" font="1">sampling rate needs to be reasonably fast and consistent. A NASA report on the practical</text>
<text top="342" left="122" width="689" height="16" font="1">aspects of these system identiﬁcation methods is detailed in <a href="pdfxml.html#91">[26]. </a>The report shows how</text>
<text top="363" left="122" width="688" height="16" font="1">the sampling rate aﬀects the quality of estimated parameters. Notably, rapid excursions,</text>
<text top="385" left="122" width="688" height="16" font="1">caused by rapid control inputs require a faster and consistent sampling rate, than say,</text>
<text top="407" left="122" width="688" height="16" font="1">when estimating slower motions like phugoid modes. In addition, time and phase shifts</text>
<text top="428" left="122" width="688" height="16" font="1">are also very important. When measurements are sampled sequentially, the time shift</text>
<text top="450" left="122" width="689" height="16" font="1">between a measured sample at the beginning of the interval and a measured sample at</text>
<text top="472" left="122" width="689" height="16" font="1">the end is crucial. With a low sampling rate and phase shifts, the initiation of a control</text>
<text top="493" left="122" width="689" height="16" font="1">input might be missed, causing the vehicle to appear to respond before the control input.</text>
<text top="515" left="122" width="688" height="16" font="1">The Output and Filter Error Methods discussed above, assume that all measurements are</text>
<text top="537" left="122" width="434" height="16" font="1">sampled simultaneously and at adequate sampling rates.</text>
<text top="567" left="148" width="662" height="16" font="1">These requirements can be implemented in QNX using either timer interrupt handlers or</text>
<text top="589" left="122" width="689" height="16" font="1">pulses, with the high priority threads sitting in a pulse receive state. The pulses themselves</text>
<text top="611" left="122" width="213" height="16" font="1">are generated by the kernel</text>
<text top="608" left="341" width="6" height="11" font="3"><a href="pdfxml.html#54">1</a></text>
<text top="611" left="355" width="455" height="16" font="1">using the real time clock and interrupts. The frequency of</text>
<text top="632" left="122" width="689" height="16" font="1">these interrupts dictate the resolution of the timing achieved. The goal is to achieve the</text>
<text top="654" left="122" width="688" height="16" font="1">best consistent update rate possible while keeping the system overheads low. For example,</text>
<text top="676" left="122" width="689" height="16" font="1">a 1ms resolution clock will give a sampling rate of anywhere from 71.43Hz to 76.29Hz if</text>
<text top="697" left="122" width="689" height="16" font="1">the desired frequency is 75Hz. This varying frequency will produce errors in parameter</text>
<text top="719" left="122" width="688" height="16" font="1">estimates as discussed above. Increasing the clock resolution also increases the system load</text>
<text top="741" left="122" width="688" height="16" font="1">and would delay thread execution. A clock resolution of 100us gives a frequency of 74.63Hz</text>
<text top="762" left="122" width="689" height="16" font="1">to 75.19Hz which is reasonably acceptable. Moving further down to 10us improves this</text>
<text top="784" left="122" width="689" height="16" font="1">even more but delays thread execution as most of the processing time is used to handle</text>
<text top="806" left="122" width="571" height="16" font="1">interrupts. A pie chart showing this comparison is shown in Figure <a href="pdfxml.html#55">(3.14).</a></text>
<text top="836" left="148" width="662" height="16" font="1">A multi-threaded program that extracts data from multiple sensors and records them</text>
<text top="858" left="122" width="689" height="16" font="1">onto a harddrive is run on-board the aircraft. It features constant time intervals with hard</text>
<text top="880" left="122" width="689" height="16" font="1">real-time constraints and synchronized data recording. Figure <a href="pdfxml.html#56">(3.15) </a>shows the timing</text>
<text top="901" left="122" width="688" height="16" font="1">trace of the program recorded in real-time over a period of about 180ms. The socket server</text>
<text top="923" left="122" width="688" height="16" font="1">serving Matlab on the ground is also one of the threads (No. 6) but is run at a much</text>
<text top="956" left="142" width="6" height="9" font="4">1</text>
<text top="958" left="148" width="662" height="13" font="5">The term, kernel, in this chapter refers to an Operating System kernel, which is diﬀerent from the</text>
<text top="976" left="122" width="260" height="13" font="5">OpenCL kernel in the previous chapter.</text>
<text top="1038" left="457" width="18" height="16" font="1">45</text>
</page>
<page number="55" position="absolute" top="0" left="0" height="1188" width="918">
<text top="404" left="122" width="530" height="16" font="1">Figure 3.14: CPU usage comparison at diﬀerent clock resolutions.</text>
<text top="404" left="668" width="142" height="16" font="1">Notice the virtual</text>
<text top="426" left="122" width="180" height="16" font="1">absence of Idle at 10us.</text>
<text top="493" left="122" width="688" height="16" font="1">lower priority. This same architecture can later be used directly for nonlinear controls</text>
<text top="515" left="122" width="124" height="16" font="1">implementation.</text>
<text top="578" left="122" width="37" height="23" font="2">3.7</text>
<text top="578" left="188" width="339" height="23" font="2">Results from Kadet Senior</text>
<text top="632" left="122" width="689" height="16" font="1">A portion of the data collected during test ﬂights and a model ﬁt obtained using the Output</text>
<text top="654" left="122" width="689" height="16" font="1">Error Method is shown in Figure <a href="pdfxml.html#57">(3.16). </a>The ﬁt is similar to the one seen in Figure <a href="pdfxml.html#47">(3.7).</a></text>
<text top="675" left="122" width="689" height="16" font="1">It was obtained using multiple runs of the algorithm where the values from the ﬁrst run</text>
<text top="697" left="122" width="688" height="16" font="1">were used as the initial parameters for the next run but some were “kicked” to let the</text>
<text top="719" left="122" width="303" height="16" font="1">solution escape local nonlinear minima.</text>
<text top="777" left="122" width="50" height="19" font="7">3.7.1</text>
<text top="777" left="195" width="614" height="19" font="7">Simplifying the Model and Reducing Identiﬁcation Errors</text>
<text top="822" left="122" width="689" height="16" font="1">Two ways to improve this ﬁt would be to include the turbulence methods discussed earlier</text>
<text top="843" left="122" width="688" height="16" font="1">and to improve the initial guesses on the parameters. The performance of the OEM is</text>
<text top="865" left="122" width="689" height="16" font="1">heavily dependent on the initial parameter estimates due to the highly nonlinear nature</text>
<text top="887" left="122" width="689" height="16" font="1">of the model, which results in many local minima. A good starting point for these would</text>
<text top="908" left="122" width="689" height="16" font="1">be wind tunnel tests. Lacking those, one can look up the most common parameters for</text>
<text top="930" left="122" width="688" height="16" font="1">other UAVs of similar scale and extrapolate to all required parameters. The Dryden Wind</text>
<text top="952" left="122" width="688" height="16" font="1">Gust model can also improve the ﬁt as discussed earlier. The OEM only accounts for</text>
<text top="973" left="122" width="596" height="16" font="1">measurement noise, therefore disturbances from wind still need to be tackled.</text>
<text top="1038" left="457" width="18" height="16" font="1">46</text>
</page>
<page number="56" position="absolute" top="0" left="0" height="1188" width="918">
<text top="516" left="122" width="689" height="16" font="1">Figure 3.15: Timing diagram showing uniform and synchronized thread execution at 75Hz.</text>
<text top="585" left="148" width="662" height="16" font="1">Another way to reduce wind disturbance errors is the Filter Error Method describe</text>
<text top="607" left="122" width="270" height="16" font="1">earlier. This is left for future work.</text>
<text top="637" left="148" width="662" height="16" font="1">Implementing nonlinear controls on a model of this size can be challenging. While exact</text>
<text top="658" left="122" width="689" height="16" font="1">requirements for controls are held oﬀ until the next chapter, it is suﬃcient to say that a</text>
<text top="680" left="122" width="689" height="16" font="1">smaller analytical model with a better ﬁt would fare better when designing control laws.</text>
<text top="702" left="122" width="689" height="16" font="1">The aerodynamic model resulting from the parameters in Equations <a href="pdfxml.html#39">(3.12) </a>and <a href="pdfxml.html#40">(3.13) </a>would</text>
<text top="723" left="122" width="689" height="16" font="1">be usable for nonlinear controls when some of the general parameters are zero, and hence</text>
<text top="745" left="122" width="688" height="16" font="1">simplifying the resulting control laws. The identiﬁcation process was started with most of</text>
<text top="767" left="122" width="689" height="16" font="1">the parameters ﬁxed to zero and was incrementally increased to all available parameters.</text>
<text top="788" left="122" width="688" height="16" font="1">The results, as shown in Figure <a href="pdfxml.html#57">(3.16), </a>can be used for high ﬁdelity simulations of the</text>
<text top="810" left="122" width="688" height="16" font="1">Kadet Senior. However, for control law derivations, a simpler analytical model, that ﬁts</text>
<text top="832" left="122" width="320" height="16" font="1">equally as good, if not better, is required.</text>
<text top="886" left="122" width="551" height="16" font="1">Consolidated Model: Replacing Polynomials with Sin and Cos</text>
<text top="928" left="122" width="688" height="16" font="1">While using the same 9 state model from Equations <a href="pdfxml.html#38">(3.6) </a>to <a href="pdfxml.html#38">(3.10), </a>as described earlier, one</text>
<text top="949" left="122" width="688" height="16" font="1">can replace the underlying aerodynamic forces and moments polynomials with trigonomet-</text>
<text top="971" left="122" width="689" height="16" font="1">ric functions (akin to a Taylor series vs a Fourier series). The idea is to reduce the number</text>
<text top="993" left="122" width="689" height="16" font="1">of parameters so that the resulting nonlinear controller equations are simpler and easy to</text>
<text top="1038" left="457" width="18" height="16" font="1">47</text>
</page>
<page number="57" position="absolute" top="0" left="0" height="1188" width="918">
<text top="922" left="122" width="689" height="16" font="1">Figure 3.16: Results from the Kadet Senior UAV, with a large number of underlying</text>
<text top="943" left="122" width="467" height="16" font="1">aerodynamic parameters from (Equations <a href="pdfxml.html#39">(3.12) </a>and <a href="pdfxml.html#40">(3.13)).</a></text>
<text top="1038" left="457" width="18" height="16" font="1">48</text>
</page>
<page number="58" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">compute on the ﬂight computer. Isidori <a href="pdfxml.html#91">[29] </a>proposes the following as an alternative to</text>
<text top="213" left="122" width="187" height="16" font="1">Equations <a href="pdfxml.html#36">(3.1) </a>to <a href="pdfxml.html#37">(3.3).</a></text>
<text top="257" left="239" width="12" height="8" font="1"></text>
<text top="290" left="239" width="12" height="8" font="1"></text>
<text top="259" left="263" width="12" height="17" font="1">L</text>
<text top="281" left="259" width="22" height="17" font="1">M</text>
<text top="302" left="261" width="15" height="17" font="1">N</text>
<text top="257" left="288" width="12" height="8" font="1"></text>
<text top="290" left="288" width="12" height="8" font="1"></text>
<text top="282" left="305" width="29" height="16" font="1">= V</text>
<text top="257" left="341" width="12" height="8" font="1"></text>
<text top="290" left="341" width="12" height="8" font="1"></text>
<text top="260" left="360" width="9" height="16" font="1">a</text>
<text top="267" left="369" width="13" height="11" font="3">12</text>
<text top="260" left="383" width="39" height="16" font="1">r + a</text>
<text top="267" left="422" width="13" height="11" font="3">13</text>
<text top="260" left="435" width="9" height="16" font="1">p</text>
<text top="282" left="386" width="9" height="16" font="1">a</text>
<text top="288" left="396" width="13" height="11" font="3">23</text>
<text top="282" left="409" width="8" height="16" font="1">q</text>
<text top="303" left="360" width="9" height="16" font="1">a</text>
<text top="310" left="369" width="13" height="11" font="3">32</text>
<text top="303" left="383" width="39" height="16" font="1">r + a</text>
<text top="310" left="422" width="13" height="11" font="3">33</text>
<text top="303" left="435" width="9" height="16" font="1">p</text>
<text top="257" left="452" width="12" height="8" font="1"></text>
<text top="290" left="452" width="12" height="8" font="1"></text>
<text top="282" left="468" width="28" height="16" font="1">+ V</text>
<text top="279" left="499" width="6" height="11" font="3">2</text>
<text top="257" left="509" width="12" height="8" font="1"></text>
<text top="290" left="509" width="12" height="8" font="1"></text>
<text top="260" left="551" width="9" height="16" font="1">a</text>
<text top="267" left="560" width="13" height="11" font="3">11</text>
<text top="260" left="577" width="34" height="16" font="1">sin β</text>
<text top="282" left="529" width="9" height="16" font="1">a</text>
<text top="288" left="538" width="13" height="11" font="3">21</text>
<text top="282" left="555" width="27" height="16" font="1">+ a</text>
<text top="288" left="582" width="13" height="11" font="3">22</text>
<text top="282" left="599" width="36" height="16" font="1">sin α</text>
<text top="303" left="551" width="9" height="16" font="1">a</text>
<text top="310" left="560" width="13" height="11" font="3">31</text>
<text top="303" left="577" width="34" height="16" font="1">sin β</text>
<text top="257" left="642" width="12" height="8" font="1"></text>
<text top="290" left="642" width="12" height="8" font="1"></text>
<text top="353" left="339" width="28" height="16" font="1">+ V</text>
<text top="350" left="371" width="6" height="11" font="3">2</text>
<text top="328" left="381" width="12" height="8" font="1"></text>
<text top="361" left="381" width="12" height="8" font="1"></text>
<text top="331" left="400" width="7" height="16" font="1">b</text>
<text top="338" left="408" width="13" height="11" font="3">11</text>
<text top="331" left="424" width="36" height="16" font="1">cos β</text>
<text top="331" left="503" width="9" height="16" font="1">0</text>
<text top="331" left="553" width="7" height="16" font="1">b</text>
<text top="338" left="561" width="13" height="11" font="3">13</text>
<text top="331" left="577" width="36" height="16" font="1">cos β</text>
<text top="353" left="426" width="9" height="16" font="1">0</text>
<text top="353" left="476" width="7" height="16" font="1">b</text>
<text top="359" left="484" width="13" height="11" font="3">22</text>
<text top="353" left="500" width="38" height="16" font="1">cos α</text>
<text top="353" left="579" width="9" height="16" font="1">0</text>
<text top="374" left="426" width="9" height="16" font="1">0</text>
<text top="374" left="503" width="9" height="16" font="1">0</text>
<text top="374" left="553" width="7" height="16" font="1">b</text>
<text top="381" left="561" width="13" height="11" font="3">33</text>
<text top="374" left="577" width="36" height="16" font="1">cos β</text>
<text top="328" left="622" width="12" height="8" font="1"></text>
<text top="361" left="622" width="12" height="8" font="1"></text>
<text top="328" left="637" width="12" height="8" font="1"></text>
<text top="361" left="637" width="12" height="8" font="1"></text>
<text top="331" left="657" width="22" height="16" font="1">δA</text>
<text top="353" left="656" width="21" height="16" font="1">δE</text>
<text top="374" left="656" width="22" height="16" font="1">δR</text>
<text top="328" left="686" width="12" height="8" font="1"></text>
<text top="361" left="686" width="12" height="8" font="1"></text>
<text top="317" left="765" width="45" height="16" font="1">(3.33)</text>
<text top="415" left="224" width="12" height="8" font="1"></text>
<text top="447" left="224" width="12" height="8" font="1"></text>
<text top="418" left="245" width="12" height="16" font="1">L</text>
<text top="439" left="244" width="15" height="16" font="1">D</text>
<text top="461" left="245" width="11" height="16" font="1">S</text>
<text top="415" left="266" width="12" height="8" font="1"></text>
<text top="447" left="266" width="12" height="8" font="1"></text>
<text top="439" left="283" width="29" height="16" font="1">= V</text>
<text top="436" left="316" width="6" height="11" font="3">2</text>
<text top="415" left="326" width="12" height="8" font="1"></text>
<text top="447" left="326" width="12" height="8" font="1"></text>
<text top="418" left="346" width="8" height="16" font="1">c</text>
<text top="424" left="353" width="13" height="11" font="3">21</text>
<text top="418" left="371" width="25" height="16" font="1">+ c</text>
<text top="424" left="396" width="13" height="11" font="3">22</text>
<text top="418" left="412" width="44" height="16" font="1">sin 2α</text>
<text top="439" left="349" width="8" height="16" font="1">c</text>
<text top="446" left="357" width="13" height="11" font="3">11</text>
<text top="439" left="374" width="25" height="16" font="1">+ c</text>
<text top="446" left="399" width="13" height="11" font="3">12</text>
<text top="439" left="416" width="38" height="16" font="1">cos α</text>
<text top="461" left="367" width="8" height="16" font="1">c</text>
<text top="468" left="375" width="13" height="11" font="3">31</text>
<text top="461" left="391" width="43" height="16" font="1">sin 2β</text>
<text top="415" left="464" width="12" height="8" font="1"></text>
<text top="447" left="464" width="12" height="8" font="1"></text>
<text top="439" left="480" width="28" height="16" font="1">+ T</text>
<text top="446" left="508" width="25" height="11" font="3">max</text>
<text top="415" left="537" width="12" height="8" font="1"></text>
<text top="447" left="537" width="12" height="8" font="1"></text>
<text top="418" left="586" width="36" height="16" font="1">sin α</text>
<text top="438" left="556" width="94" height="17" font="1">− cos α cos β</text>
<text top="461" left="565" width="77" height="16" font="1">cos α cos β</text>
<text top="415" left="659" width="12" height="8" font="1"></text>
<text top="447" left="659" width="12" height="8" font="1"></text>
<text top="439" left="674" width="19" height="16" font="1">δT</text>
<text top="439" left="765" width="45" height="16" font="1">(3.34)</text>
<text top="501" left="148" width="662" height="16" font="1">Just like in Equation <a href="pdfxml.html#36">(3.2), </a>the rolling moments here are mainly aﬀected by δR and</text>
<text top="523" left="122" width="689" height="16" font="1">δA, the pitching moments are aﬀected mainly by δE and the yawing moments are mainly</text>
<text top="544" left="122" width="689" height="16" font="1">aﬀected by δR. However, the inclusion of δA in the calculation of yawing moments is</text>
<text top="566" left="122" width="689" height="16" font="1">missing. This correlation can be observed in Figure <a href="pdfxml.html#60">(3.17). </a>Notice that the eﬀect on yaw</text>
<text top="588" left="122" width="668" height="16" font="1">rate, r, is only noticeable during large changes in δA movements. An extra parameter (b</text>
<text top="595" left="790" width="13" height="11" font="3">31</text>
<text top="588" left="803" width="7" height="16" font="1">)</text>
<text top="609" left="122" width="239" height="16" font="1">is added to improve the model.</text>
<text top="640" left="148" width="662" height="16" font="1">Furthermore, as discussed in Section <a href="pdfxml.html#35">(3.2), </a>the inclusion of control surface deﬂections</text>
<text top="662" left="122" width="689" height="16" font="1">in the force equations is still avoided here. However, due to a strong correlation (seen in</text>
<text top="683" left="122" width="688" height="16" font="1">Figure <a href="pdfxml.html#61">(3.18)), </a>and the need to simplify the model, a term with q is also added to the</text>
<text top="705" left="122" width="689" height="16" font="1">main Lift equation. By including q, the aﬀect of δE is still captured, but is delayed to the</text>
<text top="727" left="122" width="689" height="16" font="1">next derivative, the advantage of doing this is evident when deriving feedback linearizing</text>
<text top="748" left="122" width="688" height="16" font="1">control laws in Chapter <a href="pdfxml.html#66">(4). </a>However, when simulating the nonlinear controller on the</text>
<text top="770" left="122" width="689" height="16" font="1">Kadet Senior, this extra parameter is used in the plant but is explicitly excluded from the</text>
<text top="792" left="122" width="90" height="16" font="1">control law.</text>
<text top="822" left="148" width="376" height="16" font="1">The resulting forces and moments then look like,</text>
<text top="867" left="239" width="12" height="8" font="1"></text>
<text top="899" left="239" width="12" height="8" font="1"></text>
<text top="869" left="263" width="12" height="17" font="1">L</text>
<text top="890" left="259" width="22" height="17" font="1">M</text>
<text top="912" left="261" width="15" height="17" font="1">N</text>
<text top="867" left="288" width="12" height="8" font="1"></text>
<text top="899" left="288" width="12" height="8" font="1"></text>
<text top="892" left="305" width="29" height="16" font="1">= V</text>
<text top="867" left="341" width="12" height="8" font="1"></text>
<text top="899" left="341" width="12" height="8" font="1"></text>
<text top="870" left="360" width="9" height="16" font="1">a</text>
<text top="877" left="369" width="13" height="11" font="3">12</text>
<text top="870" left="383" width="39" height="16" font="1">r + a</text>
<text top="877" left="422" width="13" height="11" font="3">13</text>
<text top="870" left="435" width="9" height="16" font="1">p</text>
<text top="891" left="386" width="9" height="16" font="1">a</text>
<text top="898" left="396" width="13" height="11" font="3">23</text>
<text top="891" left="409" width="8" height="16" font="1">q</text>
<text top="913" left="360" width="9" height="16" font="1">a</text>
<text top="920" left="369" width="13" height="11" font="3">32</text>
<text top="913" left="383" width="39" height="16" font="1">r + a</text>
<text top="920" left="422" width="13" height="11" font="3">33</text>
<text top="913" left="435" width="9" height="16" font="1">p</text>
<text top="867" left="452" width="12" height="8" font="1"></text>
<text top="899" left="452" width="12" height="8" font="1"></text>
<text top="892" left="468" width="28" height="16" font="1">+ V</text>
<text top="888" left="499" width="6" height="11" font="3">2</text>
<text top="867" left="509" width="12" height="8" font="1"></text>
<text top="899" left="509" width="12" height="8" font="1"></text>
<text top="870" left="551" width="9" height="16" font="1">a</text>
<text top="877" left="560" width="13" height="11" font="3">11</text>
<text top="870" left="577" width="34" height="16" font="1">sin β</text>
<text top="891" left="529" width="9" height="16" font="1">a</text>
<text top="898" left="538" width="13" height="11" font="3">21</text>
<text top="891" left="555" width="27" height="16" font="1">+ a</text>
<text top="898" left="582" width="13" height="11" font="3">22</text>
<text top="891" left="599" width="36" height="16" font="1">sin α</text>
<text top="913" left="551" width="9" height="16" font="1">a</text>
<text top="920" left="560" width="13" height="11" font="3">31</text>
<text top="913" left="577" width="34" height="16" font="1">sin β</text>
<text top="867" left="642" width="12" height="8" font="1"></text>
<text top="899" left="642" width="12" height="8" font="1"></text>
<text top="962" left="339" width="28" height="16" font="1">+ V</text>
<text top="959" left="371" width="6" height="11" font="3">2</text>
<text top="938" left="381" width="12" height="8" font="1"></text>
<text top="970" left="381" width="12" height="8" font="1"></text>
<text top="941" left="400" width="7" height="16" font="1">b</text>
<text top="948" left="408" width="13" height="11" font="3">11</text>
<text top="941" left="424" width="36" height="16" font="1">cos β</text>
<text top="941" left="503" width="9" height="16" font="1">0</text>
<text top="941" left="553" width="7" height="16" font="1">b</text>
<text top="948" left="561" width="13" height="11" font="3">13</text>
<text top="941" left="577" width="36" height="16" font="1">cos β</text>
<text top="962" left="426" width="9" height="16" font="1">0</text>
<text top="962" left="476" width="7" height="16" font="1">b</text>
<text top="969" left="484" width="13" height="11" font="3">22</text>
<text top="962" left="500" width="38" height="16" font="1">cos α</text>
<text top="962" left="579" width="9" height="16" font="1">0</text>
<text top="984" left="400" width="7" height="16" font="1">b</text>
<text top="991" left="408" width="13" height="11" font="3">31</text>
<text top="984" left="424" width="36" height="16" font="1">cos β</text>
<text top="984" left="503" width="9" height="16" font="1">0</text>
<text top="984" left="553" width="7" height="16" font="1">b</text>
<text top="991" left="561" width="13" height="11" font="3">33</text>
<text top="984" left="577" width="36" height="16" font="1">cos β</text>
<text top="938" left="622" width="12" height="8" font="1"></text>
<text top="970" left="622" width="12" height="8" font="1"></text>
<text top="938" left="637" width="12" height="8" font="1"></text>
<text top="970" left="637" width="12" height="8" font="1"></text>
<text top="941" left="657" width="22" height="16" font="1">δA</text>
<text top="962" left="656" width="21" height="16" font="1">δE</text>
<text top="984" left="656" width="22" height="16" font="1">δR</text>
<text top="938" left="686" width="12" height="8" font="1"></text>
<text top="970" left="686" width="12" height="8" font="1"></text>
<text top="927" left="765" width="45" height="16" font="1">(3.35)</text>
<text top="1038" left="457" width="18" height="16" font="1">49</text>
</page>
<page number="59" position="absolute" top="0" left="0" height="1188" width="918">
<text top="215" left="176" width="12" height="8" font="1"></text>
<text top="247" left="176" width="12" height="8" font="1"></text>
<text top="218" left="197" width="12" height="16" font="1">L</text>
<text top="239" left="196" width="15" height="16" font="1">D</text>
<text top="261" left="197" width="11" height="16" font="1">S</text>
<text top="215" left="218" width="12" height="8" font="1"></text>
<text top="247" left="218" width="12" height="8" font="1"></text>
<text top="239" left="235" width="29" height="16" font="1">= V</text>
<text top="236" left="268" width="6" height="11" font="3">2</text>
<text top="215" left="278" width="12" height="8" font="1"></text>
<text top="247" left="278" width="12" height="8" font="1"></text>
<text top="218" left="298" width="8" height="16" font="1">c</text>
<text top="224" left="305" width="13" height="11" font="3">21</text>
<text top="218" left="323" width="25" height="16" font="1">+ c</text>
<text top="224" left="348" width="13" height="11" font="3">22</text>
<text top="218" left="364" width="74" height="16" font="1">sin 2α + c</text>
<text top="224" left="438" width="13" height="11" font="3">23</text>
<text top="218" left="451" width="8" height="16" font="1">q</text>
<text top="239" left="327" width="8" height="16" font="1">c</text>
<text top="246" left="334" width="13" height="11" font="3">11</text>
<text top="239" left="352" width="25" height="16" font="1">+ c</text>
<text top="246" left="377" width="13" height="11" font="3">12</text>
<text top="239" left="393" width="38" height="16" font="1">cos α</text>
<text top="261" left="345" width="8" height="16" font="1">c</text>
<text top="268" left="352" width="13" height="11" font="3">31</text>
<text top="261" left="369" width="43" height="16" font="1">sin 2β</text>
<text top="215" left="467" width="12" height="8" font="1"></text>
<text top="247" left="467" width="12" height="8" font="1"></text>
<text top="239" left="483" width="28" height="16" font="1">+ T</text>
<text top="246" left="511" width="25" height="11" font="3">max</text>
<text top="215" left="540" width="12" height="8" font="1"></text>
<text top="247" left="540" width="12" height="8" font="1"></text>
<text top="218" left="589" width="36" height="16" font="1">sin α</text>
<text top="238" left="560" width="94" height="17" font="1">− cos α cos β</text>
<text top="261" left="568" width="77" height="16" font="1">cos α cos β</text>
<text top="215" left="662" width="12" height="8" font="1"></text>
<text top="247" left="662" width="12" height="8" font="1"></text>
<text top="239" left="677" width="19" height="16" font="1">δT</text>
<text top="239" left="765" width="45" height="16" font="1">(3.36)</text>
<text top="299" left="148" width="662" height="16" font="1">This ﬁnal model replaces Equations <a href="pdfxml.html#36">(3.1) </a>to <a href="pdfxml.html#37">(3.5), </a>where the overall model is drastically</text>
<text top="321" left="122" width="688" height="16" font="1">simpliﬁed, and still has room to predict a broad envelope of ﬂight data. After incorporating</text>
<text top="342" left="122" width="689" height="16" font="1">into the main equations of motion, this model now has a total of 23 parameters, where</text>
<text top="364" left="122" width="664" height="16" font="1">each parameter is lumped and (other than mass and inertia) has no physical meaning.</text>
<text top="416" left="122" width="689" height="16" font="1">Better Results from Kadet Senior: Using an Improved Data Set and the Con-</text>
<text top="438" left="122" width="141" height="16" font="1">solidated Model</text>
<text top="478" left="122" width="688" height="16" font="1">Once the underlying aerodynamic model is improved, the other source of improvement</text>
<text top="500" left="122" width="688" height="16" font="1">is the data itself. IMUs, as discussed earlier, consist of accelerometers, gyroscopes and</text>
<text top="521" left="122" width="689" height="16" font="1">magnetometers. They come in various grades, with the best being based on laser systems,</text>
<text top="543" left="122" width="689" height="16" font="1">that have virtually no drift. In fact, measurements from a laser ring gyro can be integrated</text>
<text top="565" left="122" width="689" height="16" font="1">to ﬁnd the position for navigation in GPS denied environments. The IMU used on the</text>
<text top="586" left="122" width="688" height="16" font="1">Kadet Senior UAV is a MEMs based unit which is prone to noise and drift issues. To ﬁx</text>
<text top="608" left="122" width="688" height="16" font="1">the drift and noise, particularly in measuring p, q and r in the ﬁrst data set, an Extended</text>
<text top="630" left="122" width="688" height="16" font="1">Kalman Filter was designed with a constant acceleration motion model. This limits its use</text>
<text top="651" left="122" width="689" height="16" font="1">to less aggressive maneuvers, but also smooths the data for system identiﬁcation purposes.</text>
<text top="680" left="148" width="662" height="16" font="1">Further improvements on the system include better messaging protocols between the</text>
<text top="701" left="122" width="688" height="16" font="1">microcontroller and the QNX ﬂight computer, proper calibration of the wind vanes and</text>
<text top="723" left="122" width="680" height="16" font="1">control surfaces as well as precise measurements of the aircraft mass just before take-oﬀ.</text>
<text top="751" left="148" width="662" height="16" font="1">A subset of the improved data can be seen in Figures <a href="pdfxml.html#60">(3.17) </a>to <a href="pdfxml.html#63">(3.20). </a>The ﬁnal system</text>
<text top="773" left="122" width="689" height="16" font="1">identiﬁcation results are shown in Figure <a href="pdfxml.html#64">(3.21). </a>Note that since the forces are reﬂected</text>
<text top="795" left="122" width="689" height="16" font="1">in φ, γ and ψ and the moments are reﬂected in p, q and r, the ﬁnal model accurately</text>
<text top="816" left="121" width="689" height="16" font="1">predicts the aerodynamic moments and forces acting at any time on the Kadet Senior.</text>
<text top="838" left="121" width="689" height="16" font="1">This information can now be estimated on-board the ﬂight computers using this model,</text>
<text top="860" left="121" width="414" height="16" font="1">and inputs from the control surface and wind sensors.</text>
<text top="919" left="121" width="37" height="23" font="2">3.8</text>
<text top="919" left="188" width="150" height="23" font="2">Conclusions</text>
<text top="971" left="121" width="689" height="16" font="1">System identiﬁcation methods using ﬂight data have been studied extensively over the last</text>
<text top="993" left="121" width="689" height="16" font="1">few decades. These methods, which were initially designed for linear models and large</text>
<text top="1038" left="457" width="18" height="16" font="1">50</text>
</page>
<page number="60" position="absolute" top="0" left="0" height="1188" width="918">
<text top="797" left="122" width="688" height="16" font="1">Figure 3.17: Data collected from the Kadet Senior UAV, showing strong correlation be-</text>
<text top="818" left="122" width="689" height="16" font="1">tween ailerons, δA, and body axis yaw rate, r, (highlighted region). The rudder, δR, is</text>
<text top="840" left="122" width="689" height="16" font="1">kept constant. Where the ailerons do not conform to the yaw rate, the eﬀect of wind on</text>
<text top="862" left="122" width="161" height="16" font="1">the tail is noticeable.</text>
<text top="1038" left="457" width="18" height="16" font="1">51</text>
</page>
<page number="61" position="absolute" top="0" left="0" height="1188" width="918">
<text top="816" left="122" width="689" height="16" font="1">Figure 3.18: Data collected from the Kadet Senior UAV, showing correlations between</text>
<text top="838" left="122" width="551" height="16" font="1">elevator, δE, and body axis pitch rate, q and ﬂight path climb angle, γ.</text>
<text top="1038" left="457" width="18" height="16" font="1">52</text>
</page>
<page number="62" position="absolute" top="0" left="0" height="1188" width="918">
<text top="806" left="122" width="689" height="16" font="1">Figure 3.19: Data collected from the Kadet Senior UAV, showing correlations between</text>
<text top="827" left="122" width="689" height="16" font="1">elevator, δE, angle-of-attack, α and ﬂight path climb angle, γ. α is measured using the</text>
<text top="849" left="121" width="376" height="16" font="1">custom designed vane assembly discussed earlier.</text>
<text top="1038" left="457" width="18" height="16" font="1">53</text>
</page>
<page number="63" position="absolute" top="0" left="0" height="1188" width="918">
<text top="806" left="122" width="688" height="16" font="1">Figure 3.20: Data collected from the Kadet Senior UAV, showing how sudden changes in</text>
<text top="827" left="122" width="689" height="16" font="1">yaw rate aﬀects the sideslip angle, β, (highlighted regions). β is measured using a custom</text>
<text top="849" left="122" width="184" height="16" font="1">designed vane assembly.</text>
<text top="1038" left="457" width="18" height="16" font="1">54</text>
</page>
<page number="64" position="absolute" top="0" left="0" height="1188" width="918">
<text top="898" left="122" width="689" height="16" font="1">Figure 3.21: Drastic improvements in the ﬁt and with only 23 parameters: using an Ex-</text>
<text top="919" left="122" width="567" height="16" font="1">tended Kalman Filter on the ﬂight computer and the consolidated model.</text>
<text top="1038" left="457" width="18" height="16" font="1">55</text>
</page>
<page number="65" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">scale aircraft, can now be used for small scale Unmanned Aerial Vehicles. This has much</text>
<text top="213" left="122" width="689" height="16" font="1">to do with the rise in on-board and oﬀ-board computing power as well as the recent advent</text>
<text top="234" left="122" width="281" height="16" font="1">of light-weight MEMs based sensors.</text>
<text top="265" left="148" width="662" height="16" font="1">A class of methods known as the Output Error Method are discussed in this chapter.</text>
<text top="287" left="122" width="688" height="16" font="1">Extensions to the basic method can be used to account for atmospheric turbulence. Initial</text>
<text top="308" left="122" width="689" height="16" font="1">results from the Kadet Senior UAV seemed promising and were improved by changing the</text>
<text top="330" left="122" width="629" height="16" font="1">base aerodynamic model and improvements in the hardware and software system.</text>
<text top="361" left="148" width="662" height="16" font="1">The parameters identiﬁed in this chapter can now be used to design linear and non-</text>
<text top="382" left="122" width="133" height="16" font="1">linear controllers.</text>
<text top="1038" left="457" width="18" height="16" font="1">56</text>
</page>
<page number="66" position="absolute" top="0" left="0" height="1188" width="918">
<text top="306" left="122" width="184" height="33" font="0">Chapter 4</text>
<text top="390" left="122" width="381" height="33" font="0">Nonlinear Controller</text>
<text top="499" left="122" width="37" height="23" font="2">4.1</text>
<text top="499" left="188" width="160" height="23" font="2">Introduction</text>
<text top="553" left="122" width="689" height="16" font="1">The problem of tracking an arbitrary moving ground target from an aircraft can be broken</text>
<text top="575" left="122" width="689" height="16" font="1">down into two main classes. In the ﬁrst class, the target takes on a relatively steady</text>
<text top="597" left="122" width="688" height="16" font="1">motion with small changes in speed and direction. In the second class the target starts</text>
<text top="618" left="122" width="689" height="16" font="1">maneuvering in an aggressive fashion. Examples of this breakdown can be seen in car</text>
<text top="640" left="122" width="689" height="16" font="1">races, where the ﬁrst class includes all straight sections and the second, includes the sharp</text>
<text top="662" left="122" width="689" height="16" font="1">turns. Another example can be observed during the coverage of a downhill ski event. Here,</text>
<text top="683" left="122" width="689" height="16" font="1">the ﬁrst class will include all steady downward motions, and the second, will include all</text>
<text top="705" left="122" width="207" height="16" font="1">the challenging maneuvers.</text>
<text top="736" left="148" width="662" height="16" font="1">With a known target position, steady motion can be tracked using linear control tech-</text>
<text top="757" left="122" width="689" height="16" font="1">niques that have been developed in the past. The control techniques in this chapter focus</text>
<text top="779" left="122" width="689" height="16" font="1">on the second class of tracking problems, where the aircraft is required to track aggressive</text>
<text top="801" left="122" width="688" height="16" font="1">trajectories. A base set of such trajectories can be programmed into the ﬂight computer</text>
<text top="822" left="122" width="689" height="16" font="1">as motion primitives. The motion primitives can then be called from a high level planner</text>
<text top="844" left="122" width="689" height="16" font="1">whenever it foresees the need for an aggressive maneuver based on the info from the vision</text>
<text top="866" left="122" width="689" height="16" font="1">based target tracking discussed in Chapter <a href="pdfxml.html#15">(2). </a>The high level planner will be responsible</text>
<text top="887" left="122" width="689" height="16" font="1">for stitching a reference trajectory in real time which will include linear and nonlinear</text>
<text top="909" left="122" width="688" height="16" font="1">portions. The nonlinear portions will be small segments of aggressive maneuvers where</text>
<text top="931" left="122" width="567" height="16" font="1">the aircraft will move through a predictable path with timing constraints.</text>
<text top="961" left="148" width="662" height="16" font="1">It is expected that tracking such targets will push the aircraft to the extremes of its</text>
<text top="983" left="122" width="689" height="16" font="1">ﬂight envelope, requiring investigation into nonlinear ﬂight regimes where the aerodynamics</text>
<text top="1038" left="457" width="18" height="16" font="1">57</text>
</page>
<page number="67" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">and actuator limitations play a big role. The motion primitives can be developed with</text>
<text top="213" left="122" width="614" height="16" font="1">predetermined reference trajectories that are generated using linear exosystems.</text>
<text top="243" left="148" width="662" height="16" font="1">In addition to the models discussed in Section <a href="pdfxml.html#35">(3.2), </a>two simpler models are presented</text>
<text top="265" left="122" width="689" height="16" font="1">in this chapter. The motivation for developing control laws for each model stems from the</text>
<text top="287" left="122" width="689" height="16" font="1">desire to ultimately implement the simplest controller that yields acceptable performance.</text>
<text top="308" left="122" width="688" height="16" font="1">All models are demonstrated to be feedback linearizable, and a common linear tracking</text>
<text top="330" left="122" width="689" height="16" font="1">control methodology is employed on each. The simplest model is a 3 degree of freedom</text>
<text top="352" left="122" width="689" height="16" font="1">(DOF) model that is used to establish the possibility of using nonlinear techniques for</text>
<text top="373" left="122" width="688" height="16" font="1">trajectory tracking, but the model does not capture, for example, nonlinearities in the</text>
<text top="395" left="122" width="688" height="16" font="1">relationship between lift, drag and vehicle speed or angle of attack. The second follows</text>
<text top="417" left="122" width="688" height="16" font="1">Hauser and Hindman <a href="pdfxml.html#91">[23], </a>and describes a coordinated ﬂight regime where the sideslip</text>
<text top="438" left="122" width="689" height="16" font="1">angle is deliberately maintained at zero, restricting the possible trajectories of the aircraft,</text>
<text top="460" left="122" width="404" height="16" font="1">but improving on the ﬁrst model in terms of ﬁdelity.</text>
<text top="491" left="148" width="662" height="16" font="1">Since all the models are feedback linearizable, the tracking control approach used in-</text>
<text top="512" left="122" width="689" height="16" font="1">volves ﬁrst performing the feedback linearization and then applying linear tracking control</text>
<text top="534" left="122" width="689" height="16" font="1">using the internal model principle of Francis and Wonham <a href="pdfxml.html#90">[16]. </a>For this, linear exosystems</text>
<text top="556" left="122" width="689" height="16" font="1">are deﬁned which allow tracking of elliptical and oscillatory trajectories, combinations of</text>
<text top="577" left="122" width="689" height="16" font="1">which can give a vast number of motion primitives. An alternative to this approach which</text>
<text top="599" left="122" width="689" height="16" font="1">relaxes the need for feedback linearization would be to deﬁne nonlinear tracking controllers</text>
<text top="621" left="122" width="689" height="16" font="1">per Isidori and Byrnes <a href="pdfxml.html#91">[30], </a>however this method requires the solution of a partial diﬀer-</text>
<text top="642" left="122" width="688" height="16" font="1">ential equation for each trajectory under consideration. Khalil’s robust tracking control</text>
<text top="664" left="122" width="689" height="16" font="1">could also be considered <a href="pdfxml.html#92">[35], </a>however it relies on high-gain assumptions to ensure tracking</text>
<text top="686" left="122" width="266" height="16" font="1">which is impractical to implement.</text>
<text top="716" left="148" width="662" height="16" font="1">It should be noted that the particular control approach presented in this work relies on</text>
<text top="738" left="122" width="688" height="16" font="1">the possibility of feedback linearization. This requirement has therefore led to the selection</text>
<text top="760" left="122" width="688" height="16" font="1">of a particular subset of the available dynamic models for aircraft, and has resulted in the</text>
<text top="781" left="122" width="689" height="16" font="1">omission of valid models <a href="pdfxml.html#90">[13, </a><a href="pdfxml.html#93">56] </a>which include coupling between forces and angles. The</text>
<text top="803" left="122" width="688" height="16" font="1">result of such coupling, which does indeed exist in practice, is that the system becomes</text>
<text top="825" left="122" width="689" height="16" font="1">non-minimum phase, as was demonstrated by Tomlin et al. <a href="pdfxml.html#93">[56], </a>and therefore is no longer</text>
<text top="846" left="122" width="688" height="16" font="1">feedback linearizable. For non-minimum phase systems Devasia, Chen and Paden <a href="pdfxml.html#90">[10]</a></text>
<text top="868" left="122" width="688" height="16" font="1">presented a method for nonlinear tracking based on non-causal inversion. This aspect of</text>
<text top="890" left="122" width="521" height="16" font="1">the modeling and controller design remains an area for future work.</text>
<text top="920" left="148" width="662" height="16" font="1">This chapter proceeds as follows. Section <a href="pdfxml.html#68">(4.2) </a>presents the two new aircraft models in</text>
<text top="942" left="122" width="689" height="16" font="1">order of increasing complexity, and some representative linear target models are presented.</text>
<text top="964" left="122" width="689" height="16" font="1">The tracking controllers to be used with these models and the ones from Section <a href="pdfxml.html#35">(3.2)</a></text>
<text top="985" left="122" width="688" height="16" font="1">are deﬁned in Section <a href="pdfxml.html#72">(4.3), </a>and results are presented in Section <a href="pdfxml.html#78">(4.4). </a>Finally, a brief</text>
<text top="1038" left="457" width="18" height="16" font="1">58</text>
</page>
<page number="68" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="473" height="16" font="1">discussion of future directions is included in the ﬁnal Section.</text>
<text top="254" left="122" width="37" height="23" font="2">4.2</text>
<text top="254" left="188" width="351" height="23" font="2">Aircraft and Target Models</text>
<text top="308" left="122" width="689" height="16" font="1">The coordinate frames and nomenclature here follows from Section <a href="pdfxml.html#35">(3.2). </a>In addition, here</text>
<text top="330" left="122" width="222" height="19" font="1">the aircraft position, x ∈ R</text>
<text top="328" left="343" width="6" height="11" font="3">3</text>
<text top="330" left="358" width="371" height="16" font="1">is deﬁned in an inertial frame I, with ˙x and ¨</text>
<text top="330" left="719" width="91" height="16" font="1">x being the</text>
<text top="352" left="122" width="289" height="16" font="1">velocity and acceleration respectively.</text>
<text top="410" left="122" width="50" height="19" font="7">4.2.1</text>
<text top="410" left="195" width="218" height="19" font="7">Simple Flight Model</text>
<text top="455" left="122" width="689" height="16" font="1">This model assumes that direct control over the rates of change of velocity and ﬂight path</text>
<text top="476" left="122" width="380" height="16" font="1">angles of climb and heading is possible. Let V :=</text>
<text top="476" left="519" width="109" height="16" font="1">˙x and treat ˙</text>
<text top="476" left="618" width="56" height="16" font="1">V , ˙γ, ˙</text>
<text top="476" left="663" width="147" height="16" font="1">ψ as control inputs</text>
<text top="498" left="122" width="688" height="16" font="1">where γ and ψ are the two ﬂight path angles introduced above. Then the kinematics of</text>
<text top="520" left="122" width="324" height="16" font="1">the simple ﬂight model can be modeled as</text>
<text top="580" left="376" width="26" height="16" font="1">˙x =</text>
<text top="555" left="407" width="12" height="8" font="1"></text>
<text top="588" left="407" width="12" height="8" font="1"></text>
<text top="558" left="426" width="117" height="16" font="1">V cos(γ) cos(ψ)</text>
<text top="580" left="427" width="115" height="16" font="1">V cos(γ) sin(ψ)</text>
<text top="600" left="446" width="76" height="17" font="1">−V sin(γ)</text>
<text top="555" left="550" width="12" height="8" font="1"></text>
<text top="588" left="550" width="12" height="8" font="1"></text>
<text top="580" left="774" width="36" height="16" font="1">(4.1)</text>
<text top="626" left="374" width="5" height="16" font="1">˙</text>
<text top="630" left="369" width="48" height="16" font="1">V = u</text>
<text top="637" left="417" width="6" height="11" font="3">1</text>
<text top="656" left="376" width="41" height="16" font="1">˙γ = u</text>
<text top="663" left="417" width="6" height="11" font="3">2</text>
<text top="656" left="774" width="36" height="16" font="1">(4.2)</text>
<text top="681" left="377" width="5" height="16" font="1">˙</text>
<text top="685" left="371" width="46" height="16" font="1">ψ = u</text>
<text top="692" left="417" width="6" height="11" font="3">3</text>
<text top="712" left="374" width="43" height="16" font="1">y = x</text>
<text top="751" left="122" width="61" height="16" font="1">where u</text>
<text top="758" left="183" width="6" height="11" font="3">1</text>
<text top="751" left="190" width="22" height="16" font="1">, u</text>
<text top="758" left="212" width="6" height="11" font="3">2</text>
<text top="751" left="225" width="45" height="16" font="1">and u</text>
<text top="758" left="270" width="6" height="11" font="3">3</text>
<text top="751" left="284" width="526" height="16" font="1">are control inputs and y is the output. This model entirely ignores,</text>
<text top="773" left="122" width="689" height="16" font="1">among other things, the roll dynamics of the vehicle, as well as any coupling between the</text>
<text top="794" left="122" width="98" height="16" font="1">three inputs.</text>
<text top="853" left="122" width="50" height="19" font="7">4.2.2</text>
<text top="853" left="195" width="278" height="19" font="7">Coordinated Flight Model</text>
<text top="898" left="122" width="689" height="16" font="1">The second model depends on the assumption that the aircraft is restricted to coordinated</text>
<text top="919" left="122" width="689" height="16" font="1">ﬂight, which requires that β, the sideslip angle, be zero for all time. In practice, coordinated</text>
<text top="941" left="122" width="689" height="16" font="1">ﬂight is possible by implementing regulation of sideslip using the aircraft rudder. Let</text>
<text top="963" left="122" width="8" height="16" font="1">v</text>
<text top="960" left="131" width="9" height="11" font="3">w</text>
<text top="962" left="146" width="30" height="20" font="1">∈ R</text>
<text top="960" left="176" width="6" height="11" font="3">3</text>
<text top="963" left="189" width="43" height="16" font="1">and a</text>
<text top="960" left="232" width="9" height="11" font="3">w</text>
<text top="962" left="247" width="30" height="20" font="1">∈ R</text>
<text top="960" left="277" width="6" height="11" font="3">3</text>
<text top="963" left="290" width="520" height="16" font="1">denote, respectively, the aircraft velocity and acceleration expressed</text>
<text top="984" left="122" width="151" height="16" font="1">in the wind frame F</text>
<text top="991" left="272" width="11" height="11" font="3">w</text>
<text top="984" left="284" width="166" height="16" font="1">. The rotation from F</text>
<text top="991" left="450" width="11" height="11" font="3">w</text>
<text top="984" left="466" width="344" height="16" font="1">to the inertial frame is deﬁned by R ∈ SO(3).</text>
<text top="1038" left="457" width="18" height="16" font="1">59</text>
</page>
<page number="69" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="333" height="16" font="1">The rotation rates in wind axes are ω = (p</text>
<text top="198" left="454" width="9" height="11" font="3">w</text>
<text top="191" left="465" width="16" height="16" font="1">, q</text>
<text top="198" left="480" width="9" height="11" font="3">w</text>
<text top="191" left="491" width="16" height="16" font="1">, r</text>
<text top="198" left="506" width="9" height="11" font="3">w</text>
<text top="191" left="516" width="43" height="19" font="1">) ∈ R</text>
<text top="189" left="560" width="6" height="11" font="3">3</text>
<text top="191" left="573" width="237" height="16" font="1">and the evolution of R in time</text>
<text top="213" left="122" width="283" height="16" font="1">is described by the classical equation</text>
<text top="244" left="440" width="5" height="16" font="1">˙</text>
<text top="248" left="435" width="61" height="16" font="1">R = Rˆ</text>
<text top="248" left="485" width="11" height="16" font="1">ω</text>
<text top="248" left="774" width="36" height="16" font="1">(4.3)</text>
<text top="284" left="121" width="45" height="16" font="1">where</text>
<text top="322" left="363" width="9" height="16" font="1">ˆ</text>
<text top="322" left="361" width="30" height="16" font="1">ω =</text>
<text top="298" left="397" width="12" height="8" font="1"></text>
<text top="330" left="397" width="12" height="8" font="1"></text>
<text top="300" left="428" width="9" height="16" font="1">0</text>
<text top="299" left="463" width="22" height="17" font="1">−r</text>
<text top="307" left="485" width="9" height="11" font="3">w</text>
<text top="300" left="517" width="8" height="16" font="1">q</text>
<text top="307" left="525" width="9" height="11" font="3">w</text>
<text top="322" left="423" width="8" height="16" font="1">r</text>
<text top="329" left="431" width="9" height="11" font="3">w</text>
<text top="322" left="475" width="9" height="16" font="1">0</text>
<text top="321" left="510" width="23" height="17" font="1">−p</text>
<text top="329" left="533" width="9" height="11" font="3">w</text>
<text top="343" left="416" width="22" height="17" font="1">−q</text>
<text top="350" left="438" width="9" height="11" font="3">w</text>
<text top="344" left="469" width="9" height="16" font="1">p</text>
<text top="350" left="478" width="9" height="11" font="3">w</text>
<text top="344" left="522" width="9" height="16" font="1">0</text>
<text top="298" left="550" width="12" height="8" font="1"></text>
<text top="330" left="550" width="12" height="8" font="1"></text>
<text top="322" left="565" width="5" height="16" font="1">.</text>
<text top="372" left="121" width="562" height="16" font="1">The assumption of coordinated ﬂight can be imposed with the constraint</text>
<text top="407" left="431" width="66" height="16" font="1">˙x = V Re</text>
<text top="414" left="497" width="6" height="11" font="3">1</text>
<text top="407" left="774" width="36" height="16" font="1">(4.4)</text>
<text top="443" left="121" width="60" height="16" font="1">where e</text>
<text top="450" left="182" width="6" height="11" font="3">1</text>
<text top="443" left="197" width="613" height="16" font="1">= (1, 0, 0) . The control inputs are taken as the aircraft forward acceleration</text>
<text top="465" left="121" width="9" height="16" font="1">a</text>
<text top="462" left="131" width="6" height="11" font="3">v</text>
<text top="473" left="131" width="6" height="11" font="3">1</text>
<text top="465" left="138" width="212" height="16" font="1">, the upward acceleration a</text>
<text top="462" left="350" width="6" height="11" font="3">v</text>
<text top="473" left="350" width="6" height="11" font="3">3</text>
<text top="465" left="364" width="143" height="16" font="1">and the roll rate p</text>
<text top="471" left="507" width="9" height="11" font="3">w</text>
<text top="465" left="517" width="55" height="16" font="1">. Let g</text>
<text top="462" left="572" width="9" height="11" font="3">w</text>
<text top="465" left="588" width="222" height="16" font="1">= R g be the gravity vector</text>
<text top="486" left="121" width="81" height="16" font="1">g = (0, 0, g</text>
<text top="493" left="203" width="6" height="11" font="3">3</text>
<text top="486" left="210" width="7" height="16" font="1">)</text>
<text top="486" left="233" width="110" height="16" font="1">rotated into F</text>
<text top="493" left="343" width="9" height="11" font="3">w</text>
<text top="486" left="353" width="374" height="16" font="1">. Then, diﬀerentiating Equation <a href="pdfxml.html#69">(4.4), </a>we obtain</text>
<text top="522" left="418" width="9" height="16" font="1">¨</text>
<text top="522" left="417" width="87" height="16" font="1">x = g + Ra</text>
<text top="518" left="504" width="9" height="11" font="3">w</text>
<text top="522" left="774" width="36" height="16" font="1">(4.5)</text>
<text top="557" left="121" width="62" height="16" font="1">where a</text>
<text top="555" left="183" width="9" height="11" font="3">w</text>
<text top="557" left="202" width="38" height="16" font="1">= (a</text>
<text top="555" left="239" width="9" height="11" font="3">w</text>
<text top="566" left="239" width="6" height="11" font="3">1</text>
<text top="557" left="250" width="34" height="16" font="1">, 0, a</text>
<text top="555" left="283" width="9" height="11" font="3">w</text>
<text top="566" left="283" width="6" height="11" font="3">3</text>
<text top="557" left="294" width="287" height="16" font="1">) and the control inputs are u = (u</text>
<text top="564" left="581" width="6" height="11" font="3">1</text>
<text top="557" left="588" width="18" height="16" font="1">, u</text>
<text top="564" left="606" width="6" height="11" font="3">2</text>
<text top="557" left="613" width="18" height="16" font="1">, u</text>
<text top="564" left="630" width="6" height="11" font="3">3</text>
<text top="557" left="638" width="52" height="16" font="1">) = (p</text>
<text top="564" left="690" width="9" height="11" font="3">w</text>
<text top="557" left="700" width="17" height="16" font="1">, a</text>
<text top="555" left="717" width="9" height="11" font="3">w</text>
<text top="566" left="717" width="6" height="11" font="3">1</text>
<text top="557" left="727" width="17" height="16" font="1">, a</text>
<text top="555" left="744" width="9" height="11" font="3">w</text>
<text top="566" left="744" width="6" height="11" font="3">3</text>
<text top="557" left="755" width="55" height="16" font="1">). The</text>
<text top="579" left="122" width="688" height="16" font="1">coordinated ﬂight constraint imposes conditions on the evolution of the rotation rates in</text>
<text top="600" left="122" width="13" height="16" font="1">F</text>
<text top="607" left="134" width="11" height="11" font="3">w</text>
<text top="628" left="408" width="8" height="16" font="1">q</text>
<text top="635" left="415" width="9" height="11" font="3">w</text>
<text top="628" left="431" width="33" height="16" font="1">= −</text>
<text top="616" left="465" width="9" height="16" font="1">a</text>
<text top="614" left="474" width="9" height="11" font="3">w</text>
<text top="625" left="474" width="6" height="11" font="3">3</text>
<text top="616" left="488" width="26" height="16" font="1">+ g</text>
<text top="614" left="515" width="9" height="11" font="3">w</text>
<text top="625" left="514" width="6" height="11" font="3">3</text>
<text top="641" left="488" width="10" height="16" font="1">V</text>
<text top="671" left="407" width="8" height="16" font="1">r</text>
<text top="677" left="415" width="9" height="11" font="3">w</text>
<text top="671" left="431" width="14" height="16" font="1">=</text>
<text top="658" left="451" width="8" height="16" font="1">g</text>
<text top="656" left="460" width="9" height="11" font="3">w</text>
<text top="667" left="459" width="6" height="11" font="3">2</text>
<text top="683" left="454" width="10" height="16" font="1">V</text>
<text top="671" left="472" width="5" height="16" font="1">.</text>
<text top="648" left="774" width="36" height="16" font="1">(4.6)</text>
<text top="706" left="122" width="688" height="16" font="1">In summary, the coordinated ﬂight model is given by Equations <a href="pdfxml.html#69">(4.3) </a>to <a href="pdfxml.html#69">(4.5) </a>with states</text>
<text top="727" left="122" width="17" height="16" font="1">(x</text>
<text top="734" left="138" width="6" height="11" font="3">1</text>
<text top="727" left="145" width="18" height="16" font="1">, x</text>
<text top="734" left="163" width="6" height="11" font="3">2</text>
<text top="727" left="170" width="18" height="16" font="1">, x</text>
<text top="734" left="188" width="6" height="11" font="3">3</text>
<text top="727" left="195" width="18" height="16" font="1">, ˙x</text>
<text top="734" left="213" width="6" height="11" font="3">1</text>
<text top="727" left="220" width="18" height="16" font="1">, ˙x</text>
<text top="734" left="238" width="6" height="11" font="3">2</text>
<text top="727" left="245" width="18" height="16" font="1">, ˙x</text>
<text top="734" left="263" width="6" height="11" font="3">3</text>
<text top="727" left="270" width="540" height="16" font="1">, R). The state space dimension is 7 instead of 9 because the coordi-</text>
<text top="749" left="122" width="616" height="16" font="1">nated ﬂight requirement imposes additional constraints on the motion of R <a href="pdfxml.html#91">[23].</a></text>
<text top="806" left="122" width="50" height="19" font="7">4.2.3</text>
<text top="806" left="195" width="264" height="19" font="7">Full Aerodynamic Model</text>
<text top="849" left="122" width="688" height="16" font="1">This model is the same as described in Section ( <a href="pdfxml.html#35">3.2). </a>The kinematic model in Equa-</text>
<text top="871" left="122" width="612" height="16" font="1">tion <a href="pdfxml.html#68">(4.1) </a>can be used to generate the aircraft trajectory for the 9 state system.</text>
<text top="928" left="122" width="50" height="19" font="7">4.2.4</text>
<text top="928" left="195" width="154" height="19" font="7">Target Models</text>
<text top="971" left="122" width="689" height="16" font="1">The internal model approach to tracking requires a reference trajectory generator that is</text>
<text top="993" left="122" width="688" height="16" font="1">given by a linear time-invariant (LTI) system. This trajectory generating system is called</text>
<text top="1038" left="457" width="18" height="16" font="1">60</text>
</page>
<page number="70" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">an exosystem. These exosystems create the reference trajectories for the motion primitives</text>
<text top="213" left="122" width="125" height="16" font="1">discussed above.</text>
<text top="243" left="148" width="662" height="16" font="1">Three such exosystems are deﬁned below. The ﬁrst one generates a ﬁxed altitude</text>
<text top="265" left="122" width="689" height="16" font="1">elliptical trajectory which can ﬁnd many uses in aerial reconnaissance or auto racing ap-</text>
<text top="287" left="122" width="688" height="16" font="1">plications. The second, a periodic trajectory generator, can be used to chase targets up or</text>
<text top="308" left="122" width="688" height="16" font="1">downhill along a oscillatory path. The third, can be used to generate a variety of aggressive</text>
<text top="330" left="122" width="440" height="16" font="1">maneuvers by manipulating the rotation rates p, q and r.</text>
<text top="386" left="122" width="178" height="16" font="1">Elliptical Trajectory</text>
<text top="428" left="122" width="331" height="16" font="1">The desired elliptical trajectory is given by</text>
<text top="468" left="389" width="10" height="16" font="1">x</text>
<text top="474" left="399" width="25" height="11" font="3">1ref</text>
<text top="468" left="441" width="101" height="16" font="1">= 100 cos(t)</text>
<text top="494" left="389" width="10" height="16" font="1">x</text>
<text top="501" left="399" width="25" height="11" font="3">2ref</text>
<text top="494" left="441" width="91" height="16" font="1">= 50 sin(t)</text>
<text top="494" left="774" width="36" height="16" font="1">(4.7)</text>
<text top="520" left="389" width="10" height="16" font="1">x</text>
<text top="527" left="399" width="25" height="11" font="3">3ref</text>
<text top="520" left="441" width="37" height="16" font="1">= 5</text>
<text top="559" left="122" width="61" height="16" font="1">where x</text>
<text top="566" left="183" width="25" height="11" font="3">1ref</text>
<text top="559" left="210" width="18" height="16" font="1">, x</text>
<text top="566" left="228" width="25" height="11" font="3">2ref</text>
<text top="559" left="261" width="45" height="16" font="1">and x</text>
<text top="566" left="306" width="25" height="11" font="3">3ref</text>
<text top="559" left="339" width="471" height="16" font="1">represent the desired aircraft position in inertial coordinates.</text>
<text top="581" left="122" width="439" height="16" font="1">This trajectory can be generated by the following system</text>
<text top="621" left="423" width="5" height="16" font="1">˙</text>
<text top="621" left="417" width="13" height="16" font="1">w</text>
<text top="628" left="430" width="6" height="11" font="3">1</text>
<text top="621" left="452" width="41" height="16" font="1">= w</text>
<text top="628" left="493" width="6" height="11" font="3">2</text>
<text top="647" left="423" width="5" height="16" font="1">˙</text>
<text top="647" left="417" width="13" height="16" font="1">w</text>
<text top="654" left="430" width="6" height="11" font="3">2</text>
<text top="647" left="452" width="55" height="16" font="1">= −w</text>
<text top="654" left="507" width="6" height="11" font="3">1</text>
<text top="673" left="423" width="5" height="16" font="1">˙</text>
<text top="673" left="417" width="13" height="16" font="1">w</text>
<text top="680" left="430" width="6" height="11" font="3">3</text>
<text top="673" left="452" width="41" height="16" font="1">= w</text>
<text top="680" left="493" width="6" height="11" font="3">4</text>
<text top="673" left="774" width="36" height="16" font="1">(4.8)</text>
<text top="699" left="423" width="5" height="16" font="1">˙</text>
<text top="699" left="417" width="13" height="16" font="1">w</text>
<text top="706" left="430" width="6" height="11" font="3">4</text>
<text top="699" left="452" width="55" height="16" font="1">= −w</text>
<text top="706" left="507" width="6" height="11" font="3">3</text>
<text top="725" left="423" width="5" height="16" font="1">˙</text>
<text top="725" left="417" width="13" height="16" font="1">w</text>
<text top="732" left="430" width="6" height="11" font="3">5</text>
<text top="725" left="452" width="37" height="16" font="1">= 0</text>
<text top="765" left="121" width="190" height="16" font="1">with initial conditions w</text>
<text top="772" left="311" width="6" height="11" font="3">1</text>
<text top="765" left="318" width="95" height="16" font="1">(0) = 100, w</text>
<text top="772" left="413" width="6" height="11" font="3">2</text>
<text top="765" left="421" width="78" height="16" font="1">(0) = 0, w</text>
<text top="772" left="498" width="6" height="11" font="3">3</text>
<text top="765" left="505" width="78" height="16" font="1">(0) = 0, w</text>
<text top="772" left="583" width="6" height="11" font="3">4</text>
<text top="765" left="590" width="120" height="16" font="1">(0) = 50 and w</text>
<text top="772" left="711" width="6" height="11" font="3">5</text>
<text top="765" left="718" width="92" height="16" font="1">(0) = 5 and</text>
<text top="787" left="122" width="53" height="16" font="1">with w</text>
<text top="793" left="174" width="6" height="11" font="3">1</text>
<text top="787" left="186" width="29" height="16" font="1">= x</text>
<text top="793" left="215" width="6" height="11" font="3">1</text>
<text top="798" left="221" width="16" height="8" font="6">ref</text>
<text top="787" left="240" width="23" height="16" font="1">, w</text>
<text top="793" left="263" width="6" height="11" font="3">3</text>
<text top="787" left="275" width="29" height="16" font="1">= x</text>
<text top="793" left="304" width="6" height="11" font="3">2</text>
<text top="798" left="310" width="16" height="8" font="6">ref</text>
<text top="787" left="329" width="57" height="16" font="1">, and w</text>
<text top="793" left="386" width="6" height="11" font="3">5</text>
<text top="787" left="398" width="29" height="16" font="1">= x</text>
<text top="793" left="427" width="6" height="11" font="3">3</text>
<text top="798" left="433" width="16" height="8" font="6">ref</text>
<text top="787" left="452" width="5" height="16" font="1">.</text>
<text top="842" left="122" width="135" height="16" font="1">Basic Ski Slope</text>
<text top="885" left="122" width="688" height="16" font="1">A simple ski slope trajectory can be generated using a combination of periodic functions for</text>
<text top="906" left="122" width="10" height="16" font="1">V</text>
<text top="913" left="132" width="18" height="11" font="3">ref</text>
<text top="906" left="152" width="20" height="16" font="1">, γ</text>
<text top="913" left="171" width="18" height="11" font="3">ref</text>
<text top="906" left="192" width="22" height="16" font="1">, ψ</text>
<text top="913" left="213" width="18" height="11" font="3">ref</text>
<text top="906" left="239" width="44" height="16" font="1">and β</text>
<text top="913" left="283" width="18" height="11" font="3">ref</text>
<text top="906" left="303" width="83" height="16" font="1">. Setting V</text>
<text top="913" left="386" width="18" height="11" font="3">ref</text>
<text top="906" left="406" width="20" height="16" font="1">, γ</text>
<text top="913" left="426" width="18" height="11" font="3">ref</text>
<text top="906" left="451" width="142" height="16" font="1">as constants and β</text>
<text top="913" left="594" width="18" height="11" font="3">ref</text>
<text top="906" left="619" width="191" height="16" font="1">to zero gives a trajectory</text>
<text top="928" left="122" width="689" height="16" font="1">with a constant climb angle that maintains zero sideslip through aggressive turns. These</text>
<text top="950" left="122" width="647" height="16" font="1">turns can be formulated using any dynamically feasible time varying functions for ψ</text>
<text top="956" left="768" width="18" height="11" font="3">ref</text>
<text top="950" left="794" width="16" height="16" font="1">as</text>
<text top="1038" left="457" width="18" height="16" font="1">61</text>
</page>
<page number="71" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="52" height="16" font="1">follows</text>
<text top="208" left="398" width="10" height="16" font="1">V</text>
<text top="215" left="408" width="18" height="11" font="3">ref</text>
<text top="208" left="433" width="45" height="16" font="1">= 150</text>
<text top="234" left="399" width="9" height="16" font="1">γ</text>
<text top="241" left="408" width="18" height="11" font="3">ref</text>
<text top="234" left="433" width="27" height="16" font="1">= 5</text>
<text top="272" left="397" width="11" height="16" font="1">ψ</text>
<text top="279" left="408" width="18" height="11" font="3">ref</text>
<text top="272" left="433" width="54" height="16" font="1">= 5 cos</text>
<text top="260" left="511" width="6" height="16" font="1">t</text>
<text top="285" left="505" width="18" height="16" font="1">10</text>
<text top="310" left="398" width="10" height="16" font="1">β</text>
<text top="317" left="408" width="18" height="11" font="3">ref</text>
<text top="310" left="433" width="27" height="16" font="1">= 0</text>
<text top="259" left="774" width="36" height="16" font="1">(4.9)</text>
<text top="339" left="122" width="630" height="16" font="1">The reference trajectories from Equation <a href="pdfxml.html#71">(4.9) </a>can be generated by the exosystem</text>
<text top="374" left="403" width="5" height="16" font="1">˙</text>
<text top="374" left="398" width="13" height="16" font="1">w</text>
<text top="380" left="411" width="6" height="11" font="3">1</text>
<text top="374" left="423" width="29" height="16" font="1">= ˙</text>
<text top="374" left="441" width="13" height="16" font="1">w</text>
<text top="380" left="454" width="6" height="11" font="3">2</text>
<text top="374" left="466" width="29" height="16" font="1">= ˙</text>
<text top="374" left="484" width="13" height="16" font="1">w</text>
<text top="380" left="497" width="6" height="11" font="3">5</text>
<text top="374" left="509" width="27" height="16" font="1">= 0</text>
<text top="400" left="403" width="5" height="16" font="1">˙</text>
<text top="400" left="398" width="13" height="16" font="1">w</text>
<text top="407" left="411" width="6" height="11" font="3">3</text>
<text top="400" left="423" width="31" height="16" font="1">= w</text>
<text top="407" left="454" width="6" height="11" font="3">4</text>
<text top="436" left="403" width="5" height="16" font="1">˙</text>
<text top="436" left="398" width="13" height="16" font="1">w</text>
<text top="443" left="411" width="6" height="11" font="3">4</text>
<text top="436" left="423" width="33" height="16" font="1">= −</text>
<text top="424" left="466" width="9" height="16" font="1">1</text>
<text top="448" left="457" width="26" height="16" font="1">100</text>
<text top="436" left="485" width="13" height="16" font="1">w</text>
<text top="443" left="498" width="6" height="11" font="3">3</text>
<text top="408" left="765" width="45" height="16" font="1">(4.10)</text>
<text top="476" left="122" width="64" height="16" font="1">where w</text>
<text top="483" left="185" width="6" height="11" font="3">1</text>
<text top="476" left="192" width="94" height="16" font="1">(0) = 150, w</text>
<text top="483" left="286" width="6" height="11" font="3">2</text>
<text top="476" left="294" width="77" height="16" font="1">(0) = 5, w</text>
<text top="483" left="370" width="6" height="11" font="3">3</text>
<text top="476" left="377" width="77" height="16" font="1">(0) = 5, w</text>
<text top="483" left="454" width="6" height="11" font="3">4</text>
<text top="476" left="461" width="80" height="16" font="1">(0) = 0, w</text>
<text top="483" left="541" width="6" height="11" font="3">5</text>
<text top="476" left="548" width="110" height="16" font="1">(0) = 0 and w</text>
<text top="483" left="658" width="6" height="11" font="3">1</text>
<text top="476" left="670" width="30" height="16" font="1">= V</text>
<text top="483" left="700" width="18" height="11" font="3">ref</text>
<text top="476" left="720" width="24" height="16" font="1">, w</text>
<text top="483" left="744" width="6" height="11" font="3">2</text>
<text top="476" left="757" width="28" height="16" font="1">= γ</text>
<text top="483" left="785" width="18" height="11" font="3">ref</text>
<text top="476" left="805" width="5" height="16" font="1">,</text>
<text top="498" left="122" width="13" height="16" font="1">w</text>
<text top="504" left="134" width="6" height="11" font="3">3</text>
<text top="498" left="149" width="33" height="16" font="1">= ψ</text>
<text top="504" left="181" width="18" height="11" font="3">ref</text>
<text top="498" left="201" width="61" height="16" font="1">, and w</text>
<text top="504" left="262" width="6" height="11" font="3">5</text>
<text top="498" left="277" width="31" height="16" font="1">= β</text>
<text top="504" left="308" width="18" height="11" font="3">ref</text>
<text top="498" left="328" width="482" height="16" font="1">. This exosystem provides a simple example of how downhill</text>
<text top="519" left="122" width="689" height="16" font="1">ski slope trajectories can be represented by a linear exosystem, which can be extended to</text>
<text top="541" left="122" width="358" height="16" font="1">more complex reference trajectories as needed.</text>
<text top="595" left="122" width="151" height="16" font="1">Aggressive Turns</text>
<text top="635" left="122" width="204" height="16" font="1">The basic form is given by</text>
<text top="679" left="374" width="9" height="16" font="1">p</text>
<text top="686" left="383" width="18" height="11" font="3">ref</text>
<text top="679" left="418" width="86" height="16" font="1">= 0.08 cos</text>
<text top="667" left="528" width="6" height="16" font="1">t</text>
<text top="691" left="522" width="18" height="16" font="1">10</text>
<text top="728" left="375" width="8" height="16" font="1">q</text>
<text top="735" left="383" width="18" height="11" font="3">ref</text>
<text top="728" left="418" width="86" height="16" font="1">= 0.04 cos</text>
<text top="716" left="528" width="6" height="16" font="1">t</text>
<text top="741" left="522" width="18" height="16" font="1">10</text>
<text top="728" left="765" width="45" height="16" font="1">(4.11)</text>
<text top="763" left="375" width="8" height="16" font="1">r</text>
<text top="770" left="383" width="18" height="11" font="3">ref</text>
<text top="763" left="418" width="60" height="16" font="1">= 0.05</text>
<text top="797" left="122" width="439" height="16" font="1">This trajectory can be generated by the following system</text>
<text top="832" left="394" width="5" height="16" font="1">˙</text>
<text top="832" left="389" width="13" height="16" font="1">w</text>
<text top="839" left="401" width="6" height="11" font="3">1</text>
<text top="832" left="423" width="41" height="16" font="1">= w</text>
<text top="839" left="464" width="6" height="11" font="3">2</text>
<text top="858" left="394" width="5" height="16" font="1">˙</text>
<text top="858" left="389" width="13" height="16" font="1">w</text>
<text top="865" left="401" width="6" height="11" font="3">2</text>
<text top="858" left="423" width="113" height="16" font="1">= −(1/100)w</text>
<text top="865" left="536" width="6" height="11" font="3">1</text>
<text top="884" left="394" width="5" height="16" font="1">˙</text>
<text top="884" left="389" width="13" height="16" font="1">w</text>
<text top="891" left="401" width="6" height="11" font="3">3</text>
<text top="884" left="423" width="41" height="16" font="1">= w</text>
<text top="891" left="464" width="6" height="11" font="3">4</text>
<text top="884" left="765" width="45" height="16" font="1">(4.12)</text>
<text top="910" left="394" width="5" height="16" font="1">˙</text>
<text top="910" left="389" width="13" height="16" font="1">w</text>
<text top="917" left="401" width="6" height="11" font="3">4</text>
<text top="910" left="423" width="113" height="16" font="1">= −(1/100)w</text>
<text top="917" left="536" width="6" height="11" font="3">3</text>
<text top="937" left="394" width="5" height="16" font="1">˙</text>
<text top="937" left="389" width="13" height="16" font="1">w</text>
<text top="943" left="401" width="6" height="11" font="3">5</text>
<text top="937" left="423" width="37" height="16" font="1">= 0</text>
<text top="971" left="122" width="189" height="16" font="1">with initial conditions w</text>
<text top="978" left="310" width="6" height="11" font="3">1</text>
<text top="971" left="317" width="99" height="16" font="1">(0) = 0.08, w</text>
<text top="978" left="417" width="6" height="11" font="3">2</text>
<text top="971" left="424" width="77" height="16" font="1">(0) = 0, w</text>
<text top="978" left="501" width="6" height="11" font="3">3</text>
<text top="971" left="508" width="99" height="16" font="1">(0) = 0.04, w</text>
<text top="978" left="607" width="6" height="11" font="3">4</text>
<text top="971" left="614" width="110" height="16" font="1">(0) = 0 and w</text>
<text top="978" left="724" width="6" height="11" font="3">5</text>
<text top="971" left="731" width="79" height="16" font="1">(0) = 0.05</text>
<text top="993" left="122" width="87" height="16" font="1">and with w</text>
<text top="1000" left="208" width="6" height="11" font="3">1</text>
<text top="993" left="220" width="27" height="16" font="1">= p</text>
<text top="1000" left="248" width="18" height="11" font="3">ref</text>
<text top="993" left="268" width="23" height="16" font="1">, w</text>
<text top="1000" left="291" width="6" height="11" font="3">3</text>
<text top="993" left="303" width="26" height="16" font="1">= q</text>
<text top="1000" left="330" width="18" height="11" font="3">ref</text>
<text top="993" left="350" width="57" height="16" font="1">, and w</text>
<text top="1000" left="407" width="6" height="11" font="3">5</text>
<text top="993" left="419" width="27" height="16" font="1">= r</text>
<text top="1000" left="446" width="18" height="11" font="3">ref</text>
<text top="993" left="466" width="5" height="16" font="1">.</text>
<text top="1038" left="457" width="18" height="16" font="1">62</text>
</page>
<page number="72" position="absolute" top="0" left="0" height="1188" width="918">
<text top="186" left="122" width="37" height="23" font="2">4.3</text>
<text top="186" left="188" width="261" height="23" font="2">Tracking Controllers</text>
<text top="241" left="122" width="50" height="19" font="7">4.3.1</text>
<text top="241" left="195" width="419" height="19" font="7">Inverse Dynamics and Output Tracking</text>
<text top="284" left="122" width="232" height="16" font="1">Consider a system of the form</text>
<text top="331" left="389" width="82" height="16" font="1">˙x = f (x) +</text>
<text top="313" left="483" width="11" height="11" font="3">m</text>
<text top="356" left="478" width="21" height="11" font="3">i=1</text>
<text top="331" left="504" width="8" height="16" font="1">g</text>
<text top="338" left="513" width="4" height="11" font="3">i</text>
<text top="331" left="518" width="34" height="16" font="1">(x)u</text>
<text top="338" left="551" width="4" height="11" font="3">i</text>
<text top="375" left="380" width="9" height="16" font="1">y</text>
<text top="382" left="389" width="6" height="11" font="3">1</text>
<text top="375" left="401" width="29" height="16" font="1">= h</text>
<text top="382" left="429" width="6" height="11" font="3">1</text>
<text top="375" left="437" width="24" height="16" font="1">(x)</text>
<text top="375" left="765" width="45" height="16" font="1">(4.13)</text>
<text top="398" left="391" width="5" height="22" font="1">..</text>
<text top="410" left="391" width="5" height="16" font="1">.</text>
<text top="436" left="375" width="9" height="16" font="1">y</text>
<text top="443" left="384" width="11" height="11" font="3">m</text>
<text top="436" left="401" width="29" height="16" font="1">= h</text>
<text top="443" left="429" width="11" height="11" font="3">m</text>
<text top="436" left="441" width="24" height="16" font="1">(x)</text>
<text top="471" left="121" width="100" height="16" font="1">where f (x), g</text>
<text top="478" left="221" width="6" height="11" font="3">1</text>
<text top="471" left="229" width="71" height="16" font="1">(x), . . . , g</text>
<text top="478" left="300" width="11" height="11" font="3">m</text>
<text top="471" left="312" width="255" height="16" font="1">(x) are smooth vector ﬁelds and h</text>
<text top="478" left="567" width="6" height="11" font="3">1</text>
<text top="471" left="574" width="73" height="16" font="1">(x), . . . , h</text>
<text top="478" left="647" width="11" height="11" font="3">m</text>
<text top="471" left="659" width="151" height="16" font="1">(x) are smooth real-</text>
<text top="493" left="121" width="334" height="19" font="1">valued functions deﬁned in a domain D ⊂ R</text>
<text top="491" left="456" width="8" height="11" font="3">n</text>
<text top="493" left="464" width="346" height="16" font="1">. By deﬁnition, the system in Equation <a href="pdfxml.html#72">(4.13)</a></text>
<text top="515" left="121" width="146" height="16" font="1">with output y = (y</text>
<text top="521" left="267" width="6" height="11" font="3">1</text>
<text top="515" left="274" width="48" height="16" font="1">, . . . , y</text>
<text top="521" left="322" width="11" height="11" font="3">m</text>
<text top="515" left="334" width="265" height="16" font="1">) has a vector relative degree of {r</text>
<text top="521" left="599" width="6" height="11" font="3">1</text>
<text top="515" left="607" width="47" height="16" font="1">, . . . , r</text>
<text top="521" left="654" width="11" height="11" font="3">m</text>
<text top="514" left="666" width="46" height="17" font="1">} at x</text>
<text top="521" left="712" width="6" height="11" font="3">0</text>
<text top="514" left="724" width="48" height="17" font="1">∈ D if</text>
<text top="549" left="427" width="12" height="16" font="1">L</text>
<text top="556" left="439" width="6" height="11" font="3">g</text>
<text top="560" left="445" width="5" height="8" font="6">j</text>
<text top="549" left="451" width="12" height="16" font="1">L</text>
<text top="546" left="463" width="7" height="11" font="3">k</text>
<text top="558" left="463" width="6" height="11" font="3">f</text>
<text top="549" left="472" width="10" height="16" font="1">h</text>
<text top="556" left="482" width="4" height="11" font="3">i</text>
<text top="549" left="487" width="56" height="16" font="1">(x) = 0</text>
<text top="576" left="276" width="126" height="17" font="1">∀j ∈ {1, . . . , m},</text>
<text top="576" left="423" width="51" height="17" font="1">∀k &lt; r</text>
<text top="584" left="475" width="4" height="11" font="3">i</text>
<text top="576" left="484" width="32" height="17" font="1">− 1,</text>
<text top="576" left="536" width="119" height="17" font="1">∀i ∈ {1, . . . , m}</text>
<text top="563" left="765" width="45" height="16" font="1">(4.14)</text>
<text top="611" left="121" width="242" height="16" font="1">for all x in a neighborhood of x</text>
<text top="618" left="364" width="6" height="11" font="3">0</text>
<text top="611" left="377" width="116" height="16" font="1">and the matrix</text>
<text top="682" left="252" width="13" height="16" font="1">B</text>
<text top="678" left="267" width="6" height="11" font="3">∗</text>
<text top="682" left="274" width="42" height="16" font="1">(x) =</text>
<text top="642" left="321" width="12" height="8" font="1"></text>
<text top="673" left="321" width="12" height="8" font="1"></text>
<text top="684" left="321" width="12" height="8" font="1"></text>
<text top="695" left="321" width="12" height="8" font="1"></text>
<text top="706" left="321" width="12" height="8" font="1"></text>
<text top="644" left="345" width="12" height="16" font="1">L</text>
<text top="651" left="357" width="6" height="11" font="3">g</text>
<text top="655" left="363" width="5" height="8" font="6">1</text>
<text top="644" left="370" width="12" height="16" font="1">L</text>
<text top="641" left="382" width="6" height="11" font="3">r</text>
<text top="644" left="388" width="5" height="8" font="6">1</text>
<text top="640" left="394" width="16" height="11" font="3">−1</text>
<text top="654" left="382" width="6" height="11" font="3">f</text>
<text top="644" left="411" width="10" height="16" font="1">h</text>
<text top="651" left="421" width="6" height="11" font="3">1</text>
<text top="644" left="428" width="24" height="16" font="1">(x)</text>
<text top="644" left="471" width="21" height="16" font="1">. . .</text>
<text top="644" left="514" width="12" height="16" font="1">L</text>
<text top="651" left="526" width="6" height="11" font="3">g</text>
<text top="655" left="532" width="10" height="8" font="6">m</text>
<text top="644" left="544" width="12" height="16" font="1">L</text>
<text top="641" left="556" width="6" height="11" font="3">r</text>
<text top="644" left="561" width="5" height="8" font="6">1</text>
<text top="640" left="567" width="16" height="11" font="3">−1</text>
<text top="654" left="556" width="6" height="11" font="3">f</text>
<text top="644" left="584" width="10" height="16" font="1">h</text>
<text top="651" left="595" width="6" height="11" font="3">1</text>
<text top="644" left="602" width="24" height="16" font="1">(x)</text>
<text top="667" left="345" width="12" height="16" font="1">L</text>
<text top="674" left="357" width="6" height="11" font="3">g</text>
<text top="678" left="363" width="5" height="8" font="6">1</text>
<text top="667" left="370" width="12" height="16" font="1">L</text>
<text top="664" left="382" width="6" height="11" font="3">r</text>
<text top="667" left="388" width="5" height="8" font="6">2</text>
<text top="663" left="394" width="16" height="11" font="3">−1</text>
<text top="676" left="382" width="6" height="11" font="3">f</text>
<text top="667" left="411" width="10" height="16" font="1">h</text>
<text top="674" left="421" width="6" height="11" font="3">2</text>
<text top="667" left="428" width="24" height="16" font="1">(x)</text>
<text top="667" left="471" width="21" height="16" font="1">. . .</text>
<text top="667" left="514" width="12" height="16" font="1">L</text>
<text top="674" left="526" width="6" height="11" font="3">g</text>
<text top="678" left="532" width="10" height="8" font="6">m</text>
<text top="667" left="544" width="12" height="16" font="1">L</text>
<text top="664" left="556" width="6" height="11" font="3">r</text>
<text top="667" left="561" width="5" height="8" font="6">2</text>
<text top="663" left="567" width="16" height="11" font="3">−1</text>
<text top="676" left="556" width="6" height="11" font="3">f</text>
<text top="667" left="584" width="10" height="16" font="1">h</text>
<text top="674" left="595" width="6" height="11" font="3">2</text>
<text top="667" left="602" width="24" height="16" font="1">(x)</text>
<text top="685" left="396" width="5" height="22" font="1">..</text>
<text top="697" left="396" width="5" height="16" font="1">.</text>
<text top="685" left="481" width="5" height="22" font="1">..</text>
<text top="697" left="481" width="5" height="16" font="1">.</text>
<text top="685" left="567" width="5" height="22" font="1">..</text>
<text top="697" left="567" width="5" height="16" font="1">.</text>
<text top="719" left="340" width="12" height="16" font="1">L</text>
<text top="726" left="352" width="6" height="11" font="3">g</text>
<text top="730" left="358" width="5" height="8" font="6">1</text>
<text top="719" left="365" width="12" height="16" font="1">L</text>
<text top="716" left="377" width="6" height="11" font="3">r</text>
<text top="719" left="383" width="10" height="8" font="6">m</text>
<text top="715" left="393" width="16" height="11" font="3">−1</text>
<text top="728" left="377" width="6" height="11" font="3">f</text>
<text top="719" left="410" width="10" height="16" font="1">h</text>
<text top="726" left="421" width="11" height="11" font="3">m</text>
<text top="719" left="433" width="59" height="16" font="1">(x) . . .</text>
<text top="719" left="510" width="12" height="16" font="1">L</text>
<text top="726" left="522" width="6" height="11" font="3">g</text>
<text top="730" left="528" width="10" height="8" font="6">m</text>
<text top="719" left="539" width="12" height="16" font="1">L</text>
<text top="716" left="551" width="6" height="11" font="3">r</text>
<text top="719" left="557" width="10" height="8" font="6">m</text>
<text top="715" left="567" width="16" height="11" font="3">−1</text>
<text top="728" left="551" width="6" height="11" font="3">f</text>
<text top="719" left="584" width="10" height="16" font="1">h</text>
<text top="726" left="594" width="11" height="11" font="3">m</text>
<text top="719" left="606" width="24" height="16" font="1">(x)</text>
<text top="642" left="637" width="12" height="8" font="1"></text>
<text top="673" left="637" width="12" height="8" font="1"></text>
<text top="684" left="637" width="12" height="8" font="1"></text>
<text top="695" left="637" width="12" height="8" font="1"></text>
<text top="706" left="637" width="12" height="8" font="1"></text>
<text top="682" left="765" width="45" height="16" font="1">(4.15)</text>
<text top="754" left="121" width="177" height="16" font="1">is nonsingular at x = x</text>
<text top="761" left="299" width="6" height="11" font="3">0</text>
<text top="754" left="312" width="70" height="16" font="1"><a href="pdfxml.html#91">[29], </a><a href="pdfxml.html#92">[36].</a></text>
<text top="784" left="148" width="258" height="16" font="1">Diﬀerentiating each component, y</text>
<text top="791" left="406" width="4" height="11" font="3">i</text>
<text top="784" left="411" width="124" height="16" font="1">, of the output r</text>
<text top="791" left="535" width="4" height="11" font="3">i</text>
<text top="784" left="546" width="264" height="16" font="1">times and using the output and its</text>
<text top="805" left="121" width="632" height="16" font="1">derivatives to partially deﬁne a coordinate transformation in a neighborhood of x</text>
<text top="812" left="753" width="6" height="11" font="3">0</text>
<text top="805" left="766" width="44" height="16" font="1">yields</text>
<text top="827" left="121" width="159" height="16" font="1">a system of the form</text>
<text top="857" left="345" width="5" height="16" font="1">˙</text>
<text top="862" left="341" width="8" height="16" font="1">ξ</text>
<text top="859" left="349" width="4" height="11" font="3">i</text>
<text top="870" left="348" width="6" height="11" font="3">1</text>
<text top="862" left="361" width="26" height="16" font="1">= ξ</text>
<text top="859" left="388" width="4" height="11" font="3">i</text>
<text top="870" left="387" width="6" height="11" font="3">2</text>
<text top="885" left="351" width="5" height="22" font="1">..</text>
<text top="897" left="351" width="5" height="16" font="1">.</text>
<text top="921" left="324" width="5" height="16" font="1">˙</text>
<text top="926" left="320" width="8" height="16" font="1">ξ</text>
<text top="923" left="329" width="4" height="11" font="3">i</text>
<text top="935" left="328" width="6" height="11" font="3">r</text>
<text top="939" left="334" width="4" height="8" font="6">i</text>
<text top="934" left="339" width="16" height="11" font="3">−1</text>
<text top="926" left="361" width="26" height="16" font="1">= ξ</text>
<text top="923" left="388" width="4" height="11" font="3">i</text>
<text top="935" left="387" width="6" height="11" font="3">r</text>
<text top="939" left="393" width="4" height="8" font="6">i</text>
<text top="926" left="765" width="45" height="16" font="1">(4.16)</text>
<text top="963" left="340" width="5" height="16" font="1">˙</text>
<text top="968" left="337" width="8" height="16" font="1">ξ</text>
<text top="965" left="345" width="4" height="11" font="3">i</text>
<text top="976" left="344" width="6" height="11" font="3">r</text>
<text top="980" left="350" width="4" height="8" font="6">i</text>
<text top="968" left="361" width="31" height="16" font="1">= L</text>
<text top="964" left="391" width="6" height="11" font="3">r</text>
<text top="968" left="397" width="4" height="8" font="6">i</text>
<text top="977" left="391" width="6" height="11" font="3">f</text>
<text top="968" left="402" width="10" height="16" font="1">h</text>
<text top="975" left="412" width="4" height="11" font="3">i</text>
<text top="968" left="418" width="41" height="16" font="1">(x) +</text>
<text top="950" left="470" width="11" height="11" font="3">m</text>
<text top="993" left="465" width="22" height="11" font="3">j=1</text>
<text top="968" left="492" width="12" height="16" font="1">L</text>
<text top="975" left="504" width="6" height="11" font="3">g</text>
<text top="979" left="510" width="5" height="8" font="6">j</text>
<text top="968" left="516" width="12" height="16" font="1">L</text>
<text top="964" left="528" width="6" height="11" font="3">r</text>
<text top="968" left="534" width="4" height="8" font="6">i</text>
<text top="963" left="539" width="16" height="11" font="3">−1</text>
<text top="977" left="528" width="6" height="11" font="3">f</text>
<text top="968" left="556" width="10" height="16" font="1">h</text>
<text top="975" left="566" width="4" height="11" font="3">i</text>
<text top="968" left="571" width="34" height="16" font="1">(x)u</text>
<text top="975" left="604" width="5" height="11" font="3">j</text>
<text top="1038" left="457" width="18" height="16" font="1">63</text>
</page>
<page number="73" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="181" height="16" font="1">for all i ∈ {1, . . . , m}. If</text>
<text top="186" left="326" width="11" height="11" font="3">m</text>
<text top="200" left="326" width="21" height="11" font="3">i=1</text>
<text top="191" left="350" width="8" height="16" font="1">r</text>
<text top="198" left="358" width="4" height="11" font="3">i</text>
<text top="191" left="368" width="442" height="16" font="1">= n, then the output y and its derivatives completely spec-</text>
<text top="213" left="122" width="688" height="16" font="1">ify a coordinate transformation ξ = T (x) where, in transformed coordinates, the system</text>
<text top="234" left="122" width="487" height="16" font="1">has the form as in Equation <a href="pdfxml.html#72">(4.16). </a>However, in the case where</text>
<text top="244" left="633" width="4" height="11" font="3">i</text>
<text top="234" left="641" width="8" height="16" font="1">r</text>
<text top="241" left="649" width="4" height="11" font="3">i</text>
<text top="234" left="659" width="151" height="16" font="1">&lt; n, the coordinate</text>
<text top="256" left="122" width="689" height="16" font="1">transformation T (x) is only partially deﬁned by y and its derivatives. In order to complete</text>
<text top="278" left="122" width="376" height="16" font="1">the coordinate transformation we must ﬁnd n −</text>
<text top="287" left="521" width="4" height="11" font="3">i</text>
<text top="278" left="529" width="8" height="16" font="1">r</text>
<text top="285" left="537" width="4" height="11" font="3">i</text>
<text top="278" left="548" width="262" height="16" font="1">additional functions and augment</text>
<text top="299" left="122" width="689" height="16" font="1">them to the output and its derivatives. In doing so we can obtain a valid coordinate trans-</text>
<text top="321" left="122" width="435" height="16" font="1">formation (η, ξ) = T (x) deﬁned in a neighborhood of x</text>
<text top="328" left="556" width="6" height="11" font="3">0</text>
<text top="321" left="563" width="247" height="16" font="1">. In general one cannot impose</text>
<text top="343" left="122" width="688" height="16" font="1">any particular structure to the additional states η and their evolution will be described by</text>
<text top="364" left="122" width="233" height="16" font="1">a general equation of the form</text>
<text top="396" left="371" width="5" height="16" font="1">˙</text>
<text top="396" left="368" width="165" height="16" font="1">η = q(ξ, η) + p(ξ, η)u.</text>
<text top="396" left="765" width="45" height="16" font="1">(4.17)</text>
<text top="428" left="122" width="255" height="16" font="1">Setting η = 0 and u = 0 yields ˙</text>
<text top="428" left="369" width="441" height="16" font="1">η = q(ξ, 0) which are the zero dynamics of the system in</text>
<text top="449" left="122" width="689" height="16" font="1">Equation <a href="pdfxml.html#72">(4.13). </a>The system in Equation <a href="pdfxml.html#72">(4.13) </a>is minimum phase if these zero dynamics</text>
<text top="471" left="122" width="568" height="16" font="1">have an asymptotically stable equilibrium point in the domain of interest.</text>
<text top="499" left="148" width="415" height="16" font="1">When the output y yields a vector relative degree {r</text>
<text top="506" left="563" width="6" height="11" font="3">1</text>
<text top="499" left="570" width="47" height="16" font="1">, . . . , r</text>
<text top="506" left="617" width="11" height="11" font="3">m</text>
<text top="498" left="629" width="50" height="17" font="1">} with</text>
<text top="509" left="705" width="4" height="11" font="3">i</text>
<text top="499" left="713" width="8" height="16" font="1">r</text>
<text top="506" left="721" width="4" height="11" font="3">i</text>
<text top="499" left="733" width="77" height="16" font="1">&lt; n, then</text>
<text top="521" left="122" width="689" height="16" font="1">one can appeal to diﬀerential ﬂatness or dynamic feedback linearization to obtain a system</text>
<text top="543" left="122" width="689" height="16" font="1">that is linear in transformed coordinates via the use of dynamic feedback. Speciﬁcally, in</text>
<text top="564" left="122" width="689" height="16" font="1">dynamic feedback linearization, sometimes called dynamic extension, state variables are</text>
<text top="586" left="122" width="689" height="16" font="1">introduced in the controller that correspond to a chain of integrators in order to obtain a</text>
<text top="608" left="122" width="111" height="16" font="1">relative degree</text>
<text top="624" left="421" width="11" height="11" font="3">m</text>
<text top="667" left="417" width="21" height="11" font="3">i=1</text>
<text top="642" left="444" width="9" height="16" font="1">˜</text>
<text top="642" left="443" width="8" height="16" font="1">r</text>
<text top="649" left="451" width="4" height="11" font="3">i</text>
<text top="642" left="461" width="59" height="16" font="1">= n + v</text>
<text top="642" left="765" width="45" height="16" font="1">(4.18)</text>
<text top="686" left="122" width="63" height="16" font="1">where ˜</text>
<text top="686" left="174" width="8" height="16" font="1">r</text>
<text top="693" left="182" width="4" height="11" font="3">i</text>
<text top="686" left="187" width="400" height="16" font="1">, i ∈ {1, . . . , m} is the number of derivatives of y</text>
<text top="693" left="588" width="4" height="11" font="3">i</text>
<text top="686" left="601" width="209" height="16" font="1">that must be taken before</text>
<text top="707" left="122" width="688" height="16" font="1">a control input appears and v is the number of additional states introduced in by the</text>
<text top="729" left="122" width="689" height="16" font="1">controller. In other words, by adding integrators in the controller, the appearance of the</text>
<text top="751" left="122" width="689" height="16" font="1">control input in the derivatives of y is delayed until the desired relative degree is obtained.</text>
<text top="779" left="148" width="230" height="16" font="1">In either the static case when</text>
<text top="789" left="403" width="4" height="11" font="3">i</text>
<text top="779" left="411" width="8" height="16" font="1">r</text>
<text top="786" left="419" width="4" height="11" font="3">i</text>
<text top="779" left="430" width="243" height="16" font="1">= n, or the dynamic case when</text>
<text top="789" left="698" width="4" height="11" font="3">i</text>
<text top="779" left="707" width="9" height="16" font="1">˜</text>
<text top="779" left="706" width="8" height="16" font="1">r</text>
<text top="786" left="714" width="4" height="11" font="3">i</text>
<text top="779" left="725" width="85" height="16" font="1">= n + v, it</text>
<text top="801" left="122" width="688" height="16" font="1">is possible to deﬁne a regular feedback transformation that when applied to the system in</text>
<text top="822" left="122" width="621" height="16" font="1">Equation <a href="pdfxml.html#72">(4.16) </a>yields a controllable linear system with m chains of integrators ξ</text>
<text top="829" left="743" width="6" height="11" font="3">1</text>
<text top="822" left="750" width="47" height="16" font="1">, . . . , ξ</text>
<text top="829" left="797" width="8" height="11" font="3">n</text>
<text top="822" left="805" width="5" height="16" font="1">.</text>
<text top="844" left="122" width="623" height="16" font="1">The highest order derivatives from the system can be grouped together to obtain</text>
<text top="874" left="317" width="5" height="16" font="1">˙</text>
<text top="880" left="310" width="8" height="16" font="1">ξ</text>
<text top="879" left="318" width="6" height="11" font="3">1</text>
<text top="888" left="318" width="5" height="11" font="3">r</text>
<text top="892" left="323" width="5" height="8" font="6">1</text>
<text top="874" left="352" width="5" height="16" font="1">˙</text>
<text top="880" left="344" width="8" height="16" font="1">ξ</text>
<text top="879" left="353" width="6" height="11" font="3">2</text>
<text top="888" left="352" width="5" height="11" font="3">r</text>
<text top="892" left="357" width="5" height="8" font="6">2</text>
<text top="880" left="379" width="21" height="16" font="1">. . .</text>
<text top="875" left="427" width="5" height="16" font="1">˙</text>
<text top="880" left="418" width="8" height="16" font="1">ξ</text>
<text top="879" left="426" width="11" height="11" font="3">m</text>
<text top="888" left="425" width="5" height="11" font="3">r</text>
<text top="892" left="430" width="9" height="8" font="6">m</text>
<text top="871" left="456" width="7" height="11" font="3">T</text>
<text top="879" left="470" width="32" height="16" font="1">= A</text>
<text top="875" left="502" width="6" height="11" font="3">∗</text>
<text top="879" left="509" width="59" height="16" font="1">(x) + B</text>
<text top="875" left="569" width="6" height="11" font="3">∗</text>
<text top="879" left="576" width="34" height="16" font="1">(x)u</text>
<text top="879" left="765" width="45" height="16" font="1">(4.19)</text>
<text top="910" left="122" width="64" height="16" font="1">where B</text>
<text top="907" left="186" width="6" height="11" font="3">∗</text>
<text top="910" left="194" width="606" height="16" font="1">(x) (also known as the decoupling matrix) is as deﬁned in Equation <a href="pdfxml.html#72">(4.15) </a>and</text>
<text top="969" left="356" width="13" height="16" font="1">A</text>
<text top="965" left="369" width="6" height="11" font="3">∗</text>
<text top="969" left="377" width="42" height="16" font="1">(x) =</text>
<text top="939" left="424" width="12" height="8" font="1"></text>
<text top="970" left="424" width="12" height="8" font="1"></text>
<text top="982" left="424" width="12" height="8" font="1"></text>
<text top="942" left="448" width="12" height="16" font="1">L</text>
<text top="938" left="460" width="6" height="11" font="3">r</text>
<text top="942" left="466" width="5" height="8" font="6">1</text>
<text top="951" left="460" width="6" height="11" font="3">f</text>
<text top="942" left="473" width="10" height="16" font="1">h</text>
<text top="949" left="483" width="6" height="11" font="3">1</text>
<text top="942" left="490" width="24" height="16" font="1">(x)</text>
<text top="960" left="478" width="5" height="22" font="1">..</text>
<text top="972" left="478" width="5" height="16" font="1">.</text>
<text top="994" left="443" width="12" height="16" font="1">L</text>
<text top="990" left="455" width="6" height="11" font="3">r</text>
<text top="994" left="461" width="10" height="8" font="6">m</text>
<text top="1003" left="455" width="6" height="11" font="3">f</text>
<text top="994" left="472" width="10" height="16" font="1">h</text>
<text top="1001" left="482" width="11" height="11" font="3">m</text>
<text top="994" left="494" width="24" height="16" font="1">(x)</text>
<text top="939" left="525" width="12" height="8" font="1"></text>
<text top="970" left="525" width="12" height="8" font="1"></text>
<text top="982" left="525" width="12" height="8" font="1"></text>
<text top="969" left="540" width="5" height="16" font="1">.</text>
<text top="969" left="765" width="45" height="16" font="1">(4.20)</text>
<text top="1038" left="457" width="18" height="16" font="1">64</text>
</page>
<page number="74" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="59" height="16" font="1">Since B</text>
<text top="188" left="182" width="6" height="11" font="3">∗</text>
<text top="191" left="195" width="161" height="16" font="1">is nonsingular near x</text>
<text top="198" left="356" width="6" height="11" font="3">0</text>
<text top="191" left="363" width="139" height="16" font="1">, the feedback law</text>
<text top="231" left="371" width="47" height="16" font="1">u = B</text>
<text top="227" left="419" width="6" height="11" font="3">∗</text>
<text top="231" left="426" width="24" height="16" font="1">(x)</text>
<text top="227" left="450" width="16" height="11" font="3">−1</text>
<text top="231" left="467" width="51" height="16" font="1">(v − A</text>
<text top="227" left="518" width="6" height="11" font="3">∗</text>
<text top="231" left="525" width="35" height="16" font="1">(x)),</text>
<text top="231" left="765" width="45" height="16" font="1">(4.21)</text>
<text top="270" left="122" width="94" height="19" font="1">where v ∈ R</text>
<text top="268" left="216" width="11" height="11" font="3">m</text>
<text top="270" left="233" width="512" height="16" font="1">is an auxiliary control input, is well-deﬁned in a neighborhood of x</text>
<text top="277" left="745" width="6" height="11" font="3">0</text>
<text top="270" left="752" width="58" height="16" font="1">. When</text>
<text top="292" left="122" width="689" height="16" font="1">the controller in Equation <a href="pdfxml.html#74">(4.21) </a>is applied to Equation <a href="pdfxml.html#72">(4.13) </a>a controllable linear system</text>
<text top="314" left="122" width="84" height="16" font="1">is obtained</text>
<text top="424" left="352" width="5" height="16" font="1">˙</text>
<text top="429" left="349" width="27" height="16" font="1">ξ =</text>
<text top="345" left="381" width="12" height="8" font="1"></text>
<text top="377" left="381" width="12" height="8" font="1"></text>
<text top="388" left="381" width="12" height="8" font="1"></text>
<text top="399" left="381" width="12" height="8" font="1"></text>
<text top="409" left="381" width="12" height="8" font="1"></text>
<text top="420" left="381" width="12" height="8" font="1"></text>
<text top="431" left="381" width="12" height="8" font="1"></text>
<text top="442" left="381" width="12" height="8" font="1"></text>
<text top="452" left="381" width="12" height="8" font="1"></text>
<text top="463" left="381" width="12" height="8" font="1"></text>
<text top="474" left="381" width="12" height="8" font="1"></text>
<text top="485" left="381" width="12" height="8" font="1"></text>
<text top="496" left="381" width="12" height="8" font="1"></text>
<text top="346" left="409" width="5" height="16" font="1">˙</text>
<text top="351" left="405" width="8" height="16" font="1">ξ</text>
<text top="349" left="413" width="6" height="11" font="3">1</text>
<text top="360" left="412" width="6" height="11" font="3">1</text>
<text top="368" left="410" width="5" height="22" font="1">..</text>
<text top="380" left="410" width="5" height="16" font="1">.</text>
<text top="399" left="406" width="5" height="16" font="1">˙</text>
<text top="403" left="402" width="8" height="16" font="1">ξ</text>
<text top="401" left="411" width="6" height="11" font="3">1</text>
<text top="412" left="410" width="6" height="11" font="3">r</text>
<text top="416" left="416" width="5" height="8" font="6">1</text>
<text top="421" left="410" width="5" height="22" font="1">..</text>
<text top="433" left="410" width="5" height="16" font="1">.</text>
<text top="451" left="406" width="5" height="16" font="1">˙</text>
<text top="456" left="402" width="8" height="16" font="1">ξ</text>
<text top="453" left="411" width="11" height="11" font="3">m</text>
<text top="464" left="410" width="6" height="11" font="3">1</text>
<text top="473" left="410" width="5" height="22" font="1">..</text>
<text top="485" left="410" width="5" height="16" font="1">.</text>
<text top="503" left="404" width="5" height="16" font="1">˙</text>
<text top="508" left="400" width="8" height="16" font="1">ξ</text>
<text top="506" left="409" width="11" height="11" font="3">m</text>
<text top="517" left="408" width="6" height="11" font="3">r</text>
<text top="520" left="414" width="10" height="8" font="6">m</text>
<text top="345" left="432" width="12" height="8" font="1"></text>
<text top="377" left="432" width="12" height="8" font="1"></text>
<text top="388" left="432" width="12" height="8" font="1"></text>
<text top="399" left="432" width="12" height="8" font="1"></text>
<text top="409" left="432" width="12" height="8" font="1"></text>
<text top="420" left="432" width="12" height="8" font="1"></text>
<text top="431" left="432" width="12" height="8" font="1"></text>
<text top="442" left="432" width="12" height="8" font="1"></text>
<text top="452" left="432" width="12" height="8" font="1"></text>
<text top="463" left="432" width="12" height="8" font="1"></text>
<text top="474" left="432" width="12" height="8" font="1"></text>
<text top="485" left="432" width="12" height="8" font="1"></text>
<text top="496" left="432" width="12" height="8" font="1"></text>
<text top="429" left="449" width="32" height="16" font="1">= A</text>
<text top="436" left="481" width="6" height="11" font="3">1</text>
<text top="429" left="488" width="44" height="16" font="1">ξ + B</text>
<text top="436" left="532" width="6" height="11" font="3">1</text>
<text top="429" left="539" width="14" height="16" font="1">v.</text>
<text top="429" left="765" width="45" height="16" font="1">(4.22)</text>
<text top="549" left="122" width="689" height="16" font="1">Using the internal model approach by Wonham and Francis <a href="pdfxml.html#90">[16], </a>controllers can now be</text>
<text top="570" left="122" width="689" height="16" font="1">designed that will track trajectories generated by LTI exosystems like those presented in</text>
<text top="592" left="122" width="532" height="16" font="1">Equations <a href="pdfxml.html#70">(4.8) </a>and <a href="pdfxml.html#71">(4.10). </a>To this end, this system is augmented by</text>
<text top="632" left="400" width="5" height="16" font="1">˙</text>
<text top="632" left="394" width="70" height="16" font="1">w = A</text>
<text top="639" left="464" width="6" height="11" font="3">2</text>
<text top="632" left="471" width="13" height="16" font="1">w</text>
<text top="658" left="399" width="66" height="16" font="1">e = D</text>
<text top="665" left="465" width="6" height="11" font="3">1</text>
<text top="658" left="472" width="45" height="16" font="1">ξ + D</text>
<text top="665" left="517" width="6" height="11" font="3">2</text>
<text top="658" left="524" width="13" height="16" font="1">w</text>
<text top="658" left="765" width="45" height="16" font="1">(4.23)</text>
<text top="697" left="122" width="689" height="16" font="1">where ξ is the state of the system in Equation <a href="pdfxml.html#74">(4.22), </a>w is the state of the exosystem</text>
<text top="719" left="122" width="538" height="16" font="1">and e is the tracking error. The problem is solvable if and only if A</text>
<text top="726" left="659" width="6" height="11" font="3">2</text>
<text top="719" left="673" width="137" height="16" font="1">has only unstable</text>
<text top="741" left="122" width="116" height="16" font="1">eigenvalues, (A</text>
<text top="748" left="237" width="6" height="11" font="3">1</text>
<text top="741" left="244" width="21" height="16" font="1">, B</text>
<text top="748" left="265" width="6" height="11" font="3">1</text>
<text top="741" left="273" width="460" height="16" font="1">) is stabilizable and there exist matrices X and U such that</text>
<text top="780" left="444" width="15" height="16" font="1">D</text>
<text top="787" left="458" width="6" height="11" font="3">1</text>
<text top="780" left="465" width="52" height="16" font="1">X + D</text>
<text top="787" left="518" width="6" height="11" font="3">2</text>
<text top="780" left="530" width="27" height="16" font="1">= 0</text>
<text top="807" left="374" width="13" height="16" font="1">A</text>
<text top="813" left="388" width="6" height="11" font="3">1</text>
<text top="807" left="395" width="67" height="16" font="1">X − XA</text>
<text top="813" left="462" width="6" height="11" font="3">2</text>
<text top="807" left="473" width="31" height="16" font="1">+ B</text>
<text top="813" left="504" width="6" height="11" font="3">1</text>
<text top="807" left="511" width="46" height="16" font="1">U = 0</text>
<text top="807" left="765" width="45" height="16" font="1">(4.24)</text>
<text top="846" left="122" width="496" height="16" font="1">Once X and U are found, the resulting controller takes the form</text>
<text top="886" left="409" width="44" height="16" font="1">v = F</text>
<text top="893" left="453" width="6" height="11" font="3">1</text>
<text top="886" left="461" width="41" height="16" font="1">q + F</text>
<text top="893" left="502" width="6" height="11" font="3">2</text>
<text top="886" left="509" width="13" height="16" font="1">w</text>
<text top="886" left="765" width="45" height="16" font="1">(4.25)</text>
<text top="925" left="122" width="62" height="16" font="1">where F</text>
<text top="932" left="184" width="6" height="11" font="3">1</text>
<text top="925" left="197" width="165" height="16" font="1">is chosen such that A</text>
<text top="932" left="361" width="6" height="11" font="3">1</text>
<text top="925" left="372" width="31" height="16" font="1">+ B</text>
<text top="932" left="403" width="6" height="11" font="3">1</text>
<text top="925" left="410" width="11" height="16" font="1">F</text>
<text top="932" left="422" width="6" height="11" font="3">1</text>
<text top="925" left="435" width="131" height="16" font="1">is Hurwitz and F</text>
<text top="932" left="566" width="6" height="11" font="3">2</text>
<text top="925" left="578" width="66" height="16" font="1">= U − F</text>
<text top="932" left="643" width="6" height="11" font="3">1</text>
<text top="925" left="651" width="21" height="16" font="1">X.</text>
<text top="1038" left="457" width="18" height="16" font="1">65</text>
</page>
<page number="75" position="absolute" top="0" left="0" height="1188" width="918">
<text top="189" left="122" width="50" height="19" font="7">4.3.2</text>
<text top="189" left="195" width="218" height="19" font="7">Simple Flight Model</text>
<text top="233" left="122" width="689" height="16" font="1">The kinematic aircraft model from Section <a href="pdfxml.html#68">(4.2.1) </a>has a well deﬁned vector relative degree</text>
<text top="255" left="122" width="688" height="16" font="1">of {2, 2, 2} at each point in the regions of interest for our application. To see this, note</text>
<text top="277" left="121" width="226" height="16" font="1">that the decoupling matrix B</text>
<text top="274" left="349" width="6" height="11" font="3">∗</text>
<text top="277" left="362" width="82" height="16" font="1">is given by</text>
<text top="336" left="244" width="13" height="16" font="1">B</text>
<text top="333" left="258" width="6" height="11" font="3">∗</text>
<text top="336" left="270" width="14" height="16" font="1">=</text>
<text top="312" left="289" width="12" height="8" font="1"></text>
<text top="344" left="289" width="12" height="8" font="1"></text>
<text top="315" left="308" width="322" height="16" font="1">cos γ cos ψ −V cos ψ sin γ −V cos γ sin ψ</text>
<text top="336" left="309" width="76" height="16" font="1">cos γ sin ψ</text>
<text top="335" left="402" width="105" height="17" font="1">−V sin γ sin ψ</text>
<text top="336" left="529" width="95" height="16" font="1">V cos γ cos ψ</text>
<text top="357" left="321" width="51" height="17" font="1">− sin γ</text>
<text top="357" left="421" width="67" height="17" font="1">−V cos γ</text>
<text top="358" left="573" width="9" height="16" font="1">0</text>
<text top="312" left="638" width="12" height="8" font="1"></text>
<text top="344" left="638" width="12" height="8" font="1"></text>
<text top="336" left="653" width="5" height="16" font="1">.</text>
<text top="336" left="765" width="45" height="16" font="1">(4.26)</text>
<text top="398" left="122" width="288" height="16" font="1">This matrix is singular if and only if V</text>
<text top="396" left="413" width="6" height="11" font="3">2</text>
<text top="398" left="424" width="386" height="16" font="1">cos γ = 0, which corresponds to either a zero veloc-</text>
<text top="420" left="122" width="203" height="16" font="1">ity or a climb angle of γ =</text>
<text top="417" left="331" width="7" height="11" font="3">π</text>
<text top="430" left="332" width="6" height="11" font="3">2</text>
<text top="420" left="340" width="470" height="16" font="1">. The decoupling matrix is therefore invertible during normal</text>
<text top="441" left="122" width="688" height="16" font="1">ﬂight conditions. We conclude that the output y = x yields a well-deﬁned relative degree</text>
<text top="463" left="122" width="180" height="16" font="1">almost everywhere and</text>
<text top="459" left="328" width="6" height="11" font="3">3</text>
<text top="473" left="328" width="21" height="11" font="3">i=1</text>
<text top="463" left="352" width="8" height="16" font="1">r</text>
<text top="470" left="360" width="4" height="11" font="3">i</text>
<text top="463" left="373" width="437" height="16" font="1">= 6 which implies that the system is feedback lineariz-</text>
<text top="485" left="122" width="689" height="16" font="1">able via a static controller. The corresponding coordinate transformation, as discussed in</text>
<text top="506" left="122" width="201" height="16" font="1">section <a href="pdfxml.html#72">(4.3.1), </a>is given by</text>
<text top="543" left="385" width="12" height="8" font="1"></text>
<text top="575" left="385" width="12" height="8" font="1"></text>
<text top="586" left="385" width="12" height="8" font="1"></text>
<text top="596" left="385" width="12" height="8" font="1"></text>
<text top="607" left="385" width="12" height="8" font="1"></text>
<text top="618" left="385" width="12" height="8" font="1"></text>
<text top="629" left="385" width="12" height="8" font="1"></text>
<text top="640" left="385" width="12" height="8" font="1"></text>
<text top="546" left="405" width="8" height="16" font="1">ξ</text>
<text top="543" left="413" width="6" height="11" font="3">1</text>
<text top="554" left="412" width="6" height="11" font="3">1</text>
<text top="567" left="405" width="8" height="16" font="1">ξ</text>
<text top="565" left="413" width="6" height="11" font="3">1</text>
<text top="576" left="412" width="6" height="11" font="3">2</text>
<text top="589" left="405" width="8" height="16" font="1">ξ</text>
<text top="587" left="413" width="6" height="11" font="3">2</text>
<text top="597" left="412" width="6" height="11" font="3">1</text>
<text top="611" left="405" width="8" height="16" font="1">ξ</text>
<text top="608" left="413" width="6" height="11" font="3">2</text>
<text top="619" left="412" width="6" height="11" font="3">2</text>
<text top="632" left="405" width="8" height="16" font="1">ξ</text>
<text top="630" left="413" width="6" height="11" font="3">3</text>
<text top="641" left="412" width="6" height="11" font="3">1</text>
<text top="654" left="405" width="8" height="16" font="1">ξ</text>
<text top="652" left="413" width="6" height="11" font="3">3</text>
<text top="662" left="412" width="6" height="11" font="3">2</text>
<text top="543" left="428" width="12" height="8" font="1"></text>
<text top="575" left="428" width="12" height="8" font="1"></text>
<text top="586" left="428" width="12" height="8" font="1"></text>
<text top="596" left="428" width="12" height="8" font="1"></text>
<text top="607" left="428" width="12" height="8" font="1"></text>
<text top="618" left="428" width="12" height="8" font="1"></text>
<text top="629" left="428" width="12" height="8" font="1"></text>
<text top="640" left="428" width="12" height="8" font="1"></text>
<text top="600" left="445" width="14" height="16" font="1">=</text>
<text top="543" left="463" width="12" height="8" font="1"></text>
<text top="575" left="463" width="12" height="8" font="1"></text>
<text top="586" left="463" width="12" height="8" font="1"></text>
<text top="596" left="463" width="12" height="8" font="1"></text>
<text top="607" left="463" width="12" height="8" font="1"></text>
<text top="618" left="463" width="12" height="8" font="1"></text>
<text top="629" left="463" width="12" height="8" font="1"></text>
<text top="640" left="463" width="12" height="8" font="1"></text>
<text top="546" left="483" width="10" height="16" font="1">x</text>
<text top="552" left="493" width="6" height="11" font="3">1</text>
<text top="567" left="489" width="5" height="16" font="1">˙</text>
<text top="567" left="483" width="10" height="16" font="1">x</text>
<text top="574" left="493" width="6" height="11" font="3">1</text>
<text top="589" left="483" width="10" height="16" font="1">x</text>
<text top="596" left="493" width="6" height="11" font="3">2</text>
<text top="611" left="489" width="5" height="16" font="1">˙</text>
<text top="611" left="483" width="10" height="16" font="1">x</text>
<text top="617" left="493" width="6" height="11" font="3">2</text>
<text top="632" left="483" width="10" height="16" font="1">x</text>
<text top="639" left="493" width="6" height="11" font="3">3</text>
<text top="654" left="489" width="5" height="16" font="1">˙</text>
<text top="654" left="483" width="10" height="16" font="1">x</text>
<text top="661" left="493" width="6" height="11" font="3">3</text>
<text top="543" left="507" width="12" height="8" font="1"></text>
<text top="575" left="507" width="12" height="8" font="1"></text>
<text top="586" left="507" width="12" height="8" font="1"></text>
<text top="596" left="507" width="12" height="8" font="1"></text>
<text top="607" left="507" width="12" height="8" font="1"></text>
<text top="618" left="507" width="12" height="8" font="1"></text>
<text top="629" left="507" width="12" height="8" font="1"></text>
<text top="640" left="507" width="12" height="8" font="1"></text>
<text top="600" left="765" width="45" height="16" font="1">(4.27)</text>
<text top="692" left="122" width="512" height="16" font="1">and is valid in a neighborhood of any point at which V = 0 and γ =</text>
<text top="689" left="640" width="7" height="11" font="3">π</text>
<text top="703" left="641" width="6" height="11" font="3">2</text>
<text top="692" left="650" width="160" height="16" font="1">. The static feedback</text>
<text top="714" left="122" width="258" height="16" font="1">linearizing control law is given by</text>
<text top="736" left="425" width="47" height="16" font="1">u = B</text>
<text top="732" left="473" width="23" height="11" font="3">∗−1</text>
<text top="736" left="497" width="8" height="16" font="1">v</text>
<text top="736" left="765" width="45" height="16" font="1">(4.28)</text>
<text top="767" left="122" width="78" height="16" font="1">because A</text>
<text top="764" left="199" width="6" height="11" font="3">∗</text>
<text top="767" left="211" width="599" height="16" font="1">= 0 in this case. The auxiliary control input v can be designed for tracking an</text>
<text top="789" left="122" width="613" height="16" font="1">elliptical trajectory. The exosystem in Equation <a href="pdfxml.html#70">(4.8) </a>results in a tracking error</text>
<text top="831" left="310" width="27" height="16" font="1">e =</text>
<text top="831" left="357" width="13" height="16" font="1">w</text>
<text top="838" left="369" width="6" height="11" font="3">1</text>
<text top="830" left="380" width="26" height="17" font="1">− ξ</text>
<text top="829" left="407" width="6" height="11" font="3">1</text>
<text top="840" left="406" width="6" height="11" font="3">1</text>
<text top="831" left="429" width="13" height="16" font="1">w</text>
<text top="838" left="441" width="6" height="11" font="3">3</text>
<text top="830" left="452" width="26" height="17" font="1">− ξ</text>
<text top="829" left="479" width="6" height="11" font="3">2</text>
<text top="840" left="478" width="6" height="11" font="3">1</text>
<text top="831" left="501" width="13" height="16" font="1">w</text>
<text top="838" left="514" width="6" height="11" font="3">5</text>
<text top="830" left="525" width="26" height="17" font="1">− ξ</text>
<text top="829" left="551" width="6" height="11" font="3">3</text>
<text top="840" left="550" width="6" height="11" font="3">1</text>
<text top="831" left="587" width="5" height="16" font="1">.</text>
<text top="831" left="765" width="45" height="16" font="1">(4.29)</text>
<text top="871" left="122" width="215" height="16" font="1">By appropriately deﬁning D</text>
<text top="878" left="337" width="6" height="11" font="3">1</text>
<text top="871" left="349" width="48" height="16" font="1">and D</text>
<text top="878" left="397" width="6" height="11" font="3">2</text>
<text top="871" left="409" width="401" height="16" font="1">based on Equation <a href="pdfxml.html#75">(4.29), </a>the matrices X and U can</text>
<text top="893" left="122" width="412" height="16" font="1">be found by solving Equation <a href="pdfxml.html#74">(4.24). </a>Furthermore, F</text>
<text top="900" left="534" width="6" height="11" font="3">1</text>
<text top="893" left="541" width="269" height="16" font="1">, can be suitably picked depending</text>
<text top="914" left="122" width="689" height="16" font="1">on the magnitude of gains required for minimizing e and v can then be computed using</text>
<text top="936" left="122" width="126" height="16" font="1">Equation <a href="pdfxml.html#74">(4.25).</a></text>
<text top="1038" left="457" width="18" height="16" font="1">66</text>
</page>
<page number="76" position="absolute" top="0" left="0" height="1188" width="918">
<text top="189" left="122" width="50" height="19" font="7">4.3.3</text>
<text top="189" left="195" width="278" height="19" font="7">Coordinated Flight Model</text>
<text top="233" left="122" width="337" height="16" font="1">The coordinated ﬂight model with 7 states (x</text>
<text top="240" left="459" width="6" height="11" font="3">1</text>
<text top="233" left="466" width="18" height="16" font="1">, x</text>
<text top="240" left="484" width="6" height="11" font="3">2</text>
<text top="233" left="491" width="18" height="16" font="1">, x</text>
<text top="240" left="509" width="6" height="11" font="3">3</text>
<text top="233" left="516" width="18" height="16" font="1">, ˙x</text>
<text top="240" left="534" width="6" height="11" font="3">1</text>
<text top="233" left="541" width="18" height="16" font="1">, ˙x</text>
<text top="240" left="559" width="6" height="11" font="3">2</text>
<text top="233" left="566" width="18" height="16" font="1">, ˙x</text>
<text top="240" left="584" width="6" height="11" font="3">3</text>
<text top="233" left="591" width="170" height="16" font="1">, R) and output y = (x</text>
<text top="240" left="760" width="6" height="11" font="3">1</text>
<text top="233" left="767" width="18" height="16" font="1">, x</text>
<text top="240" left="785" width="6" height="11" font="3">2</text>
<text top="233" left="792" width="18" height="16" font="1">, x</text>
<text top="240" left="810" width="6" height="11" font="3">3</text>
<text top="233" left="817" width="7" height="16" font="1">)</text>
<text top="255" left="121" width="689" height="16" font="1">as described in Section <a href="pdfxml.html#68">(4.2) </a>has a well deﬁned vector relative degree of {2, 2, 2} but</text>
<text top="272" left="140" width="6" height="11" font="3">3</text>
<text top="286" left="140" width="21" height="11" font="3">i=1</text>
<text top="277" left="165" width="8" height="16" font="1">r</text>
<text top="283" left="173" width="4" height="11" font="3">i</text>
<text top="277" left="185" width="625" height="16" font="1">= 6 &lt; 7 and therefore static feedback cannot be used to feedback linearize this</text>
<text top="298" left="121" width="689" height="16" font="1">system. In order to obtain a fully linear system in transformed coordinates, two new</text>
<text top="320" left="121" width="688" height="16" font="1">states need to be added to the system by adding integrators on two of the inputs. The</text>
<text top="342" left="121" width="345" height="16" font="1">resulting system will have 9 states (x, ˙x, R, a</text>
<text top="339" left="467" width="9" height="11" font="3">w</text>
<text top="350" left="467" width="6" height="11" font="3">1</text>
<text top="342" left="477" width="17" height="16" font="1">, a</text>
<text top="339" left="494" width="9" height="11" font="3">w</text>
<text top="350" left="494" width="6" height="11" font="3">3</text>
<text top="342" left="504" width="306" height="16" font="1">) with a well deﬁned vector relative de-</text>
<text top="363" left="121" width="78" height="16" font="1">gree of {˜</text>
<text top="363" left="190" width="8" height="16" font="1">r</text>
<text top="370" left="198" width="6" height="11" font="3">1</text>
<text top="363" left="205" width="17" height="16" font="1">, ˜</text>
<text top="363" left="213" width="8" height="16" font="1">r</text>
<text top="370" left="221" width="6" height="11" font="3">2</text>
<text top="363" left="228" width="17" height="16" font="1">, ˜</text>
<text top="363" left="236" width="8" height="16" font="1">r</text>
<text top="370" left="244" width="6" height="11" font="3">3</text>
<text top="362" left="251" width="559" height="17" font="1">} = {3, 3, 3}. The system can equivalently be expressed in coordinates</text>
<text top="385" left="122" width="17" height="16" font="1">(x</text>
<text top="392" left="138" width="6" height="11" font="3">1</text>
<text top="385" left="145" width="18" height="16" font="1">, ˙x</text>
<text top="392" left="163" width="6" height="11" font="3">1</text>
<text top="385" left="170" width="18" height="16" font="1">, ¨</text>
<text top="385" left="178" width="10" height="16" font="1">x</text>
<text top="392" left="188" width="6" height="11" font="3">1</text>
<text top="385" left="195" width="18" height="16" font="1">, x</text>
<text top="392" left="213" width="6" height="11" font="3">2</text>
<text top="385" left="220" width="18" height="16" font="1">, ˙x</text>
<text top="392" left="238" width="6" height="11" font="3">2</text>
<text top="385" left="245" width="18" height="16" font="1">, ¨</text>
<text top="385" left="253" width="10" height="16" font="1">x</text>
<text top="392" left="263" width="6" height="11" font="3">2</text>
<text top="385" left="270" width="18" height="16" font="1">, x</text>
<text top="392" left="288" width="6" height="11" font="3">3</text>
<text top="385" left="295" width="18" height="16" font="1">, ˙x</text>
<text top="392" left="313" width="6" height="11" font="3">3</text>
<text top="385" left="320" width="18" height="16" font="1">, ¨</text>
<text top="385" left="328" width="10" height="16" font="1">x</text>
<text top="392" left="338" width="6" height="11" font="3">3</text>
<text top="385" left="345" width="427" height="16" font="1">) as shown in <a href="pdfxml.html#91">[23]. </a>The new control inputs are given by</text>
<text top="446" left="408" width="47" height="16" font="1">u = R</text>
<text top="421" left="458" width="12" height="8" font="1"></text>
<text top="454" left="458" width="12" height="8" font="1"></text>
<text top="424" left="481" width="7" height="16" font="1">˙a</text>
<text top="422" left="488" width="6" height="11" font="3">v</text>
<text top="433" left="488" width="6" height="11" font="3">1</text>
<text top="446" left="477" width="9" height="16" font="1">p</text>
<text top="452" left="486" width="9" height="11" font="3">w</text>
<text top="467" left="481" width="7" height="16" font="1">˙a</text>
<text top="465" left="488" width="6" height="11" font="3">v</text>
<text top="476" left="488" width="6" height="11" font="3">3</text>
<text top="421" left="504" width="12" height="8" font="1"></text>
<text top="454" left="504" width="12" height="8" font="1"></text>
<text top="446" left="519" width="5" height="16" font="1">.</text>
<text top="446" left="765" width="45" height="16" font="1">(4.30)</text>
<text top="507" left="121" width="51" height="16" font="1">The A</text>
<text top="504" left="173" width="6" height="11" font="3">∗</text>
<text top="507" left="188" width="49" height="16" font="1">and B</text>
<text top="504" left="238" width="6" height="11" font="3">∗</text>
<text top="507" left="253" width="557" height="16" font="1">matrices can be formed using Equations <a href="pdfxml.html#73">(4.20) </a>and <a href="pdfxml.html#72">(4.15) </a>respectively</text>
<text top="528" left="121" width="121" height="16" font="1">which results in</text>
<text top="567" left="295" width="13" height="16" font="1">A</text>
<text top="563" left="308" width="6" height="11" font="3">∗</text>
<text top="567" left="320" width="32" height="16" font="1">= R</text>
<text top="543" left="355" width="12" height="8" font="1"></text>
<text top="575" left="355" width="12" height="8" font="1"></text>
<text top="545" left="382" width="8" height="16" font="1">q</text>
<text top="552" left="389" width="9" height="11" font="3">w</text>
<text top="545" left="400" width="9" height="16" font="1">a</text>
<text top="543" left="409" width="6" height="11" font="3">v</text>
<text top="554" left="409" width="6" height="11" font="3">3</text>
<text top="567" left="382" width="8" height="16" font="1">r</text>
<text top="574" left="389" width="9" height="11" font="3">w</text>
<text top="567" left="400" width="9" height="16" font="1">a</text>
<text top="564" left="409" width="6" height="11" font="3">v</text>
<text top="575" left="409" width="6" height="11" font="3">1</text>
<text top="587" left="375" width="22" height="17" font="1">−q</text>
<text top="595" left="396" width="9" height="11" font="3">w</text>
<text top="588" left="407" width="9" height="16" font="1">a</text>
<text top="586" left="416" width="6" height="11" font="3">v</text>
<text top="597" left="416" width="6" height="11" font="3">1</text>
<text top="543" left="431" width="12" height="8" font="1"></text>
<text top="575" left="431" width="12" height="8" font="1"></text>
<text top="567" left="446" width="26" height="16" font="1">, B</text>
<text top="563" left="473" width="6" height="11" font="3">∗</text>
<text top="567" left="485" width="32" height="16" font="1">= R</text>
<text top="543" left="520" width="12" height="8" font="1"></text>
<text top="575" left="520" width="12" height="8" font="1"></text>
<text top="545" left="539" width="9" height="16" font="1">1</text>
<text top="545" left="574" width="9" height="16" font="1">0</text>
<text top="545" left="608" width="9" height="16" font="1">0</text>
<text top="567" left="539" width="47" height="16" font="1">0 −a</text>
<text top="564" left="586" width="6" height="11" font="3">v</text>
<text top="575" left="586" width="6" height="11" font="3">3</text>
<text top="567" left="608" width="9" height="16" font="1">0</text>
<text top="588" left="539" width="9" height="16" font="1">0</text>
<text top="588" left="574" width="9" height="16" font="1">0</text>
<text top="588" left="608" width="9" height="16" font="1">1</text>
<text top="543" left="625" width="12" height="8" font="1"></text>
<text top="575" left="625" width="12" height="8" font="1"></text>
<text top="567" left="765" width="45" height="16" font="1">(4.31)</text>
<text top="620" left="121" width="688" height="16" font="1">Finally, a feedback linearizing control law is generated using Equation <a href="pdfxml.html#74">(4.21) </a>and <a href="pdfxml.html#76">(4.30).</a></text>
<text top="641" left="121" width="688" height="16" font="1">A linear tracking controller can now be designed for v as before. The tracking error, e, for</text>
<text top="663" left="121" width="434" height="16" font="1">the elliptical exosystem is also given by Equation <a href="pdfxml.html#75">(4.29).</a></text>
<text top="721" left="121" width="50" height="19" font="7">4.3.4</text>
<text top="721" left="195" width="264" height="19" font="7">Full Aerodynamic Model</text>
<text top="766" left="121" width="118" height="16" font="1">Taking y = (y</text>
<text top="773" left="239" width="6" height="11" font="3">1</text>
<text top="766" left="246" width="48" height="16" font="1">, . . . , y</text>
<text top="773" left="294" width="6" height="11" font="3">4</text>
<text top="766" left="301" width="314" height="16" font="1">) = (V, γ, ψ, β) as the output we get r</text>
<text top="773" left="615" width="6" height="11" font="3">1</text>
<text top="766" left="632" width="31" height="16" font="1">= r</text>
<text top="773" left="663" width="6" height="11" font="3">2</text>
<text top="766" left="679" width="31" height="16" font="1">= r</text>
<text top="773" left="710" width="6" height="11" font="3">3</text>
<text top="766" left="726" width="31" height="16" font="1">= r</text>
<text top="773" left="757" width="6" height="11" font="3">4</text>
<text top="766" left="773" width="37" height="16" font="1">= 1.</text>
<text top="788" left="121" width="689" height="16" font="1">The sum of these relative degrees is less than the number of states (9) in the system</text>
<text top="809" left="121" width="689" height="16" font="1">which is a direct result of the throttle input (δT ) appearing in the force terms, L, D and</text>
<text top="831" left="121" width="689" height="16" font="1">S. Using the previous discussion on zero dynamics, this implies 5 uncontrollable and</text>
<text top="853" left="121" width="688" height="16" font="1">potentially unobservable internal states. Extending the system with two additional states</text>
<text top="874" left="121" width="189" height="16" font="1">and replacing δT with ¨</text>
<text top="874" left="295" width="515" height="16" font="1">δT as the new control input ensures diﬀerential ﬂatness by delaying</text>
<text top="896" left="121" width="678" height="16" font="1">the appearance of the control inputs in the output derivatives. The new control input is</text>
<text top="939" left="359" width="29" height="16" font="1">u =</text>
<text top="934" left="413" width="9" height="16" font="1">¨</text>
<text top="939" left="407" width="19" height="16" font="1">δT</text>
<text top="939" left="443" width="21" height="16" font="1">δE</text>
<text top="939" left="481" width="58" height="16" font="1">δA δR</text>
<text top="939" left="568" width="5" height="16" font="1">.</text>
<text top="939" left="765" width="45" height="16" font="1">(4.32)</text>
<text top="1038" left="457" width="18" height="16" font="1">67</text>
</page>
<page number="77" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="546" height="16" font="1">With these re-deﬁned control inputs, the decoupling matrix is given by</text>
<text top="258" left="339" width="13" height="16" font="1">B</text>
<text top="254" left="354" width="6" height="11" font="3">∗</text>
<text top="258" left="366" width="14" height="16" font="1">=</text>
<text top="223" left="384" width="12" height="8" font="1"></text>
<text top="254" left="384" width="12" height="8" font="1"></text>
<text top="265" left="384" width="12" height="8" font="1"></text>
<text top="277" left="384" width="12" height="8" font="1"></text>
<text top="211" left="406" width="15" height="16" font="1">...</text>
<text top="226" left="404" width="10" height="16" font="1">V</text>
<text top="230" left="423" width="6" height="11" font="3">¨</text>
<text top="234" left="418" width="13" height="11" font="3">δT</text>
<text top="211" left="451" width="15" height="16" font="1">...</text>
<text top="226" left="450" width="10" height="16" font="1">V</text>
<text top="231" left="464" width="15" height="11" font="3">δE</text>
<text top="211" left="498" width="15" height="16" font="1">...</text>
<text top="226" left="496" width="10" height="16" font="1">V</text>
<text top="231" left="510" width="16" height="11" font="3">δA</text>
<text top="211" left="544" width="15" height="16" font="1">...</text>
<text top="226" left="542" width="10" height="16" font="1">V</text>
<text top="231" left="556" width="16" height="11" font="3">δR</text>
<text top="233" left="404" width="15" height="16" font="1">...</text>
<text top="244" left="406" width="9" height="16" font="1">γ</text>
<text top="252" left="423" width="6" height="11" font="3">¨</text>
<text top="255" left="418" width="13" height="11" font="3">δT</text>
<text top="233" left="450" width="15" height="16" font="1">...</text>
<text top="244" left="452" width="9" height="16" font="1">γ</text>
<text top="253" left="464" width="15" height="11" font="3">δE</text>
<text top="233" left="496" width="15" height="16" font="1">...</text>
<text top="244" left="498" width="9" height="16" font="1">γ</text>
<text top="253" left="510" width="16" height="11" font="3">δA</text>
<text top="233" left="542" width="15" height="16" font="1">...</text>
<text top="244" left="544" width="9" height="16" font="1">γ</text>
<text top="253" left="556" width="16" height="11" font="3">δR</text>
<text top="253" left="404" width="15" height="16" font="1">...</text>
<text top="268" left="405" width="11" height="16" font="1">ψ</text>
<text top="274" left="423" width="6" height="11" font="3">¨</text>
<text top="277" left="418" width="13" height="11" font="3">δT</text>
<text top="253" left="450" width="15" height="16" font="1">...</text>
<text top="268" left="451" width="11" height="16" font="1">ψ</text>
<text top="276" left="464" width="15" height="11" font="3">δE</text>
<text top="253" left="496" width="15" height="16" font="1">...</text>
<text top="268" left="497" width="11" height="16" font="1">ψ</text>
<text top="276" left="510" width="16" height="11" font="3">δA</text>
<text top="253" left="542" width="15" height="16" font="1">...</text>
<text top="268" left="543" width="11" height="16" font="1">ψ</text>
<text top="276" left="556" width="16" height="11" font="3">δR</text>
<text top="291" left="415" width="9" height="16" font="1">0</text>
<text top="291" left="461" width="9" height="16" font="1">0</text>
<text top="286" left="501" width="9" height="16" font="1">¨</text>
<text top="291" left="498" width="10" height="16" font="1">β</text>
<text top="298" left="508" width="16" height="11" font="3">δA</text>
<text top="286" left="546" width="9" height="16" font="1">¨</text>
<text top="291" left="544" width="10" height="16" font="1">β</text>
<text top="298" left="554" width="16" height="11" font="3">δR</text>
<text top="223" left="580" width="12" height="8" font="1"></text>
<text top="254" left="580" width="12" height="8" font="1"></text>
<text top="265" left="580" width="12" height="8" font="1"></text>
<text top="277" left="580" width="12" height="8" font="1"></text>
<text top="258" left="765" width="45" height="16" font="1">(4.33)</text>
<text top="329" left="121" width="445" height="16" font="1">where each entry is expressed using partial derivatives of</text>
<text top="316" left="575" width="15" height="16" font="1">...</text>
<text top="331" left="573" width="19" height="16" font="1">V ,</text>
<text top="316" left="596" width="15" height="16" font="1">...</text>
<text top="327" left="598" width="17" height="18" font="1">γ ,</text>
<text top="314" left="618" width="15" height="16" font="1">...</text>
<text top="329" left="619" width="67" height="16" font="1">ψ and ¨</text>
<text top="329" left="675" width="135" height="16" font="1">β with respect to</text>
<text top="351" left="121" width="144" height="16" font="1">each control input.</text>
<text top="380" left="148" width="662" height="16" font="1">These higher order derivatives are extremely complex and their length prohibits them</text>
<text top="402" left="121" width="689" height="16" font="1">from being reproduced here with clarity. An analytical check of the singularity conditions</text>
<text top="423" left="121" width="688" height="16" font="1">for the matrix in Equation <a href="pdfxml.html#77">(4.33) </a>is therefore close to impossible. The matrix was however</text>
<text top="445" left="121" width="689" height="16" font="1">checked numerically to be nonsingular in the region of interest when tracking the basic ski</text>
<text top="467" left="121" width="689" height="16" font="1">slope reference trajectories from Section <a href="pdfxml.html#70">(4.2.4). </a>This implies that the system yields a well</text>
<text top="488" left="121" width="274" height="16" font="1">deﬁned vector relative degree of {˜</text>
<text top="488" left="386" width="8" height="16" font="1">r</text>
<text top="495" left="394" width="6" height="11" font="3">1</text>
<text top="488" left="401" width="17" height="16" font="1">, ˜</text>
<text top="488" left="409" width="8" height="16" font="1">r</text>
<text top="495" left="416" width="6" height="11" font="3">2</text>
<text top="488" left="424" width="17" height="16" font="1">, ˜</text>
<text top="488" left="431" width="8" height="16" font="1">r</text>
<text top="495" left="439" width="6" height="11" font="3">3</text>
<text top="488" left="446" width="17" height="16" font="1">, ˜</text>
<text top="488" left="454" width="8" height="16" font="1">r</text>
<text top="495" left="462" width="6" height="11" font="3">4</text>
<text top="487" left="469" width="341" height="17" font="1">} = {3, 3, 3, 2}. Using Equation <a href="pdfxml.html#74">(4.21), </a>and</text>
<text top="510" left="121" width="134" height="16" font="1">an appropriate A</text>
<text top="507" left="255" width="6" height="11" font="3">∗</text>
<text top="510" left="269" width="541" height="16" font="1">term (not shown here for brevity), a feedback linearizing controller is</text>
<text top="532" left="121" width="435" height="16" font="1">formed. For tracking control, the error can be deﬁned as</text>
<text top="569" left="278" width="27" height="16" font="1">e =</text>
<text top="569" left="325" width="13" height="16" font="1">w</text>
<text top="575" left="337" width="6" height="11" font="3">1</text>
<text top="568" left="349" width="26" height="17" font="1">− ξ</text>
<text top="566" left="375" width="6" height="11" font="3">1</text>
<text top="577" left="374" width="6" height="11" font="3">1</text>
<text top="569" left="397" width="13" height="16" font="1">w</text>
<text top="575" left="410" width="6" height="11" font="3">2</text>
<text top="568" left="421" width="26" height="17" font="1">− ξ</text>
<text top="566" left="447" width="6" height="11" font="3">2</text>
<text top="577" left="446" width="6" height="11" font="3">1</text>
<text top="569" left="469" width="13" height="16" font="1">w</text>
<text top="575" left="482" width="6" height="11" font="3">3</text>
<text top="568" left="493" width="26" height="17" font="1">− ξ</text>
<text top="566" left="519" width="6" height="11" font="3">3</text>
<text top="577" left="518" width="6" height="11" font="3">1</text>
<text top="569" left="541" width="13" height="16" font="1">w</text>
<text top="575" left="554" width="6" height="11" font="3">5</text>
<text top="568" left="565" width="26" height="17" font="1">− ξ</text>
<text top="566" left="591" width="6" height="11" font="3">4</text>
<text top="577" left="591" width="6" height="11" font="3">1</text>
<text top="562" left="613" width="7" height="11" font="3">T</text>
<text top="569" left="765" width="45" height="16" font="1">(4.34)</text>
<text top="604" left="121" width="60" height="16" font="1">where ξ</text>
<text top="601" left="182" width="6" height="11" font="3">1</text>
<text top="612" left="181" width="6" height="11" font="3">1</text>
<text top="604" left="189" width="20" height="16" font="1">, ξ</text>
<text top="601" left="210" width="6" height="11" font="3">2</text>
<text top="612" left="209" width="6" height="11" font="3">1</text>
<text top="604" left="217" width="20" height="16" font="1">, ξ</text>
<text top="601" left="238" width="6" height="11" font="3">3</text>
<text top="612" left="237" width="6" height="11" font="3">1</text>
<text top="604" left="252" width="43" height="16" font="1">and ξ</text>
<text top="601" left="296" width="6" height="11" font="3">4</text>
<text top="612" left="295" width="6" height="11" font="3">1</text>
<text top="604" left="310" width="500" height="16" font="1">refer to V , γ, ψ and β respectively. The controller can then be</text>
<text top="625" left="121" width="688" height="16" font="1">completed, with results for a BAC-221 high performance aircraft shown in the next section.</text>
<text top="682" left="121" width="50" height="19" font="7">4.3.5</text>
<text top="682" left="195" width="360" height="19" font="7">Subset of the Consolidated Model</text>
<text top="725" left="121" width="689" height="16" font="1">A subset of the 9 state consolidated model from Section <a href="pdfxml.html#56">(3.7.1) </a>can also be used to control</text>
<text top="747" left="121" width="688" height="16" font="1">the rotation rates of the aircraft and produce additional motion primitives. With a selection</text>
<text top="768" left="121" width="689" height="16" font="1">of 3 states (p, q, r), output y = (p, q, r) and input u = (δE, δA, δR), the model has a well</text>
<text top="790" left="121" width="359" height="16" font="1">deﬁned vector relative degree of {1, 1, 1} and</text>
<text top="786" left="508" width="6" height="11" font="3">3</text>
<text top="799" left="508" width="21" height="11" font="3">i=1</text>
<text top="790" left="532" width="8" height="16" font="1">r</text>
<text top="797" left="540" width="4" height="11" font="3">i</text>
<text top="790" left="554" width="256" height="16" font="1">= 3. This implies that a static</text>
<text top="812" left="121" width="688" height="16" font="1">feedback linearization is suﬃcient and can be used with the model identiﬁed for the Kadet</text>
<text top="833" left="121" width="688" height="16" font="1">Senior. This selection of states assumes that a low level linear controller maintains V ,</text>
<text top="855" left="121" width="688" height="16" font="1">which can be easily accomplished as the only inputs required here are δE, δA and δR,</text>
<text top="877" left="121" width="688" height="16" font="1">leaving δT decoupled for velocity control. V does not need to be actively changed and can</text>
<text top="898" left="121" width="689" height="16" font="1">be maintained at a constant level. α and β can be kept in check by subtracting or adding</text>
<text top="920" left="121" width="688" height="16" font="1">to δR and δA. This may not be necessary in calm weather due to the stability provided</text>
<text top="942" left="121" width="408" height="16" font="1">by the tail and the inherent stability of the platform.</text>
<text top="971" left="148" width="49" height="16" font="1">The A</text>
<text top="968" left="197" width="6" height="11" font="3">∗</text>
<text top="971" left="210" width="47" height="16" font="1">and B</text>
<text top="968" left="258" width="6" height="11" font="3">∗</text>
<text top="971" left="271" width="539" height="16" font="1">matrices can be formed using Equations <a href="pdfxml.html#73">(4.20) </a>and <a href="pdfxml.html#72">(4.15) </a>respectively</text>
<text top="993" left="121" width="121" height="16" font="1">which results in</text>
<text top="1038" left="457" width="18" height="16" font="1">68</text>
</page>
<page number="78" position="absolute" top="0" left="0" height="1188" width="918">
<text top="246" left="242" width="13" height="16" font="1">A</text>
<text top="242" left="255" width="6" height="11" font="3">∗</text>
<text top="246" left="267" width="14" height="16" font="1">=</text>
<text top="222" left="286" width="12" height="8" font="1"></text>
<text top="254" left="286" width="12" height="8" font="1"></text>
<text top="225" left="306" width="9" height="16" font="1">a</text>
<text top="231" left="315" width="13" height="11" font="3">11</text>
<text top="225" left="332" width="46" height="16" font="1">sin βV</text>
<text top="222" left="381" width="6" height="11" font="3">2</text>
<text top="225" left="392" width="34" height="16" font="1">+ (a</text>
<text top="231" left="426" width="13" height="11" font="3">13</text>
<text top="225" left="440" width="40" height="16" font="1">p + a</text>
<text top="231" left="479" width="13" height="11" font="3">12</text>
<text top="225" left="493" width="82" height="16" font="1">r)V + qr(I</text>
<text top="231" left="575" width="13" height="11" font="3">yy</text>
<text top="224" left="593" width="26" height="17" font="1">− I</text>
<text top="231" left="619" width="12" height="11" font="3">zz</text>
<text top="225" left="633" width="7" height="16" font="1">)</text>
<text top="246" left="310" width="16" height="16" font="1">(a</text>
<text top="253" left="326" width="13" height="11" font="3">21</text>
<text top="246" left="343" width="27" height="16" font="1">+ a</text>
<text top="253" left="370" width="13" height="11" font="3">22</text>
<text top="246" left="386" width="53" height="16" font="1">sin α)V</text>
<text top="244" left="443" width="6" height="11" font="3">2</text>
<text top="246" left="454" width="27" height="16" font="1">+ a</text>
<text top="253" left="481" width="13" height="11" font="3">23</text>
<text top="246" left="495" width="76" height="16" font="1">qV − pr(I</text>
<text top="253" left="571" width="14" height="11" font="3">xx</text>
<text top="245" left="590" width="26" height="17" font="1">− I</text>
<text top="253" left="616" width="12" height="11" font="3">zz</text>
<text top="246" left="629" width="7" height="16" font="1">)</text>
<text top="268" left="305" width="9" height="16" font="1">a</text>
<text top="275" left="314" width="13" height="11" font="3">31</text>
<text top="268" left="331" width="46" height="16" font="1">sin βV</text>
<text top="266" left="380" width="6" height="11" font="3">2</text>
<text top="268" left="392" width="34" height="16" font="1">+ (a</text>
<text top="275" left="425" width="13" height="11" font="3">33</text>
<text top="268" left="439" width="40" height="16" font="1">p + a</text>
<text top="275" left="478" width="13" height="11" font="3">32</text>
<text top="268" left="492" width="83" height="16" font="1">r)V + pq(I</text>
<text top="275" left="575" width="14" height="11" font="3">xx</text>
<text top="267" left="594" width="26" height="17" font="1">− I</text>
<text top="275" left="619" width="13" height="11" font="3">yy</text>
<text top="268" left="633" width="7" height="16" font="1">)</text>
<text top="222" left="648" width="12" height="8" font="1"></text>
<text top="254" left="648" width="12" height="8" font="1"></text>
<text top="246" left="765" width="45" height="16" font="1">(4.35)</text>
<text top="357" left="270" width="13" height="16" font="1">B</text>
<text top="353" left="284" width="6" height="11" font="3">∗</text>
<text top="357" left="296" width="14" height="16" font="1">=</text>
<text top="333" left="315" width="12" height="8" font="1"></text>
<text top="365" left="315" width="12" height="8" font="1"></text>
<text top="335" left="371" width="9" height="16" font="1">0</text>
<text top="335" left="432" width="10" height="16" font="1">V</text>
<text top="333" left="446" width="6" height="11" font="3">2</text>
<text top="335" left="453" width="7" height="16" font="1">b</text>
<text top="342" left="461" width="13" height="11" font="3">11</text>
<text top="335" left="477" width="36" height="16" font="1">cos β</text>
<text top="335" left="530" width="10" height="16" font="1">V</text>
<text top="333" left="544" width="6" height="11" font="3">2</text>
<text top="335" left="551" width="7" height="16" font="1">b</text>
<text top="342" left="558" width="13" height="11" font="3">13</text>
<text top="335" left="575" width="36" height="16" font="1">cos β</text>
<text top="357" left="334" width="10" height="16" font="1">V</text>
<text top="354" left="348" width="6" height="11" font="3">2</text>
<text top="357" left="356" width="7" height="16" font="1">b</text>
<text top="364" left="363" width="13" height="11" font="3">22</text>
<text top="357" left="379" width="38" height="16" font="1">cos α</text>
<text top="357" left="469" width="9" height="16" font="1">0</text>
<text top="357" left="567" width="9" height="16" font="1">0</text>
<text top="378" left="371" width="9" height="16" font="1">0</text>
<text top="378" left="432" width="10" height="16" font="1">V</text>
<text top="376" left="446" width="6" height="11" font="3">2</text>
<text top="378" left="453" width="7" height="16" font="1">b</text>
<text top="385" left="461" width="13" height="11" font="3">31</text>
<text top="378" left="477" width="36" height="16" font="1">cos β</text>
<text top="378" left="530" width="10" height="16" font="1">V</text>
<text top="376" left="544" width="6" height="11" font="3">2</text>
<text top="378" left="551" width="7" height="16" font="1">b</text>
<text top="385" left="558" width="13" height="11" font="3">33</text>
<text top="378" left="575" width="36" height="16" font="1">cos β</text>
<text top="333" left="620" width="12" height="8" font="1"></text>
<text top="365" left="620" width="12" height="8" font="1"></text>
<text top="357" left="765" width="45" height="16" font="1">(4.36)</text>
<text top="425" left="148" width="662" height="16" font="1">The tracking error is the same as Equation <a href="pdfxml.html#75">(4.29) </a>and applies just as well to Equation</text>
<text top="447" left="122" width="689" height="16" font="1"><a href="pdfxml.html#71">(4.12). </a>The results of this simple yet powerful controller as applied to the Kadet Senior</text>
<text top="469" left="122" width="286" height="16" font="1">UAV can be seen in the next section.</text>
<text top="532" left="122" width="37" height="23" font="2">4.4</text>
<text top="532" left="188" width="93" height="23" font="2">Results</text>
<text top="585" left="122" width="689" height="16" font="1">Simulation results for trajectory tracking control of the simple ﬂight model are shown in</text>
<text top="607" left="122" width="689" height="16" font="1">Figure <a href="pdfxml.html#79">(4.1). </a>The aircraft position achieves perfect tracking of the elliptical exosystem</text>
<text top="629" left="122" width="652" height="16" font="1">described in section <a href="pdfxml.html#69">(4.2.4), </a>and also rejects errors in initial conditions smoothly.</text>
<text top="629" left="790" width="20" height="16" font="1">To</text>
<text top="650" left="122" width="688" height="16" font="1">implement this controller, the aircraft is assumed to have a low level autopilot which</text>
<text top="672" left="122" width="688" height="16" font="1">would provide the required V , γ and ψ to track the trajectory. The scale of the reference</text>
<text top="694" left="122" width="689" height="16" font="1">ellipse and the time to traverse it can be adjusted based on the performance limitations of</text>
<text top="715" left="122" width="91" height="16" font="1">the aircraft.</text>
<text top="746" left="148" width="662" height="16" font="1">Simulation result for the coordinated ﬂight model with the elliptical exosystem is shown</text>
<text top="767" left="122" width="689" height="16" font="1">in Figure <a href="pdfxml.html#79">(4.2). </a>The aircraft rapidly reduces the initial errors and achieves perfect tracking.</text>
<text top="789" left="122" width="689" height="16" font="1">As with the simple ﬂight model, this controller can be used where an autopilot is already</text>
<text top="811" left="122" width="688" height="16" font="1">present that can command the required forward and vertical acceleration and the required</text>
<text top="832" left="122" width="78" height="16" font="1">roll rate a</text>
<text top="830" left="200" width="6" height="11" font="3">v</text>
<text top="841" left="200" width="6" height="11" font="3">1</text>
<text top="832" left="207" width="17" height="16" font="1">, a</text>
<text top="830" left="224" width="6" height="11" font="3">v</text>
<text top="841" left="224" width="6" height="11" font="3">3</text>
<text top="832" left="232" width="17" height="16" font="1">, p</text>
<text top="839" left="248" width="9" height="11" font="3">w</text>
<text top="832" left="258" width="552" height="16" font="1">, respectively. Since the model doesn’t account for aircraft limitations,</text>
<text top="854" left="122" width="625" height="16" font="1">these control outputs can be adjusted by altering the ﬂight path as required.</text>
<text top="854" left="763" width="47" height="16" font="1">As an</text>
<text top="876" left="122" width="689" height="16" font="1">example, an autopilot could be developed that would regulate the sideslip to zero at all</text>
<text top="897" left="122" width="368" height="16" font="1">times through rudder deﬂection, δR. Similarly, a</text>
<text top="895" left="490" width="6" height="11" font="3">v</text>
<text top="906" left="490" width="6" height="11" font="3">1</text>
<text top="897" left="501" width="42" height="16" font="1">and a</text>
<text top="895" left="543" width="6" height="11" font="3">v</text>
<text top="906" left="543" width="6" height="11" font="3">3</text>
<text top="897" left="555" width="255" height="16" font="1">can be generated through throttle</text>
<text top="919" left="122" width="418" height="16" font="1">control, δT , and elevator deﬂection, δE, respectively. p</text>
<text top="926" left="540" width="9" height="11" font="3">w</text>
<text top="919" left="555" width="255" height="16" font="1">can be produced by actuating the</text>
<text top="941" left="122" width="91" height="16" font="1">ailerons δA.</text>
<text top="971" left="148" width="662" height="16" font="1">The BAC-221 aerodynamic model (developed in Section <a href="pdfxml.html#48">3.5) </a>can also be tested with the</text>
<text top="993" left="122" width="688" height="16" font="1">proposed control strategy and the basic ski model exosystem. The ﬁnal trajectory result</text>
<text top="1038" left="457" width="18" height="16" font="1">69</text>
</page>
<page number="79" position="absolute" top="0" left="0" height="1188" width="918">
<text top="523" left="236" width="460" height="16" font="1">Figure 4.1: Simulation Results for the Simple Flight Model.</text>
<text top="940" left="214" width="503" height="16" font="1">Figure 4.2: Simulation Results for the Coordinated Flight Model.</text>
<text top="1038" left="457" width="18" height="16" font="1">70</text>
</page>
<page number="80" position="absolute" top="0" left="0" height="1188" width="918">
<text top="474" left="122" width="689" height="16" font="1">Figure 4.3: Aircraft trajectory over a basic ski-slope simulated using the BAC-221 fully</text>
<text top="495" left="122" width="372" height="16" font="1">aerodynamic model and the proposed controller.</text>
<text top="565" left="122" width="688" height="16" font="1">is shown in Figure <a href="pdfxml.html#80">(4.3), </a>which very precisely tracks the reference trajectory. The sideslip</text>
<text top="586" left="122" width="689" height="16" font="1">angle can be seen in Figure <a href="pdfxml.html#81">4.4. </a>Here the controller is trying to maintain coordinated ﬂight</text>
<text top="608" left="122" width="689" height="16" font="1">by actively regulating the angle to zero through a combined eﬀort of rudder and aileron</text>
<text top="630" left="122" width="688" height="16" font="1">deﬂection. Note that during the sharp turns, peaks can be seen which implies that some</text>
<text top="651" left="122" width="127" height="16" font="1">sideslip (&lt; 0.001</text>
<text top="648" left="249" width="6" height="11" font="3">◦</text>
<text top="651" left="256" width="181" height="16" font="1">) does inevitably occur.</text>
<text top="681" left="148" width="662" height="16" font="1">One drawback in the proposed controller, when applied to the full aerodynamic model,</text>
<text top="703" left="121" width="689" height="16" font="1">is that it is not robust to small deviations from the reference. This implies a small domain</text>
<text top="725" left="121" width="689" height="16" font="1">of attraction around the trajectory. Hence, this approach maybe diﬃcult to implement</text>
<text top="746" left="121" width="688" height="16" font="1">in practice, but could be addressed by adding a robust control component to the linear</text>
<text top="768" left="121" width="78" height="16" font="1">controller.</text>
<text top="798" left="148" width="662" height="16" font="1">The best results are achieved when the controller is applied to the subset of the consoli-</text>
<text top="819" left="121" width="512" height="16" font="1">dated model. This scheme is a compromise. The overtly complex A</text>
<text top="816" left="634" width="6" height="11" font="3">∗</text>
<text top="819" left="646" width="47" height="16" font="1">and B</text>
<text top="816" left="693" width="6" height="11" font="3">∗</text>
<text top="819" left="705" width="105" height="16" font="1">matrices from</text>
<text top="841" left="122" width="689" height="16" font="1">the full 9 state model capture the entire aircraft model but are too rigid to accommodate</text>
<text top="863" left="122" width="689" height="16" font="1">deviations from initial conditions and require measurements of higher order derivatives,</text>
<text top="884" left="122" width="689" height="16" font="1">which are very diﬃcult to determine accurately from MEMs based sensors. The very sim-</text>
<text top="906" left="122" width="689" height="16" font="1">ple controllers from Sections <a href="pdfxml.html#75">(4.3.2) </a>and <a href="pdfxml.html#76">(4.3.3) </a>depend on complex low level autopilots</text>
<text top="928" left="122" width="688" height="16" font="1">that will have to meet demands for acceleration, velocity and attitude angles as the aircraft</text>
<text top="949" left="122" width="689" height="16" font="1">progresses through the reference trajectory. The subset model on the other hand connects</text>
<text top="971" left="122" width="689" height="16" font="1">with the control surfaces directly, and is still able to perform with a very simple low level</text>
<text top="993" left="122" width="689" height="16" font="1">autopilot whose demands don’t change over time. This controller was applied to the Kadet</text>
<text top="1038" left="457" width="18" height="16" font="1">71</text>
</page>
<page number="81" position="absolute" top="0" left="0" height="1188" width="918">
<text top="468" left="255" width="422" height="16" font="1">Figure 4.4: β being regulated to zero for the BAC-221.</text>
<text top="539" left="122" width="689" height="16" font="1">Senior model that was identiﬁed using real ﬂight data. Results with small variations in the</text>
<text top="560" left="122" width="533" height="16" font="1">exosystem from Equation <a href="pdfxml.html#71">(4.12) </a>can be seen in Figures <a href="pdfxml.html#82">(4.5) </a>to <a href="pdfxml.html#83">(4.7).</a></text>
<text top="591" left="148" width="662" height="16" font="1">The Kadet Senior UAV was test ﬂown with linear controllers only. This was mainly to</text>
<text top="613" left="122" width="688" height="16" font="1">verify the custom designed autopilot hardware, the onboard QNX system, long range radio</text>
<text top="634" left="122" width="688" height="16" font="1">links, ground station, remote debugging and safety takeover systems. The UAV itself is</text>
<text top="656" left="122" width="689" height="16" font="1">not structurally sound to perform aggressive maneuvers. Results from the linear autopilot</text>
<text top="678" left="122" width="320" height="16" font="1">tests are shown in Figures <a href="pdfxml.html#84">(4.8) </a>to <a href="pdfxml.html#85">(4.10).</a></text>
<text top="741" left="122" width="37" height="23" font="2">4.5</text>
<text top="741" left="188" width="150" height="23" font="2">Conclusions</text>
<text top="795" left="122" width="689" height="16" font="1">In this work, a nonlinear controller is designed which achieves trajectory tracking for three</text>
<text top="817" left="122" width="689" height="16" font="1">progressively complex models of an aircraft. Each of these models can be used to design</text>
<text top="838" left="122" width="689" height="16" font="1">autopilots provided that an underlying low level controller is already present that ensures</text>
<text top="860" left="122" width="689" height="16" font="1">that the input requirements are met. The controllers for the basic and coordinated ﬂight</text>
<text top="882" left="122" width="689" height="16" font="1">models can be scaled up or down based on the type of aircraft being used. For a small</text>
<text top="903" left="122" width="689" height="16" font="1">scale UAV, where the thrust to weight ratio is usually more than one, fairly aggressive</text>
<text top="925" left="122" width="689" height="16" font="1">trajectories should be within reach. The controller for the full aerodynamic model needs</text>
<text top="947" left="122" width="688" height="16" font="1">to be built ground up for the speciﬁc aircraft after a thorough system identiﬁcation. It may</text>
<text top="968" left="122" width="689" height="16" font="1">also require the inclusion of a robust control component to achieve tracking in non-ideal</text>
<text top="990" left="122" width="689" height="16" font="1">conditions. However, this controller would only require a simple underlying controller</text>
<text top="1038" left="457" width="18" height="16" font="1">72</text>
</page>
<page number="82" position="absolute" top="0" left="0" height="1188" width="918">
<text top="526" left="122" width="689" height="16" font="1">Figure 4.5: Motion primitive 1. Nonlinear controller applied to the Kadet Senior model:</text>
<text top="547" left="122" width="653" height="16" font="1">fully controlled downward spiral. Note, for illustrative purposes z is positive up here.</text>
<text top="938" left="122" width="689" height="16" font="1">Figure 4.6: Motion primitive 2. Nonlinear controller applied to the Kadet Senior model:</text>
<text top="960" left="122" width="665" height="16" font="1">undergoing an aggressive eight pattern. Note, for illustrative purposes z is positive up.</text>
<text top="1038" left="457" width="18" height="16" font="1">73</text>
</page>
<page number="83" position="absolute" top="0" left="0" height="1188" width="918">
<text top="761" left="122" width="689" height="16" font="1">Figure 4.7: Motion primitive 3. Nonlinear controller applied to the Kadet Senior model: a</text>
<text top="783" left="122" width="688" height="16" font="1">displacement roll, usually used during dog ﬁghting maneuvers, can be used in this applica-</text>
<text top="804" left="122" width="689" height="16" font="1">tion to chase agile targets susceptible to frequent changes in direction. Note, for illustrative</text>
<text top="826" left="122" width="194" height="16" font="1">purposes z is positive up.</text>
<text top="1038" left="457" width="18" height="16" font="1">74</text>
</page>
<page number="84" position="absolute" top="0" left="0" height="1188" width="918">
<text top="538" left="122" width="689" height="16" font="1">Figure 4.8: Flight test results: using a decoupled linear controller to level the aircraft and</text>
<text top="560" left="122" width="689" height="16" font="1">achieve a desired heading. The linear controllers used were Proportional-Derivative (PD),</text>
<text top="581" left="122" width="489" height="16" font="1">whose gains were tuned midﬂight to control the attitude states.</text>
<text top="936" left="269" width="393" height="16" font="1">Figure 4.9: Kadet Senior taxiing at the ﬂying ﬁeld.</text>
<text top="1038" left="457" width="18" height="16" font="1">75</text>
</page>
<page number="85" position="absolute" top="0" left="0" height="1188" width="918">
<text top="736" left="122" width="689" height="16" font="1">Figure 4.10: Kadet Senior airborne and in autopilot mode. A higher altitude is required</text>
<text top="758" left="122" width="689" height="16" font="1">for safe operation: in case of an autopilot failure, the ground pilot can resume control and</text>
<text top="780" left="122" width="322" height="16" font="1">recover the vehicle before a crash landing.</text>
<text top="1038" left="457" width="18" height="16" font="1">76</text>
</page>
<page number="86" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">to meet control surface deﬂections as opposed to the other two models which require</text>
<text top="213" left="122" width="689" height="16" font="1">controllers for ﬂight path angles and accelerations. The controller for the subset of the</text>
<text top="234" left="122" width="688" height="16" font="1">consolidated model is relatively simple and does not need robust control components. It</text>
<text top="256" left="122" width="320" height="16" font="1">only requires a simple low level autopilot.</text>
<text top="287" left="148" width="662" height="16" font="1">Future work in this area involves ﬂight tests using all aircraft models implemented on</text>
<text top="308" left="122" width="689" height="16" font="1">the Kadet Senior UAV after suﬃcient structural enhancements. New tracking controls,</text>
<text top="330" left="122" width="689" height="16" font="1">with less computationally intensive control laws will also be considered. One of these</text>
<text top="352" left="122" width="689" height="16" font="1">includes the output tracking method developed by Devasia, Chen and Paden <a href="pdfxml.html#90">[10], </a>where</text>
<text top="373" left="122" width="688" height="16" font="1">the inverse is solved numerically. The high level system, which stiches these trajectories</text>
<text top="395" left="122" width="689" height="16" font="1">for meaningful real-time tracking is also an area of active research within the WAVE Lab.</text>
<text top="1038" left="457" width="18" height="16" font="1">77</text>
</page>
<page number="87" position="absolute" top="0" left="0" height="1188" width="918">
<text top="306" left="122" width="184" height="33" font="0">Chapter 5</text>
<text top="390" left="122" width="200" height="33" font="0">Conclusion</text>
<text top="494" left="122" width="689" height="16" font="1">This thesis presents three crucial components towards real-time tracking of high speed,</text>
<text top="515" left="122" width="412" height="16" font="1">aggressive targets using an Unmanned Aerial Vehicle.</text>
<text top="546" left="148" width="662" height="16" font="1">The vision system employs the latest in oﬀ-the-shelf parallel computing technology to</text>
<text top="568" left="122" width="689" height="16" font="1">achieve robust real-time target tracking. It uses the new OpenCL GPGPU framework, and</text>
<text top="589" left="122" width="688" height="16" font="1">AMD’s new line of stream computing GPUs and Fusion processors. This processor, with</text>
<text top="611" left="122" width="688" height="16" font="1">a GPU and CPU on a single silicon die, provides a lightweight and low power computing</text>
<text top="633" left="122" width="688" height="16" font="1">solution for vision based avionics. With its large number of parallel cores, it rivals the com-</text>
<text top="654" left="122" width="688" height="16" font="1">puting power of high-end desktop based CPUs. Algorithms that are slow performers on a</text>
<text top="676" left="122" width="689" height="16" font="1">CPU, but hold the potential to be parallelized can be ported over to such units. A state-of-</text>
<text top="698" left="122" width="688" height="16" font="1">the-art vision tracking algorithm is described, together with implementation details using</text>
<text top="719" left="122" width="688" height="16" font="1">OpenCL and a HD5870 GPU. The results convert a once oﬄine-only technique, to online</text>
<text top="741" left="122" width="689" height="16" font="1">real-time tracking. Object tracking is performed under rotation, scale changes and occlu-</text>
<text top="763" left="122" width="689" height="16" font="1">sion. The system is tested on a key-chain target undergoing rotations and transformations</text>
<text top="784" left="122" width="553" height="16" font="1">and subsequently on an aerial video stream of a high speed RC aircraft.</text>
<text top="815" left="148" width="662" height="16" font="1">System identiﬁcation is performed using the well-established Maximum Likelihood</text>
<text top="837" left="122" width="689" height="16" font="1">method, also known as the Output Error Method, to develop a wide envelope and high-</text>
<text top="858" left="122" width="688" height="16" font="1">ﬁdelity model for the Kadet Senior. The techniques are ﬁrst tested using wind tunnel</text>
<text top="880" left="122" width="689" height="16" font="1">data from a 1970’s British jet aircraft known as the BAC-221. The data is used to create</text>
<text top="902" left="122" width="688" height="16" font="1">mathematical models of the jet, which are in turn used to simulate and extract appropri-</text>
<text top="923" left="122" width="688" height="16" font="1">ate data for performing system identiﬁcation. The result of the identiﬁcation procedure is</text>
<text top="945" left="122" width="688" height="16" font="1">compared with the original wind-tunnel based model to prove its eﬀectiveness. A Kadet</text>
<text top="967" left="122" width="689" height="16" font="1">Senior model aircraft is outﬁtted with custom sensors and avionics running the latest QNX</text>
<text top="988" left="122" width="689" height="16" font="1">real-time operating system to acquire clean and reliable ﬂight data. Control inputs are de-</text>
<text top="1038" left="457" width="18" height="16" font="1">78</text>
</page>
<page number="88" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="689" height="16" font="1">signed to capture the diﬀerent ﬂight modes and are ﬂown by a ground pilot. A ground</text>
<text top="213" left="122" width="688" height="16" font="1">station monitors the progress while the pilot is ﬂying. All maneuvers are completed in</text>
<text top="234" left="122" width="689" height="16" font="1">one ﬂight without the need to land. The data is processed oﬄine over a 9 state model,</text>
<text top="256" left="122" width="688" height="16" font="1">with diﬀerent underlying aerodynamic assumptions. The best set of parameters results in</text>
<text top="278" left="122" width="506" height="16" font="1">a relatively simple model that is usable for feedback linearization.</text>
<text top="308" left="148" width="662" height="16" font="1">This model forms the basis for nonlinear controls techniques which are shown to be</text>
<text top="330" left="122" width="689" height="16" font="1">eﬀective for generating aggressive motion primitives. The control law uses feedback lin-</text>
<text top="352" left="122" width="689" height="16" font="1">earization to cancel the known nonlinearities from the high ﬁdelity system identiﬁcation.</text>
<text top="373" left="122" width="688" height="16" font="1">Linear tracking control using the internal model approach is then applied to the resulting</text>
<text top="395" left="122" width="688" height="16" font="1">linear system, to direct the aircraft on a prescribed trajectory. The control laws are sim-</text>
<text top="417" left="122" width="688" height="16" font="1">ulated on two general aircraft kinematic models, on the BAC-221 model and then ﬁnally</text>
<text top="438" left="122" width="689" height="16" font="1">on the Kadet Senior model identiﬁed earlier. A motion primitive bank is created, with</text>
<text top="460" left="122" width="322" height="16" font="1">examples of aggressive trajectories shown.</text>
<text top="491" left="148" width="662" height="16" font="1">Linear autopilot controls are implemented on the Kadet Senior using the same custom</text>
<text top="512" left="122" width="689" height="16" font="1">designed avionics, showcasing the autonomous UAV and providing a safe platform for</text>
<text top="534" left="122" width="219" height="16" font="1">future controls development.</text>
<text top="565" left="148" width="662" height="16" font="1">The vision system can be improved by using advanced search methods and incorporating</text>
<text top="586" left="122" width="688" height="16" font="1">predictive motion models on the target. Its adaptation to an AMD Fusion APU will allow</text>
<text top="608" left="122" width="689" height="16" font="1">the tracking algorithm to be ﬂown onboard the aircraft. Cameras can be mounted on a</text>
<text top="630" left="122" width="688" height="16" font="1">two axis gimbal to consistently track the target even when repositioning of the aircraft is</text>
<text top="651" left="122" width="96" height="16" font="1">not possible.</text>
<text top="682" left="148" width="662" height="16" font="1">The nonlinear controller can be improved by adding robust control techniques to main-</text>
<text top="704" left="122" width="688" height="16" font="1">tain tracking during atmospheric disturbances. The proposed exosystems allow a wide</text>
<text top="725" left="122" width="688" height="16" font="1">variety of trajectories to be generated by changing the initial conditions. This approach</text>
<text top="747" left="122" width="689" height="16" font="1">works because motion primitives can be generated ahead of time and have the advantage</text>
<text top="769" left="122" width="362" height="16" font="1">of being ﬁne tuned during experimental ﬂights.</text>
<text top="799" left="148" width="662" height="16" font="1">Future research will focus on integrating the components developed here into a complete</text>
<text top="821" left="122" width="688" height="16" font="1">aggressive maneuver tracking UAV solution. A high level planner will need to be devised to</text>
<text top="843" left="122" width="688" height="16" font="1">maintain target visibility during the tracking mission. This planner would use the provided</text>
<text top="864" left="122" width="689" height="16" font="1">motion primitives to abstract out the controls required during aggressive maneuvers and</text>
<text top="886" left="122" width="689" height="16" font="1">meet the demands created by the vision system. In a farther future, the system will be</text>
<text top="908" left="122" width="688" height="16" font="1">reliable enough to be accepted as a mainstream tool for covering live action sports, shooting</text>
<text top="929" left="122" width="671" height="16" font="1">high speed car chases and providing autonomous pursuit solutions for law enforcement.</text>
<text top="1038" left="457" width="18" height="16" font="1">79</text>
</page>
<page number="89" position="absolute" top="0" left="0" height="1188" width="918">
<text top="306" left="122" width="196" height="33" font="0">References</text>
<text top="408" left="130" width="680" height="16" font="1">[1] APU101: All about AMD Fusion Accelerated Processing Units and how they’re chang-</text>
<text top="430" left="158" width="432" height="16" font="1">ing, well, everything. Technical report, AMD Inc., 2011.</text>
<text top="467" left="130" width="680" height="16" font="1">[2] Programming guide, AMD Accelerated Parallel Processing, OpenCL. Technical re-</text>
<text top="488" left="158" width="171" height="16" font="1">port, AMD Inc., 2011.</text>
<text top="525" left="130" width="680" height="16" font="1">[3] S. A. Al-Hiddabi and N. H. McClamroch. Tracking and maneuver regulation con-</text>
<text top="547" left="158" width="652" height="16" font="1">trol for nonlinear nonminimum phase systems: application to ﬂight control. IEEE</text>
<text top="568" left="158" width="511" height="16" font="1">Transactions on Control Systems Technology, 10(6):780–792, 2002.</text>
<text top="605" left="130" width="680" height="16" font="1">[4] P. Babenko and M. Shah. MinGPU: a minimum gpu library for computer vision.</text>
<text top="627" left="158" width="461" height="16" font="1">Journal of Real-Time Image Processing, 3(4):255–268, 2008.</text>
<text top="663" left="130" width="346" height="16" font="1">[5] M. E. Campbell and W. W. Whitacre.</text>
<text top="663" left="495" width="315" height="16" font="1">Cooperative tracking using vision mea-</text>
<text top="685" left="158" width="652" height="16" font="1">surements on SeaScan UAVs. Control Systems Technology, IEEE Transactions on,</text>
<text top="707" left="158" width="196" height="16" font="1">15(4):613–626, July 2007.</text>
<text top="743" left="130" width="680" height="16" font="1">[6] J. Canny. A computational approach to edge detection. Pattern Analysis and Machine</text>
<text top="765" left="158" width="523" height="16" font="1">Intelligence, IEEE Transactions on, PAMI-8(6):679–698, Nov. 1986.</text>
<text top="801" left="130" width="680" height="16" font="1">[7] G. Chowdhary and R. V. Jategaonkar. Aerodynamic parameter estimation from ﬂight</text>
<text top="823" left="158" width="652" height="16" font="1">data applying extended and unscented kalman ﬁlter. Aerospace Science and Technol-</text>
<text top="845" left="158" width="192" height="16" font="1">ogy, 14(2):106–117, 2010.</text>
<text top="881" left="130" width="680" height="16" font="1">[8] M. M. Chu. Marketing Presentation: GPU computing: past, present and future with</text>
<text top="903" left="158" width="289" height="16" font="1">ATI Stream Technology, March 2010.</text>
<text top="940" left="130" width="680" height="16" font="1">[9] NVIDIA Corporation. NVIDIA CUDA compute uniﬁed device architecture program-</text>
<text top="961" left="158" width="482" height="16" font="1">ming guide. <a href="http://developer.nvidia.com/cuda">http://developer.nvidia.com/cuda, </a>Jan. 2007.</text>
<text top="1038" left="457" width="18" height="16" font="1">80</text>
</page>
<page number="90" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">[10] S. Devasia, D. Chen, and B. Paden. Nonlinear inversion-based output tracking. IEEE</text>
<text top="213" left="158" width="440" height="16" font="1">Transactions on Automatic Control, 41(7):930–942, 1996.</text>
<text top="249" left="121" width="688" height="16" font="1">[11] G. Ducard and H. P. Geering. Airspeed control for unmanned aerial vehicles: a non-</text>
<text top="270" left="158" width="652" height="16" font="1">linear dynamic inversion approach. In Proceedings of 16th Mediterranean Conference</text>
<text top="292" left="158" width="426" height="16" font="1">on Control and Automation, pages 676–681, June 2008.</text>
<text top="328" left="121" width="689" height="16" font="1">[12] B. Edwards, J. Archibald, W. Fife, and D. J. Lee. A vision system for precision</text>
<text top="350" left="158" width="652" height="16" font="1">mav targeted landing. In Proceedings of International Symposium on Computational</text>
<text top="372" left="158" width="522" height="16" font="1">Intelligence in Robotics and Automation, pages 125–130, June 2007.</text>
<text top="408" left="121" width="596" height="16" font="1">[13] B. Etkin. Dynamics of atmospheric ﬂight. John Wiley &amp; Sons Inc, 1972.</text>
<text top="444" left="121" width="688" height="16" font="1">[14] J. P. Farrugia, P. Horain, E. Guehenneux, and Y. Alusse. GPUCV: A framework</text>
<text top="465" left="158" width="652" height="16" font="1">for image processing acceleration with graphics processors. In Proceedings of IEEE</text>
<text top="487" left="158" width="595" height="16" font="1">International Conference on Multimedia and Expo, pages 585–588, July 2006.</text>
<text top="523" left="121" width="688" height="16" font="1">[15] W. Forstner and B. Moonen. A metric for covariance matrices. Technical report,</text>
<text top="545" left="158" width="505" height="16" font="1">Dept. of Geodesy and Geoinformatics, Stuttgart University, 1999.</text>
<text top="581" left="121" width="689" height="16" font="1">[16] B. A. Francis and W. M. Wonham. The internal model principle for linear multivari-</text>
<text top="603" left="158" width="571" height="16" font="1">able regulators. Applied Mathematics &amp; Optimization, 2(2):170–194, 1975.</text>
<text top="639" left="121" width="689" height="16" font="1">[17] G. F. Franklin, J. D. Powell, and A. Emami-Naeini. Feedback Control of Dynamic</text>
<text top="660" left="158" width="515" height="16" font="1">Systems. Prentice Hall, Upper Saddle River, NJ, 5th edition, 2008.</text>
<text top="697" left="121" width="688" height="16" font="1">[18] J. Fung and S. Mann. Using graphics devices in reverse: GPU-based image processing</text>
<text top="718" left="158" width="652" height="16" font="1">and computer vision. In Proceedings of IEEE International Conference on Multimedia</text>
<text top="740" left="158" width="261" height="16" font="1">and Expo, pages 9–12, April 2008.</text>
<text top="776" left="121" width="689" height="16" font="1">[19] G. H. Golub and H. A. van der Vorst. Eigenvalue computation in the 20th century.</text>
<text top="798" left="158" width="572" height="16" font="1">Journal of Computational and Applied Mathematics, 123(1-2):35–65, 2000.</text>
<text top="834" left="121" width="688" height="16" font="1">[20] D. M. Halford. Aerodynamic Data for the BAC 221 up to a Mach Number of 0.955</text>
<text top="856" left="158" width="642" height="16" font="1">as Measured in Wind Tunnel Tests. Her Majesty’s Stationery Oﬃce, London, 1972.</text>
<text top="892" left="121" width="688" height="16" font="1">[21] P. G. Hamel and R. V. Jategaonkar. The role of system identiﬁcation for ﬂight ve-</text>
<text top="913" left="158" width="652" height="16" font="1">hicle applications - revisited. In Proceedings of RTO SCI Symposium on ”System</text>
<text top="935" left="158" width="641" height="16" font="1">Identiﬁcation for Integrated Aircraft Development and Flight Testing”, March 1998.</text>
<text top="971" left="121" width="688" height="16" font="1">[22] M. J. Harvey and G. D. Fabritiis. Swan: A tool for porting CUDA programs to</text>
<text top="993" left="158" width="545" height="16" font="1">OpenCL. Computer Physics Communications, 182(4):1093–1099, 2011.</text>
<text top="1038" left="457" width="18" height="16" font="1">81</text>
</page>
<page number="91" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">[23] J. Hauser and R. Hindman. Aggressive ﬂight maneuvers. In Proceedings of 36th IEEE</text>
<text top="213" left="158" width="507" height="16" font="1">Conference on Decision and Control, pages 4186–4191, Dec. 1997.</text>
<text top="249" left="121" width="688" height="16" font="1">[24] J. Huang, S. P. Ponce, S. I. Park, Y. Cao, and F. Quek. GPU-accelerated compu-</text>
<text top="271" left="158" width="652" height="16" font="1">tation for robust motion tracking using the CUDA framework. In Proceedings of 5th</text>
<text top="293" left="158" width="652" height="16" font="1">International Conference on Visual Information Engineering, pages 437–442, Aug.</text>
<text top="314" left="158" width="40" height="16" font="1">2008.</text>
<text top="351" left="121" width="689" height="16" font="1">[25] K. Ilif. Aircraft parameter estimation. Technical Report NASA TM 88281, Ames Re-</text>
<text top="373" left="158" width="652" height="16" font="1">search Center, National Aeronautics and Space Administration, Edwards, California</text>
<text top="394" left="158" width="95" height="16" font="1">93523, 1987.</text>
<text top="431" left="121" width="689" height="16" font="1">[26] K. Ilif and R. Maine. Practical aspects of using a maximum likelihood estimation</text>
<text top="453" left="158" width="652" height="16" font="1">method to extract stability and control derivatives from ﬂight data. Technical Report</text>
<text top="474" left="158" width="652" height="16" font="1">NASA TN D-8209, Dryden Flight Research Center, National Aeronautics and Space</text>
<text top="496" left="158" width="426" height="16" font="1">Administration, Edwards, California 93523, April 1976.</text>
<text top="532" left="121" width="688" height="16" font="1">[27] AMD Inc. Heterogeneous computing, OpenCL and the ATI Radeon HD5870 (”Ever-</text>
<text top="554" left="158" width="204" height="16" font="1">green”) architecture, 2010.</text>
<text top="591" left="121" width="118" height="16" font="1">[28] AMD Inc.</text>
<text top="591" left="263" width="294" height="16" font="1">OpenCL and the AMD APP SDK.</text>
<text top="592" left="579" width="231" height="15" font="1"><a href="http://developer.amd.com/documentation/articles/pages/OpenCL-and-the-AMD-APP-SDK.aspx">http://developer.amd.com/</a></text>
<text top="614" left="158" width="652" height="15" font="1"><a href="http://developer.amd.com/documentation/articles/pages/OpenCL-and-the-AMD-APP-SDK.aspx">documentation/articles/pages/OpenCL-and-the-AMD-APP-SDK.aspx, </a>April 2011.</text>
<text top="649" left="121" width="688" height="16" font="1">[29] A. Isidori. Nonlinear Control Systems. Springer-Verlag New York, Inc., Secaucus, NJ,</text>
<text top="671" left="158" width="87" height="16" font="1">USA, 1995.</text>
<text top="707" left="121" width="688" height="16" font="1">[30] A. Isidori and C. I. Byrnes. Output regulation of nonlinear systems. IEEE Transac-</text>
<text top="729" left="158" width="379" height="16" font="1">tions on Automatic Control, 35(2):131–140, 1990.</text>
<text top="766" left="121" width="688" height="16" font="1">[31] F. James, S. Mann, and C. Aimone. Openvidia: Parallel GPU computer vision. In</text>
<text top="787" left="158" width="339" height="16" font="1">Proceedings of ACM Multimedia, Nov. 2005.</text>
<text top="824" left="121" width="689" height="16" font="1">[32] R. V. Jategaonkar. Flight Vehicle System Identiﬁcation - A Time Domain Methodol-</text>
<text top="846" left="158" width="488" height="16" font="1">ogy. American Institute of Aeronautics and Astronautics, 2006.</text>
<text top="882" left="121" width="688" height="16" font="1">[33] R. V. Jategaonkar and E. Plaetschke. Estimation of aircraft parameters using ﬁlter</text>
<text top="904" left="158" width="652" height="16" font="1">error methods and extended kalman ﬁlter. Technical Report DFVLR-FB 88-15, In-</text>
<text top="926" left="158" width="652" height="16" font="1">stitute of Flight Systems, German Aerospace Center, Lilienthalplatz, Braunschweig,</text>
<text top="947" left="158" width="95" height="16" font="1">March 1988.</text>
<text top="1038" left="457" width="18" height="16" font="1">82</text>
</page>
<page number="92" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">[34] R. V. Jategaonkar and E. Plaetschke. Algorithms for aircraft parameter estimation</text>
<text top="213" left="158" width="652" height="16" font="1">accounting for process and measurement noise. Journal of Aircraft, 26(4):360–372,</text>
<text top="234" left="158" width="85" height="16" font="1">April 1989.</text>
<text top="270" left="122" width="688" height="16" font="1">[35] H. K. Khalil. Robust servomechanism output feedback controllers for feedback lin-</text>
<text top="291" left="158" width="427" height="16" font="1">earizable systems. Automatica, 30(10):1587–1599, 1994.</text>
<text top="327" left="122" width="450" height="16" font="1">[36] H. K. Khalil. Nonlinear Systems. Prentice Hall, 1996.</text>
<text top="362" left="122" width="688" height="16" font="1">[37] J. Kim, M. Hwangbo, and T. Kanade. Realtime aﬃne-photometric klt feature tracker</text>
<text top="384" left="158" width="652" height="16" font="1">on GPU in CUDA framework. In Proceedings of 12th International Conference on</text>
<text top="406" left="158" width="431" height="16" font="1">Computer Vision Workshops, pages 886–893, Oct. 2009.</text>
<text top="441" left="122" width="688" height="16" font="1">[38] M. Lalonde, D. Byrns, L. Gagnon, N. Teasdale, and D. Laurendeau. Real-time eye</text>
<text top="463" left="158" width="652" height="16" font="1">blink detection with GPU-based sift tracking. In Proceedings of Fourth Canadian</text>
<text top="485" left="158" width="541" height="16" font="1">Conference on Computer and Robot Vision, pages 481–487, May 2007.</text>
<text top="520" left="122" width="689" height="16" font="1">[39] S. H. Lane and R. F. Stengel. Flight control design using non-linear inverse dynamics.</text>
<text top="542" left="158" width="255" height="16" font="1">Automatica, 24(4):471–483, 1988.</text>
<text top="577" left="121" width="689" height="16" font="1">[40] P. Li and L. Xiao. Mean shift parallel tracking on GPU. In Proceedings of 4th Iberian</text>
<text top="599" left="158" width="638" height="16" font="1">Conference on Pattern Recognition and Image Analysis, pages 120–127, June 2009.</text>
<text top="634" left="122" width="689" height="16" font="1">[41] D. G. Lowe. Distinctive image features from scale-invariant keypoints. International</text>
<text top="656" left="158" width="376" height="16" font="1">Journal of Computer Vision, 60(2):91–110, 2004.</text>
<text top="691" left="122" width="689" height="16" font="1">[42] B. D. Lucas and T. Kanade. An iterative image registration technique with an ap-</text>
<text top="713" left="158" width="652" height="16" font="1">plication to stereo vision. In Proceedings of DARPA Image Understanding Workshop,</text>
<text top="735" left="158" width="205" height="16" font="1">pages 121–130, April 1981.</text>
<text top="770" left="122" width="688" height="16" font="1">[43] Y. Luo and R. Duraiswami. Canny edge detection on NVIDIA CUDA. In Proceedings</text>
<text top="792" left="158" width="652" height="16" font="1">of IEEE Computer Society Conference on Computer Vision and Pattern Recognition</text>
<text top="813" left="158" width="261" height="16" font="1">Workshops, pages 1–8, June 2008.</text>
<text top="849" left="122" width="689" height="16" font="1">[44] L. Meng, L. Li, and S. M. Veres. Aerodynamic parameter estimation of an unmanned</text>
<text top="871" left="158" width="652" height="16" font="1">aerial vehicle based on extended kalman ﬁlter and its higher order approach. In Pro-</text>
<text top="892" left="158" width="652" height="16" font="1">ceedings of 2nd International Conference on Advanced Computer Control (ICACC),</text>
<text top="914" left="158" width="295" height="16" font="1">volume 5, pages 526–531, March 2010.</text>
<text top="949" left="122" width="688" height="16" font="1">[45] M. Naruoka, T. Hino, R. Nakagawa, T. Tsuchiya, and S. Suzuki. System identiﬁcation</text>
<text top="971" left="158" width="652" height="16" font="1">of small UAVs with mems-based avionics. In Proceedings of AIAA Infotech@Aerospace</text>
<text top="993" left="158" width="346" height="16" font="1">Conference, Seattle, Washington, April 2009.</text>
<text top="1038" left="457" width="18" height="16" font="1">83</text>
</page>
<page number="93" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="688" height="16" font="1">[46] F. Porikli. Achieving real-time object detection and tracking under extreme conditions.</text>
<text top="213" left="158" width="444" height="16" font="1">Journal of Real-Time Image Processing, 1(1):33–40, 2006.</text>
<text top="249" left="122" width="688" height="16" font="1">[47] F. Porikli and O. Tuzel. Covariance tracking using model update based on lie algebra.</text>
<text top="271" left="158" width="652" height="16" font="1">Technical Report TR2005-127, Mitsubishi Electric Research Laboratories, June 2006.</text>
<text top="308" left="122" width="688" height="16" font="1">[48] F. Quek and R. Bryll. Vector coherence mapping: A parallelizable approach to image</text>
<text top="329" left="158" width="652" height="16" font="1">ﬂow computation. In Roland Chin and Ting-Chuen Pong, editors, Computer Vision</text>
<text top="351" left="158" width="652" height="16" font="1">ACCV’98, volume 1352 of Lecture Notes in Computer Science, pages 591–598. Springer</text>
<text top="373" left="158" width="200" height="16" font="1">Berlin / Heidelberg, 1997.</text>
<text top="409" left="122" width="688" height="16" font="1">[49] S. Saripalli, J. F. Montgomery, and G. S. Sukhatme. Visually guided landing of an</text>
<text top="431" left="158" width="652" height="16" font="1">unmanned aerial vehicle. Robotics and Automation, IEEE Transactions on, 19(3):371–</text>
<text top="453" left="158" width="119" height="16" font="1">380, June 2003.</text>
<text top="489" left="122" width="689" height="16" font="1">[50] J. Shi and C. Tomasi. Good features to track. In Proceedings of IEEE Computer</text>
<text top="511" left="158" width="652" height="16" font="1">Society Conference on Computer Vision and Pattern Recognition, pages 593–600, June</text>
<text top="532" left="158" width="40" height="16" font="1">1994.</text>
<text top="569" left="122" width="689" height="16" font="1">[51] T. Shimobaba, T. Ito, N. Masuda, Y. Ichihashi, and N. Takada. Fast calculation</text>
<text top="591" left="158" width="652" height="16" font="1">of computer-generated-hologram on AMD HD5000 series GPU and OpenCL. Opt.</text>
<text top="612" left="158" width="291" height="16" font="1">Express, 18(10):9955–9960, May 2010.</text>
<text top="649" left="122" width="689" height="16" font="1">[52] S. Sinha, J-M. Frahm, M. Pollefeys, and Y Genc. GPU-based video feature tracking</text>
<text top="671" left="158" width="652" height="16" font="1">and matching. Technical Report TR 06-012, Dept. of Computer Science, University</text>
<text top="692" left="158" width="320" height="16" font="1">of North Carolina Chapel Hill, May 2006.</text>
<text top="729" left="122" width="673" height="16" font="1">[53] J. E. Slotine and Weiping Li. Applied Nonlinear Control. Prentice-Hall, Inc., 1991.</text>
<text top="766" left="122" width="689" height="16" font="1">[54] C. Teuliere, L. Eck, and E. Marchand. Chasing a moving target from a ﬂying UAV.</text>
<text top="787" left="158" width="652" height="16" font="1">In Proceedings of International Conference on Intelligent Robots and Systems, pages</text>
<text top="809" left="158" width="175" height="16" font="1">4929–4934, Sept. 2011.</text>
<text top="846" left="122" width="689" height="16" font="1">[55] P. Theodorakopoulos and S. Lacroix. A strategy for tracking a ground target with a</text>
<text top="867" left="158" width="652" height="16" font="1">UAV. In Proceedings of International Conference on Intelligent Robots and Systems,</text>
<text top="889" left="158" width="223" height="16" font="1">pages 1254–1259, Sept. 2008.</text>
<text top="926" left="122" width="455" height="16" font="1">[56] C. Tomlin, J. Lygeros, L. Benvenuti, and S. Sastry.</text>
<text top="926" left="592" width="218" height="16" font="1">Output tracking for a non-</text>
<text top="947" left="158" width="652" height="16" font="1">minimum phase dynamic ctol aircraft model. In Proceedings of 34th IEEE Conference</text>
<text top="969" left="158" width="412" height="16" font="1">in Decision and Control, pages 1867–1872, Dec. 1995.</text>
<text top="1038" left="457" width="18" height="16" font="1">84</text>
</page>
<page number="94" position="absolute" top="0" left="0" height="1188" width="918">
<text top="191" left="122" width="176" height="16" font="1">[57] Tom’s Hardware.</text>
<text top="191" left="326" width="484" height="16" font="1">Charts, benchmarks desktop CPU charts 2010, raw per-</text>
<text top="213" left="158" width="75" height="16" font="1">formance.</text>
<text top="214" left="263" width="547" height="15" font="1"><a href="http://www.tomshardware.com/charts/desktop-cpu-charts-2010/Raw-Performance-SiSoftware-Sandra-2010-Pro-GFLOPS,2409.html">http://www.tomshardware.com/charts/desktop-cpu-charts-2010/</a></text>
<text top="236" left="158" width="600" height="15" font="1"><a href="http://www.tomshardware.com/charts/desktop-cpu-charts-2010/Raw-Performance-SiSoftware-Sandra-2010-Pro-GFLOPS,2409.html">Raw-Performance-SiSoftware-Sandra-2010-Pro-GFLOPS,2409.html, </a>2010.</text>
<text top="271" left="122" width="689" height="16" font="1">[58] O. Tuzel, F. Porikli, and P. Meer. Region covariance: A fast descriptor for detec-</text>
<text top="293" left="158" width="652" height="16" font="1">tion and classiﬁcation. Technical Report TR2005-111, Mitsubishi Electric Research</text>
<text top="314" left="158" width="187" height="16" font="1">Laboratories, May 2006.</text>
<text top="351" left="122" width="689" height="16" font="1">[59] A. Wald. Note on the consistency of the maximum likelihood estimate. The Annals</text>
<text top="373" left="158" width="367" height="16" font="1">of Mathematical Statistics, 20(4):595–601, 1949.</text>
<text top="409" left="122" width="523" height="16" font="1">[60] W. Whitacre, M. Campbell, M. Wheeler, and D. Stevenson.</text>
<text top="409" left="661" width="149" height="16" font="1">Flight results from</text>
<text top="431" left="158" width="652" height="16" font="1">tracking ground targets using SeaScan UAVs with gimballing cameras. In Proceedings</text>
<text top="453" left="158" width="458" height="16" font="1">of American Control Conference, pages 377–383, July 2007.</text>
<text top="1038" left="457" width="18" height="16" font="1">85</text>
</page>
</pdf2xml>
